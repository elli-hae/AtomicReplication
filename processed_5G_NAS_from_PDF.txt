Non-Access-Stratum (NAS) protocol for 5G System (5GS);.
(3GPP specification document version 1 Release 16).
650 Route des Lucioles F-06921 Sophia Antipolis Cedex - FRANCE.
Association à but non lucratif enregistrée à la Sous-Préfecture de Grasse (06) N° 7803/88 The present document can be downloaded from: The present document may be made available in electronic versions and/or in print.
The content of any electronic and/or print versions of the present document shall not be modified wi thout the prior written authorization of ETSI.
In case of any existing or perceived difference in contents between such versions and/or in print, the prevailing version of an ETSI deliverable is the one made publicly available in PDF format at www.
Users of the present document should be aware that the document may be subject to revision or change of status.
Information on the current status of this and other ETSI documents is available at If you find errors in the present document, please send your comment to one of the following services:.
No part may be reproduced or utilized in any form or by any means, electronic or mechanical, including photocopying and microfilm except as authorized by written permission of ETSI.
The content of the PDF version shall not be modified without the written authorization of ETSI.
The copyright and the foregoing restriction extend to reproduction in all media.
DECT™, PLUGTESTS™, UMTS™ and the ETSI logo are trademarks of ETSI registered for the benefit of its Members.
3GPP™ and LTE™ are trademarks of ETSI registered for the benefit of its Members and of the 3GPP Organizational Partners.
of the oneM2M Partners.
GSM® and the GSM logo are trademarks registered and owned by the GSM Association.
IPRs essential or potentially essential to normative deliverables may have been declared to ETSI.
The information pertaining to these essential IPRs, if any, is publicly available for ETSI members and non-members , and can be found in ETSI SR 000 314: "Intellectual Property Rights (IPRs); Essential, or potentially Essential, IPRs notified to ETSI in respect of ETSI standards" , which is available from the ETSI Secretariat.
Latest updates are available on the ETSI Web Pursuant to the ETSI IPR Policy, no investigation, including IPR searches, has been carried out by ETSI.
No guarantee can be given as to the existence of other IPRs not referenced in ETSI SR 000 314 (or the updates on the ETSI Web server) which are, or may be, or may become, essential to the present document.
The present document may include trademarks and/or tradenames which are asserted and/or registered by their owners.
right to use or reproduce any trademark and/or tradename.
Mention of those trademarks in the present document does not constitute an endorsement by ETSI of products, serv ices or organizations associated with those trademarks.
This Technical Specification (TS) has been produced by ETSI 3rd Generation Partnership Project (3GPP).
The present document may refer to technical specifications or reports using their 3GPP identities.
These shall be interpreted as being references to the corresponding ETSI deliverables.
The cross reference between 3GPP and ETSI identities can be found under http://webapp.
In the present document " shall ", "shall not ", "should ", "should not ", "may", "need not ", "will", "will not ", "can" and "cannot " are to be interpreted as described in clause of the ETSI Drafting Rules (Verbal forms for the expression of "must " and "must not " are NOT allowed in ETSI deliverables except when used in direct citation.
2 Modal verbs te rminology .
22 3 Definitions and abbreviations .
36 Coordination between the protocols for 5GS mob ility management and 5GS session management .
36 UE domain selection .
37 UE's usage setting .
37 Domain selection for UE originating sess ions / calls .
37 Change of UE's usage setting .
39 NAS security .
40 Handling of 5G NAS security contexts.
40 to N1 mode in 5GMM-CONNECTED mode .
42 Establishment of a 5G NAS security context during N1 mode to N1 mode handover .
43 Establishment of an EPS security context during inter-system change from N1 mode to S1 mode in 5GMM-CONNECTED mode .
44 Establishment of secure exchange of NAS messages .
45 Change of security keys .
46 Handling of NAS COUNT and NAS sequence number .
47 Replay protection .
48 Integrity protection and verification .
48 Ciphering and deciphering .
48 NAS COUNT wrap around .
49 Integrity protection of NAS signalling messages.
49 Integrity checking of NAS signalling messages in the UE .
50 Integrity checking of NAS signalling messages in the AMF .
50 Ciphering of NAS signalling messages .
52 Unified access control .
54 UEs not operating in SNPN access mode .
56 UEs operating in SNPN access mode .
62 Operator-defined access categories .
66 Access control and checking .
68 Access control and checking in 5GMM-IDLE mode and in 5GMM-IDLE mode with suspend indication .
68 Access control and checking in 5GMM-CONNECTED mode and in 5GMM-CONNECTED mode with RRC inactive indication .
70 Exception handling and avoiding double barring .
72 Mapping between access categories/access identities and RRC establishment cause .
76 NSSAI storage .
79 Provision of NSSAI to lower layers in 5GMM-IDLE mode .
81 Network slice-specific authentication and authorization .
83 Session management aspects .
84 NAS over non-3GPP access .
84 5GS mobility ma nagement aspects .
84 Establishment cause for non-3GPP access .
85 5GS session management aspects .
86 Limited service state over non-3GPP access .
86 NAS signalling using trusted WLAN access network .
87 Interworking with E-UTRAN connected to EPC .
87 Single-registration mode .
87 Single-registration mode with N26 interface .
88 Single-registration mode without N26 interface .
88 Interworking between NG-RAN and E-UTRAN .
88 Interworking between TNGF or N3IWF connected to 5GCN and E-UTRAN.
89 Dual-registration mode .
90 Core Network selection for UEs not using CIoT 5GS optimizations .
91 A Core Network selection and redir ection for UEs using CIoT optimizations.
1 Core network selection .
2 Redirection of the UE by the core network .
92 Disabling and re-enabling of UE's N1 mode capability .
93 Disabling and re-enabling of UE 's N1 mode capab ility for 3G PP access .
93 Disabling and re-enabling of UE's N1 mode capability for non-3GPP access.
95 0 Interworking with ePDG connected to EPC .
96 1 UE configuration parameter updates .
96 2 Access traffic steering, switching and sp litting (A TSSS) .
96 3 Support of NAS signalling using wireline access network .
96 4 Non-public network .
97 Stand-alone non-public network .
97 Public network integrated non-public network (PNI-NPN) .
98 5 Time sensitive communication .
99 Integration with TSN network .
99 Time synchronization .
99 TSN bridge management .
99 6 UE radio capability signalling optim isation .
100 7 5GS mobility management in NB-N1 mode .
101 8 5GS session management in NB-N1 mode .
101 9 5GS mobility management in WB-N1 mode for IoT .
102 0 5GS session management in WB-N1 mode for IoT .
102 5 Elementary procedures for 5GS mobility ma nagement .
103 Types of 5GMM procedures .
103 5GMM sublayer states .
104 5GMM sublayer states .
104 5GMM sublayer states in the UE.
105 Substates of state 5GMM-DEREGISTERED .
Substates of state 5GMM-REGISTERED .
5GS update status in the UE .
108 5GMM sublayer states in the network side .
109 Coordination between 5GMM and EMM .
110 Coordination between 5GMM for 3GPP access and EMM with N26 interface .
110 Coordination between 5GMM for 3GPP access and EMM without N26 interface .
110 Coordination between 5GMM and GMM .
111 Behaviour of the UE in state 5GMM-DEREGISTERED and state 5GMM-REGISTERED .
111 UE behaviour in state 5GMM-DEREGISTERED .
111 Primary substate selection .
111 Selection of the substate after power on .
111 Detailed description of UE behaviour in state 5GMM-DEREGISTERED .
113 Substate when back to state 5GMM-DEREGISTERED from another 5GMM state .
114 UE behaviour in state 5GMM-REGISTERED .
114 Detailed description of UE behaviour in state 5GMM-REGISTERED .
116 Establishment of the N1 NAS signalling connection .
117 Re-establishment of the N1 NAS signalling connection .
118 Release of the N1 NAS signalling connection .
119 5GMM-CONNECTED mode with RRC inactive indication .
122 Suspend and resume of the N1 NAS signalling connection .
124 Permanent identifiers .
125 Temporary identities .
127 Registration areas .
127 Service area restrictions .
128 3GPP access service area restrictions .
128 Wireline access service area restrictions .
131 Mobile initiated connection only mode .
132 Handling of NAS level mobility management congestion control .
135 0 Handling of DNN based congestion control .
136 1 Handling of S-NSSAI based congestion control .
136 2 Handling of local emergency numbers .
136 2A Handling of local emergency numbers received via 3GPP access and non-3GPP access .
3 Lists of 5GS forbidden tracking areas.
138 3A Forbidden PLMN lists .
139 4 List of equivalent PLMNs .
139 5 Transmission failure abnormal case in the UE .
139 6 Extended DRX cycle for UEs in 5GMM-IDLE .
7 Service Gap Control.
140 8 Restriction on use of enhanced coverage .
142 9 Handling of congestion control for trans port of user data via the control plane .
143 9a Specific requirements for UE configured to use timer T3245 .
143 0 Specific requirements for UE when receiving non-integrity protected reject messages .
144 Requirements for UE in an SNPN .
148 1 CIoT 5GS optimizations .
151 2 Interaction between MICO mode with active time and extended idle mode DRX cycle .
153 3 Forbidden wireline access area .
153 4 WUS assistance .
153 5GMM common procedures.
154 Primary authentication and key agreement procedure .
154 EAP based primary authentication and key agreement procedure .
154 EAP-AKA' related procedures.
157 UE successfully authenticates network .
157 Errors when handling EAP-request/AKA'-challenge message .
158 Network successfully authenticates UE .
158 UE handling EAP-AKA' notification message .
158 A EAP based Identification initiation by the network .
158 B EAP based Identification response by the UE .
159 Network sending EAP-success message .
159 UE handling EAP-success message .
159 Network not successfully authenticates UE .
159 0 Network sending EAP-failure message .
159 1 UE handling EAP-failure message .
B Procedures related to EAP methods used for primary authentication of an N5GC device .
EAP message reliable transport procedure .
168 EAP message reliable transport procedure initiation by the network .
168 EAP message reliable transport procedure accepted by the UE.
169 Abnormal cases on the network side .
169 Abnormal cases in the UE .
169 EAP result message transport procedure .
171 EAP result message transport procedure initiation by the network .
171 5G AKA based primary authentication and key agreement procedure .
172 Authentication initiation by the network .
173 Authentication response by the UE .
173 Authentication completion by the network .
174 Authentication not accepted by the network .
174 Authentication not accepted by the UE .
176 Abnormal cases .
177 Security mode control procedure .
181 NAS security mode control initiation by the network .
181 NAS security mode command accepted by the UE .
184 NAS security mode control completion by the network .
186 NAS security mode command not accepted by the UE.
186 Abnormal cases in the UE .
186 Abnormal cases on the network side .
187 Identification procedure .
187 Identification initiation by the network .
188 Identification response by the UE .
188 Identification completion by the network .
188 Abnormal cases in the UE .
188 Abnormal cases on the network side .
188 Generic UE configuration update procedure.
189 Generic UE configuration update procedure initiated by the network .
191 Generic UE configuration update accepted by the UE .
193 Generic UE configuration update completion by the network .
197 Abnormal cases in the UE .
197 Abnormal cases on the network side .
198 NAS transport procedure(s) .
199 UE-initiated NAS transport procedure .
200 UE-initiated NAS transport of messages accepted by the network .
202 UE-initiated NAS transport of messages not accepted by the network .
206 Abnormal cases on the network side .
208 Abnormal cases in the UE .
212 Network-initiated NAS transport procedure .
214 Network-initiated NAS transport proced ure initiation .
215 Network-initiated NAS transport of messages .
218 5GMM status procedure .
221 5GMM status received in the UE .
222 Network slice-specific EAP message reliable transport procedure initiation .
223 Network slice-specific EAP message reliable transport procedure accepted by the UE .
224 Abnormal cases on the network side .
224 Abnormal cases in the UE .
224 Network slice-specific EAP result message transport procedure .
225 Network slice-specific EAP result message transport procedure initiation .
225 5GMM specific procedures .
225 Registration procedure .
225 Registration procedure for initial registration .
226 Initial registration initiation .
227 5GMM common procedure initiation .
232 Initial registration accepted by the network .
232 Initial registration not accepted by the network .
244 Initial registration for emergency services not accepted by the network .
253 Abnormal cases in the UE .
253 Abnormal cases on the network side .
256 Registration procedure for mobili ty and periodic registration update .
258 Mobility and periodic registration update initiation .
258 5GMM common procedure initiation .
266 Mobility and periodic registrati on update accepted by the network .
267 Mobility and periodic registration update not accepted by the network .
284 Mobility and periodic registration update for initiating an emergency PDU session not accepted by the network .
292 Abnormal cases in the UE .
293 Abnormal cases on the network side .
296 De-registration procedure .
298 UE-initiated de-registration procedure .
299 UE-initiated de-regis tration procedure completion .
300 UE-initiated de-registration procedure completion for 5GS services over 3GPP access.
300 UE-initiated de-registration procedure completion for 5GS services over both 3GPP access and non-3GPP access .
301 Abnormal cases in the UE .
301 Abnormal cases in the network side .
303 Network-initiated de-registration procedure .
304 Network-initiated de-registration procedure initiation .
304 Network-initiated de-registration procedure completion by the UE .
304 Network-initiated de-registration procedure completion by the network .
310 Abnormal cases in the UE .
310 Abnormal cases in the network side .
310 eCall inactivity procedure .
311 5GMM connection management procedures .
312 Service request procedure .
312 Service request procedure initiation .
316 UE is not using 5GS services wi th control plane CIoT 5GS optimization .
316 UE is using 5GS services with control plane CIoT 5GS optimization .
318 Common procedure initiation.
320 Service request procedure accepted by the network .
320 UE is not using 5GS services wi th control plane CIoT 5GS optimization .
320 UE is using 5GS services with control plane CIoT 5GS optimization .
322 Paging procedure .
338 Paging for 5GS services .
338 Abnormal cases on the network side .
339 Abnormal cases in the UE .
339 Notification procedure .
340 Notification pr ocedure initiation .
340 Notification procedure completion .
341 Abnormal cases on the network side .
341 Abnormal cases on the UE side .
342 6 Elementary procedures for 5GS session management .
342 Types of 5GSM procedures .
343 5GSM sublayer states .
343 5GSM sublayer states in the UE .
343 PDU SESSION INACTIVE .
344 PDU SESSION ACTIVE PENDING .
344 PDU SESSION ACTIVE .
344 PDU SESSION INACTIVE PENDING .
344 PDU SESSION MODIFICATION PENDING .
344 PROCEDURE TRANSACTION INACTIVE.
344 PROCEDURE TRANSACTION PENDING .
344 5GSM sublayer states in the network side .
345 PDU SESSION INACTIVE .
345 PDU SESSION ACTIVE .
345 PDU SESSION INACTIVE PENDING .
345 PDU SESSION MODIFICATION PENDING .
346 PROCEDURE TRANSACTION INACTIVE.
346 PROCEDURE TRANSACTION PENDING .
346 Coordination between 5GSM and ESM.
346 Coordination between 5GSM and ESM with N26 interface .
34 6 Coordination between 5GSM and ESM without N26 interface .
358 a Coordination between 5GSM and SM .
360 Coordination for interworking with ePDG connected to EPC .
360 General on elementary 5GSM procedures .
360 Principles of PTI handling for 5GSM procedures.
360 PDU session types .
362 PDU session management .
362 IP address allocation .
362 IP address allocation via NAS signalling .
363 Additional RG requirements for IP address allocation .
364 Quality of service .
364 QoS rules .
364 Signalled QoS rules .
365 Derived QoS rules .
366 QoS flow descriptions .
366 Se ssion-AMBR .
Ignoring RQI in the UE.
370 QoS in MA PDU session .
370 Local area data network (LADN) .
371 Handling of DNN based congestion control .
372 Handling of S-NSSAI based congestion control .
372 Interaction with upper layers .
374 0 Handling of 3GPP PS data off .
374 1 Multi-homed IPv6 PDU session .
375 2 Handling of network rejection not due to congestion control .
375 3 Handling of Small data rate control .
376 4 Handling of Serving PLMN rate control .
377 5 Handling of Reliable Data Service .
378 6 Handling of header compression for control plane CIoT optimizations .
378 Network-requested 5GSM procedures .
378 PDU session authentication and authorization procedure .
378 PDU EAP message reliable transport procedure .
380 PDU EAP message reliable transport procedure accepted by the UE .
381 Abnormal cases on the network side .
381 Abnormal cases in the UE .
382 PDU EAP result message transport procedure .
382 PDU EAP result message transport procedure initiation .
382 Network-requested PDU session modification procedure .
382 Network-requested PDU session modification procedure initiation .
382 Network-requested PDU session modification procedure accepted by the UE .
385 Network-requested PDU session modification procedure not accepted by the UE.
391 Abnormal cases on the network side .
395 Abnormal cases in the UE .
396 Network-requested PDU session release procedure .
396 Network-requested PDU session release procedure initiation .
396 Network-requested PDU session release procedure accepted by the UE .
398 N1 SM delivery skipped .
405 Abnormal cases on the network side .
405 Abnormal cases in the UE .
406 UE-requested 5GSM procedures .
406 UE-requested PDU session establishment procedure .
406 UE-requested PDU session establishment procedure initiation .
406 UE-requested PDU session establishment procedure accepted by the network .
413 UE requested PDU session establishment procedure not accepted by the network .
421 Handling of network rejection due to congestion control .
424 Handling of network rejection not due to congestion control .
430 Handling the maximum number of established PDU sessions .
43 5 A Handling the maximum number of allowed active user-plane resources for PDU sessions of UEs in NB-N1 mode .
435 Abnormal cases in the UE .
436 Abnormal cases on the network side .
436 UE-requested PDU session modification procedure .
437 Handling of network rejection due to congestion control .
442 Handling of network rejection not due to congestion control .
448 Abnormal cases in the UE .
451 Abnormal cases on the network side .
452 UE-requested PDU session release procedure .
453 UE-requested PDU session release procedure initiation .
453 UE-requested PDU session release procedure accepted by the network .
454 UE-requested PDU session release procedure not accepted by the network .
454 Abnormal cases in the UE .
454 Abnormal cases on the network side .
455 5GSM status procedure .
455 5GSM status received in the UE .
455 5GSM status received in the SMF .
456 Miscellaneous procedures .
456 Exchange of extended protocol configuration options .
456 7 Handling of unknown, unforeseen, and erroneous protocol data .
457 Message too short or too long .
457 Message too short .
457 Message too long .
457 Unknown or unforeseen procedure trans action identity or PDU Session identity .
457 Procedure transaction identity.
457 PDU Session identity .
458 Unknown or unforeseen message type .
459 Non-semantical mandatory information element errors .
459 Common procedures .
459 5GS mobility management .
460 5GS session management .
460 Unknown and unforeseen IEs in the non-imperative message part .
461 IEIs unknown in the message .
461 Out of sequence IEs .
461 Repeated IEs .
461 Non-imperative message part errors .
461 Syntactically incorrect optional IEs .
461 Conditional IE errors .
461 Messages with semantical ly incorrect contents .
462 8 Message functional defi nitions and contents .
462 5GS mobility mana gement messages .
462 Authentication request .
462 Message definition .
462 Authentication parameter RAND .
462 Authentication parameter AUTN .
463 Authentication response .
463 Message definition .
463 Authentication response parameter .
463 Authentication result .
463 Message definition .
463 Authentication failure .
464 Message definition .
464 Registration request .
465 Message definition .
465 Non-current native NAS key set identifier .
468 5GMM capability .
468 UE security capability .
468 Requested NSSAI .
468 Last visited registered TAI .
468 S1 UE network capability .
468 Uplink data status .
468 PDU session status .
468 0 MICO indication .
468 2 Additional GUTI .
469 3 Allowed PDU session status .
469 4 UE's usage setting .
469 5 Requested DRX parameters .
469 6 EPS NAS message container.
469 7 LADN indication .
469 7A Payload container type .
469 8 Payload container .
469 9 Network slicing indication .
470 0 5GS update type .
470 1 NAS message container .
470 2 Requested extended DRX parameters .
470 3 EPS bearer context status .
470 5 Mobile station classmark 2 .
470 6 Suppor ted codecs .
470 7 UE radio capability ID .
470 8 Requested mapped NSSAI .
470 9 Additional information requested .
471 0 Requested WUS assistance information.
2 N5GC indication .
471 3 Requested NB-N1 mode DRX parameters .
471 Registration accept .
471 Message definition .
471 Equivalent PLMNs .
474 TAI list .
474 Allowed NSSAI .
474 Rejected NSSAI .
474 Configured NSSAI .
475 5GS network feature support.
475 PDU session status .
475 0 PDU session reactivation result .
475 1 PDU session reactivation result error cause .
475 2 LADN information .
475 3 MICO indication .
475 4 Network slicing indication .
475 5 Service area list .
475 7 Non-3GPP de-registration timer value .
476 9 Emergency number list .
476 0 Extended emergency number list .
476 1 SOR transparent container .
476 2 EAP message.
476 7 Negotiated extended DRX parameters .
477 1 EPS bearer context status .
477 2 UE radio capability ID .
477 3 UE radio capability ID deletion indication .
477 4 Pending NSSAI .
477 5 Ciphering key data .
477 6 CAG information list.
477 7 Truncated 5G-S-TMSI configuration .
477 8 Negotiated NB-N1 mode DRX parameters .
478 9 Negotiated WUS assistance information .
478 Registration complete .
478 Message definition .
478 SOR transparent container .
478 Registration reject .
478 Message definition .
479 Rejected NSSAI .
479 CAG information list.
479 0 UL NAS transport .
479 Message definition .
479 PDU session ID .
480 Old PDU session ID .
480 Request type .
480 Additional information .
481 MA PDU session information .
481 Release assistance indication .
481 1 DL NAS transport .
481 Message definition .
481 PDU session ID .
482 Additional information .
482 Back-off timer value .
482 2 De-registration request (UE originating de-registration) .
482 Message definition .
482 3 De-registration accept (UE originating de-registration).
482 Message definition .
482 4 De-registration request (UE terminated de-r egistration) .
483 Message definition .
483 Rejected NSSAI .
483 5 De-registration accept (UE te rminated de-registration) .
484 Message definition .
484 6 Service request .
484 Message definition .
484 Uplink data status .
485 PDU session status .
485 Allowed PDU session status .
485 NAS message container .
485 7 Service accept .
485 Message definition .
485 8 Service reject .
486 Message definition .
486 PDU session status .
487 CAG information list.
487 9 Configuration update command .
487 Message definition .
487 Configuration update indication .
490 TAI list .
490 Allowed NSSAI .
490 Service area list .
490 Full name for network .
490 Short name for network .
490 Local time zone .
490 0 Universal time and local time zone .
490 1 Network daylight saving time .
490 2 LADN information .
490 3 MICO indication .
490 4 Network slicing indication .
490 5 Configured NSSAI .
490 6 Rejected NSSAI .
491 7 Operator-defined access category definitions .
491 8 SMS indication .
491 0 CAG information list.
491 1 UE radio capability ID .
491 3 5GS registration result.
491 4 Truncated 5G-S-TMSI configuration .
491 5 Additional configuration indication .
491 0 Configuration update complete .
491 Message definition .
1 Identity request .
492 Message definition .
492 Message definition .
493 Message definition .
493 4 Notification response .
493 Message definition .
493 PDU session status .
494 5 Security mode command .
494 Message definition .
494 IMEISV request .
Additional 5G security information .
495 Replayed S1 UE security capab ilities .
496 6 Security mode complete .
496 Message definition .
496 8 Security protect ed 5GS NAS message .
497 Message definition .
497 Message definition .
498 0 Control Plane Service request .
498 Message definition .
498 CIoT small data container .
499 Payload container type .
499 Payload container .
499 PDU session ID .
499 PDU session status .
499 Release assistance indication .
500 Uplink data status .
500 NAS message container .
500 0 Additional information .
500 Message definition .
500 2 Network slice-specific authentication complete .
500 Message definition .
500 Message definition .
501 5GS session management messages .
502 PDU session establishment request .
502 Message definition .
502 PDU session type .
502 SSC mode .
503 Maximum number of supported packet filters .
503 5GSM capability .
Always-on PDU session requested .
503 SM PDU DN request container .
503 Extended protocol configuration options .
503 0 IP header compression configuration .
503 1 DS-TT Ethernet port MAC address .
503 2 UE-DS-TT residence time .
503 3 Port management information container .
504 4 Ethernet header compression configuration .
504 PDU session establishment accept .
504 Message definition .
504 PDU address .
505 RQ timer value .
506 Always-on PDU session indication .
506 Mapped EPS bearer contexts.
506 Authorized QoS flow descriptions .
506 0 Extended protocol configuration options .
506 2 5GSM network feature support .
4 Serving PLMN rate control .
506 5 ATSSS container .
506 6 Control plane only indication .
506 7 IP header compression configuration .
507 8 Ethernet header compression configuration .
507 PDU session establishment reject .
507 Message definition .
507 Re-attempt indicator .
508 5GSM congestion re-attempt indicator .
508 PDU session authentication command .
508 Message definition .
508 Extended protocol configuration options .
509 PDU session authentication complete .
509 Message definition .
509 Extended protocol configuration options .
510 PDU session authentication result .
510 Message definition .
510 Extended protocol configuration options .
510 PDU session modification request .
510 Message definition .
510 5GSM capability .
511 Maximum number of supported packet filters .
512 Always-on PDU session requested .
512 Integrity protection maximum data rate .
512 Requested QoS rules .
512 Requested QoS flow descriptions .
512 Extended protocol configuration options .
512 0 Mapped EPS bearer contexts.
512 1 Port management information container .
512 2 IP header compression configuration .
512 3 Ethernet header compression configuration .
513 PDU session modification reject .
513 Message definition .
513 Back-off timer value .
513 Extended protocol configuration options .
513 Re-attempt indicator .
513 5GSM congestion re-attempt indicator .
514 PDU session modification command .
514 Message definition .
515 RQ timer value .
515 Always-on PDU session indication .
515 Authorized QoS rules .
515 Mapped EPS bearer contexts.
515 Authorized QoS flow descriptions .
515 Extended protocol configuration options .
1 ATSSS container .
515 2 IP header compression configuration .
515 3 Port management information container .
515 4 Serving PLMN rate control .
515 5 Ethernet header compression configuration .
516 0 PDU session modification complete .
516 Message definition .
516 Extended protocol configuration options .
516 Port management information container .
516 1 PDU session modification command reject .
516 Message definition .
516 Extended protocol configuration options .
517 2 PDU session release request .
517 Message definition .
517 4 PDU session release command .
518 Message definition .
518 Back-off timer value .
519 Extended protocol configuration options .
519 5GSM congestion re-attempt indicator .
519 Access type .
519 5 PDU session release complete .
519 Message definition .
519 Extended protocol configuration options .
520 Message definition .
520 9 General message format and in formation elemen ts coding.
521 NAS message format .
521 Field format and mapping .
522 Extended protocol discriminator .
522 Security header type .
522 PDU session identity .
523 Spare half octet .
523 Procedure transaction identity .
523 Message type .
523 Message authentication code .
525 Plain 5GS NAS message .
525 0 Sequence number .
525 1 Other information elements .
526 Common information elements .
526 Additional information .
527 GPRS timer .
527 GPRS timer 2 .
528 GPRS timer 3 .
528 Intra N1 mode NAS transparent container .
528 N1 mode to S1 mode NAS transparent container .
529 S1 mode to N1 mode NAS transparent container .
531 5GMM capability .
532 A 5GS DRX parameters .
537 5GS identity type .
538 5GS mobile identity .
538 5GS network feature support.
545 5GS registration result.
550 5GS registration type.
551 5GS tracking area identity .
552 A 5GS update type .
2 Additional 5G security information .
559 2A Additional information requested .
560 3 Allowed PDU session status .
560 8 Configuration update indication .
561 8A CAG information list.
562 8B CIoT small data container .
563 8C Ciphering key data .
567 8D Control plane service type .
575 9 Daylight saving time .
576 0 De-registration type .
3 Emergency number list .
576 3A EPS bearer context status .
577 4 EPS NAS message container.
577 5 EPS NAS security algorithms .
577 6 Extended emergency number list .
577 6A Extended DRX parameters .
8 IMEISV request .
577 9 LADN indication .
577 0 LADN information .
578 1 MICO indication .
579 1A MA PDU session information .
580 1B Mapped NSSAI .
580 1C Mobile station classmark 2 .
581 2 NAS key set identifier .
581 3 NAS message container .
582 4 NAS security algorithms .
582 5 Netw ork name .
583 6 Network slicing indication .
583 6A Non-3GPP NW provided policies .
584 7A NSSAI inclusion mode .
585 8 Operator-defined access category definitions .
585 9 Payload container .
589 0 Payload container type .
593 1 PDU session identity 2 .
594 2 PDU session reactivation result .
594 3 PDU session reactivation result error cause .
595 4 PDU session status .
595 6 Rejected NSSAI .
596 6A Release assistance indication .
597 7 Requ est type .
597 8 S1 UE network capability .
598 8A S1 UE security capability .
598 9 Service area list .
598 0 Service type .
603 0A SMS indication .
603 1 SOR transparent container .
604 2 Ti me zone .
606 3 Time zone and time .
606 3A UE parameters update transparent container .
606 4 UE security capability .
607 5 UE's usage setting .
612 7 Uplink data status .
8 UE radio capability ID .
614 9 UE radio capability ID deletion indication .
614 0 Truncated 5G-S-TMSI configuration .
615 1 WUS assistance information .
616 2 N5GC indication .
616 3 NB-N1 mode DRX parameters .
617 4 Additional configuration indication .
617 5GS session management (5GSM) information elements .
618 5GSM capability .
618 Always-on PDU session indication .
620 Always-on PDU session requested .
621 Allowed SSC mode .
621 Extended protocol configuration options .
622 Integrity protection maximum data rate .
622 Mapped EPS bearer contexts.
623 Maximum number of supported packet filters .
626 0 PDU address .
626 1 PDU session type .
627 2 QoS flow descriptions .
628 4 Session-AMBR .
640 5 SM PDU DN request container .
641 7 Re-attempt indicator .
642 8 5GSM network feature support .
0 Serving PLMN rate control .
643 1 5GSM congestion re-attempt indicator .
643 2 ATSSS container .
644 3 Control plane only indication .
644 4 IP header compression configuration .
645 5 DS-TT Ethernet port MAC address .
648 6 UE-DS-TT residence time .
648 7 Port management information container .
649 8 Ethernet header compression configuration .
649 2 3GPP specific coding information defined within present document .
650 Serving network name (SNN) .
650 10 List of system parameters .
1 Timers of 5GS mobility management .
651 1 Timers of 5GS session management .
660 Annex A (informative): Cause values for 5GS mobility management .
1 Causes related to UE identification .
2 Cause related to subscription options .
3 Causes related to PLMN or SNPN specific network failures and congestion/authentication failures .
4 Causes related to invalid messages .
668 Annex B (informative): Cause values for 5GS session management .
1 Causes related to nature of request .
2 Protocol errors (e.
, unknown message) .
671 Annex C (normative): Storage of 5GMM information .
Principles of PTI handling for UE policy delivery service procedures .
Network-requested UE policy management procedure .
Network-requested UE policy management procedure initiation .
Network-requested UE policy management procedure accepted by the UE .
Network-requested UE policy management procedure not accepted by the UE .
Abnormal cases on the network side .
Abnormal cases in the UE .
UE-initiated UE state indication procedure initiation .
UE-initiated UE state indication procedure accepted by the network .
Abnormal cases on the network side .
3 UE policy re-assembly at the UE .
5 Message functional definition and contents .
Manage UE policy command.
Manage UE policy complete .
Manage UE policy command reject .
6 Information elements coding .
UE policy delivery service message type .
UE policy section management list .
UE policy section management result .
UE policy classmark .
UE OS Id .
7 Timers of UE policy delivery service .
8 Handling of unknown, unforeseen, and erroneous UPDS data .
Message too short or too long .
Message too short .
Message too long .
Unknown or unforeseen procedure transaction identity .
Procedure transaction identity .
Unknown or unforeseen message type.
Non-semantical mandatory information element errors.
Unknown and unforeseen IEs in the non-imperative message part .
IEIs unknown in the message .
Out of sequence IEs .
Non-imperative message part errors .
Syntactically incorrect optional IEs .
Conditional IE errors .
Messages with semanti cally incorrect contents .
696 Annex E (informative): Void .
697 Annex F (informative): Change history .
728 This Technical Specification has been produced by the 3rd Generation Partnership Project (3GPP).
The contents of the present document are subject to conti nuing work within the TSG and may change following formal TSG approval.
Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows: x the first digit: 1 presented to TSG for information; 2 presented to TSG for approval; 3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.
technical enhancements, corrections, z the third digit is incremented when editorial only changes have been incor porated in the document.
The present document specifies the non-access stratum (NAS) procedures in the 5G system (5GS) used by the protocols mobility management between the user equipment (UE) and the access and mobility management function (AMF) for both 3GPP access and non-3GPP access; and session management between the user equipment (UE) and the session management function (SMF) for both 3GPP access and non-3GPP access.
The 5GS mobility management (5GMM) protocol defined in the present document provides procedures for the control of mobility when the user equipment (UE) is using the NG radio access network (NG-RAN) and/or non-3GPP access network.
The 5GMM protocol also provides control of security for the NAS protocols.
The 5GS session management (5GSM) protocol defined in the present document provides procedures for the handling of 5GS PDU sessions.
Together with the bearer control prov ided by the access stratum, this protocol is used for the control of user-plane resources.
For both NAS protocols the present document specifies proced ures for the support of inter-system mobility between the NG-RAN and the evolved universal terrestrial radio access (E-UTRAN), between the NG-RAN and the non-3GPP access network connected to the EPC, and between the non-3GPP access network connected to the 5G core network (5GCN) and the E-UTRAN.
For both NAS protocols the present document specifies procedures for the support of mobility between the NG-RAN and the non-3GPP access network connected to the 5GCN.
In addition, the present document specifies the procedures in the 5GS for UE policy delivery service between the UE and the policy control function (PCF) for both 3GPP access and non-3GPP access.
The present document is applicable to the UE, the access and mobility management function (AMF), the session management function (SMF), and the PCF in the 5GS.
The clauses and subclauses in the present document are common for both 3GPP access and non-3GPP access unless it is explicitly stated that they apply to 3GPP access only or non-3GPP access only.
The following documents contain provisions which, through reference in this text, constitute provisions of the present document.
References are either specific (identified by date of publication, edition number, version number, etc.
) or a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.
3GPP specification document: "Vocabulary for 3GPP Specifications".
[1A] 3GPP specification document: "Service accessibility".
3GPP specification document: "Service aspects; Service principles".
3GPP specification document: "Service requirements for the 5G system; Stage 1".
3GPP specification document: "Numbering, addressing and identification".
[4A] 3GPP specification document: "Technical realization of Short Message Service (SMS)".
3GPP specification document: "Non-Access-Stratum functions related to Mobile Station (MS) in idle mode".
[6B] 3GPP specification document: "5G System (5GS) Location Services (LCS); Stage 2".
[6C] 3GPP specification document: "Architecture enhancements for 5G System (5GS) to support Vehicle-to- [6D] 3GPP specification document: "Wireless and wireline conv ergence access support for the 5G System (5GS)".
3GPP specification document: "GPRS enhancements for E-UTRAN access".
3GPP specification document: "System Architecture for the 5G System; Stage 2".
3GPP specification document: "Procedures for the 5G System; Stage 2".
3GPP specification document: "Policy and Charging Control Framework for the 5G System; Stage 2".
3GPP specification document: "Mobile radio interf ace signalling layer 3; General aspects".
3GPP specification document: "Mobile Radio Interface La yer 3 specification; Core Network Protocols;.
3GPP specification document: "Point-to-Point Short Message Service (SMS) support on mobile radio [13A] 3GPP specification document: "Mobile radio interface layer 3 Supplementary services specification; Formats [13B] 3GPP specification document: "Access Traffic Steering, Switching and Splitting; Stage 3".
3GPP specification document: "IP multimedia call control protocol based on Session Initiation Protocol (SIP) and Session Description Protocol (SDP); Stage 3".
[14A] 3GPP specification document: "Protocol for Reliable Data Service; Stage 3".
3GPP specification document: "Non-Access-Stratum (NAS) protocol for Evolved Packet System (EPS);.
3GPP specification document: "Access to the 3GPP Ev olved Packet Core (EPC) via non-3GPP access 3GPP specification document: "Non-Access Stratum (NAS) configuration Management Object (MO)".
3GPP specification document: "Access to the 3GPP 5G System (5GS) via non-3GPP access 3GPP specification document: "UE policies for 5G System (5GS); Stage 3".
[19A] 3GPP specification document: "Device-Side Time-Sensitive Networking (TSN) Translator (DS-TT) to Network-Side TSN Translator (NW-TT) protocol aspects; Stage 3".
[19B] 3GPP specification document: "Vehicle-to-Everything (V2X) services in 5G System (5GS); Protocol aspects;.
[19C] 3GPP specification document: "Vehicle-to-Everything (V2X) services in 5G System (5GS); User Equipment (UE) policies; Stage 3" [19D] 3GPP specification document: "Time-Sensitive Networking (TSN) Application Function (AF) to Device-Side TSN Translator (DS-TT) and Network-Side TSN Tr anslator (NW-TT) protocol aspects; Stage 3".
3GPP specification document: "Extensive Markup Language (XML) Configuration Access Protocol (XCAP) over the Ut interface for Manipulating Supplementary Services".
[20AA] 3GPP specification document: "5G System; Technical Realization of Service Based Architecture; Stage 3".
(NSSAA) services; Stage 3".
3GPP specification document: "Characteristics of the Universal Subscriber Identity Module (USIM) [22A] 3GPP specification document: "USIM Application Toolkit (USAT)".
[22B] 3GPP specification document: "Secured packet structure for (Universal) Subscriber Identity Module (U)SIM 3GPP specification document: "3G security; Security architecture".
[23A] 3GPP specification document: "3GPP System Architecture Evolution; Security architecture".
3GPP specification document: "Security architecture and procedures for 5G System".
3GPP specification document: "NR; Packet Data Convergence Protocol (PDCP) specification".
[25A] 3GPP specification document: "Evolved Universal Terrestrial Radio Access (E-UTRA); Radio Resource Control (RRC) protocol specification".
[25B] 3GPP specification document: "Evolved Universal Terrestrial Radio Access (E-UTRA) and Evolved Universal Terrestrial Radio Access Network (E-UTRAN); Overall description".
[25C] 3GPP specification document: "Evolved Universal Terrestrial Radio Access (E-UTRA); User Equipment (UE) procedures in idle mode".
[25D] 3GPP specification document: "Evolved Universal Terrestrial Radio Access (E-UTRA); User Equipment (UE) [25E] 3GPP specification document: "Evolved Universal Terrestrial Radio Access (E-UTRA); Medium Access Control (MAC) protocol specification".
3GPP specification document: "Evolved Universal Terrestrial Radio Access (E-UTRA); LTE Positioning 3GPP specification document: "NR; NR and NG-RAN Overall Description; Stage 2".
3GPP specification document: "New Generation Radio Access Network; User Equipment (UE) procedures in 3GPP specification document: "Evolved Universal Terrestrial Radio Access (E-UTRA); Packet Data Convergence Protocol (PDCP) specification".
3GPP specification document: "NR; Radio Resource Control (RRC); Protocol Specification".
3GPP specification document: "NG Radio Access Network (NG-RAN); NG Application Protocol (NGAP)".
[31A] IEEE Std 80™-2018: "Ethernet".
IETF RFC 768: "User Datagram Protocol".
IETF RFC 793: "Transmission Control Protocol.
" [33A] IETF RFC 3095: "RObust Header Compression (ROHC): Framework and four profiles: RTP, UDP, ESP and uncompressed".
[33B] IETF RFC 3315: "Dynamic Host Configuration Protocol for IPv6 (DHCPv6)".
IETF RFC 3748: "Extensible Authentication Protocol (EAP)".
[34A] IETF RFC 3843: "RObust Header Compression (ROHC): A Compression Profile for IP".
IETF RFC 3736: "Stateless Dynamic Host Configuration Protocol (DHCP) Service for IPv6" [35A] IETF RFC 4122: "A Universally Unique IDentifier (UUID) URN Namespace".
IETF RFC 4191: "Default Router Preferences and More-Specific Routes".
IETF RFC 7542: "The Network Access Identifier".
IETF RFC 4303: "IP Encapsulating Security Payload (ESP)".
[38A] IETF RFC 4815: "RObust Header Compression (ROHC): Corrections and Clarifications to [38B] IETF RFC 4861: "Neighbor Discovery for IP version 6 (IPv6)".
IETF RFC 4862: "IPv6 Stateless Address Autoconfiguration".
[39A] IETF RFC 5225: "RObust Header Compression (ROHC) Version 2: Profiles for RTP, UDP, IP, ESP and UDP Lite".
[39B] IETF RFC 5795: "The RObust Header Compression (ROHC) Framework".
IETF RFC 5448: "Improved Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA')".
[40A] IETF RFC 6603: "Prefix Exclude Option for DHCPvbased Prefix Delegation".
[40B] IETF RFC 6846: "RObust Header Compression (ROHC): A Profile for TCP/IP (ROHC-TCP)".
IETF RFC 7296: "Internet Key Exchange Protocol Version 2 (IKEv2)".
212: "The international identification plan for public networks and IEEE Std 80014: "IEEE Standard for Local and Metropolitan Area Networks: Overview and.
[43A] IEEE Std 80AS-Rev/D, August 2018: "IEEE Standard for Local and metropolitan area networks--Timing and Synchronization for Time-Sensitive Applications".
Networked Measurement and Control Systems".
IEEE "Guidelines for Use of Extended Unique Id entifier (EUI), Organizationally Unique Identifier (OUI), and Company ID (CID)".
BBF TR-069: "CPE WAN Management Protocol".
3 Definitions and abbreviations 
For the purposes of the present document, the terms and definitions given in 3GPP specification document and the following apply.
A term defined in the present document takes precedence over the definition of the same term, if any, in 3GPP specification document .
can be either in 5GMM-IDLE mode over 3GPP access or in 5GMM-IDLE mode over non-3GPP access.
mode means the UE can be either in 5GMM-CONNECTED mode over 3GPP access or in 5GMM-CONNECTED mode over non-3GPP access.
5GMM-IDLE mode over 3GPP access: A UE is in 5GMM-IDLE mode over 3GPP access when no N1 NAS signalling connection between the UE and network over 3GPP access exists.
The term 5GMM-IDLE mode over 3GPP access used in the present document corresponds to the term CM-IDLE state for 3GPP access used in 3GPP specification document .
5GMM-CONNECTED mode over 3GPP access: A UE is in 5GMM-CONNECTED mode over 3GPP access when an N1 NAS signalling connection between the UE and network over 3GPP access exists.
The term 5GMM-CONNECTED mode over 3GPP access used in the present document corresponds to the term CM-CONNECTED state for 3GPP access used in 3GPP specification document .
5GMM-IDLE mode over non-3GPP access: A UE is in 5GMM-IDLE mode over non-3GPP access no N1 NAS signalling connection between the UE and network over non-3GPP access exists.
The term 5GMM-IDLE mode over non-3GPP access used in the present document corresponds to the term CM-IDLE state for non-3GPP access used in 3GPP specification document .
5GMM-CONNECTED mode over non-3GPP access: A UE is in 5GMM-CONNECTED mode over non-3GPP CONNECTED state for non-3GPP access used in 3GPP specification document .
5GS services: Services provided by PS domain.
Within the context of this specification, 5GS services is used as a synonym for EPS services.
5G-EA: 5GS encryption algorithms.
The term 5G-EA, 5G-EA0, 12G-EA and 5G-EA used in the present document corresponds to the term NEA, NEA0, NEA and NEA defined in 3GPP specification document .
5G-IA: 5GS integrity algorithms.
The term 5G-IA, 5G-IA0, 12G-IA and 5G-IA used in the present document corresponds to the term NIA, NIA0, NIA and NIA defined in 3GPP specification document .
Access stratum connection: A peer to peer acce ss stratum connection: between the UE and the NG-RAN for 3GPP access; - between the UE and the N3IWF for untrusted non-3GPP access; - between the UE and the TNGF for trusted non-3GPP access used by the UE; - within the TWIF acting on behalf of the N5CW for trusted non-3GPP access used by the N5CW; between the 5G-RG and the W-AGF for wireline access used by the 5G-RG; within the W-AGF acting on behalf of the FN-RG for wireline access used by the FN-RG; or - within the W-AGF acting on behalf of the N5GC device for wireline access used by the N5GC device.
connection for trusted non-3GPP access used by the UE corres ponds to the UE reception of an EAP-request/5G-start via NWt reference point (see 3GPP specification document\).
The creation of the access stratum connection for trusted non-3GPP access used by the N5CW corresponds to the TWIF's start of acting on behalf of the N5CW.
The creation of the access stratum connection for wireline access used by the 5G-RG corresponds to the 5G-RG reception of an EAP-request/5G-packet over the W-CP connection via the Y4 reference point (see 3GPP specification document [6D]).
The creation of the access stratum connection for wireline access used by the FN-RG corresponds to the W-AGF's start of acting on behalf of the FN-RG.
The creation of the access stratum connection for wi reline access used by the N5GC device corresponds to the W-AGF's start of acting on behalf of the N5GC device.
a PLMN when the UE is connecting to the 5GCN of the SNPN using the 3GPP access of the PLMN.
Definition derived from 3GPP specification document .
Always-on PDU session: A PDU session for which user-plane resources have to be established during every transition NOTE 1: How the upper layers in the UE are configured to provide an indication is outside the scope of the present Applicable UE radio capability ID for the current UE radio configuration in the selected network: The UE has an applicable UE radio capability ID for the current UE radio configuration in the selected network if: a) the UE supports RACS; and b) the UE has: 1) a stored network-assigned UE radio capability ID which is associated with the PLMN ID or SNPN identity of the serving network and which maps to the set of radio capabilities currently enabled at the UE; or 2) a manufacturer-assigned UE radio capability ID which maps to the set of radio capabilities currently enabled CAG cell: A cell in which only members of the CAG can get normal service.
Depending on local regulation, the CAG cell can provide emergency services also to subscribers who are not members of the CAG.
restricted to members of the CAG.
Cleartext IEs: Information elements that can be sent without confidentiality protection in initial NAS messages as Control plane CIoT 5GS optimization: signalling optimizations to enable efficient transport of user data (IP, Ethernet, Unstructured or SMS) over control plane via the AMF incl uding optional header compression of IP data and Ethernet subscription information or local policy.
Otherwise DNN de termined by the AMF is the DNN requested by the UE.
Otherwise DNN selected by the network is the DNN determined by the AMF.
Globally-unique SNPN identity: An SNPN identity with an NID whose assignment mode is not set to 1 (see User plane CIoT 5GS optimization: signalling optimizations to enable efficient transport of user data (IP, Ethernet or Unstructured) over the user plane.
A UE supporting CIoT 5GS optimizations is registered for 5GS services, and control plane CIoT 5GS optimization along with one or more other CIoT 5GS optimizations have been accepted by the network.
Registered for 5GS services with user pl ane CIoT 5GS optimization: A UE supporting CIoT 5GS optimizations is registered for 5GS services, and user plane CIoT 5GS optimization along with one or more other CIoT 5GS optimizations have been accepted by the network.
Registered for 5GS services with CIoT 5GS optimization: A UE is registered for 5GS services with control plane CIoT 5GS optimization or registered for 5GS services with user plane CIoT 5GS optimization.
DNN based congestion control: Type of congestion control at session management level that is applied to reject session management requests from UEs or release PDU sessions when the associated DNN is congested.
DNN based congestion control can be activated at the SMF over session management level and also activated at the AMF over Emergency PDU session: A PDU session which was established with the request type "initial emergency request" or "existing emergency PDU session".
Failed or revoked NSSAA: The network slice-specific authentication and authorization procedure for S-NSSAI(s) fails, or the network slice-specific authorization for S-NSSAI(s) is revoked.
General NAS level co ngestion control: Type of congestion control at mobility management level that is applied at a general overload or congestion situation in the network, e.
lack of processing resources.
Initial NAS message: A NAS message is considered as an initial NAS message, if this NAS message can trigger the establishment of an N1 NAS signalling connection.
For instance, the REGISTRATION REQUEST message is an initial registration" in the REGISTRATION REQUEST message.
Last visited registered TAI: A TAI which is contained in the registration area that the UE registered to the network and which identifies the tracking area last visited by the UE.
Mapped S-NSSAI: An S-NSSAI in the subscribed S-NSSAIs for the HPLMN, which is mapped to an S-NSSAI of the Native 5G-GUTI: A 5G-GUTI previously allocated by an AMF.
Non-globally-unique SNPN identity: An SNPN identity with an NID whose assignment mode is set to 1 (see system this case applies if the current serving radio access network provides access to network services via E-UTRA connected to 5GCN by NB-IoT (see 3GPP specification document [25B ], 3GPP specification document [25A], 3GPP specification document [25D]).
system this case applies if the system operates in N1 mode with E-UTRA connected to 5GCN, but not in NB-N1 mode.
session, are used as initial parameters to limit the allowed data for the PDU session according to small data rate control Initial small data rate control parameters for exception data: Parameters corresponding to initial small data rate control parameters for small data rate control of exception data.
N6 PDU session: A PDU session established between the UE and the User Plane Function (UPF) for transmitting the NEF PDU session: A PDU session established between the UE and the Network Exposure Function (NEF) for Network slicing information: information stored at the UE consisting of one or more of the following: d) pending NSSAI; and e) for each access type: Non-cleartext IEs: Information elements that are not cleartext IEs.
Non-emergency PDU session: Any PDU session which is not an emergency PDU session.
PDU address: An IP address assigned to the UE by the packet data network.
PDU session with suspended user-plane resources: A PDU session for which user-plane resources were established or re-established, and for which data radio bearers were suspended when transiting to 5GMM-CONNECTED mode with RRC inactive indication.
radio bearer associated with that context.
Procedure transaction identity: An identity which is dynamically allocat ed by the UE for the UE-requested 5GSM procedures, or allocated by the UE or the PCF for the UE policy delivery proced ures.
The procedure transaction identity is released when the procedure is completed but it should not be released immediately.
RAT frequency selection priority index: A parameter provided by the AMF to the NG-RAN via the N2 reference operator's policies, the allowed NSSAI and the UE context in formation, including the UE's usage setting, if received during the registration procedure.
Definition derived from 3GPP specification document .
Registered for emergency services: A UE is considered as "registered for emergency services" when it has successfully completed initial registration for emergency services.
Registered PLMN : The PLMN on which the UE is registered.
The identity of the registered PLMN (MCC and MNC) is provided to the UE within the GUAMI field of the 5G-GUTI.
Rejected NSSAI: Rejected NSSAI for the current PLMN, SNPN or rejected NSSAI for the current registration area or rejected NSSAI for the failed or revoked NSSAA.
the current PLMN or SNPN.
A set of S-NSSAI(s) which was included in the requested NSSAI by the UE and is sent by the AMF with the rejection cause "S-NSSAI not available in the current registration area".
Rejected NSSAI for the failed or revoked NSSAA : A set of S-NSSAI(s) which is sent by the AMF with the rejection cause "rejected NSSAI due to the failed or revoked ne twork slice-specific authentication and authorization".
NOTE 4: Local release can include communication among network entities.
Removal of eCall only mode restriction: All the limitations as described in 3GPP specification document for the eCall only mode do not apply any more.
with the Home Network Identifier for routing network signalling.
Routing Indicator is provisioned in the USIM.
The term Routing indicator used in the present document corresponds to the term Routing ID used in 3GPP specification document .
S-NSSAI-based congestion control: Type of congestion control at session management level that is applied to reject session management requests from UEs or release PDU sessions when the associated S-NSSAI and optionally the associated DNN are congested.
S-NSSAI based congestion control can be activated at the SMF over session management level and also activated at the AMF over mobility management level.
case of an E-UTRA cell connected to both EPC and 5GCN.
UE configured for high priori ty access in selected PLMN: A UE configured with one or more access identities equal to 1, 2, or 15 applicable in the selected PLMN as specified in subclause Definition derived from 3GPP specification document .
supports NAS over 3GPP access).
During the last attach, tracking area update (s ee 3GPP specification document\) or registration procedures, the UE has received either a 5GS network feature support IE with IWK N26 bit set to "interworking without N26 interface not UE using 5GS services with control plane CIoT 5GS optimization: A UE that is registered for 5GS services with the control plane CIOT 5GS optimization accepted by the network.
User-plane resources: Resources established between the UE and the UPF.
The user-plane resources consist of one of reference point (if any) for 3GPP access; point (if any) for untrusted non-3GPP access; point (if any) for trusted non-3GPP access used by the UE; used by the N5CW; CRG to connect to the 5G Core.
For the purposes of the present document, the following terms and definitions given in 3GPP specification document apply: For the purposes of the present document, the following terms and definitions given in 3GPP specification document apply: 5G-S-TMSI Global Line Identifier (GLI) Global Cable Identifier (GCI) For the purposes of the present document, the following terms and definitions given in 3GPP specification document apply:.
EHPLMN HPLMN Registered SNPN Selected PLMN Selected SNPN SNPN identity Steering of Roaming (SOR) Steering of Roaming information Suitable cell VPLMN For the purposes of the present document, the following terms and definitions given in 3GPP specification document apply: For the purposes of the present document, the following terms and definitions given in 3GPP specification document [6A] apply: For the purposes of the present document, the following terms and definitions given in 3GPP specification document apply: For the purposes of the present document, the following terms and definitions given in 3GPP specification document apply: 5G access network 5G core network 5G QoS flow 5G QoS identifier 5G-BRG 5G-CRG 5G System Allowed area Allowed NSSAI AMF set Closed access group Configured NSSAI IAB-node PDU session type Pending NSSAI Requested NSSAI Routing ID Service Gap Control Serving PLMN rate control Small data rate control status SNPN access mode SNPN enabled UE Time Sensitive Communication UE presence in LADN service area For the purposes of the present document, the following terms and definitions given in 3GPP specification document apply: For the purposes of the present document, the following terms and definitions given in 3GPP specification document apply: GMM MM A/Gb mode Iu mode GPRS Non-GPRS For the purposes of the present document, the following terms and definitions given in 3GPP specification document apply: CIoT EPS optimization Control plane CIoT EPS optimization EENLV EMM EMM-DEREGISTERED-INITIATED EMM-IDLE mode EMM-NULL EMM-REGISTERED EMM-REGISTERED-INITIATED EMM-TRACKING-AREA-UPDATING-INITIATED EPS EPS security context EPS services Lower layer failure.
Message header NAS signalling connection recovery NB-S1 mode Non-EPS services S1 mode User plane CIoT EPS optimization For the purposes of the present document, the following terms and definitions given in 3GPP specification document apply: Mapped 5G NAS security context Mapped security context Native 5G NAS security context Non-current 5G NAS security context Partial native 5G NAS security context For the purposes of the present document, the following terms and definitions given in 3GPP specification document apply: For the purposes of the present document, the following terms and definitions given in 3GPP specification document [19B] apply:.
For the purposes of the present document, the abbreviations given in 3GPP specification document and the following apply.
An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in 3GPP specification document .
4G-GUTI 4G-Globally Unique Temporary Identifier 5GCN 5G Core Network 5G-GUTI 5G-Globally Unique Temporary Identifier 5GMM 5GS Mobility Management 5G-RG 5G Residential Gateway 5G-BRG 5G Broadband Residential Gateway 5G-CRG 5G Cable Residential Gateway 5GS 5G System 5GSM 5GS Session Management 5G-S-TMSI 5G S-Temporary Mobile Subscription Identifier 5G-TMSI 5G Temporary Mobile Subscription Identifier 5QI 5G QoS Identifier AKA Authentication and Key Agreement AMBR Aggregate Maximum Bit Rate AMF Access and Mobility Management Function APN Access Point Name ATSSS Access Traffic Steering, Switching and Splitting AUSF Authentication Server Function CAG Closed access group DL Downlink DN Data Network DNN Data Network Name eDRX Extended DRX cycle DS-TT Device-Side TSN Translator EUI Extended Unique Identifier E-UTRAN Evolved Universal Terrestrial Radio Access Network EAP-AKA' Improved Extensible Authentication Protocol method for 3rd generation Authentication and Key.
ECIES Elliptic Curve Integrated Encryption Scheme EPD Extended Protocol Discriminator EMM EPS Mobility Management FN-RG Fixed Network RG FN-BRG Fixed Network Broadband RG FN-CRG Fixed Network Cable RG Gbps Gigabits per second GFBR Guaranteed Flow Bit Rate GUAMI Globally Unique AMF Identifier IAB Integrated access and backhaul IP-CAN IP-Connectivity Access Network KSI Key Set Identifier LADN Local Area Data Network LCS LoCation Services LMF Location Management Function LPP LTE Positioning Protocol MAC Message Authentication Code Mbps Megabits per second MFBR Maximum Flow Bit Rate MICO Mobile Initiated Connection Only N3IWF Non-3GPP Inter-Working Function N5CW Non-5G-Capable over WLAN device NAI Network Access Identifier NITZ Network Identity and Time Zone NR New Radio ngKSI Key Set Identifier for Next Generation Radio Access Network NPN Non-public network NSSAA Network slice-specific authentication and authorization NSSAAF NSSAA Function NSSAI Network Slice Selection Assistance Information OS Operating System OS Id OS Identity PNI-NPN Public Network Integrated Non-Public Network PTI Procedure Transaction Identity QFI QoS Flow Identifier QoS Quality of Service QRI QoS Rule Identifier RACS Radio Capability Signalling Optimisation (R)AN (Radio) Access Network RFSP RAT Frequency Selection Priority RG Residential Gateway RPLMN Registered PLMN RSNPN Registered SNPN RQA Reflective QoS Attribute RQI Reflective QoS Indication S-NSSAI Single NSSAI SA Security Association SDF Service Data Flow SMF Session Management Function SGC Service Gap Control SNN Serving Network Name SNPN Stand-alone Non-Public Network SOR Steering of Roaming TA Tracking Area TAC Tracking Area Code TAI Tracking Area Identity Tbps Terabits per second TSC Time Sensitive Communication TWIF Trusted WLAN Interworking Function TSN Time-Sensitive Networking URN Uniform Resource Name URSP UE Route Selection Policy V2XP V2X policy WLAN Wireless Local Area Network.
The non-access stratum (NAS) described in the present document forms the highest stratum of the control plane between UE and AMF (reference point "N1" see 3GPP specification document\) for both 3GPP and non-3GPP access.
Main functions of the protocols that are part of the NAS are: support of mobility of the user equipment (UE) includ ing also common procedures such as authentication, identification, generic UE configuration upda te and security control mode procedures; support of session management procedures to establish and maintain data connectivity between the UE and the container and UE parameters update information payload.
Principles for the handing of 5GS security contexts and for the activation of ciphering and integrity protection, when a NAS signalling connection is established, are provided in subclause For the support of the above functions, the following procedures are supplied within this specification: elementary procedures for 5GS mobility management in clause 5; and elementary procedures for 5GS session management in clause Signalling procedures for the control of NAS security are described as part of the 5GMM common procedures in Complete NAS transactions consist of specific sequences of elementary procedures.
Examples of such specific sequences can be found in 3GPP specification document .
The NAS for 5GS follows the protocol architecture model for layer 3 as described in 3GPP specification document .
Coordination between the protocols for 5GS mobility management and 5GS session management A 5GS session management (5GSM) message is piggybacked in specific 5GS mobility management (5GMM) transport messages.
To this purpose, the 5GSM messages can be tr ansmitted in an information element in the 5GMM transport messages.
In this case, the UE, the AMF and the SMF execute the 5GMM procedure and the 5GSM procedure in parallel.
The success of the 5GMM procedure is not depend ent on the success of the piggybacked 5GSM procedure.
The UE can only initiate the 5GSM procedure when there is a 5GMM context established at the UE.
resources of PDU session(s) is initiated without including PDU session status IE or Allowed PDU session status IE.
In this case, the UE and the AMF need not suspend the transmission of 5GSM messages related to other PDU session(s) than the one(s) for which the user- plane resources re-establishment is requested.
2) non-3GPP access if the UE is in 5GMM-CONNECTED mode over non-3GPP access; and NOTE: The interaction between the 5GMM sublayer and the 5GSM sublayer to enable the UE to send the UL NAS TRANSPORT message containing the response message via 3GPP access is required.
This is achieved via UE implementation.
c) the UE shall send, via the target access, an UL NAS TRANSPORT message piggybacking a 5GSM message The UE's usage setting defined in 3GPP specification document applies to voice capable UEs in 5GS and indicates whether the UE has preference for voice services over data services or vice-versa, where: a) voice services include IMS voice; and The UE's usage setting can be set to: a) "voice centric"; or b) "data centric".
Domain selection for UE originating sessions / calls The behaviour of the UE for domain selection is determined by: a) the UE usage setting; b) the availability of IMS voice; and c) whether the UE operates in single-registration mode or dual-registration mode (see 3GPP specification document\).
In the present document the condition "the UE supports IMS voice over 3GPP access" evaluates to "true" if at least one of the following is fulfilled: 1) the UE supports IMS voice over NR connected to 5GCN; 2) the UE supports IMS voice over E-UTRA connected to 5GCN; or 3) the UE supports IMS voice in EPS.
In the present document the condition "the UE does not support IMS voice over 3GPP access" evaluates to "true" if the condition "the UE supports IMS voice over 3GPP access" evaluates to "false".
In the present document the condition "the UE supports IMS voice over non-3GPP access" evaluates to "true" if the UE supports IMS voice over non-3GPP access connected to 5GCN.
In the present document the condition "the UE does not support IMS voice over non-3GPP access" evaluates to "true" if the condition "the UE supports IMS voice over non-3GPP access" evaluates to "false".
In the present document, "IMS voice not available" is determined per access type independently, i.
3GPP access or non-3GPP access.
b) the UE supports IMS voice, but the network indicates in the REGISTRATION ACCEPT message that IMS voice over PS sessions are not supported; or c) the UE supports IMS voice, the network indicates in the REGISTRATION ACCEPT message that IMS voice over PS sessions are supported, but the upper layers: period of time; or 2) indicate that the UE is not available for voice calls in the IMS.
an indication from the upper layers that the UE is available for voice calls in the IMS takes longer than Other conditions may exist but these are implementation specific.
When IMS voice is not available over 3GPP access, if the UE's usage setting is "voice centric", the UE operates in single-registration mode, and the UE: 1) if the UE is only registered over 3GPP access, or if the UE is registered over both 3GPP access and non- 3GPP access and IMS voice is not available over non-3GPP access, the UE shall disable the N1 mode capability for 3GPP access and proceed as specified in subclause with modifications described below;.
or 2) if the UE is registered over both 3GPP access and non-3GPP access and IMS voice is available over non- 3GPP access, the UE may disable the N1 mode capability for 3GPP access and proceed as specified in subclause with modifications described below; or has been released.
When the radio bearer associated wi th the persistent PDU session has been released, then: 1) if the UE is only registered over 3GPP access, or if the UE is registered over both 3GPP access and non- 3GPP access and IMS voice is not available over non-3GPP access, the UE shall disable the N1 mode capability for 3GPP access and proceed as specified in subclause with modifications described below; or 2) If the UE is registered over both 3GPP access and non-3GPP access and IMS voice is available over non- 3GPP access, the UE may disable the N1 mode capab ility for 3GPP access and proceed as specified in subclause with modifications described below.
The following modifications are applied to the procedure in subclause for disabling the N1 mode capability for 3GPP access, if the UE's usage setting is "voice centric " and the UE operates in single-registration mode: found, the UE shall then perform voice domain selection procedures as defined in 3GPP specification document ; and b) in item b) of subclause , if an E-UTRA cell connected to EPC cannot be found, the UE shall attempt to select another supported radio access techno logy which supports voice services.
When IMS voice is not available over non-3GPP access, if the UE's usage setting is "voice centric" and the UE operates in single-registration mode, then: a) if the UE is only registered over non-3GPP access, the UE shall disable the N1 mode capability for non-3GPP access (see subclause\); or If the UE operates in single-registration mode, whenever the UE's usage setting changes, the UE shall execute procedures according to table : change Procedure to execute From "data centric" to "voice centric" and "IMS voice not available" over 3GPP access only Disable the N1 mode capability for 3GPP access (see subclause\), if the UE is only registered over 3GPP access (NOTE) From "data centric" to "voice centric", and "IMS voice not available" over both 3GPP access and non-3GPP access Disable the N1 mode capability for 3GPP access (see subclause\) and non-3GPP access (see subclause\), if the UE is registered over both 3GPP access and non-3GPP access Disable the N1 mode capability for 3GPP access (see subclause\), if the UE is only registered over 3GPP access.
Disable the N1 mode capability for non-3GPP access (see subclause\), if the UE is only registered over non-3GPP access.
(NOTE) From "voice centric" to "data centric" and the N1 mode capability for 3GPP access is disabled at the UE due to "IMS voice not available" Re-enable the N1 mode capability for 3GPP access (see subclause\) From "data centric" to "voice centric" and "IMS voice not available" over non-3GPP access only Disable the N1 mode capability for non-3GPP access (see subclause\), if the UE is only registered over non-3GPP access From "voice centric" to "data centric", and the N1 mode capability for non-3GPP access is disabled at the UE due to "IMS voice not available" Re-enable the N1 mode capability for non-3GPP access (see subclause\) waits until the radio bearer associated with the persistent PDU session has been released.
Change or determination of IMS voice availability If the UE operates in single-registration mode, whenever the IMS voice availability is determined or changes, the UE shall execute procedures according to table : "IMS voice not available" over 3GPP access only and the UE's usage setting is "voice centric" Disable the N1 mode capability for 3GPP access, if the UE is only registered over 3GPP access(see subclause\) "IMS voice not available" over non-3GPP access only and the UE's usage setting is "voice centric" Disable the N1 mode capability for non-3GPP access (see subclause\), if the UE is only registered over non-3GPP access "IMS voice not available" over both 3GPP access and non-3GPP access, and the UE's usage setting is "voice centric" Disable the N1 mode capability for 3GPP access (see subclause\) and non-3GPP access (see subclause\), if the UE is registered over both 3GPP access and non-3GPP access.
Disable the N1 mode capability for 3GPP access (see subclause\), if the UE is only registered over 3GPP access Disable the N1 mode capability for non-3GPP access (see subclause\), if the UE is only registered over non-3GPP access.
(NOTE) waits until the radio bearer associated with the persistent PDU session has been released.
This clause describes the principles for the handling of 5G NAS security contexts in the UE and in the AMF and the procedures used for the security protection of NAS mess ages between the UE and the AMF.
Security protection involves integrity protection and ciphering of the 5GMM me ssages.
5GSM messages are security protected indirectly by being piggybacked by the security protected 5GMM messages (i.
UL NAS TRANSPORT message and the DL The signalling procedures for the control of NAS security are part of the 5GMM protocol and are described in detail in ciphering is achieved by configuring the AMF so that it always selects the "null ciphering algorithm", 5G- Handling of 5G NAS security contexts.
The security parameters for authentication, integrity protect ion and ciphering are tied together in a 5G NAS security Before security can be activated, the AMF and the UE need to establish a 5G NAS security context.
Usually, the 5G AMF and the UE.
A new 5G NAS security context may also be created during an N1 mode to N1 mode handover.
Alternatively, during inter-system change from S1 mode to N1 mode, the AMF not supporting interworking without procedure, during an N1 mode to N1 mode handover, or during the inter-system change procedure from S1 mode to N1 mode.
The 5G NAS security context which has been taken into use by the network most recently is called current 5G NAS security context.
This current 5G NAS security context can be of type native or mapped, i.
originating from a AMF, and when the current 5G NAS security context is of type mapped, the ngKSI has the value of KSI ASME.
For this purpose, the initial NAS messages (i.
REGISTRATION REQUEST, DEREGISTRATION REQUEST, SERVICE REQUEST and CONTROL PLANE SERVICE REQUEST) and the SECURITY MODE COMMAND message contain an ngKSI in the NAS key set identifier IE indicating the current 5G NAS security context used to integrity protect the NAS message.
In the present document, when the UE is required to delete an ngKSI, the UE shall set the ngKSI to the value "no key is available" and consider also the associated keys K AMF or K' AMF, 5G NAS ciphering key and 5G NAS integrity key invalid (i.
the 5G NAS security context associated with the ngKSI as no longer valid).
NOTE: In some specifications the term ciphering key sequence number might be used instead of the term key set As described in subclause in order to interwork with E-UTRAN connected to EPC, the UE supporting both S1 mode and N1 mode can operate in either single-registration mode or dual-registration mode.
A UE operating in dual-registration mode shall independently maintain and use both EPS security context (see 3GPP specification document\) and 5G NAS security context.
When the UE operating in dual-registration mode performs an EPS attach procedure, it shall take into use an EPS security context and follow the handling of this security context as specified in 3GPP specification document .
However, when the UE operating in dual-registration mode performs an initial registration procedure, it shall take into use a 5G NAS security context and follow the handling of this security context as described in the present specification.
current 5G NAS security context which has not yet been taken into use (i.
a partial native 5G NAS security context); and The number of 5G NAS security contexts that need to be maintained simultaneously by the UE and the AMF is limited by the following requirements: and the UE shall delete the non-current 5G NAS security context, if any; AMF and the UE shall delete the previously current 5G NAS security context; c) when the AMF and the UE create a 5G NAS security context using "null integrity protection algorithm" and protection algorithm" and "null ciphering algorithm" is taken into use during the inter-system change from S1 mode to N1 mode, the AMF and the UE shall not delete the previously current native 5G NAS security context, NAS security context, and the AMF and the UE shall delete any partial native 5G NAS security context; If no previously current native 5G NAS security context exists, the AMF and the UE shall not delete the partial then the AMF and the UE shall delete the previously current mapped 5G NAS security context; g) when the UE or the AMF moves from 5GMM-REGISTERED to 5GMM-DEREGISTERED state, if the current context exists, then the non-current 5G NAS security context shall become the current 5G NAS security context.
Furthermore, the UE and the AMF shall delete any mapped 5G NAS security context or partial native 5G NAS security context.
system change from N1 mode to S1 mode: i) 5GMM-IDLE mode, the UE shall delete the mapped 5G NAS security context after the successful completion of the tracking area update procedure (see 3GPP specification document\); or ii) 5GMM-CONNECTED mode, the UE shall delete the mapped 5G NAS security context after the completion of the inter-system change; and The UE shall mark the 5G NAS security context on the USIM or in the non-volatile memory as invalid when the UE initiates an initial registration procedure as described in subclause or when the UE leaves state 5GMM-DEREGISTERED for any other state except 5GMM-NULL.
the UE enters state 5GMM-DEREGISTERED from any other state except 5GMM-NULL or when the UE aborts the initial registration procedure without having left 5GMM-DEREGISTERED.
change from S1 mode to N1 mode in 5GMM-CONNECTED mode NAS security context for an inter-system change from S1 mode to N1 mode in 5GMM-CONNECTED mode, the AMF ngKSI with the newly created mapped 5G NAS security context.
The AMF shall then include the message authentication code, selected NAS algorithms, NCC and genera ted ngKSI in the S1 mode to N1 mode NAS transparent container IE (see subclause\).
derive the 5G NAS keys from the mapped K' AMF using the selected NAS algorithm identifiers included in the S1 mode to N1 mode NAS transparent container IE and associate th is mapped 5G NAS security context with the ngKSI value received.
The UE shall then verify the received NAS MAC.
In case the received NAS MAC is not verified successfully (see subclause\) the UE shall discard the content of the received S1 mode to N1 mode NAS transparent container IE and inform the lower layers that the received S1 m ode to N1 mode NAS transparent container is invalid.
selected 5G NAS security algorithms in the S1 mode to N1 mode NAS transparent container IE.
The AMF shall create a AMF.
The AMF shall set the ngKSI value of the associated security context to "000" and the type of security context flag to "mapped security context" in the S1 mode to N1 mode NAS transparent container IE.
Furthermore, the UE shall set the ngKSI value of the associated security context to the KSI value received.
system change from S1 mode to N1 mode in 5GMM-CONNECTED mode and the UE is registered with the same PLMN over the 3GPP access and non-3GPP access: 1) the UE is in 5GMM-IDLE mode over the non-3GPP access, then the AMF and the UE shall activate and take 2) the UE is in 5GMM-CONNECTED mode over the non-3GPP access, in order to activate the native 5G NAS security context over the 3GPP access that is active on the non-3GPP access the AMF shall send the SECURITY MODE COMMAND message over the 3GPP access as described in 3GPP specification document .
The SECURITY MODE COMMAND message shall include the same ngKSI to identify the native 5G NAS security context that is used on the non-3GPP access; or 1) the UE is in 5GMM-IDLE mode over the non-3GPP access, the AMF and the UE shall activate and take into use the new mapped 5G NAS security context active on the 3GPP access for the non-3GPP access as described in 3GPP specification document after the AMF sends or the UE receives the REGISTRATION ACCEPT message respectively; or 2) the UE is in 5GMM-CONNECTED mode over the non-3GPP access, in order to activate the same mapped SECURITY MODE COMMAND message over one-access as described in 3GPP specification document .
The SECURITY MODE COMMAND message shall include the same ngKSI to identify the mapped 5G NAS security context that is used over the other access.
mapped 5G NAS security context.
Establishment of a 5G NAS security context during N1 mode to N1 mode AMF, the target AMF includes the 8 least significant shall not be derived (see subclause\).
The AMF shall increment the downlink NAS COUNT by one after creating the Intra N1 mode NAS transparent container IE.
AMF, the target AMF includes the 8 least significant bits be derived (see subclause\).
The AMF shall then set both the uplink and downlink NAS COUNT counters of this 5G NAS security context to zero.
The AMF shall in crement the downlink NAS COUNT by one after creating the Intra N1 mode NAS transparent container IE.
The target AMF also includes the ngKSI with the same value as the ngKSI currently being used with the UE, the message authentication code, and the selected NAS algorithms in the Intra N1 mode NAS transparent container IE.
derived, the UE shall set both the downlink NAS COUNT and uplink NAS COUNT to zero after creating the new 5G NAS security context.
or the received NAS MAC is not verified successfully (see subclause\) the UE shall discard the content of the received Intra N1 mode NAS transparent container IE, continue to use the current 5G NAS security context, and inform the lower layers that the received Intra N1 mode NAS transparent container is invalid.
a) the UE is in 5GMM-IDLE mode over the non-3GPP access, the AMF and the UE shall activate and take into use AMF, the AMF and the UE shall set the downlink NAS COUNT and uplink NAS COUNT to zero also for the non-3GPP access, otherwise the downlink NAS COUNT and uplink NAS COUNT for the non-3GPP access are not changed; or b) the UE is in 5GMM-CONNECTED mode over the non-3GPP access, in order to activate the new 5G NAS security context over the non-3GPP access that has been activated for the 3GPP access the AMF shall send the SECURITY MODE COMMAND message over the non-3GPP access as described in 3GPP specification document .
The SECURITY MODE COMMAND message shall include the same ngKSI to identify the new 5G NAS security context that was activated over the 3GPP access and shall include the horizontal derivation parameter indicating "K the AMF and the UE shall set the downlink NAS COUNT and uplink NAS COUNT to zero for the non-3GPP access.
NOTE 2: Explicit indication "K AMF derivation is not required" for the non-3GPP access is to align security contexts Establishment of an EPS security context during inter-system change from N1 mode to S1 mode in 5GMM-CONNECTED mode (see subclause\) and then increments its stored downlink NAS COUNT value by one.
NOTE: The creation of the N1 mode to S1 mode NAS tr ansparent container and the increment of the stored downlink NAS COUNT value by one are performed in prior to transferring the mapped EPS security context to the MME.
The AMF shall select the NAS algorithms identifiers to be used in the target MME after the inter-system change from N1 mode to S1 mode in 5GMM-CONNECTED mode, for encryption and integrity protection.
The uplink and downlink NAS COUNT associated with the newly derived K' ASME key are set to the uplink and downlink NAS COUNT value of the current 5G NAS security context, respectively.
The eKSI for the newly derived K' ASME key shall be defined such as perform inter-system change from N1 mode to S1 mode in 5GMM-CONNECTED mode, the UE shall derive the mapped EPS security context, i.
derive K' 3GPP specification document [23A] using the EPS NAS security algorithms identifiers that are stored in the UE's 5G NAS security subclause\) the UE shall discard the content of the re ceived N1 mode to S1 mode NAS transparent container IE and inform the lower layers that the received N1 mode to S1 mode NAS transparent container is invalid.
If the inter-system change from N1 mode to S1 mode in 5GMM-CONNECTED mode is not completed successfully, the AMF and the UE shall delete the new mapped EPS security context.
Establishment of secure exchange of NAS messages control procedure, all NAS messages ex changed between the UE and the AMF are sent integrity protected using the current 5G security algorithms, and except for the messages specified in subclause , all NAS messages exchanged between the UE and the AMF are sent ciphered using the current 5G security algorithms.
During inter-system change from S1 mode to N1 mode in 5GMM-CONNECTED mode, secure exchange of NAS messages is established between the AMF and the UE by: a) the transmission of NAS security related parameters encapsulated in the AS signalling from the AMF to the UE triggering the inter-system change in 5GMM-CONNECTED mode (see 3GPP specification document\).
The UE uses these parameters to generate the mapped 5G NAS security context (see subclause of 3GPP specification document\); and REQUEST message from the UE to the AMF.
The UE shall send this message integrity protected using the mapped 5G NAS security context and further protect this message as specified in subclause and subclause From this time onward, all NAS messages exchanged between the UE and the AMF are sent integrity protected using the mapped 5G NAS security context, and except for the messages specified in subclause , all NAS messages exchanged between the UE and the AMF are sent ciphered using the mapped 5G NAS security context.
During inter-system change from S1 mode to N1 mode in 5GMM-IDLE mode, if the UE is operating in single-registration mode and: message integrity protected with the native 5G NAS security context.
The UE shall include the ngKSI indicating the native 5G NAS security context value in the REGISTRATION REQUEST message.
security context value, the AMF shall check whether the ngKSI included in the REGISTRATION REQUEST message belongs to a 5G NAS security context available in the AMF, and shall verify the MAC of the REGISTRATION REQUEST message.
If the verification is successful, the AMF deletes the EPS security context received from the source MME if any, and the AMF re-establishes the secure exchange of NAS 5G NAS security context.
From this time onward, all NAS messages exchanged between the UE and the AMF are sent integrity protected and except for the messages specified in subclause , all NAS messages exchanged between the UE and the AMF are sent ciphered; or security context into use or to modify the current 5G NAS security context by selecting new NAS security algorithms.
b) if the UE has no valid native 5G NAS security context, the UE shall send the REGISTRATION REQUEST message without integrity protection and encryption.
i) if an EPS security context received from the source MME does not include the NAS security algorithms ii) if an EPS security context received from the source MME includes the NAS security algorithms set to fresh native 5G NAS security context; or this context becomes the current 5G NAS security context in both the UE and the AMF.
This re-establishes the secure exchange of NAS messages.
During an N1 mode to N1 mode handover, secure exchange of NAS messages is established between the AMF and the UE by: the transmission of NAS security related parameters encapsulated in the AS signalling from the target AMF to The secure exchange of NAS messages shall be continued after N1 mode to N1 mode handover.
It is terminated after inter-system change from N1 mode to S1 mode in 5GMM-CONNECTED mode or when the NAS signalling connection is released.
security context, the UE shall transmit the initial NAS message integrity protected with the current 5G NAS security context and further protect this message as specified in subclause The UE shall include the ngKSI indicating the current 5G NAS security context value in the initial NAS message.
The AMF shall check whether the ngKSI included in the initial NAS message belongs to a 5G NAS security context available in the AMF, and shall verify the MAC of the NAS message.
If the verification is successful, the AMF may re-establish the secure exchange of NAS messages: context.
From this time onward, all NAS messages exchanged between the UE and the AMF are sent integrity protected and except for the messages specified in subclause , all NAS messages exchanged between the UE and the AMF are sent ciphered; or security context into use or to modify the current 5G NAS security context by selecting new NAS security algorithms.
Change of security keys NAS security context to be used.
The AMF shall send the SECURITY MODE COMMAND message integrity The AMF can also modify the current 5G NAS security context or take the non-current native 5G NAS security context, SECURITY MODE COMMAND message integrity protected with the modified 5G NAS security context, but Handling of NAS COUNT and NAS sequence number.
Each 5G NAS security context shall be associated with two separate counters NAS COUNT per access type in the same PLMN: one related to uplink NAS messages and one related to downlink NAS messages.
If the 5G NAS security context is used for access via both 3GPP and non-3GPP access in the same PLMN, there are two NAS COUNT counter pairs associated with the 5G NAS security context.
The NAS COUNT counters use 24 bit internal representation and When NAS COUNT is input to NAS ciphering or NAS integrity algorithms it shall be considered to be a 3bit entity which shall be constructed by padding the 2bit internal representation with 8 zeros in the most significant bits.
The value of the uplink NAS COUNT that is stored or read out of the USIM or non-volatile memory as described in The value of the downlink NAS COUNT that is stored or read out of the USIM or non-volatile memory as described in integrity checked NAS message.
The value of the downlink NAS COUNT stored in the AMF is the value that shall be used in the next NAS message.
The NAS sequence number part of the NAS COUNT shall be exchanged between the UE and the AMF as part of the NAS signalling.
After each new or retransmitted outbound SECURITY PROTECTED 5GS NAS MESSAGE message, the sender shall increase the NAS COUNT number by one, except for the initial NAS messages if the lower layers indicated the failure to establish the RRC connection (see 3GPP specification document\).
Specifically, on the sender side, the NAS sequence number shall be increased by one, and if the result is zero (due to wrap around), the stored NAS overflow counter shall also be incremented by one (see subclause\).
If, through implementation-dependent The sequence number part of the estimated NAS COUNT value shall be equal to the sequence number in the received NAS message; and If the receiver can guarantee that this NAS message was not previously accepted, then the receiver may select the estimated NAS overflow counter so that the estimated NAS COUNT value is lower than the stored NAS COUNT value; otherwise, the receiver selects the estima ted NAS overflow counter so that the estimated NAS COUNT value is higher than the stored NAS COUNT value.
of this 5G NAS security context to zero.
The UE shall set both the uplink and downlink NAS COUNT counters of this 5G NAS security context to zero.
During the inter-system change from S1 mode to N1 mode in 5GMM-CONNECTED mode, the AMF shall increment the downlink NAS COUNT by one after it has created an S1 mode to N1 mode NAS transparent container (see subclause\).
During the inter-system change from N1 mode to S1 mode in 5GMM-CONNECTED mode, the AMF shall increment the downlink NAS COUNT by one after it has created an N1 mode to S1 mode NAS transparent container (see During N1 mode to N1 mode handover: subclause\).
The AMF shall then increment the downlink NAS COUNT by one; or of the current downlink NAS COUNT value in an Intra N1 mode NAS transparent container (see subclause\) and shall then set both the uplink and downlink NAS COUNT counters of this 5G NAS security context to zero.
The AMF shall then increment the downlink NAS COUNT by one.
The UE shall also set both the uplink and downlink NAS COUNT counters to zero.
NOTE: During the inter-system change from S1 mode to N1 mode in 5GMM-CONNECTED mode, the S1 mode to N1 mode NAS transparent container (see subclaus e\) is treated as an implicit SECURITY Replay protection shall be supported for received NAS messages both in the AMF and the UE.
However, since the realization of replay protection does not affect the interoperability between nodes, no specific mechanism is required for implementation.
Replay protection assures that one and the same NAS message is not accepted twice by the receiver.
Specifically, for a Replay protection is not applicable when 5G-IA0 is used.
Integrity protection and verification The sender shall use its locally stored NAS COUNT as input to the integrity protection algorithm.
The receiver shall use the NAS sequence number included in the received message and an estimate for the NAS overflow counter as defined in subclause to form the NAS COUNT input to the integrity verification algorithm.
The algorithm to calculate the integrity protection information is specified in 3GPP specification document , and in case of the: the Sequence number IE and the NAS message IE.
b) Intra N1 mode NAS transparent container IE, the integrity protection shall include octet 7 to c) S1 mode to N1 mode NAS transparent container IE, the integrity protection shall include octet 7 to 1 In addition to the data that is to be integrity protected, the BEARER ID, DIRECTION bit, NAS COUNT and 5G NAS integrity key are input to the integrity protection algorithm.
These parameters are described in 3GPP specification document .
After successful integrity protection validation, the receiver shall update its corresponding locally stored NAS COUNT with the value of the estimated NAS COUNT for this NAS message.
Integrity verification is not applicable when 5G-IA0 is used.
The sender shall use its locally stored NAS COUNT as input to the ciphering algorithm.
The receiver shall use the NAS sequence number included in the received message and an estimate for the NAS overflow counter as defined in subclause to form the NAS COUNT input to the deciphering algorithm.
The input parameters to the NAS ciphering algorithm are the BEARER ID, DIRECTION bit, NAS COUNT, NAS encryption key and the length of the key stream to be generated by the encryption algorithm.
included in the NAS message container IE, i.
the value part of the NAS message container IE, that is to be ciphered.
When applying initial NAS message protection to the CONTROL PLANE SERVICE REQUEST message as described in subclause , the length of the key stream is set to the length of: a) the value part of the CIoT small data container IE that is to be ciphered; or b) the value part of the NAS message container IE that is to be ciphered.
NAS COUNT wrap around If, when increasing the NAS COUNT as specified above, the AMF detects that either its downlink NAS COUNT or the UE's uplink NAS COUNT is "close" to wrap around, (close to 224), the AMF shall take the following actions: If there is no non-current native 5G NAS security context with sufficiently low NAS COUNT values, the AMF established 5G NAS security context and the NAS COUNT being reset to 0 in both the UE and the AMF when the new 5G NAS security context is activated; AMF has not been established using primary authentication and key agreement procedure When the 5G-IA0 is used as the NAS integrity algorithm, the UE and the AMF shall allow NAS COUNT wrap around.
If NAS COUNT wrap around occurs, the following requirements apply: a) the UE and the AMF shall continue to use the current 5G NAS security context; b) the AMF shall not initiate the primary authentication and key agreement procedure; c) the AMF shall not release the NAS signalling connection; and Integrity protection of NAS signalling messages.
Integrity protection of all NAS signalling messages is the responsibility of the NAS.
It is the network which activates The use of "null integrity protection algorithm" 5G-IA0 (see subclause 2) in the current 5G NAS security context is only allowed: a) for an unauthenticated UE for which establishment of emergency services is allowed; For setting the security header type in outbound NAS messages, the UE and the AMF shall apply the same rules irrespective of whether the "null integrity protection algorith m" or any other integrity protection algorithm is indicated in the 5G NAS security context.
Details of the integrity protection and verification of NAS signalling messages are specified in 3GPP specification document .
then the ciphered NAS message and the NAS sequence nu mber are integrity protect ed by calculating the MAC.
NOTE: NAS messages that are ciphered with the "null ci phering algorithm" 5G-EA0 are regarded as ciphered When a 5GSM message is piggybacked in a 5GMM message, there is only one Sequence number IE and one Message authentication code IE for the 5GMM message piggybacking the 5GSM message.
Integrity checking of NAS signalling messages in the UE Except the messages listed below, no NAS signalling messages shall be processed by the receiving 5GMM entity in the UE or forwarded to the 5GSM entity, unless the network has established secure exchange of 5GS NAS messages for the NAS signalling connection: a) IDENTITY REQUEST (if requested identification parameter is SUCI); b) AUTHENTICATION REQUEST; c) AUTHENTICATION RESULT; e) REGISTRATION REJECT (if the 5GMM cause is not #76); f) DEREGISTRATION ACCEPT (for non switch off); and g) SERVICE REJECT (if the 5GMM cause is not #76).
NOTE: These messages are accepted by the UE without integrity protection, as in certain situations they are sent by the network before security can be activated.
Integrity protection is never applied directly to 5GSM messages, but to the 5GMM message in which the 5GSM The network can provide the SOR transparent container IE during the registration procedure to the UE in the REGISTRATION ACCEPT message.
The SOR transparent cont ainer IE is integrity protected by the HPLMN as specified in 3GPP specification document .
Once the secure exchange of NAS messages has been established, the receiving 5GMM entity in the UE shall not even though the secure exchange of NAS messages has been established by the network, then the NAS shall discard this message.
Integrity checking of NAS signalling messages in the AMF Except the messages listed below, no NAS signalling messages shall be processed by the receiving 5GMM entity in the AMF or forwarded to the 5GSM entity, unless the secure exchange of NAS messages has been established for the NAS signalling connection: b) IDENTITY RESPONSE (if requested identification parameter is SUCI); d) AUTHENTICATION FAILURE; e) SECURITY MODE REJECT; f) DEREGISTRATION REQUEST; and g) DEREGISTRATION ACCEPT; NOTE 1: The REGISTRATION REQUEST message is sent by the UE without integrity protection, if the registration procedure is initiated due to an inter-system change in 5GMM-IDLE mode and no current 5G NAS security context is available in the UE.
The other messages are accepted by the AMF without integrity protection, as in certain situations they are sent by the UE before security can be activated.
NOTE 2: The DEREGISTRATION REQUEST message can be sent by the UE without integrity protection, e.
if has been established.
For these cases the network can attempt to use additional criteria (e.
whether the UE is subsequently still performing periodic registration update or still responding to paging) before marking the UE as 5GMM-DEREGISTERED.
Integrity protection is never applied directly to 5GSM messages, but to the 5GMM message in which the 5GSM message is included.
NAS signalling connection, the receiving 5GMM entity in the AMF shall process the following NAS signalling messages, even if the MAC included in the message fails the integrity check or cannot be verified, as the 5G NAS security context is not available in the network: b) IDENTITY RESPONSE (if requested identification parameter is SUCI); d) AUTHENTICATION FAILURE; e) SECURITY MODE REJECT; f) DEREGISTRATION REQUEST; g) DEREGISTRATION ACCEPT; h) SERVICE REQUEST; and i) CONTROL PLANE SERVICE REQUEST; NOTE 3: These messages are processed by the AMF even when the MAC that fails the integrity check or cannot be verified, as in certain situations they can be sent by the UE protected with a 5G NAS security context that is no longer available in the network.
UE provided EPS NAS message container IE which was suc cessfully verified by the source MME, the AMF may create AMF should authenticate the subscriber before pr ocessing the deregistration request any further.
other reason, the AMF may ignore the deregistration request and remain in state 5GMM-REGISTERED.
NOTE 4: The network can attempt to use additional criteria (e.
whether the UE is subsequently still performing periodic registration update or still responding to paging) before marking the UE as 5GMM- security mode control procedure as specified in subclause Additionally, the AMF shall include the Additional 5G security information IE with the RINMR bit set to "Retransmission of the initial NAS message requested" in the sessions shall not be released.
Once the secure exchange of NAS messages has been established for the NAS signalling connection, the receiving 5GMM entity in the AMF shall not process any NAS signalling messages unless they have been successfully integrity checked by the NAS.
If any NAS signalling message, having not successfully passed the integrity check, is received, then the NAS in the AMF shall discard that message.
If any NAS signalling message is received, as not integrity protected even though the secure exchange of NAS messages has been established, then the NAS shall discard this message.
Ciphering of NAS signalling messages outbound NAS messages, the UE and the AMF shall apply the same rules irrespective of whether the "null ciphering algorithm" or any other ciphering algorithm is indicated in the 5G NAS security context.
The UE shall start the ciphering and deciphering of NAS messages when the secure exchange of NAS messages has been established for an N1 NAS signalling connection.
From this time onward, unless explicitly defined, the UE shall send all NAS messages ciphered until the N1 NAS signalling connection is released, or the UE performs inter-system change to S1 mode.
The AMF shall start ciphering and deciphering of NAS messages as described in subclause From this time onward, except for the SECURITY MODE COMMAND message, the AMF shall send all NAS messages ciphered until the N1 NAS signalling connection is released, or the UE performs inter-system change to S1 mode.
Ciphering is never applied directly to 5GSM messages, but to the 5GMM message in which the 5GSM message is Once the encryption of NAS messages has been started between the AMF and the UE, the receiver shall discard the unciphered NAS messages which shall have been ciphered according to the rules described in this specification.
security header indicating ciphering are regarded as ciphered.
Details of ciphering and deciphering of NAS signall ing messages are specified in 3GPP specification document .
NAS messages applies to the REGISTRATION REQUEST, SERVICE REQUEST and CONTROL PLANE SERVICE REQUEST message, and is achieved as follows: 1) if the UE needs to send non-cleartext IEs, the UE shall include the entire REGISTRATION REQUEST message (i.
containing both cleartext IEs and non-cleartext IEs) in the NAS message container IE and shall include the NAS message container IE in the SECURITY MODE COMPLETE message; or 2) if the UE does not need to send non-cleartext IEs, the UE shall include the entire REGISTRATION REQUEST message (i.
containing cleartext IEs only) in the NAS message container IE and shall include the NAS message container IE in the SECURITY MODE COMPLETE message.
the UE includes the entire REGISTRATION REQUEST or SERVICE REQUEST message (i.
containing both cleartext IEs and non-cleartext IEs) in the NAS mess age container IE and shall cipher the value part of i) if CIoT small data container IE is the only non-cleartext IE to be sent, the UE shall cipher the value part ii) otherwise, the UE includes non-cleartext IEs in the NAS message container IE and shall cipher the value or CONTROL PLANE SERVICE REQUEST message, the UE sends the REGISTRATION REQUEST or SERVICE REQUEST or CONTROL PLANE SERVICE REQUEST message without including the NAS message container IE.
Security header type; - Spare half octet; - Registration request message identity; - 5GS registration type; 5GS mobile identity; - UE security capability; - Additional GUTI; - UE status; and - EPS NAS message container.
Security header type; - Spare half octet; Control plane service request message identity; and - Control plane service type.
If the UE does not need to send non-cleartext IEs in the initial NAS message, the UE shall send the initial NAS message i.
REGISTRATION REQUEST or SERVICE REQUEST or CONTROL PLANE SERVICE REQUEST message with cleartext IEs only i.
without including the NAS message container IE in the initial NAS message.
AMF shall decipher the value part of the NAS message container IE.
If the received initial NAS message is a that is obtained from the NAS message container IE as the initial NAS message that triggered the procedure.
container IE, the AMF shall decipher the value part of the CIoT small data container IE and handle the message as specified in subclause the UE shall discard the 5G NAS security context and send an initial NAS message including cleartext IEs only as.
When the UE needs to access the 5GS, the UE not operating as an IAB-node (see 3GPP specification document\) first performs access control checks to determine if the access is allowed.
Access control checks shall be performed for the access attempts defined by the following list of events: derive an RRC establishment cause.
In this case the NAS provides the RRC establishment cause but does not provide the access category and the one or more access identities to the lower layers.
Editor's note [IABARC-CT, CR#2242]: When the UE operating as an IAB-node starts skipping the access control a) the UE is in 5GMM-IDLE mode or 5GMM-IDLE mode with suspend indication over 3GPP access and an event b) the UE is in 5GMM-CONNECTED mode over 3GPP access or 5GMM-CONNECTED mode with RRC inactive indication and one of the following events occurs: 1) 5GMM receives an MO-IMS-registration-related-signa lling-started indication, an MO-MMTEL-voice-call- started indication, an MO-MMTEL-video-call-started indication or an MO-SMSoIP-attempt-started indication from upper layers; 5GMM-IDLE mode or 5GMM-IDLE mode with suspend indication to 5GMM-CONNECTED mode; with suspend indication to 5GMM-CONNECTED mode; and 5GMM-IDLE mode to 5GMM-CONNECTED mode.
NOTE 2: 5GMM specific procedures initiated by NAS in 5GMM-CONNECTED mode are not subject to access control, e.
a registration procedure after PS handover will not be prevented by access control (see subclause\).
terminating or network induced location request, and the corresponding access attempts are handled as MT access.
TRANSPORT message including an SOR transparent container is not supported.
Therefore, access control for these cases has not been specified.
When the NAS detects one of the above events, the NAS needs to perform the mapping of the kind of request to one or more access identities and one access category and lower layers will perform access barring checks for that request based on the determined access identities and access category.
NOTE 5: The NAS is aware of the above events through indications provided by upper layers or through determining the need to start 5GMM procedures through normal NAS behaviour, or both.
a) a set of standardized access identities; b) a set of standardized access categories; and c) a set of operator-defined access categories, if available.
For the purpose of determining the appli cable access identities from the set of standardized access identities defined in 3GPP specification document , the NAS shall follow the requirements set out in: a) subclause and the rules and actions defined in table , if the UE is not operating in SNPN access In order to enable access barring checks for access attempts identified by lower layers in 5GMM-CONNECTED mode with RRC inactive indication, the UE provides the applicable access identities to lower layers.
NOTE 6: When and how the NAS provides the applicable access identities to lower layers is UE implementation NOTE 7: Although the UE operating as an IAB-node skips the access control checks, the UE provides the applicable access identities to lower layers for access attempts identified by lower layers in 5GMM- CONNECTED mode with RRC inactive indication.
For the purpose of determining the applicable access categ ory from the set of standardized access categories and operator-defined access categories defined in 3GPP specification document , the NAS shall follow the requirements set out in: a) subclause and the rules and actions defined in table , if the UE is not operating in SNPN access Determination of the access identities and access category When the UE needs to initiate an access attempt in one of the events listed in subclause , the UE shall determine one or more access identities from the set of standardized access identities, and one access category from the set of standardized access categories and operator-defined access cate gories, to be associated with that access attempt.
The set of the access identities applicable for the request is determined by the UE in the following way: a) for each of the access identities 1, 2, 11, 12, 13, 14 and 15 in table , the UE shall check whether the access RPLMN or equivalent PLMN; and b) if none of the above access identities is applicable, then access identity 0 is applicable.
0 UE is not configured with any parameters from this table 1 (NOTE 1) UE is configured for multimedia priority service (MPS).
2 (NOTE 2) UE is configured for mission critical service (MCS).
0 Reserved for future use 11 (NOTE 3) Access Class 11 is configured in the UE.
12 (NOTE 3) Access Class 12 is configured in the UE.
13 (NOTE 3) Access Class 13 is configured in the UE.
14 (NOTE 3) Access Class 14 is configured in the UE.
15 (NOTE 3) Access Class 15 is configured in the UE.
NOTE 1: Access identity 1 is valid when: the USIM file EF UAC_AIC indicates the UE is configured for access identity 1 and the selected the definition of home country in 3GPP specification document\); or the UE receives the 5GS network feature support IE with the MPS indicator bit set to "Access identity 1 valid" from the RPLMN as described in subclause and subclause NOTE 2: Access identity 2 is used by UEs configured for MCS and is valid when: the USIM file EF UAC_AIC indicates the UE is configured for access identity 2 and the selected 3GPP specification document\); or - the UE receives the 5GS network feature support IE with the MCS indicator bit set to "Access identity 2 valid" from the RPLMN as described in subclause and subclause NOTE 3: Access identities 11 and 15 are valid in HPLMN (if the EHPLMN list is not present or is empty) or EHPLMN (if the EHPLMN list is present).
Access Identities 12, 13 and 14 are valid in HPLMN and visited PLMNs of home country only (see the definition of home country in 3GPP specification document\).
The UE uses the MPS indicator bit of the 5GS network feat ure support IE to determine if access identity 1 is valid.
Processing of the MPS indicator bit of the 5GS network feature support IE in the REGISTRATION ACCEPT message is described in subclause and subclause The UE shall not consider access identity 1 to be valid when the UE is not in the country of its HPLMN or in an EHPL MN (if the EHPLMN list is present) prior to receiving the MPS indicator bit of the 5GS network feature support IE in the REGISTRATION ACCEPT message being set to "Access identity 1 valid".
When the UE is in the country of its HPLMN or in an EHPLMN (if the EHPLMN list is present), the contents of the UAC_AIC as specified in 3GPP specification document and the rules specified in table are used to determine the applicability of access identity When the UE is in the country of its HPLMN or in an EHPLMN (if the EHPLMN list is present), and the USIM file EF UAC_AIC does not indicate the UE is configured for access identity 1, the UE uses the MPS indicator bit of the 5GS network feature support IE in the REGISTRATION ACCEPT message to determine if access identity 1 is valid.
When the UE is in the country of its HPLMN or in an EHPLMN (if the EHPLMN list is present), and the USIM file EF UAC_AIC indicates the UE is configured for access identity 1, the MPS indicator bit of the 5GS network feature support IE is not applicable.
When the UE is not in the country of its HPLMN or in an EHPLMN (if the EHPLMN list is present), the contents of the USIM file EF UAC_AIC are not applicable.
The UE uses the MCS indicator bit of the 5GS network feat ure support IE to determine if access identity 2 is valid.
Processing of the MCS indicator bit of the 5GS network feature support IE in the REGISTRATION ACCEPT message is described in subclause and subclause The UE shall not consider access identity 2 to be valid when the UE is not in the country of its HPLMN or in an EHPL MN (if the EHPLMN list is present) prior to receiving the MCS indicator bit of the 5GS network feature support IE in the REGISTRATION ACCEPT message being set to "Access identity 2 valid".
When the UE is in the country of its HPLMN or in an EHPLMN (if the EHPLMN list is present), the contents of the UAC_AIC as specified in 3GPP specification document and the rules specified in table are used to determine the applicability of access identity When the UE is in the country of its HPLMN or in an EHPLMN (if the EHPLMN list is present), and the USIM file EF UAC_AIC does not indicate the UE is configured for access identity 2, the UE uses the MCS indicator bit of the 5GS network feature support IE in the REGISTRATION ACCEPT message to determine if access identity 2 is valid.
When the UE is in the country of its HPLMN or in an EHPLMN (if the EHPLMN list is present), and the USIM file EF UAC_AIC indicates the UE is configured for access identity 2, the MCS indicator bit of the When the UE is in its HPLMN (if the EHPLMN list is not present or is empty) or in an EHPLMN (if the EHPLMN list is present), the contents of the USIM file EF ACC as specified in 3GPP specification document and the rules specified in table are used to determine the applicability of access classes 11 and 1 When the UE is not in its HPLMN (if the EHPLMN list is not present or is empty) or in an EHPLMN (if the EHPLMN list is present), access classes 11 and 15 are not applicable.
When the UE is in the country of its HPLMN, the contents of the USIM file EF ACC as specified in 3GPP specification document and the rules specified in table are used to determine the applicability of access classes 12 - 1 When the UE is not in the country of its HPLMN, access classes 14 are not applicable.
In order to determine the access category applicable for the access attempt, the NAS shall check the rules in NOTE: The case when an access attempt matches more than one rule includes the case when multiple events trigger an access attempt at the same time.
3GPP access; initiated for the purpose of MMTEL video call or MMTEL video call or SMSoIP from non- 2 Emergency UE is attempting access for an emergency session (NOTE 1, NOTE 2) 2 (= emergency) 3 Access attempt for category UE stores operator-defined access category definitions valid in the current PLMN as specified in subclause , and access attempt is matching criteria of an operator- defined access category definition 33 Access attempt for MO exception data UE is in NB-N1 mode and allowed to use exception data reporting (see the ExceptionDataReportingAllowed leaf of the NAS configuration MO in 3GPP specification document or the USIM file NASCONFIG in 3GPP specification document\), and access attempt is for MO data or for MO related to an exceptional event.
10 (= MO 4 Access attempt for delay tolerant service (a) UE is configured for NAS signalling low priority or UE supporting S1 mode is configured for EAB (see the "ExtendedAccessBarring" leaf of NAS configuration MO in 3GPP specification document or 3GPP specification document\) where "EAB override" does not apply, and (b): the UE received one of the categories a, broadcasted category in the selected PLMN or RPLMN/equivalent PLMN (NOTE 3, NOTE 5, NOTE 6, NOTE 7, NOTE 8) 1 (= delay related signalling Access attempt is for MO IMS registration related signalling (e.
IMS initial registration, re-registration, subscription refresh) or for NAS signalling connection recovery during ongoing procedure for MO IMS registration related signalling (NOTE 2a) 9 (= MO IMS 5 MO MMTel voice call Access attempt is for MO MMTel voice call or for NAS signalling connection recovery during ongoing MO MMTel voice call (NOTE 2) 4 (= MO MMTel 6 MO MMTel video call Access attempt is for MO MMTel video call or for NAS signalling connection recovery during ongoing MO MMTel video call (NOTE 2) 5 (= MO MMTel 8 UE NAS initiated 5GMM specific procedures Access attempt is for MO signalling 3 (= MO_sig) request Access attempt is for mobile originated location request (NOTE 9) 3 (= MO_sig) towards the PCF Access attempt is for mobile originated signalling transaction towards the PCF (NOTE 10) 3 (= MO_sig) 9 UE NAS initiated 5GMM procedure or 5GMM NAS transport procedure Access attempt is for MO data 7 (= MO_data) 10 An uplink user data packet user-plane resources No further requirement is to be met 7 (= MO_data) NOTE 1: This includes 5GMM specific procedur es while the service is ongoing and 5GMM connection NOTE 2: Access for the purpose of NAS signalling connection recovery during an ongoing service as defined in subclause , or for the purpose of NAS signalling connection establishment following fallback indication from lower layers during an ongoing service as defined in subclause , is mapped to the access category of the ongoing service in order to derive an RRC establishment cause, but barring checks will be skipped for this access attempt.
NOTE 2a: Access for the purpose of NAS signalling connection recovery during an ongoing procedure for MO IMS registration related signalling as defined in subclause , or for the purpose of NAS signalling connection establishment following fallback indication from lower layers during an ongoing procedure for MO IMS registration related signalling as defined in subclause , is mapped to the access category of the MO IMS registration related signalling in order to derive an RRC establishment cause, but barring checks will be skipped for this access attempt.
NOTE 4: This includes the 5GMM connection management procedures triggered by the UE-initiated NAS transport procedure for transporting the MO SMS.
NOTE 5: The UE configured for NAS signalling low priority is not supported in this release of specification.
NOTE 6: If the access category applicable for the access attempt is 1, then the UE shall additionally NOTE 7: "EAB override" does not apply, if the UE is not configured to allow overriding EAB (see the NOTE 9: This includes: b) the 5GMM connection management procedure triggered by a) above; and c) NAS signalling connection recovery during an ongoing 5GC-MO-LR procedure.
NOTE 10: This includes: When the UE needs to initiate an access attempt in one of the events listed in subclause , the UE shall determine one or more access identities from the set of standardized access identities, and one access category from the set of standardized access categories and operator-defined access cate gories, to be associated with that access attempt.
The set of the access identities applicable for the request is determined by the UE in the following way: a) for each of the access identities 1, 2, 11, 12, 13, 14 and 15 in table A.
1, the UE shall check whether the b) if none of the above access identities is applicable, then access identity 0 is applicable.
1: Access identities 0 UE is not configured with any parameters from this table 1 (NOTE 1) UE is configured for multimedia priority service (MPS).
2 (NOTE 2) UE is configured for mission critical service (MCS).
0 Reserved for future use 11 (NOTE 3) Access Class 11 is configured in the UE.
12 (NOTE 3) Access Class 12 is configured in the UE.
13 (NOTE 3) Access Class 13 is configured in the UE.
14 (NOTE 3) Access Class 14 is configured in the UE.
15 (NOTE 3) Access Class 15 is configured in the UE.
NOTE 1: Access identity 1 is valid when: the unified access control configuration in the "list of subscriber data" stored in the ME (see 3GPP specification document\) indicates the UE is configured for access identity 1 in the selected SNPN, if a new SNPN is selected, or RSNPN; or the UE receives the 5GS network feature support IE with the MPS indicator bit set to "Access identity 1 valid" from the RSNPN as described in subclause and subclause NOTE 2: Access identity 2 is used by UEs configured for MCS and is valid when: identity 2 valid" from the RSNPN as described in subclause and subclause NOTE 3: Access identities 11 to 15 are valid if indicated as configured for the UE in the unified access control configuration in the "list of subscriber data" stored in the ME (see 3GPP specification document\) in The contents of the unified access control configuration in the "list of subscriber data" stored in the ME (see 3GPP specification document\) and the rules specified in table A.
1 are used to determine the appl icability of access identity 1 in the SNPN.
When the contents of the unified access control co nfiguration in the "list of subscriber data" stored in the ME (see 3GPP specification document\) do not indicate the UE is configured for access identity 1 for the SNPN, the UE uses the MPS indicator bit of the 5GS network feature support IE in the REGISTRATION ACCEPT message to determine if access identity 1 is valid.
The contents of the unified access control configuration in the "list of subscriber data" stored in the ME (see 3GPP specification document\) and the rules specified in table A.
1 are used to determine the appl icability of access identity 2 in the SNPN.
When the contents of the unified access control co nfiguration in the "list of subscriber data" stored in the ME (see 3GPP specification document\) do not indicate the UE is configured for access identity 2 for the SNPN, the UE uses the MCS indicator bit of the 5GS network feature support IE in the REGISTRATION ACCEPT message to determine if access identity 2 is valid.
The contents of the unified access control configuration in the "list of subscriber data" stored in the ME (see 3GPP specification document\) and the rules specified in table A.
1 are used to determine the applicability of access classes 11 to 15 in the SNPN.
NOTE: The case when an access attempt matches more than one rule includes the case when multiple events trigger an access attempt at the same time.
3GPP access (NOTE 11); initiated for the purpose of handover of MMTEL voice call, MMTEL video call or MMTEL video call or SMSoIP from non- 2 Emergency UE is attempting access for an emergency session (NOTE 1, NOTE 2) 2 (= emergency) 3 Access attempt for category UE stores operator-defined access category definitions valid in the SNPN as specified in subclause , and access attempt is matching criteria of an operator-defined access category definition 33 4 Access attempt for delay tolerant service (a) UE is configured for NAS signalling low priority or UE supporting S1 mode is configured for EAB (see the "ExtendedAccessBarring" leaf of NAS configuration MO in 3GPP specification document or 3GPP specification document\) where "EAB override" does not apply, and broadcasted category in the selected SNPN or RSNPN (NOTE 3, NOTE 5, NOTE 6, NOTE 7, NOTE 8) 1 (= delay related signalling Access attempt is for MO IMS registration related signalling (e.
IMS initial registration, re-registration, subscription or for NAS signalling connection recovery during ongoing procedure for MO IMS registration related signalling (NOTE 2a) 9 (= MO IMS 5 MO MMTel voice call Access attempt is for MO MMTel voice call or for NAS signalling connection recovery during ongoing MO MMTel voice call (NOTE 2) 4 (= MO MMTel 6 MO MMTel video call Access attempt is for MO MMTel video call or for NAS signalling connection recovery during ongoing MO MMTel video call (NOTE 2) 5 (= MO MMTel 7 MO SMS over NAS or MO SMSoIP Access attempt is for MO SMS over NAS (NOTE 4) or MO SMS over SMSoIP transfer or for NAS signalling connection recovery during ongoing MO SMS or SMSoIP transfer (NOTE 2) 6 (= MO SMS 8 UE NAS initiated 5GMM specific procedures Access attempt is for MO signalling 3 (= MO_sig) request Access attempt is for mobile originated location request (NOTE 9) 3 (= MO_sig) towards the PCF Access attempt is for mobile originated signalling transaction towards the PCF (NOTE 10) 3 (= MO_sig) 10 An uplink user data packet NOTE 1: In this release of the specification, there is no support for establishing an emergency session in NOTE 2: Access for the purpose of NAS signalling connection recovery during an ongoing service as defined in subclause , or for the purpose of NAS signalling connection establishment following fallback indication from lower layers during an ongoing service as defined in subclause , is mapped to the access category of the ongoing service in order to derive an RRC establishment cause, but barring checks will be skipped for this access attempt.
NOTE 2a: Access for the purpose of NAS signalling connection recovery during an ongoing MO IMS registration related signalling as defined in subclause , or for the purpose of NAS signalling connection establishment following fallback indication from lower layers during an ongoing MO IMS registration related signalling as defined in subclause , is mapped to the access category of the MO IMS registration related signalling in order to derive an RRC establishment cause, but barring checks will be skipped for this access attempt.
otherwise the UE uses the RSNPN.
NOTE 4: This includes the 5GMM connection management procedures triggered by the UE-initiated NAS transport procedure for transporting the MO SMS.
NOTE 5: The UE configured for NAS signalling low priority is not supported in this release of specification.
configuration for NAS signalling low priority when in N1 mode.
NOTE 6: If the access category applicable for the access attempt is 1, then the UE shall additionally matches, the access category of the lowest rule number shall be chosen.
The UE shall use the second access category only to derive an RRC establishment cause for the access attempt.
NOTE 7: "EAB override" does not apply, if the UE is not configured to allow overriding EAB (see the "Override_ExtendedAccessBarring" leaf of NAS configuration MO in 3GPP specification document or 3GPP specification document\), or if NAS has not received an indication from the upper layers to override 3GPP specification document .
The categories associated with access category 1 are distinct from the NOTE 9: This includes: c) NAS signalling connection recovery during an ongoing 5GC-MO-LR procedure.
NOTE 10: This includes: transaction towards the PCF; b) the 5GMM connection management procedure triggered by a) above; and c) NAS signalling connection recovery during an ongoing UE triggered V2X policy provisioning procedure.
NOTE 11: The term "non-3GPP access" refers to the case when the UE is accessing SNPN services via a Operator-defined access category definitions can be signalled to the UE using NAS signalling.
Each operator-defined access category definition consists of the following parameters: a) a precedence value which indicates in which order the UE shall evaluate the operator-defined category definition b) an operator-defined access category number, i.
acce ss category number in the 33 range that uniquely identifies the access category in the PLMN or SNPN in which the access categories are being sent to the UE; 1) DNN; 3) OS Id + OS App Id of applicat ion triggering the access attempt; or access identities of the UE to determine the RRC esta blishment cause as specified in subclause a request from upper layers to send an UL NAS TRANSPORT message for the purpose of PDU session mode or 5GMM-IDLE mode with suspend indication to 5GMM-CONNECTED mode; or a service request procedure to transition the UE from 5GMM-IDLE mode or 5GMM-IDLE mode with suspend the access attempt matches access category criteria type DNN if the DNN requested by the UE during the PDU session establishment procedure matches any of the access criteria type values associated with the access criteria type DNN; and the access attempt matches access category criteria type S-NSSAI if the S-NSSAI requested by the UE during the PDU session establishment procedure matches any of the access criteria type values associated with the access criteria type S-NSSAI.
If the access attempt is for an existing PDU session i.
it is triggered by: a request from upper layers to send an UL NAS TRANSPORT message for the purpose of PDU session a service request procedure to transition the UE from 5GMM-IDLE mode or 5GMM-IDLE mode with suspend a service request procedure to transition the UE from 5GMM-IDLE mode or 5GMM-IDLE mode with suspend the access attempt matches access category criteria type DNN if the DNN provided by the network in the PDU SESSION ESTABLISHMENT ACCEPT message matches any of the access criteria type values associated with the access criteria type DNN; and the access attempt matches access category criteria type S-NSSAI if the S-NSSAI associated with the PDU session matches any of the access criteria type values associated with the access criteria type S-NSSAI.
An access attempt matches the criteria of an operator-defined access category definition, if the access attempt matches all access category criteria types included in the criteria with any of the associated access criteria type values.
Several operator-defined access category definitions can have the same operator-defined access category number.
If: the UE shall use instead access category 7 (MO_data) in combination with the access identities of the UE to determine the RRC establishment cause as specified in subclause equivalent to the PLMN which provided them, or in the SNPN which provided them, as specified in annex C.
If the UE stores operator-defined access category definitions valid in the selected PLMN or the RPLMN, or valid in the selected SNPN or RSNPN, then access control in 5GMM-I DLE mode or 5GMM-IDLE mode with suspend indication range < 32, see subclause I.
for this case the UE shall skip the checking of operator-defined access category definitions.
If the UE is stores operator-defined access category definitions valid in the selected PLMN or the RPLMN, or valid in the selected SNPN or RSNPN, then access control in 5GMM-CONNECTED mode and in 5GMM-CONNECTED mode with RRC inactive indication will only be performed for the events 1) to 6) defined in subclause The UE shall handle the operator-defined access category definitions stored for the RPLMN or RSNPN as specified in subclause , subclause , and subclause When the UE is switched off, the UE shall keep the ope rator-defined access category definitions so that the operator- defined access category definitions can be used after switch on.
the UE shall stop using the operator-defined access category definitions stored for the previously selected PLMN or SNPN and should keep the operator-defined access category definitions stored for the previously selected PLMN or SNPN.
new SNPN, the UE can delete the operator-defined access category definitions stored for the previously selected PLMN or SNPN e.
if there is no storage space in the UE.
Access control and checking Access control and checking in 5GMM-IDLE mode and in 5GMM-IDLE mode a) subclause , table and table , and subclause , if the UE is not operating in SNPN access and provide the applicable access identities and the access category to the lower layers for the purpose of access control checking.
In this request to the lower layer the NAS can also provide to the lower layer the RRC establishment cause determined as specified in subclause of this specification.
being informed by the lower layers that the access attempt is allowed.
SERVICE REQUEST message as initial NAS message, the UE shall indicate the respective PDU sessions in the Uplink data status IE as specified in subclause and , regardless of the access category for which the access barring check is performed.
UE shall indicate the respective PDU sessions as specified in subclause , regardless of the access category for which the access barring check is performed.
NOTE 3: The UE indicates pending user data for all the respective PDU sessions, even if barring timers are running for some of the corresponding access categories.
If the lower layers indicate that the access attempt is allowed, the NAS shall initiate the procedure to send the initial NAS message for the access attempt.
If the lower layers indicate that the access attempt is barred, the NAS shall not initiate the procedure to send the initial NAS message for the access attempt.
Additionally: a) if the event which triggered the access attempt was an MO-MMTEL-voice-call-started indication or an MO- 1) if the UE is operating in the single-registration mode, the UE's usage setting is "voice centric" and the UE has not disabled its E-UTRA capability as specified in 3G PP specification document , the UE may attempt to select an E- providing access to IMS available; see su bclause and 3GPP specification document ; 2) if the UE is operating in the dual-registration mode , the UE may proceed in S1 mode with the appropriate available; see subclause and 3GPP specification document ; or 3) otherwise, the NAS shall notify the upper layers that the access attempt is barred.
In this case, upon receiving an indication from the lower layers that the barring is alleviated for the access category with which the access attempt was associated, the NAS shall notify the upper layers that the barring is alleviated for the access category and may initiate the procedure to send the initial NAS message, if still needed; b) if the event which triggered the access attempt was an MO-SMSoIP-attempt-started indication or an MO-IMS- 1) if the UE is operating in the single-registration mode, the UE may attempt to select an E-UTRA cell providing access to IMS available; see su bclause and 3GPP specification document ; 2) if the UE is operating in the dual-registration mode , the UE may proceed in S1 mode with the appropriate available; see subclause and 3GPP specification document ; or 3) otherwise, the NAS shall notify the upper layers that the access attempt is barred.
In this case, upon receiving an indication from the lower layers that the barring is alleviated for the access category with which the access attempt was associated, the NAS shall notify the upper layers that the barring is alleviated for the access category and may initiate the procedure to send the initial NAS message, if still needed; and c) if the access attempt is for emergency: 1) the NAS shall notify the upper layers that the access attempt is barred.
NOTE 4: This can result in the upper layers requesting another emergency call attempt using domain selection as specified in 3GPP specification document and 3GPP specification document .
Access control and checking in 5GMM-CONNECTED mode and in 5GMM- CONNECTED mode with RRC inactive indication When the UE is in 5GMM-CONNECTED mode or 5GMM-CONNECTED mode with RRC inactive indication, upon detecting one of events 1) through 8) listed in subcla use , the NAS shall categorize the corresponding access attempt into access identities and an access category following: a) subclause , table and table , and subclause , if the UE is not operating in SNPN access and provide the access identities and the access category to the lower layers for the purpose of access control checking.
In this request to the lower layer the NAS can also provide to the lower layer the RRC establishment cause determined as specified in subclause of this specification.
NOTE 1: As an implementation option, the NAS can provide the RRC establishment cause to the lower layers after being informed by the lower layers that the access attempt is allowed.
data status IE as specified in subclause and , regardless of the access category for which the access barring check is performed.
NOTE 2: The UE indicates pending user data for all the respective PDU sessions, even if barring timers are running for some of the corresponding access categories.
If the lower layers indicate that the access attempt is allowed, the NAS shall take the following action depending on the event which triggered the access attempt: a) if the event which triggered the access attempt was an MO-MMTEL-voice-call-started indication, an MO- MMTEL-video-call-started indication, an MO-SMSoIP-attempt-started indication, or an MO-IMS-registration-related-signalling-started indication, the NAS shall notify the upper layers that the access attempt is allowed; over NAS, 5GMM shall initiate the NAS transport procedure as specified in subclause to send the SMS in an UL NAS TRANSPORT message; 5GMM shall initiate the NAS transport procedure as specified in subclause to send the PDU SESSION ESTABLISHMENT REQUEST message; session, 5GMM shall initiate the NAS transport procedure as specified in subclause to send the PDU SESSION MODIFICATION REQUEST message; existing PDU session, 5GMM shall initiate the service request procedure as specified in subclause ; suspended user-plane resources, 5GMM shall consider that the uplink user data packet is allowed to be sent; location request, 5GMM shall initiate the NAS transport procedure as specified in clause to send an LCS message in an UL NAS TRANSPORT message; and subclause to send the signalling transaction via an UL NAS TRANSPORT message.
a) if the event which triggered the access attempt was an MO-MMTEL-voice-call-started indication, an MO- MMTEL-video-call-started indication or an MO-SMSoIP-at tempt-started indication, or an MO-IMS-registration- 1) if the UE is operating in the dual-registration mode , the UE may proceed in S1 mode with the appropriate available; see subclause and 3GPP specification document ; 2) otherwise, the NAS shall notify the upper layers that the access attempt is barred.
In this case, upon receiving an indication from the lower layers that the barring is alleviated for the access category with which the access attempt was associated, the NAS shall notify the upper layers that the barring is alleviated for the access NOTE 3: In this case prohibiting the initiation of the MMTEL voice session, MMTEL video session or prohibiting sending of the SMS over IP or the IMS registration related signalling is performed by the upper layers.
over NAS, 5GMM shall not initiate the NAS transport procedure as specified in subclause to send the SMS in an UL NAS TRANSPORT message.
Upon receiving an indication from the lower layers that the barring is alleviated for the access category with which the access attempt was associated, 5GMM may initiate the NAS transport procedure as specified in subclause to send the SMS in an UL NAS TRANSPORT message, if 5GMM shall not initiate the NAS transport procedure to send the PDU SESSION ESTABLISHMENT REQUEST message.
Upon receiving an indication from the lower layers that the barring is alleviated for the access category with which the access attempt was associated, the NAS may initiate the NAS transport procedure as specified in subc lause , if still needed; session modification, 5GMM shall not initiate the NAS transport procedure to send the PDU SESSION MODIFICATION REQUEST message.
Upon receiving an indication from the lower layers that the barring is alleviated for the access category with which the access attempt was associated, the NAS may initiate the NAS transport procedure as specified in subclause , if still needed; existing PDU session, the NAS shall not initiate the service request procedure as specified in subclause Upon receiving an indication from the lower layers that the barring is alleviated for the access category with which the access attempt was associated, the NAS may initi ate the service request procedure as specified in subclause , if still needed; suspended user-plane resources, 5GMM shall consider that the uplink user data packet is not allowed to be sent.
Upon receiving an indication from the lower layers that the barring is alleviated for the access category with which the access attempt was associated, the NAS shall consider that the barring is alleviated for the access category; location request, 5GMM shall not initiate the NAS transport procedure as specified in clause to send an LCS message in an UL NAS TRANSPORT message.
Upon receiving an indication from the lower layers that the barring is alleviated for the access category with which the access attempt was associated, 5GMM may initiate the NAS transport procedure as specified in clause to send the LCS message in an UL NAS TRANSPORT message, if still needed; and which the access attempt was associated, 5GMM may initia te the NAS transport procedure as specified in Access attempts are allowed to proceed without further acce ss control checking in order to avoid double barring for any NOTE 1: Although the access control checking is skipped, the access category is determined for the specific access attempt in order to derive an RRC establishment cause.
There are several services or an MO IMS registration related signalling for which the NAS needs to be informed when the service starts and stops, because, while the service is ongoing or the MO IMS re gistration related signalling is ongoing, the mapping of in order to avoid double barring at the start of these serv ices or at the start of the MO IMS registration related d) SMSoIP; e) SMS over NAS; f) 5GC-MO-LR procedure; and g) UE triggered V2X policy provisioning procedure.
layers to perform emergency service fallback and performs emergency services fallback as specified in subclause of 3GPP specification document .
In this case, the UE considers the emergency service as stopped when: the emergency PDU session established during the emergency services fallback is released if the UE has moved to an E-UTRA cell connected to 5GCN; or the service request procedure involved in the emergency services fallback is completed otherwise.
Once the emergency service has successfully passed access control, then as long as the service is ongoing, the following access attempts are allowed to proceed without further access control checking in order to avoid double barring: any service request procedure related to the PDU session associated with request type = "initial emergency request" or "existing emergency PDU session"; and request type = "initial emergency request" or "existing emergency PDU session".
For services b) to g) the 5GMM receives explicit start and stop indications from the upper layers.
For the case of handover of ongoing services b) to d) from non-3GPP access, the 5GMM receives an additional explicit handover of ongoing service from non-3GPP access indication from the upper layer.
Once the service has successfully passed access control, then as long as the service is ongoi ng, the following access attempts are allowed to proceed without further access control checking in order to avoid double barring: for services b), c) and d): 1) any service request procedure related to the PDU session established for DNN = "IMS" except between receiving from the lower layers an indication that access barring is applicable for all access categories except categories 0 and 2 and receiving from the lower layers an indication that the barring is alleviated for the access category determined for the access attempt; and DNN = "IMS" except between receiving from the lower laye rs an indication that access barring is applicable for all access categories except categories 0 and 2 and recei ving from the lower layers an indication that the barring is alleviated for the access category determined for the access attempt; SMSoIP is different from "IMS": 1) any service request procedure related to the PDU session established for the DNN used for SMSoIP except between receiving from the lower layers an indicat ion that access barring is applicable for all access categories except categories 0 and 2 and receiving from the lower layers an indication that the barring is alleviated for access category 6; and the DNN used for SMSoIP except between receiving from the lower layers an indication that access barring is applicable for all access categories except categories 0 and 2 and receiving from the lower layers an indication that the barring is alleviated for access category Once the MO IMS registration related signalling has successfully passed access control, then as long as the MO IMS registration related signalling is ongoing, the following access attempts are allowed to proceed without further access control checking in order to avoid double barring: 1) any service request procedure related to the PDU session established for DNN = "IMS" and for the DNN used SMSoIP is different from "IMS", except between receiving from the lower layers an indication that access barring is applicable for all access categories except categories 0 and 2 and receiving from the lower layers an indication that the barring is alleviated for the access category determined for the access attempt; and DNN = "IMS" and for the DNN used for SMSoIP except between receiving from the lower layers an indication that access barring is applicable for all access categories ex cept categories 0 and 2 and receiving from the lower layers an indication that the barring is alleviated for the access category determined for the access attempt; While an MMTEL voice call is ongoing: any service request procedure related to the PDU session established for DNN = "IMS" is mapped to access DNN = "IMS" is mapped to access category 4; and 1) service request procedure; or 2) registration procedure; and\) is mapped to access category While an MMTEL video call is ongoing and no MMTEL voice call is ongoing: any service request procedure related to the PDU session established for DNN = "IMS" is mapped to access DNN = "IMS" is mapped to access category 5; and 1) service request procedure; or initiated in 5GMM-IDLE mode or 5GMM-IDLE mode with suspend indication for the purpose of NAS and\) is mapped to access category While an SMSoIP is ongoing, no MMTEL video call is ongoing and no MMTEL voice call is ongoing: any service request procedure related to the PDU session established: 1) for DNN = "IMS"; or DNN used for SMSoIP is different from "IMS"; is mapped to access category 6; and 1) for DNN = "IMS"; or DNN used for SMSoIP is different from "IMS"; is mapped to access category 6; and 1) service request procedure; or 2) registration procedure; initiated in 5GMM-IDLE mode or 5GMM-IDLE mode with suspend indication for the purpose of NAS and\) is mapped to access category While an MO IMS registration related signalling is ongoing, no SMSoIP is ongoing, no MMTEL video call is ongoing and no MMTEL voice call is ongoing: any service request procedure related to the PDU session established: 1) for DNN = "IMS"; and DNN used for SMSoIP is different from "IMS"; 1) for DNN = "IMS"; and is mapped to access category 9; and 1) service request procedure; or 2) registration procedure; indication from the lower layers (see subclause and\) is mapped to access category While an SMS over NAS is ongoing, no SMSoIP is ongoing, no MO IMS registration related signalling is ongoing, no MMTEL video call is ongoing and no MMTEL voice call is ongoing: 1) service request procedure; or initiated in 5GMM-IDLE mode or 5GMM-IDLE mode with suspend indication for the purpose of NAS and\) is mapped to access category While a 5GC-MO-LR procedure is ongoing, no SMS over NAS is ongoing, no SMSoIP is ongoing, no MO IMS registration related signalling is ongoing, no MMTEL video call is ongoing, and no MMTEL voice call is ongoing: 1) service request procedure; or initiated in 5GMM-IDLE mode or 5GMM-IDLE mode with suspend indication for the purpose of NAS and\) is mapped to access category 1) service request procedure; or indication from the lower layers (see subclauses and\) is mapped to access category NOTE 3: Although the access control checking is skipped, the mapping is performed in order to derive an RRC If an access category is determined and the access control checking is skipped, the NAS shall determine the RRC establishment cause from one or more determined access identities and the access category as specified in subclause , the NAS shall initiate the procedure to send the initial NAS message for the access attempt and shall provide the RRC establishment cause to lower layers.
If the UE receives from the lower layers an indication th at access barring is applicable for all access categories except categories 0 and 2: a) if an MMTEL voice call or MMTEL video call is ongoing: 1) if the UE is operating in the single-registration mode and the UE's usage setting is "voice centric", the UE 2) if the UE is operating in the dual-registration mode , the UE may proceed in S1 mode with the appropriate available; see subclause and 3GPP specification document ; and b) if SMSoIP is ongoing or an MO IMS registration related signalling is ongoing: 1) if the UE is operating in the single-registration mode, the UE may attempt to select an E-UTRA cell providing access to IMS available; see subc lause and 3GPP specification document ; and 2) if the UE is operating in the dual-registration mode , the UE may proceed in S1 mode with the appropriate available; see subclause and 3GPP specification document .
Mapping between access categories/access identities and RRC category by checking the rules specified in table and table If the access attempt matches more than one rule, the RRC establishment cause of the lowest rule number shall be used.
If the determined access category is an operator-defined access category, then the RRC establishment cause used by the UE shall be selected according to table and table based on one or more access identities (see subclauses and A) and the standardized access category determined for the operator-de fined access category as described in subclause Table : Mapping table for access identities/access categories and RRC establishment cause when establishing N1 NAS signalling connection via NR connected to 5GCN Rule # Access identities Access categories RRC establishment cause is 1 1 Any category mps-PriorityAccess 2 2 Any category mcs-PriorityAccess 3 11, 15 Any category highPriorityAccess 4 12, 13, 14, Any category highPriorityAccess 5 0 0 (= MT_acc) mt-Access 1 (= delay tolerant) Not applicable (NOTE 1) 2 (= emergency) emergency 3 (= MO_sig) mo-Signalling 4 (= MO MMTel voice) mo-VoiceCall 5 (= MO MMTel video) mo-VideoCall 6 (= MO SMS and SMSoIP) mo-SMS 7 (= MO_data) mo-Data 9 (= MO IMS registration range 3 to 7 that is to be used for determination of the RRC establishment cause.
See subclause , NOTE 2: See subclause , table for use of the access identities of 0, 1, 2, and 1 1 1 Any category highPriorityAccess 2 2 Any category highPriorityAccess 3 11, 15 Any category highPriorityAccess 4 12, 13, 14, Any category highPriorityAccess 5 0 0 (= MT_acc) mt-Access 1 (= delay tolerant) Not applicable (NOTE 1) 2 (= emergency) emergency 3 (= MO_sig) mo-Signalling 4 (= MO MMTel voice) mo-VoiceCall 5 (= MO MMTel video) mo-VoiceCall 6 (= MO SMS and SMSoIP) mo-Data 7 (= MO_data) mo-Data 9 (= MO IMS registration 10 (= MO exception data) mo-ExceptionData (NOTE 3) range 3 to 7 that is to be used for determination of the RRC establishment cause.
See subclause , NOTE 2: See subclause , table for use of the access identities of 0, 1, 2, and 1 NOTE 3: This applies to the UE in NB-N1 mode.
an SD in an S-NSSAI is optional.
A set of one or more S-NSSAIs is called the NSSAI.
The following NSSAIs are defined in 3GPP specification document : b) requested NSSAI; c) allowed NSSAI; d) subscribed S-NSSAIs; and The following NSSAIs are defined in the present document: a) rejected NSSAI for the current PLMN or SNPN; b) rejected NSSAI for the current registration area; and c) rejected NSSAI for the failed or revoked NSSAA.
In roaming scenarios, the S-NSSAI(s) included in the re jected NSSAI for the failed or revoked NSSAA is HPLMN S- equivalent PLMNs, can be used to form the requested NSSAI for any of the equivalent PLMNs when the UE is outside of the registration area where the allowed NSSAI was received.
When the network slice-specific authentication and authorization procedure is to be initiated for one or more S-NSSAIs in the requested NSSAI, these S-NSSAI(s) will be included in the pending NSSAI.
When the network slice-specific NSSAI will be moved to the allowed NSSAI or rejected NSSAI depending on the outcome of the procedure and communicated to the UE.
The pending NSSAI is managed regardless of access type i.
the pending NSSAI is applicable to both 3GPP access and non-3GPP access for the current PLMN even if sent over only one of the accesses.
If the registration area contains TAIs belonging to differ ent PLMNs, which are equivalent PLMNs, the pending NSSAI is applicable to these PLMNs in this registration area.
The rejected NSSAI for the current PLMN or SNPN is appl icable for the whole registered PLMN or SNPN.
The AMF to the whole registered PLMN.
The rejected NSSAI for the failed or revoked NSSAA includes one or more S-NSSAIs that have failed the network the whole registered PLMN or SNPN.
NOTE 1: Based on local policies, the UE can remove an S-NSSAI from the rejected NSSAI for the failed or revoked NSSAA when the UE wants to register to the slice identified by this S-NSSAI.
NOTE 2: At least one S-NSSAI in the default configured NSSAI or in the subscribed S-NSSAIs marked as default S-NSSAI is recommended as not subject to network slice-specific authentication and authorization, in order to ensure that at least one PDU session can be established to access service, even when Network Slice-specific Authentication and Authorization fails.
b) the UE has an allowed NSSAI for the current PLMN or SNPN; or c) the UE has neither allowed NSSAI for the current PLMN nor configured NSSAI for the current PLMN and has a default configured NSSAI.
In this case the UE indicates to the AMF that the requested NSSAI is created from the default configured NSSAI.
NSSAI(s) available in the UE (see subclause for further details).
In roaming scenarios, the UE shall also provide the mapped S-NSSAI(s) for the requested NSSAI, if available.
The AMF verifies if the requested NSSAI is permitted based on the subscribed S-NSSAIs in the UE subscription and optionally the mapped S-NSSAI(s) provided by the UE, and if so then the AMF shall provide the UE with the allowed NSSAI for the PLMN or SNPN, and shall also provide the UE with the mapped S-NSSAI(s) for the allowed NSSAI for the PLMN if available.
The AMF shall ensure that there are not two or more S-NSSAIs of the allowed NSSAI which are mapped to the same S-NSSAI of the change may be initiated by the network or the UE.
In this case, the allowed NSSAI and associated registration area may be changed during the registration procedure or the generic UE configuration update procedure.
In addition, using the generic UE configuration update procedure, the network may trigger the registration procedure in order to update the The UE in NB-N1 mode does not include the requested NSSAI during the registration procedure if the 5GS registration type IE indicates "mobility registration updating", procedure is not initiated to change the slice(s) that the UE is currently registered to, and the UE is still in the current registration area.
The AMF does not include the allowed NSSAI an access type.
Each of the configured NSSAI except the default configured NSSAI, and the rejected NSSAI is for the current registration area are further associated with one or more tracking areas where the rejected S-NSSAI(s) is not available.
The S-NSSAI(s) in the rejected NSSAI for the current PLMN or SNPN shall be considered rejected for revoked NSSAA shall be considered rejected for the curre nt PLMN regardless of the access type.
There shall be no duplicated PLMN identities or SNPN identities in each of the list of configured NSSAI(s), allowed NSSAI(s), rejected NSSAI(s) for the current PLMN or SNPN, and rejected NSSAI(s) for the current registration area.
The UE stores NSSAIs as follows: The network may provide to the UE the mapped S-NSSAI(s) for the new configured NSSAI which shall also be 1) replace any stored configured NSSAI for this PLMN or SNPN with the new configured NSSAI for this 2) delete any stored mapped S-NSSAI(s) for the configured NSSAI and, if available, store the mapped S- NSSAI(s) for the new configured NSSAI; 3) delete any stored allowed NSSAI for this PLMN or SNPN and, if available, the stored mapped S-NSSAI(s) for the allowed NSSAI, if the UE received the new configured NSSAI for this PLMN or SNPN and the Configuration update indication IE with the Registration requested bit set to "registration requested", in the same CONFIGURATION UPDATE COMMAND message but without any new allowed NSSAI for this PLMN or SNPN included; 4) delete any stored rejected NSSAI for the current PL MN or SNPN, rejected NSSAI for the current registration area and rejected NSSAI for the failed or revoked NSSAA; and 5) delete any stored pending NSSAI, if not already included in the new configured NSSAI for the current establishment procedure in EPS as specified in 3GPP specification document or via ePDG as specified in 3GPP specification document , the UE may store the received S-NSSAI in the configured NSSAI for the PLMN identified by the PLMN ID associated with the S-NSSAI, if not already in the configured NSSAI; NOTE 1: The maximum number of configured NSSAIs and associated mapped S-NSSAIs for PLMNs other than the HPLMN that need to be stored in the UE, and how to handle the stored entries, are up to UE the CONFIGURATION UPDATE COMMAND message with the Registration requested bit of the Configuration update indication IE set to "registration requested" is received and contains no other parameters 1) replace any stored allowed NSSAI for this PLMN or SNPN with the new allowed NSSAI for this PLMN or 2) delete any stored mapped S-NSSAI(s) for the allowed NSSAI and, if available, store the mapped S-NSSAI(s) for the new allowed NSSAI; 3) remove from the stored rejected NSSAI, the S-NSSAI(s), if any, included in the new allowed NSSAI for the current PLMN or SNPN; and 4) remove from the stored pending NSSAI, one or more S-NSSAIs, if any, included in the new allowed NSSAI for the current PLMN or SNPN and its equivalent PLMN(s).
If the UE receives the CONFIGURATION UPDATE COMMAND message with the Registration requested bit of the Configuration update indication IE set to "registration requested" and contains no other parameters (see subclauses and\), the UE shall delete any stored allowed NSSAI for this PLMN or SNPN, and delete any stored mapped S-NSSAI(s) for the allowed NSSAI, if available; NOTE 2: Whether the UE stores the allowed NSSAI and the mapped S-NSSAI(s) for the allowed NSSAI also when the UE is switched off is implementation specific.
c) When the UE receives the S-NSSAI(s) included in rejected NSSAI in the REGISTRATION ACCEPT message, the REGISTRATION REJECT message, the DEREGISTRATION REQUEST message or in the CONFIGURATION UPDATE COMMAND message, the UE shall: 1) store the S-NSSAI(s) into the rejected NSSAI based on the associated rejection cause(s); 2) remove from the stored allowed NSSAI for the current PLMN or SNPN, the S-NSSAI(s), if any, included in i) rejected NSSAI for the current PLMN or SNPN, for each and every access type; and ii) rejected NSSAI for the current registration area, associated with the same access type; 3) remove from the stored mapped S-NSSAI(s) for the allowed NSSAI if available, the S-NSSAI(s), if any, included in the: i) rejected NSSAI due to the failed or revoked netw ork slice-specific authentication and authorization, for each and every access type; 4) remove from the stored pending NSSAI for the current PLMN or SNPN and its equivalent PLMN(s), the S- NSSAI(s), if any, included in the: i) rejected NSSAI for the current PLMN or SNPN, for each and every access type; and ii) rejected NSSAI for the current registration area, associated with the same access type; and 5) remove from the stored mapped S-NSSAI(s) for the pending NSSAI, the S-NSSAI(s), if any, included in the: i) rejected NSSAI for the failed or revoked NSSAA, for each and every access type.
When the UE: the current PLMN; or and the UE is not registered with the current PLMN over another access, the rejected NSSAI for the current PLMN shall be deleted.
3) enters state 5GMM-DEREGISTERED or 5GMM-REGISTERED following an unsuccessful registration in a new registration area over an access type; the rejected NSSAI for the current registration ar ea corresponding to the access type shall be deleted; d) When the UE receives the pending NSSAI in the REGISTRATION ACCEPT message, the UE shall replace any stored pending NSSAI for this PLMN or SNPN with the new pending NSSAI received in the REGISTRATION ACCEPT message for this PLMN or SNPN.
Editor’s Note [WI: eNS, CR#1602]: The NSSAI storage update regarding Allowed NSSAI in scenario when re- If the registration area contains TAIs belonging to diff erent PLMNs, which are equivalent PLMNs, then for each of the equivalent PLMNs, the UE shall replace any stor ed pending NSSAI with the pending NSSAI received in 1) deregisters with the current PLMN using explicit signalling or enters state 5GMM-DEREGISTERED for the 5) initiates attach or tracking area update procedure in S1 mode and receives an ATTACH REJECT or TRACKING AREA UPDATE REJECT and the UE is operating in single-registration mode; and the UE is not registered with the current PLMN over another access, the pending NSSAI for the current PLMN and its equivalent PLMN(s) shall be deleted; and subscription change indication set to "Network slicing subscription changed" in the REGISTRATION ACCEPT The UE shall not delete the default configured NSSAI.
Additionally, the UE shall update the network slicing information for the current PLMN (if received) as specified above in bullets a), b), c) and e).
Provision of NSSAI to lower layers in 5GMM-IDLE mode The UE NAS layer may provide the lower layers with an NSSAI (either requested NSSAI or allowed NSSAI) when the UE in 5GMM-IDLE mode sends an initial NAS message.
inclusion mode in which the UE shall operate over the current access within the current PLMN or SNPN, if any (see i) including the 5GS registration type IE set to "initial registration" Requested i) including the 5GS registration type IE set to "mobility registration updating"; and ii) initiated by case other than case g) or n) in subclause Requested i) including the 5GS registration type IE set to "mobility registration updating"; and ii) initiated by case g) or n) in subclause Allowed NSSAI No NSSAI No NSSAI i) including the 5GS registration type IE set to "periodic registration NSSAI No NSSAI No NSSAI SERVICE REQUEST message Allowed NOTE 1 No NSSAI No NSSAI NOTE 1: All the S-NSSAIs of the PDU sessions that have the user-plane resources requested to be re- triggering the service request is related to (see 3GPP specification document\) of the S-NSSAIs in the requested NSSAI or the allowed NSSAI when it is provided to the lower The UE shall store the NSSAI inclusion mode: a) indicated by the AMF, if the AMF included the NSSAI inclusion mode IE in the REGISTRATION ACCEPT b) decided by the UE, if the AMF did not include the NSSAI inclusion mode IE in the REGISTRATION ACCEPT specified in annex C.
The UE shall apply the NSSAI inclusion mode received in the REGISTRATION ACCEPT message over the current access within the current PLMN and its equivalent PLMN(s) or the current SNPN, if any, in the current registration area.
the UE shall provide the lower layers with: a) no NSSAI if the UE is performing the registration procedure over 3GPP access; or b) requested NSSAI if the UE is performing the registration procedure over non-3GPP access.
Network slice-specific authentication and authorization The UE and network may support network slice-specific authentication and authorization.
A serving PLMN shall perform network slice-specific authentication and authorization for the S-NSSAI(s) of the HPLMN which are subject to it based on subscription information.
The UE shall indicate whether it supports network slice-specific authentication and authorization in the 5GMM Capability IE in the REGISTRATION REQUEST message as specified in subclauses and specific authentication and authorization.
NOTE 1: The credentials for network slice-specific authenti cation and authorization and how to provision them in the upper layer are out of the scope of 3GPP.
The network slice-specific authentication and author ization procedure shall not be performed unless: a) the primary authentication and key ag reement procedure as specified in the subclause has successfully been b) the initial registration procedure or the mobility and periodic registration update procedure has been completed.
The AMF informs the UE about S-NSSAI(s) for which network slice-specific authentication and authorization will be performed in the pending NSSAI.
The AMF informs the UE about S-NSSAI(s) for which NSSAA procedure is completed as success in the allowed NSSAI.
The AMF informs the UE about S-NSSAI(s) for which NSSAA procedure is completed as failure in the rejected NSSAI for the failed or revoked NSSAA.
The AMF stores and handles allowed NSSAI, pending NSSAI, rejected NSSAI, and 5GS registration result in the REGISTRATION ACCEPT message according to subclauses and NOTE 2: The AMF maintains the NSSAA procedure status for each S-NSSAI, as specified in 3GPP specification document [20B].
To perform network slice-specific authentication and authorization for an S-NSSAI, the AMF invokes an EAP-based network slice-specific authentication and authorization procedure for the S-NSSAI, see subclause and 3GPP specification document using the EAP framework as described in 3GPP specification document .
The AMF updates the allowed NSSAI and the rejected NSSAI using the generic UE configuration update procedure as specified in the subclause after the network slice-speci fic authentication and authoriza tion procedure is completed.
The AMF shall send the pending NSSAI containing all S-NSSAIs for which the network slice-specific authentication and authorization procedure will be performed or is ongoing in the REGISTRATION ACCEPT message.
The AMF shall also include in the REGISTRATION ACCEPT message the allowed NSSAI containing one or more S-NSSAIs from the requested NSSAI which are allowed by the AMF and for which network slice-specific authentication and authorization is not required, if any.
The network slice-specific authentication and authorization procedure or the network slice-specific authori zation revocation procedure: a) if network slice-specific authentication and authorization fails or network slice-specific authorization is revoked for some but not all S-NSSAIs in the allowed NSSAI, the AMF updates the allowed NSSAI and the rejected NSSAI accordingly using the generic UE configuration upda te procedure as specified in the subclause and inform the SMF to release all PDU sessions associated with the S-NSSAI for which network slice-specific re- authentication and re-authorization fails or network slice-specific authorization is revoked; or b) if network slice-specific authentication and authorization fails or network slice-specific authorization is revoked for all S-NSSAIs in the allowed NSSAI and the pending NSSAI, then AMF performs the network-initiated de-registration procedure and includes the rejected NSSAI in the DEREGISTRATION REQUEST message as establishing an emergency PDU session.
In this case the AMF shall send the CONFIGURATION UPDATE COMMAND message containing rejected NSSAI and inform the SMF to release all PDU sessions associated When performing the network slice-specific re-authenti cation and re-authorization procedure if the S-NSSAI is included in the allowed NSSAI for both 3GPP and non-3GPP accesses, and the UE is registered to both 3GPP and non- 3GPP accesses in the same PLMN, then the AMF selects an access type to perform network slice-specific authentication and authorization based upon operator policy.
If network slice-specific authorization is revoked for an S-NSSAI that is in the current allowed NSSAI for an access type, the AMF shall: slice-specific authorization is revoked, with the reject cause "S-NSSAI is not available due to the failed or revoked network slice-specific authentication and authorization", to the UE using the generic UE configuration update proce dure as specified in the subclause and inform the SMF for this access type.
slice-specific authentication and authori zation procedure, the AMF may determine to not forward the 5GSM message to the SMF as described in subclause NOTE 2: If the AMF receives the HTTP code set to "4xx" or "5xx" as specified in 3GPP specification document [20AA] or the Session ma nagement aspects based on the URSP rules which include S-NSSAIs, if any (see subclause\), or based on UE local configuration, as described in subclause of 3GPP specification document .
NAS over non-3GPP access 
From the UE's NAS perspective, in general the procedures and messages defined for 5GMM and 5GSM are used over 5GS mobility management aspects.
The mobility management procedures defined over 3GPP access are re-used over non-3GPP access with the following exceptions: a) the registration status, and the 5GMM parameters of the UE's 3GPP access and non-3GPP access 5GMM state machine instances are independent in each of these accesses and can be different; RPLMN over 3GPP access and the MCC of the RPLMN over the non-3GPP access can also be different; d) the registration for 3GPP access and for non-3GPP access are performed separately.
Like for 3GPP access, an access stratum connection exists before the UE can perform the registration procedure for non-3GPP access.
As over non-3GPP access the 5GS operates one single common registration area for an entire PLMN, which is associated with the operator-specific N3GPP TAI for the PLMN, list management of registration areas is not required, and registration updating due to registration area change with the registered PLMN is not performed.
Furthermore, the periodic registration update procedure is also not performed.
New registration at change of PLMN is required; e) the 5GMM over non-3GPP access in the UE considers that the N1 NAS signalling connection is established when the lower layers indicate that the access stratum connection is established succcessfully; f) the UE-initiated service request procedure via non-3GPP access is supported.
Upon indication from the lower layers of non-3GPP access, that the access stratum connection is established between the UE and the network, the UE in 5GMM-REGISTERED state and in 5GMM-IDLE mode over non-3GPP access shall initiate the service request procedure via non-3GPP access.
The UE may indicate with the service request message the PDU session(s) associated with non-3GPP access to re-establish user-plane resources for which the UE has pending user data to be sent; g) paging procedure is not performed via non-3GPP access; h) service area restrictions do not apply for non-3GPP access other than the wireline access; i) the establishment cause for non-3GPP access is determined according to subclause ; j) eCall inactivity procedure is not performed via non-3GPP access; k) local area data network (LADN) does not apply for non-3GPP access; l) the Allowed PDU session IE shall not be included in the REGISTRATION REQUEST message or the SERVICE REQUEST message sent over non-3GPP access; m) DRX parameters do not apply for non-3GPP access; n) Mobile initiated connection only mode (MICO) does not apply for non-3GPP access; o) CIoT 5GS optimizations do not apply for non-3GPP access; p) unified access control does not apply for non-3GPP access; q) UE radio capability signalling optimisation (RACS) does not apply for non-3GPP access; and r) Closed access group (CAG) does not apply for non-3GPP access.
Establishment cause for non-3GPP access When establishment of an N1 NAS signalling connection over non-3GPP access is initiated, the UE shall determine one or more access identities to be associated with the establishment of the N1 NAS signalling connection as specified in subclause and table , shall select the establ ishment cause for non-3GPP access from the determined one or more access identities and the event which triggered initiation of the N1 NAS signalling connection over non-3GPP 3GPP access to the lower layers.
If the access attempt matches more than one rule, the establishment cause for non-3GPP access of the lowest rule number shall be used.
2 2 Any Any mcs-PriorityAccess 3 11, 15 Any Any highPriorityAccess 4 12, 13, 14, Any Any highPriorityAccess 5 0 Emergency UE is attempting procedures Access attempt is for procedure Access attempt is for NOTE 1: This includes 5GMM specific procedures while the service is ongoing and 5GMM connection management NOTE 2: See subclause , table for use of the access identities of 0, 1, 2, and 1 5GS session management aspects The session management procedures defined over 3GPP access are re-used over non-3GPP access with the following Serving PLMN rate control does not apply for non-3GPP access.
Small data rate control does not apply for non-3GPP access.
- Handling of 5GSM cause value #82 "maximum data rate per UE for user-plane integrity protection is too low" does not apply for non-3GPP access.
Limited service state over non-3GPP access access and the UE enters the limited service state over non-3GPP access.
These include: a) no USIM in the ME; b) an "illegal UE" or "illegal ME" response is received when registration or service request is performed (any USIM in the ME is then considered "invalid"); 3GPP specification document .
NAS signalling using trusted WLAN access network a) NAS signalling over N1 NAS signalling connection with AMF; and b) PDU session establishment, modification and release on behalf of the N5CW device, over N2 connection with The TWIF registers on behalf of the N5CW device to an AMF according to subclause by populating the parameters for the registration by using implementation specific default values which are the same for N5CW devices.
request from the N5CW device by populating either all the required parameters or part of the required parameters for the PDU session establishment by using implementation specific default values from the TWIF's configuration.
NOTE 1: If part of the required parameters for the PDU session establishment is provided by the TWIF, the remaining of the required parameters are determined by the AMF or the SMF based on the N5CW device's subscription information.
Upon loss of the IP address of the N5CW device, the TWIF acting on behalf of the N5CW device shall initiate the UE- requested PDU session release procedure as defined in subclause NOTE 2: The established PDU session on behalf of the N5CW device can be modified by the TWIF or the Interworking with E-UTRAN connected to EPC.
In order to interwork with E-UTRAN connected to EPC, the UE supporting both S1 mode and N1 mode can operate in single-registration mode or dual-registration mode (see 3GPP specification document\).
Support of single-registration mode is mandatory for UEs supporting both S1 mode and N1 mode.
During the EPS attach procedure (see 3GPP specification document\) or initial registration procedure (see subclause\), the mode for interworking is selected if the UE supports both S1 mode and N1 mode, and the network supports interworking.
The mode for interworking may also be se lected during the EPS tracking area updating procedure (see 3GPP specification document\) or registration procedure for mobility and periodic registration update (see subclause\).
operate as specified in either subclause or subclause Which subclause the UE follows is chosen by the UE irrespective of the interworking without N26 interface indicator.
If the UE receives the indication that "interworking without N26 interface not supported" (see 3GPP specification document\), the UE operates as described in subclause If the UE receives the indication that "interworking without N26 interface supported" and a) the UE does not support dual-registration mode; or b) the UE supporting dual-registration mode determines to operate in single-registration mode, See subclause for coordination between 5GMM and EMM and subclause for coordination between Single-registration mode without N26 interface Interworking between NG-RAN and E-UTRAN At inter-system change from N1 mode to S1 mode in EMM-IDLE mode when: b) the UE supports IPv4 PDN type and at least one PDU session of IPv4 PDU session type is active; c) the UE supports IPv6 PDN type and at least one PDU session of IPv6 PDU session type is active; e) at least one PDU session of Ethernet PDU session type is active and: 1) the UE supports non-IP PDN type; or 2) the UE and the network support Ethernet PDN type in S1 mode; the UE shall proceed as follows: session from N1 mode to S1 mode and the UE has received an "interworking without N26 interface supported" indication from the network, the UE shall: 1) enter substates EMM-DEREGISTERED.
NO-CELL- AVAILABLE for 3GPP access; 2) map the PDU session(s) which the UE intends to transfer to EPS to the default EPS bearer context of the corresponding PDN connection(s) as specified in subclause ; and for an active emergency PDU session, if the session to be transferred is an emergency PDU session; or If the UE is the 5G-RG and the selected PDU session is an MA PDU session established over 3GPP access, the 5G-RG shall include the ATSSS request PCO parameter in the ESM INFORMATION RESPONSE After successful completion of the EPS attach procedure, the UE shall reset the registration attempt counter for 3GPP access and the attach attempt counter (see 3GPP specification document\) and attempt to activate each of the other b) otherwise, enter substates EMM-REGISTERED.
NO-CELL- At inter-system change from N1 mode to S1 mode in EMM-IDLE mode when: a) the UE does not support non-IP PDN type or no PDU session of Unstructured PDU session type is active; d) the UE does not support IPv4v6 PDN type or no PDU session of IPv4v6 PDU session type is active; and e) no PDU session of Ethernet PDU session type is active or: 1) the UE does not support non-IP PDN type; and 2) the UE, the network or both do not support Ethernet PDN type in S1 mode; the UE shall enter substates EMM-DEREGISTERED .
NO-CELL- AVAILABLE for 3GPP access, and initiate an attach procedure.
At inter-system change from S1 mode to N1 mode in 5GMM-IDLE mode, the UE shall: a) enter substate 5GMM-REGISTERED.
NORMAL-SERVICE for 3GPP access and substate EMM- b) map the default EPS bearer context(s) of the PDN connection(s) which the UE intends to transfer to 5GS, if any, to the corresponding PDU session(s) as specified in subclause ; and c) initiate the registration procedure for mobility and periodic registration update over 3GPP access indicating "mobility registration updating" in the 5GS registration type IE of the REGISTRATION REQUEST message After having successfully registered in N1 mode over 3GPP access, the UE shall reset the registration attempt counter for 3GPP access, and the attach attempt counter (see 3GPP specification document\) and: a) if the UE supports the PDU session establishment procedure with request type set to "existing PDU session" or initiating the PDU session establishment procedure with request type set to "existing emergency PDU session" to transfer the PDN connection for emergency bearer services; and PDU session establishment procedure with request type set to: resource of an MA PDU session; or 2) "existing PDU session" to transfer the non-emergency PDN connection; and b) otherwise, establish PDU session(s) corresponding to the PDN connection(s) which the UE intends to transfer to 5GS, if any, by initiating the PDU session establishment procedure with request type set to "initial request".
See subclause for coordination between 5GMM and EMM and subclause for coordination between Interworking between TNGF or N3IWF connected to 5GCN and E-UTRAN.
a) the UE has registered in neither N1 mode over 3GPP access nor S1 mode yet; and b) the UE has at least one active PDU session associated with non-3GPP access which the UE intends to transfer to which the UE intends to transfer to EPS (see 3GPP specification document\).
The request type is set as follows: - if the PDU sessions which the UE intends to transfer include an emergency PDU session, the request type is set to "handover of emergency bearer services" and the defa ult bearer to be activated is the default EPS bearer context for the emergency PDU session.
CONNECTIVITY REQUEST message with request type set to "handover" or "handover of emergency N3IWF connected to 5GCN and E-UTRAN.
other PDU sessions which the UE intends to transfer to EPS, if any.
the UE shall initiate an initial registration procedure over non-3GPP access (see subclause\).
After successful completion of the 5GS initial registration in N1 mode over non-3GPP access, the UE shall initiate a the UE intends to transfer to TNGF or N3IWF connected to 5GCN, if any.
The request type is set as follows: request type is set to "existing emergency PDU session " to transfer the PDN connection for emergency bearer set to "existing PDU session" to transfer the non-emergency PDN connection.
NOTE 2: If the UE has no active PDU session associated with non-3GPP access which the UE in N1 mode intends to transfer to EPS or no active PDN connection associated with 3GPP access which the UE in S1 mode intends to transfer to TNGF or N3IWF connected to 5GCN, the interworking between TNGF or N3IWF connected to 5GCN and E-UTRAN is not supported.
See subclause for coordination between 5GSM and ESM.
a) A UE operating in the dual-registration mode may register to N1 mode only, S1 mode only, or to both N1 mode b) When the UE decides to operate in dual-registration mode (see subclause\), NAS informs the lower 1) the same PLMN to which it is registered in N1 mode; or 2) an equivalent PLMN; or the same or equivalent to any of the registered ones.
When no PDU session is active and the UE has not registered to S1 mode yet, the UE may initiate the EPS attach procedure with PDN connection establishment if EMM-REGISTERED without PDN connection is not supported by the MME.
If EMM-REGISTERED without PDN connection is supported by the MME, the UE may initiate either the EPS attach procedure without PDN connection establishment or the attach procedure with PDN connection establishment.
When at least one PDU session is active and the UE has not registered to S1 mode yet, the UE may initiate the EPS attach procedure.
If necessary, the UE may transfer an active PDU session from N1 mode to S1 mode by initiating the EPS attach procedure with request type set to "handover" in the PDN CONNECTIVITY REQUEST message.
After successfully attached in S1 mode, if necessary, the UE may transfer other active PDU sessions from N1 mode to S1 mode by initiating the PDN connectivity procedure with request type set to "handover" in the PDN CONNECTIVITY REQUEST message.
NOTE 2: It is up to UE implementation to determine which active PDU session is transferred from N1 mode to S1 When the UE has not registered to N1 mode, the UE may initiate the initial registration procedure.
After successfully registered in N1 mode, if necessary, the UE may transfer one or more active PDN connections from S1 mode to N1 mode by initiating the PDU session establishment procedure with request type set to "existing PDU session".
NOTE 3: It is up to UE implementation to determine which active PDN connection is transferred from S1 mode to If the MME supports EMM-REGISTERED without PDN connection, the UE that transferred all PDN connections to the 5GS, may stay in state EMM-REGISTERED.
Otherwise, the UE shall enter state EMM-DEREGISTERED upon transferring all PDN connection to the 5GS.
NOTE 4: When the UE has registered in both N1 mode and S1 mode, it is up to UE implementation to maintain the registration update to date in both N1 mode and S1 mode.
See subclause for coordination between 5GSM and ESM.
See subclause for interworking between TNGF or N3IWF connected to 5GCN and E-UTRAN.
If the UE is capable of both N1 mode and S1 mode, when the UE needs to use one or more functionalities not supported in 5GS but supported in EPS and the UE is in 5GMM-IDLE mode, the UE may disable the N1 mode capability for 3GPP access (see subclause\).
specified in 3GPP specification document and provide the selected core network type information to the lower layer during the If the UE is capable of both N1 mode and S1 mode and the lower layers have provided an indication that the current E- UTRA cell is connected to both EPC and 5GCN and an indication of whether the network supports IMS emergency NOTE 1: If the PLMN selection information provisioned in the USIM does not contain any prioritization between and proceed with the appropriate 5GMM procedure.
redirection (see 3GPP specification document [25A] and 3GPP specification document\).
A Core Network selection and redirection for UEs using CIoT A.
1 Core network selection A UE that supports CIoT optimizations performs core network selection (i.
it selects EPC or 5GCN) if the lower layers have provided an indication that the current E-UTRA cell is connected to both EPC and 5GCN as specified in 3GPP specification document .
a) indication from the lower layers about the CIoT EPS optimizations supported in EPC; b) indication from the lower layers about the CIoT 5GS optimizations supported in 5GCN; c) the CIoT EPS optimizations supported by the UE; d) the CIoT 5GS optimizations supported by the UE; e) the UE's preferred CIoT network behaviour for EPC; and f) the UE's preferred CIoT network behaviour for 5GCN.
The UE shall provide the selected core network type information to the lower layer during the initial registration A.
2 Redirection of the UE by the core network NOTE: It is assumed that the network would avoid redi recting the UE back and forth between EPC and 5GCN.
The network redirects the UE to EPC by rejecting the registration request with the 5GMM cause #31 "Redirection to EPC required" as specified in subclause and Upon receipt of reject message, the UE disables the N1 mode capability for 3GPP access as specified in subclause and enables the E-UTRA capability if it was disabled in order to move to EPC.
redirect the UE to EPC, the AMF shall initiate the generic UE configuration update procedure to indicate registration then redirects the UE to EPC by rejecting the registration request as specified in subclause subclause of 3GPP specification document .
The UE shall re-enable the N1 mode capability when the UE powers off and powers on again, the USIM is removed or an entry of the "list of subscriber data" with the SNPN identity of the SNPN is updated.
Disabling and re-enabling of UE's N1 mode capability for 3GPP The UE shall only disable the N1 mode capability for 3GPP access when in 5GMM-IDLE mode.
PLMNs, if the UE supports S1 mode and the UE has not disabled its E-UTRA capability as specified in 3GPP specification document ; cannot be found, the UE does not support S1 mode or the UE has disabled its E-UTRA capability as specified in switch-off, the UE may re-enable the N1 capability for this PLMN selection.
As an implementation option, if the d) if no other allowed PLMN and RAT combinations are available, then the UE may re-enable the N1 mode capability for 3GPP access and indicate to lower layers to remain camped in NG-RAN of the registered PLMN, and may periodically scan for another PLMN and RAT co mbination which can provide EPS services or non-EPS services (if the UE supports EPS services or non-EPS services).
How this periodic scanning is done, is UE implementation dependent.
When the UE is disabling the N1 mode capability for 3GPP access for an SNPN, it should proceed as follows: a) enter the state 5GMM-DEREGISTERED.
PLMN-SEARCH and perform SNPN selection as specified in registration procedure for 5GS services over 3GPP access not due to switch-off, the UE may re-enable the N1 capability for this SNPN selection; or b) if no other SNPN is available, then the UE may re-enable the N1 mode capability for 3GPP access and indicate to lower layers to remain camped in NG-RAN of the registered SNPN.
When the UE is disabling the N1 mode capability upon receiving reject cause #31 "Redirection to EPC required" as specified in subclauses , and , it should proceed as follows: a) If the UE is in NB-N1 mode: 1) if lower layers do not provide an indication that the current E-UTRA cell is connected to EPC or lower layers 3GPP specification document [25C]; 2) if lower layers provide an indication that the current E-UTRA cell is connected to EPC and the current E- b) If the UE is in WB-N1 mode: 1) if lower layers do not provide an indication that the current E-UTRA cell is connected to EPC or lower layers 3GPP specification document [25C]; 2) if lower layers provide an indication that the current E-UTRA cell is connected to EPC and the current E- connected to EPC which supports CIoT EPS optimizations that are supported by the UE, the UE may re-enable the N1 mode capability for 3GPP access, and indicate to lower layers to remain camped in E-UTRA connected to 5GCN of the previously registered PL MN and proceed with the appropriate 5GMM procedure.
Editor's Note [WI: 5G_CIoT, CR#2106]: To be further studied on how to avoid ping-pong effect due to the redirection between 5GC and EPC, namely using 5GMM cause value #3 When the UE supporting both N1 mode and S1 mode needs to stay in E-UTRA connected to EPC (e.
due to the domain selection for UE originating sessions as specified in subclause\), in order to prevent unintentional handover or cell reselection from E-UTRA connected to EPC to NG-RAN connected to 5GCN, the UE operating in single- registration mode shall disable the N1 mode capability for 3GPP access and: a) shall set the N1mode bit to "N1 mode not supported" in the UE network capability IE (see 3GPP specification document\) of the ATTACH REQUEST message and the TRACKING AREA UPDATE REQUEST message in EPC; and b) the UE NAS layer shall indicate the access stratum layer(s) of disabling of the N1 mode capability for 3GPP If the UE is required to disable the N1 mode capability for 3GPP access and select E-UTRA or another RAT, and the UE is in the 5GMM-CONNECTED mode, PDU session has been released; otherwise the UE shall locally release the established NAS signalling connection; and enter the 5GMM-IDLE mode before selecting E-UTRA or another RAT.
If the UE is disabling its N1 mode capability for 3GPP access before selecting E-UTRA or another RAT, the UE shall not perform the UE-initiated de-registration procedure of subclause The UE shall re-enable the N1 mode capability for 3GPP access when the UE performs PLMN or SNPN selection over services over 3GPP access not due to switch-off; or the UE has already re-enabled the N1 mode capability for 3GPP access when performing items c) or d) above.
If the disabling of N1 mode capability for 3GPP access was due to IMS voice is not available over 3GPP access and the UE's usage setting is "voice centric", the UE shall re-enable the N1 mode capability for 3GPP access when the UE's usage setting is changed from "voice centric" to "d ata centric", as specified in subclauses The UE should memorize the identity of the PLMN or SNPN where N1 mode capability for 3GPP access was disabled and should use that stored information in subsequent PLMN or SNPN selections as specified in 3GPP specification document .
If the disabling of N1 mode capability for 3GPP access was due to successful completion of an emergency services UE's registration attempt counter reaches 5 and the UE disables the N1 mode capability for 3GPP access for cases described in subclauses and The UE should memorize the identity of the PLMNs where N1 mode capability for 3GPP access was disabled.
On expiry of this timer: if the UE is in Iu mode or A/Gb mode and is in idle mode as specified in 3GPP specification document on expiry of the timer, the UE should enable the N1 mode capability for 3GPP access; if the UE is in Iu mode or A/Gb mode and an RR connection exists, the UE shall delay enabling the N1 mode capability for 3GPP access until the RR connection is released; PS signalling connection before enabling the N1 mode capability for 3GPP access; if the UE is in S1 mode and is in EMM-IDLE mode as specified in 3GPP specification document , on expiry of the timer, the UE should enable the N1 mode capability for 3GPP access; and if the UE is in S1 mode and is in EMM-CONNECTED mode as specified in 3GPP specification document , on expiry of the timer, the UE shall delay enabling the N1 mode capability for 3GPP access until the NAS signalling connection in S1 mode is released.
the UE's registration attempt counter have reached 5, the UE may enable N1 mode capability for that PLMN memorized NOTE: If N1 mode capability is disabled due to the UE's registration attempt counter reaches 5, the value of the timer for re-enabling N1 mode capability is recommended to be the same as the value of T3502 which follows the handling specified in subclause Disabling and re-enabling of UE's N1 mode capability for non-3GPP When the UE disables the N1 mode capability for non-3GPP access, the UE NAS layer shall not initiate any 5GS NAS procedures towards the network over non-3GPP access.
When the UE supporting both N1 mode and S1 mode needs to stay in non-3GPP access connected to EPC (e.
due to the domain selection for UE originating sessions as specified in subclause\), in order to prevent unintentional If the disabling of N1 mode capability for non-3GPP access was due to IMS voice is not available over non-3GPP access in 5GS and the UE's usage setting is "voice centric", the UE shall re-enable the N1 mode capability for non-3GPP access when the UE's usage setting is changed from "voice centric" to "data centric" as specified in subclauses NOTE: In SNPN, the term "UE's N1 mode capability for non-3GPP access" in this subclause refers to the UE's The UE shall not attempt to transfer PDU sessions with PDU session type "Ethernet" or "Unstructured" to an ePDG NOTE: PDU sessions with PDU session type "Ethernet" or "Unstructured" cannot be transferred to an ePDG connected to EPC because PDN connections with PDN type "non-IP" or PDN type "Ethernet" are not supported over ePDG connected to EPC.
1 UE configuration parameter updates In this release of the specification, updates of the following USIM configuration parameters are supported: In this release of specification, updates of the following ME configuration parameters are supported: The 5GS in an SNPN supports updating UE parameters via NAS signalling.
The feature enables the SNPN to securely and dynamically re-configure the UE configuration parameter stored on the USIM if the UE used the USIM for registration to the SNPN.
In this release of the specification, updates of the following USIM configuration parameters are supported: The update of UE configuration parameters is initiated by the network using the network-initiated downlink NAS transport procedure as described in subclause The ME acknowledgement of successful reception of the updated UE configuration parameter information is sent back to the network using the UE-initiated uplink NAS transport procedure as described in subclause 2 Access traffic steering, switching and splitting (ATSSS) The ATSSS feature is an optional feature that may be supported by the UE and the 5GCN.
plane resources on two access networks.
The UE can request an MA PDU session when the UE is registered via both 3GPP and non-3GPP accesses, or when the UE is registered via one access only.
The MA PDU session management is performed based on the PDU session management procedures.
The detailed description of the procedures for ATSSS between the UE and the network across one 3GPP access network and one non-3GPP access network are specified in 3GPP specification document [13B].
3 Support of NAS signalling using wireline access network 5G-RG maintains the N1 NAS signalling connection with the AMF over the wireline access network after all the PDU sessions for the 5G-RG over that access have been released or handed over to 3GPP access.
The 5G-RG connected to 5GCN via NG-RAN is specified in 3GPP specification document [6D].
When accessing the 5GCN over 3GPP access, in addition to requirements specified for the 5G-RG in the present requirement specified for the UE in the present document, the 5G-RG shall perform the requirement specified in the present document for the 5G-RG.
For the scenario of FN-RG, which does not support N1 mode, the W-AGF acting on behalf of the FN-RG exchanges NAS signalling messages with an AMF.
For the scenario of N5GC device, which does not support N1 mode, the W-AGF acting on behalf of the N5GC device exchanges NAS signalling messages with an AMF.
In addition to requirements specified for the W-AGF acting on behalf of the FN-RG (or on behalf of the N5GC device) FN-RG (or on behalf of the N5GC device) shall perform requirement specified in the present document for the W-AGF acting on behalf of the FN-RG (or on behalf of the N5GC device).
AGF acting on behalf of the FN-RG or on behalf of the N5GC device.
Only one PDU session per N5GC device is supported.
provided by the 5G-RG or the FN-RG can access to the 5G CN via the N3IWF or via the TNGF as described in 3GPP specification document [6D].
The 5G-RG or the W-AGF acting on behalf of the FN-RG shall indicate "ANDSP not supported by the UE" in the UE policy classmask IE during the the UE-initiated UE state indication procedure as specified in subclause D.
Two types of NPN can be deployed using 5GS: SNPN (see subclause\) and PNI-NPN (see subclause\).
If the UE is not SNPN enabled, the UE is always consider ed to be not operating in SNPN access mode.
If the UE is SNPN enabled, the UE can operate in SNPN access mode.
Details of activation and deactivation of SNPN access mode at the SNPN enabled UE are up to UE implementation.
The functions and procedures of NAS described in the present document are applicable to an SNPN and an SNPN enabled UE unless indicated otherwise.
The key differences brought by the SNPN to the NAS layer are as follows: access mode (see 3GPP specification document for furt her details on the SNPN selection); forbidden PLMN lists; c) inter-system change to and from S1 mode is not supported; d) emergency services are not supported in SNPN access mode; e) CAG is not supported in SNPN access mode; f) with respect to the 5GMM cause values: 1) 5GMM cause values #74 "Temporarily not authorized for this SNPN" and #75 "Permanently not authorized 2) 5GMM cause values #11 "PLMN not allowed", #31 "Redirection to EPC required", #73 "Serving network not authorized", and #76 "Not authorized for this CAG or authorized for CAG cells only" are not supported Editor's note [WI: Vertical_LAN, CR#1286]: It is FFS whether 5GMM cause value # 72 "Non-3GPP access to 5GCN not allowed" is supported in an SNPN.
NOTE: The network does not send 5GMM cause value #13 to the UE operating in SNPN access mode in this provision of service" are managed per SNPN (see 3GPP specification document\); non-3GPP access.
From the UE's NAS perspective, accessing PLMN services via an SNPN and accessing SNPN i) when registered to an SNPN, the UE shall use only the UE policies provided by the registered SNPN; j) equivalent SNPN is not supported; k) neither the default configured NSSAI nor the network slicing indication is supported in SNPNs; l) roaming is not supported in SNPN access mode; n) CIoT 5GS optimizations are not supported; o) Accessing SNPN services using non-3GPP access is not supported, except when accessing SNPN services via a PLMN using 3GPP access as specified in item h; and p) when registering or registered to an SNPN, the UE sh all only consider a 5G-GUTI previously assigned by the Public network integrated non-public network (PNI-NPN) enablers for the CAG in the NAS layer are as follows: a) CAG selection (see 3GPP specification document\); and b) provisioning of a "CAG information list" as specified in 3GPP specification document , from network to UE via the generic UE configuration update procedure and the registration procedure.
information list" is deleted when the USIM is changed or removed.
session is camping on: a) a CAG cell and none of the CAG-IDs of the CAG cell are included in the "Allowed CAG list" for the current PLMN in the UE's subscription; or to access 5GS via CAG cells"; the AMF shall release all non-emergency PDU sessions associated with 3GPP access, if any.
The AMF shall not release the emergency PDU session.
NOTE: The emergency services for CAG only UE can be subject to local regulation.
5 Time sensitive communication 
A 5GS can support TSC (see 3GPP specification document , 3GPP specification document , and 3GPP specification document\).
The clause describes NAS-specific aspects of the 5GS features to support TSC.
Integration with TSN network 
For 5GS synchronization, the lower layers provide the 5G internal system clock signalled via an NG-RAN (see 3GPP specification document\) and the UE forwards the 5G internal system clock to the DS-TT(s).
For TSN domain synchronization, the UE supports forwarding generalized precision time protocol (gPTP) messages.
session to the DS-TT associated with the PDU session (see 3GPP specification document and 3GPP specification document\).
See 3GPP specification document [19A] for the details on gPTP messages within a 5GS.
information containers, then the UE indicates that transfer of port management information container is supported and residence time, if available, to the network (see subclause\).
information container is supported during the UE-requested PDU session establishment procedure (see 6 UE radio capability signalling optimisation capability ID.
A UE radio capability ID can be either manufacturer-assigned or network-assigned.
The UE radio capability ID is an alternative to the signalling of the radio capabilities container over the radio interface.
In this release of the specification, RACS is applicable to neither NB-N1 mode nor non-3GPP access.
If the UE supports RACS: a) the UE shall indicate support for RACS by setting the RACS bit to "RACS supported" in the 5GMM capability IE of the REGISTRATION REQUEST message; capability ID for the current UE radio configuration in the selected network, the UE shall include the UE radio 1) if the UE has an applicable UE radio capability ID for the new UE radio configuration, the UE shall initiate a registration procedure for mobility and periodic registration update.
The UE shall include the applicable UE radio capability ID in the UE radio capability ID IE of the REGISTRATION REQUEST message and shall include the 5GS update type IE in the REGISTRATION REQUEST message with the NG-RAN-RCU bit set 2) if the UE does not have an applicable UE radio capability ID for the new UE radio configuration, the UE NOTE: Performing the registration procedure for mobility and periodic registration update and including the 5GS the mapping to the corresponding UE radio configuration; the PLMN which assigned it; capability IDs" in the REGISTRATION ACCEPT message or the CONFIGURATION UPDATE COMMAND message, the UE shall delete all network-assigned UE radio capability IDs stored at the UE for the serving tracking area that is not in the list of tracking areas that the UE previously registered in the AMF and the UE has an applicable UE radio capability ID for the current UE ra dio configuration in the selected network, the UE shall If the network supports RACS: UE radio capability ID IE in the REGISTRATION ACCEPT message or in the CONFIGURATION UPDATE COMMAND message; b) the network may trigger the UE to delete all network-assigned UE radio capability IDs stored at the UE for the c) the network may send an IDENTITY REQUEST message to the UE that supports RACS to retrieve the PEI, if not available in the network.
7 5GS mobility management in NB-N1 mode A UE in NB-N1 mode (see 3GPP specification document [25A]) shall calculate the value of the applicable NAS timer indicated in table 1 plus 240s.
The timer value obtained is used as described in the appr opriate procedure subclause of this specification.
The NAS until the NAS procedure is completed, restarted or aborted.
shall calculate the value of the applicable NAS timer indicated in table 1 plus 240s.
The timer value obtained is used as described in the appr opriate procedure subclause of this specification.
The NAS until the NAS procedure is completed, restarted or aborted.
8 5GS session management in NB-N1 mode A UE in NB-N1 mode (see 3GPP specification document [25A]) shall calculate the value of the applicable NAS timer indicated in table 1 plus 180s.
The timer value obtained is used as described in the appr opriate procedure subclause of this specification.
The NAS until the NAS procedure is completed, restarted or aborted.
shall calculate the value of the applicable NAS timer indicated in table 1 plus 180s.
The timer value obtained is used as described in the appr opriate procedure subclause of this specification.
The NAS set to "voice centric" (see 3GPP specification document\), and: a) the use of enhanced coverage is not restricted by the network; or The NAS timer value obtained is used as described in the appropriate procedure subclause of this specification.
The a) the use of enhanced coverage is not restricted for the UE; or the AMF shall calculate the value of the applicable NAS timer indicated in table 1 for WB-N1/CE mode.
The NAS timer value obtained is used as described in the appropriate procedure subclause of this specification.
The 0 5GS session management in WB-N1 mode for IoT a) the use of enhanced coverage is not restricted by the network; or the UE shall apply the value of the applicable NAS timer indicated in table 1 for WB-N1/CE mode.
The NAS timer value obtained is used as described in the appropriate procedure subclause of this specification.
The is completed, restarted or aborted.
If the use of extended NAS timer is indicated by the AMF (see 3GPP specification document and 3GPP specification document\), the SMF shall calculate the value of the applicable NAS timer indicated in table 1 for WB-N1/CE mode.
The NAS timer value obtained is used as described in the appropriate procedure subclause of this specification.
The main function of the 5GS mobility management (5GMM) sublayer is to support the identification, security, A further function of the 5GMM sublayer is to provide connection management services to the other sublayer(s).
Types of 5GMM procedures Depending on how they can be initiated, three types of 5GMM procedures can be distinguished: a) 5GMM common procedures 5GMM common procedure can always be initiated when the UE is in 5GMM-CONNECTED mode.
The procedures belonging to this type are: 1) Initiated by the network: i) network-initiated NAS transport; ii) primary authentication and key agreement iii) security mode control; iv) generic UE configuration update vi) network slice-specific authentication and authorization; 2) Initiated by the UE: 3) Initiated by the UE or the network and used to report certain error conditions detected upon receipt of 5GMM b) 5GMM specific procedures: At any time only one UE initiated 5GMM specific procedure can be running for each of the access network(s) that the UE is camping in.
The proced ures belonging to this type are: 1) Initiated by the UE and used e.
to register to the network for 5GS services and establish a 5GMM context, to update the location/parameter(s) of the UE: registration.
2) Initiated by the UE or the network and used to deregister from the network for 5GS services and to release a 3) Initiated by the UE and used to deregister from the network for 5GS services and to release a 5GMM context: eCall inactivity procedure.
reservation for sending data, or both: The service request procedure can only be initiated if no UE initiated 5GMM specific procedure is ongoing for each of the access network(s) that the UE is camping in.
2) Initiated by the network and used to request the establishment of an N1 NAS signalling connection or to request re-establishment of user-plane resources for the PDU session(s) associated with 3GPP access or to request re-establishment of user-plane resources of the PDU session(s) associated with non-3GPP access over 3GPP access; not applicable for the non-3GPP access network: 3) Initiated by the network and used to request re-establishment of user-plane resources of the PDU session(s) associated with non-3GPP access over 3GPP access or to deliver 5GSM downlink signalling messages associated with non-3GPP access over 3GPP access, when the UE is in 5GMM-CONNECTED mode over 3GPP access and in 5GMM-IDLE mode over non-3GPP access; or Initiated by the network and used to request re-establishment of user-plane resources of the PDU session(s) associated with 3GPP access over 3GPP access or to de liver downlink signalling associated with 3GPP access over 3GPP access, when the UE is in 5GMM-CONNECTED mode over non-3GPP access, and when the UE is in 5GMM-IDLE mode over 3GPP access and not in MICO mode: NOTE 1: In NB-N1 mode, the UE NAS using 5GS services with control plane CIoT 5GS optimization can wait for the lower layers to complete the transmission of the previous UL NAS TRANSPORT messages carrying control plane user data before providing subsequent NAS messages.
Other implementations are possible.
NOTE 2: When providing NAS messages to the lower layers for transmission, the UE NAS using 5GS services with control plane CIoT 5GS optimization can prio ritize sending NAS signalling messages over the UL NAS TRANSPORT messages carrying control plane user data.
How the UE performs this prioritization is implementation specific.
In the following subclauses, the 5GS mobility management (5GMM) sublayer of the UE and the network is described by means of different state machines.
The 5GMM sublayer states is managed per access type independently, i.
3GPP access or non-3GPP access.
In subclause , the states of the 5GMM sublayer are introduced.
5GMM sublayer states in the UE.
In the following subclauses, the possible 5GMM sublayer states of the UE are described and shown in.
Deregistration re quested (pow er off) - Initial registration requested- Initial registration rejected or failed- Non-initial registration rejected (e.
#3, #6, #7)- NW-initiated deregistration requested - Initial registration accepted- Non-initial registration accepted- Non-initial registration rejected or failed (other causes) Non-initial registration requested- NW-initiated deregistration requested- Local deregistration REQUES T-INITIATED- SR initiated SR accepted- SR rejected or failed (e.
#22, #28) NOTE: Not all possible transitions are shown in this figure.
5GMM main states in the UE 5GS services are disabled in the UE.
No 5GS mobility management function shall be performed in this state.
In the state 5GMM-DEREGISTERED, no 5GMM context has been established and the UE location is unknown to the A UE enters the state 5GMM-REGISTERED-INITIATED after it has started the initial registration procedure or the In the state 5GMM-REGISTERED, a 5GMM context has been established.
Additionally, one or more PDU session(s) REGISTERED over non-3GPP access shall not initiate the periodic registration update procedure.
A UE enters the state 5GMM-DEREGISTERED-INITIATED af ter it has requested release of the 5GMM context by A UE enters the state 5GMM-SERVICE-REQUEST-INITIATED after it has started the service request procedure and following substates are not applicable to non-3GPP access: Valid subscriber data are available for the UE before it enters the substates, except for the substate 5GMM- and the PLMN, SNPN, or tracking area is not in the forbidden list.
for 3GPP access or TA for non-3GPP access is unable to prov ide normal service (e.
the selected cell over 3GPP The substate 5GMM-DEREGISTERED.
ATTEMPTING-REGISTRATION is chosen in the UE if the initial registration The substate 5GMM-DEREGISTERED.
PLMN-SEARCH is chosen in the UE, if the UE is searching for PLMNs or This substate is not applicable to non-3GPP access.
NO-SUPI is chosen in the UE, if the N1 mode is enabled and the UE has no valid subscriber data available (USIM not available, the USIM is considered invalid by the UE or an entry of the "list of subscriber data" with the SNPN identity of the SNPN is considered invalid by the UE).
This substate is not applicable to non-3GPP access.
eCALL-INACTIVE is chosen in the UE when: service.
In this substate, the UE shall not initiate any signalling towards the network, except to originate an eCall over IMS, or a This substate is not applicable to non-3GPP access.
be performed as soon as possible.
This substate can be en tered if the access is barred due to unified access control, (see subclause\) or if the network rejects the N1 NAS signalling connection establishment.
Substates of state 5GMM-REGISTERED 
substates are not applicable to non-3GPP access: b) 5GMM-REGISTERED.
NON-ALLOWED-SERVICE; and c) 5GMM-REGISTERED.
NORMAL-SERVICE is chosen by the UE as the primary substate when the UE enters the state 5GMM-REGISTERED, and: for 3GPP access, the cell the UE selected is known to be in an allowed area; or for wireline access, the wireline access service area restrictions are not enforced.
NON-ALLOWED-SERVICE is chosen in the UE, if: for wireline access, the wireline access service area restrictions are enforced.
This substate is applicable only to 3GPP access and to wireline access.
ATTEMPTING-REGISTRATION-UPDATE is chosen by the UE if the or due to the circumstances described in subclauses , and No 5GMM procedure except registration procedure for mobility and periodic registration update (i.
the 5GS registration type IE set to "mobility registration updating" in the REGISTRATION REQUEST message) shall be initiated by the UE in this substate.
No data shall be sent or received.
LIMITED-SERVICE is chosen in the UE, if the cell the UE selected is known not to be able to provide normal service.
PLMN-SEARCH is chosen in the UE, while the UE is searching for PLMNs or This substate is not applicable to non-3GPP access.
mode at any time by activating the AS layer when the UE needs to send mobile originated signalling or user data.
Otherwise, the UE shall not initiate any 5GMM procedure except for cell and PLMN reselection.
This substate is not applicable to non-3GPP access.
a) the access is barred due to unified access control when in 3GPP access; b) the network rejects the N1 NAS signalling connection establishment when in 3GPP access or in non-3GPP c) the UE in 5GMM-CONNECTED mode with RRC inactive indication receives an indication from the lower layers that the resumption of the RRC connection has failed and for access is barred for all categories except categories '0' and '2' as specified in subclause No 5GMM procedure except: a) registration procedure for mobility and periodic registration update; and shall be initiated by the UE in this substate.
5GS update status in the UE volatile memory in the USIM if the corresponding file is present in the USIM, else in the non-volatile memory in the ME, as described in annex C.
If the UE is operating in SNPN access mode, the 5GS update status for each SNPN whose SNPN identity is included in the "list of subscriber data" configured in the ME (see 3GPP specification document\) is stored in the non-volatile memory in the ME as described in annex C.
based primary authentication and key agreement, service request, paging procedure or due to change in TAI which does not belong to the current registration area while T3346 is running.
5GMM sublayer states in the network side.
In the following subclauses, the possible 5GMM sublayer states of the network are described and shown in.
Common procedure successful- Initial registration successful- Common procedure request ed- Initial registration successful- NW-initiated deregistration requested- Deregistration accepted UE-initiated deregistration requested- Non-initial registration rejected (e.
#3, #6, SR rejected (e.
#3, #6, #7)- Implicit deregistration NOTE: Not all possible transitions are shown in this figure.
5GMM main states in the network deregistered.
The UE is deregistered.
The network may answer to an initial registration procedure initiated by the UE.
In the state 5GMM-REGISTERED, a 5GMM context has been established.
Additionally, one or more PDU session(s) may be established at the network.
Coordination between 5GMM and EMM.
registration for 5GMM for 3GPP access and EMM.
operates in dual-registration mode, is not need ed, except as specified in subclause The coordination between 5GMM for 3GPP access and EMM in subclauses and only applies to the UEs operating in single-registration mode.
Regarding the coordination of "SIM/USIM considered inva lid" and "USIM considered invalid for 5GS services" between the various mobility management entities see subclause Coordination between 5GMM for 3GPP access and EMM with N26 interface A UE that is not registered shall be in state EMM-DEREGISTERED and state 5GMM-DEREGISTERED for 3GPP registration mode shall enter substates 5GMM-REGISTERED.
NORMAL-SERVICE for 3GPP access and EMM-REGISTERED.
The UE shall reset the registration attempt counter for 3GPP access and the attach attempt counter (see 3GPP specification document\).
At inter-system change from S1 mode to N1 mode, the UE shall enter substates 5GMM-REGISTERED.
NORMAL- registration type IE of the REGISTRATION REQUEST message (see subclause\).
In S1 mode, upon successful completion of an attach or tracking area updating procedure, the UE operating in single- registration mode shall enter substates 5GMM-REGISTERED.
NO-CELL-AVAILABLE for 3GPP access and EMM- REGISTERED.
The UE shall reset the registration attempt counter for 3GPP access and the attach attempt counter (see 3GPP specification document\).
At inter-system change from N1 mode to S1 mode when there is no active PDU session for which interworking with EPS is supported as specified in subclause , and EMM-REGISTERED without PDN connection is not supported by the UE or the MME, the UE shall enter state 5GMM-DEREGISTERED for 3GPP access and state EMM- DEREGISTERED and then initiate the EPS attach procedure.
If EMM-REGISTERED without PDN connection is At inter-system change from N1 mode to S1 mode when th ere is at least one active PDU session for which interworking with EPS is supported as specified in subclause , the UE shall enter substates EMM-REGISTERED.
NORMAL- Coordination between 5GMM for 3GPP access and EMM without N26 A UE operating in the single-registration mode that is not registered over 3GPP access shall be in state EMM-DEREGISTERED and in state 5GMM-DEREGISTERED for 3GPP access.
registration mode shall enter substates 5GMM-REGISTERED.
NORMAL-SERVICE for 3GPP access and EMM-REGISTERED.
In S1 mode, upon successful completion of an attach or tracking area updating procedure, the UE operating in the single-registration mode shall enter substates 5GMM-REGISTERED.
NO-CELL-AVAILABLE for 3GPP access and EMM-REGISTERED.
At inter-system change from S1 mode to N1 mode in 5GMM-IDLE mode, the UE operating in the single-registration mode shall enter substates EMM-REGISTERED.
NO-CELL-AVAILABLE and 5GMM- REGISTERED.
NORMAL-SERVICE for 3GPP access and then initiate the registration procedure for mobility and periodic registration update over 3GPP access indicating "mobility registration updating" in the 5GS registration type IE of the REGISTRATION REQUEST message (see subclause\).
Coordination between 5GMM and GMM Coordination between 5GMM and GMM states is not required.
Regardless whether the UE is operating in single-registration mode or dual-registration mode, a) if the UE considers the SIM/USIM invalid for any of: 3GPP access in N1 mode, S1 mode, A/Gb mode or Iu mode, then it considers the SIM/USIM invalid for all of them; and b) if the UE considers the USIM invalid for 5GS serv ices for any of: 3GPP access in N1 mode, S1 mode, A/Gb mode or Iu mode, then it considers the USIM invalid for 5GS services for all of them.
Behaviour of the UE in state 5GMM-DEREGISTERED and.
In this subclause, the detailed behaviour of the UE in the states 5GMM-DEREGISTERED and 5GMM-REGISTERED UE behaviour in state 5GMM-DEREGISTERED.
The state 5GMM-DEREGISTERED is entered in the UE, when: a) the de-registration is performed either by the UE or by the network (see subclause\); b) the registration request is rejected by the AMF (see subclause and\); c) the service request is rejected by the AMF (see subclause\); or d) the UE is switched on.
In state 5GMM-DEREGISTERED, the UE shall behave according to the substate as explained in subclause Selection of the substate after power on to have expired at power on.
When the UE is switched on, the substate shall be PLMN-SEARCH if the USIM is available and valid or there are valid entries in the "list of subscriber data".
See 3GPP specification document for further details.
The substate chosen after PLMN-SEARCH, following power on is: a) if no cell can be selected, the substate shall be NO-CELL-AVAILABLE; lists, the "permanently forbidden SNPNs" list or the "temporarily forbidden SNPNs" list, and the tracking area is not in one of the lists of 5GS forbidden tracking areas, then the substate shall be NORMAL-SERVICE; d) if the selected cell is known not to be able to provide normal service, then the UE shall enter the substate e) if the UE is in manual network selection mode and no cell of the selected PLMN or SNPN has been found, the UE shall enter the substate NO-CELL-AVAILABLE; and f) if the UE is configured for eCall only mode as specified in 3GPP specification document , the substate shall be eCALL- Detailed description of UE behaviour in state 5GMM-DEREGISTERED The UE shall initiate an initial registration procedure if the timer T3346 is not running.
If timer T3346 is running, the UE shall initiate an initial registration procedure on the expiry of timer T334 The UE may initiate an initial registration procedure for emergency services even if timer T3346 is running.
The UE in 3GPP access: a) shall initiate an initial registration procedure on the expiry of timers T3502, T3511 or T3346; b) may initiate an initial registration procedure for emergency services even if timers T3502, T3511 or T3346 are high priority access in selected PLMN; i) if timer T3346 is running and the new PLMN is equivalent to the PLMN where the UE started timer T3 346; ii) if the PLMN identity of the new cell is in the forbidden PLMN lists or the SNPN identity of the new cell is in the "permanently forbidden SNPNs" list or the "temporarily forbidden SNPNs" list; or ii) if the tracking area is in one of the lists of 5GS forbidden tracking areas; d) shall initiate an initial registration procedure when the tracking area of the serving cell has changed, if timer T3346 is not running, the PLMN identity of the new cell is not in one of the forbidden PLMN lists or the SNPN identity of the new cell is in neither the "permanently forbidden SNPNs" list nor the "temporarily forbidden SNPNs" list and the tracking area of the new cell is not in one of the lists of 5GS forbidden tracking areas; e) shall initiate an initial registration procedure if the 5GS update status is set to 5U2 NOT UPDATED, and timers to transmit user data related to an exceptional event and the UE is allowed to use exception data reporting (see the ExceptionDataReportingAllowed leaf of the NAS configuration MO in 3GPP specification document\) if timer T3346 is not already running for "MO exception data" and even if timer T3502 or timer T3511 is running; and session.
The UE in non-3GPP access: a) shall initiate an initial registration procedure on the expiry of timers T3502, T3511 or T3346; b) may initiate an initial registration procedure for emergency services even if timers T3502, T3511 or T3346 are priority access in selected PLMN; the new PLMN is equivalent to the PLMN where the UE started timer T3346; d) shall initiate an initial registration procedure if the 5GS update status is set to 5U2 NOT UPDATED, and timers e) may initiate an initial registration procedure with 5GS registration type IE set to "initial registration" for initiating of an emergency PDU session, upon request of the upper layers to establish the emergency PDU registration attempt counter and initiate the registration procedure for initial registration (see subclause\).
If the selected cell in the new PLMN is known not to be able to provide normal service, the UE may initiate the registration procedure for initial registration for emergency services.
The UE may initiate the registration procedure for initial registration for emergency services.
initiates no 5GMM signalling with the network and ignores any paging requests.
The UE shall leave substate 5GMM-DEREGISTERED.
eCALL-INACTIVE state only when one of the following a) if the USIM is removed, the UE enters substate 5GMM-DEREGISTERED.
NO-SUPI; b) if coverage is lost, the UE enters substate 5GMM-DEREGISTERED.
The UE then uses the relevant 5GMM and 5GSM procedures to establish the eCall over IMS at the earliest opportunity; or MSISDN or URI for test or terminal reconfig uration service, the UE enters state 5GMM- DEREGISTERED.
Once the registration procedure is completed, the UE uses the relevant 5GMM and 5GSM procedures to establish the non-emergency call.
The UE may initiate registration procedure for emergency services.
Substate when back to state 5GMM-DEREGISTERED from another 5GMM The substate depends on the result of the cell selection procedure, the outcome of the previously performed 5GMM specific procedures, on the 5GS update status of the UE, on the tracking area data stored in the UE, on the presence of the USIM, on the UE configuration and on the reason for moving to 5GMM-DEREGISTERED: b) If no USIM is present or if the inserted USIM is considered invalid by the UE, the substate shall be NO-SUPI; d) If an initial registration shall be performed (e.
network-requested re-registration), the substate shall be f) If the selected cell is known not to be able to provide normal service, the substate shall be LIMITED-SERVICE; g) If the UE is configured for eCall only mode as specified in 3GPP specification document , T3444 and T3445 have expired or are not running, and substate PLMN-SEARCH is not required, the substate shall be eCALL- UE behaviour in state 5GMM-REGISTERED.
The state 5GMM-REGISTERED is entered at the UE, when the initial registration procedure is performed by the UE (see subclause\).
In state 5GMM-REGISTERED, the UE shall behave according to the substate as explained in subclause Detailed description of UE behaviour in state 5GMM-REGISTERED a) shall initiate the mobility or the periodic registration update procedure (according to conditions given in subclause\), except that the periodic registration update procedure shall not be initiated over non-3GPP b) shall initiate the service request procedure (according to conditions given in subclause\); c) shall respond to paging; d) if configured for eCall only mode as specified in 3GPP specification document , shall perform the eCall inactivity procedure at expiry of timer T3444 or timer T3445 (see subclause\); and The UE shall behave as specified in subclause The UE in 3GPP access: a) shall not send any user data; timer T3346 is running and the new PLMN is not equivalent to the PLMN where the UE started timer T3 346, the PLMN identity of the new cell is not in the forbidden PLMN lists, and the tracking area is not in one of the lists of 5GS forbidden tracking areas; serving cell has changed, if timer T3346 is not running, the PLMN identity of the new cell is not in one of the forbidden PLMN lists or the SNPN identity of the new cell is in neither the "permanently forbidden SNPNs" list nor the "temporarily forbidden SNPNs" list, and the tracking area is not in one of the lists of 5GS forbidden tracking areas; layers to establish an emergency PDU session; services even if timer T3346 is running; g) shall initiate registration procedure for mobility and periodic registration update upon reception of paging, or upon reception of NOTIFICATION message with access type indicating 3GPP access; voice call, MMTEL video call, or an MO IMS registration related signalling from the upper layers, if timer T3346 is not running; j) if configured for eCall only mode as specified in 3GPP specification document , shall perform the eCall inactivity procedure at expiry of timer T3444 or timer T3445 (see subclause\); to use exception data reporting (see the ExceptionDataRe portingAllowed leaf of the NAS configuration MO in 3GPP specification document\) if timer T3346 is not already running for "MO exception data" and even if timer T3502 or timer T3511 is running; and l) shall not initiate the de-registration signalling procedure unless timer T3346 is running and the current TAI is part of the TAI list.
The UE in non-3GPP access: a) shall not send any user data; b) shall initiate the registration procedure for mobility and periodic registration update on the expiry of timers services even if timer T3346 is running; voice call, MMTEL video call, or an MO IMS registration related signalling from the upper layers, if timer T3346 is not running; g) shall not initiate the de-registration signalling procedure unless timer T3346 is running.
a) shall perform cell selection/reselection; b) may perform de-registration locally and initiate an initial registration for emergency services; and c) if configured for eCall only mode as specified in 3GPP specification document , shall perform the eCall inactivity procedure at expiry of timer T3444 or timer T3445 (see subclause\).
If the selected cell in the new PLMN is known not to be able to provide normal service, the UE may perform de- registration locally and initiate an initial registration for emergency services.
a) shall not send any user data; for emergency services or emergency services fallback; c) shall perform cell selection/reselection; d) shall enter the appropriate new substate as soon as the lower layers indicate that the barring is alleviated for the access category with which the access attempt for the registration procedure for mobility and periodic registration update was associated; and e) if configured for eCall only mode as specified in 3GPP specification document , shall perform the eCall inactivity procedure at expiry of timer T3444 or T3445 (see subclause\).
5GMM modes and N1 NAS signalling connection Establishment of the N1 NAS signalling connection When the UE is in 5GMM-IDLE mode over 3GPP access and needs to transmit an initial NAS message, the UE shall request the lower layer to establish an RRC connection.
Upon indication from the lower layers that the RRC connection has been established, the UE shall cons ider that the N1 NAS signalling connection over 3GPP access is established and enter 5GMM-CONNECTED mode over 3GPP access.
When the UE is in 5GMM-IDLE mode over non-3GPP access, and the UE receives an indication from the lower layers 5GMM-CONNECTED mode over non-3GPP access and send an initial NAS message.
Initial NAS messages are: a) REGISTRATION REQUEST message; b) DEREGISTRATION REQUEST message; c) SERVICE REQUEST message; and d) CONTROL PLANE SERVICE REQUEST.
is connected to both EPC and 5GCN, for the routing of the REGISTRATION REQUEST message during the initial registration procedure to the appropriate core network (EPC or 5GCN), the UE NAS provides the lower layers with the selected core network type information.
For the routing of the initial NAS message to the appropriate AMF, if the UE holds a 5G-GUTI or 4G-GUTI, the UE NAS provides the lower layers with either the 5G-S-TMSI or the registered GUAMI, or neither the 5G-S-TMSI nor registered GUAMI according to the following rules: a) if the registration procedure for mobility and periodic update was triggered due to the last CONFIGURATION UPDATE COMMAND message containing the Configuration update indication IE with the Registration bit set to "registration requested" and including: 1) no other parameters; 2) one or both of the Allowed NSSAI IE and the Configured NSSAI IE; or 3) the Network slicing indication IE with the Network slicing subscription change indication set to "Network the UE NAS shall not provide the lower layers with the 5G-S-TMSI or the registered GUAMI; b) if the service request procedure was initiated over non-3GPP access, the UE NAS shall provide the lower layers with the registered GUAMI, but shall not provide the lower layers with the 5G-S-TMSI; c) if the initial NAS message other than the SERVICE REQUEST or CONTROL PLANE SERVICE REQUEST message was initiated over non-3GPP access, the UE NAS shall provide the lower layers with the GUAMI of the 5G-GUTI that the UE NAS has selected as specified in the subclause and , but shall not provide the lower layers with the 5G-S-TMSI; d) if the UE does not hold a 5G-GUTI that was previously assigned by the same PLMN with which the UE is performing the registration procedure and if: update indicating "mobility registration updating" following an inter-system change from S1 mode to N1 mode; or "interworking without N26 interface not supported" from the network, and the UE holds a 4G-GUTI; specified in 3GPP specification document with an indication that the GUAMI is mapped from EPS; or 1) if the tracking area of the current cell is in the registration area, the UE NAS shall provide the lower layers with the 5G-S-TMSI, but shall not provide the registered GUAMI to the lower layers; or 2) if the tracking area of the current cell is not in the registration area, the UE NAS shall provide the lower layers with the GUAMI of the 5G-GUTI that the UE NAS has selected as specified in the subclauses and , but shall not provide the lower layers with the 5G-S-TMSI.
If the UE does not hold a 5G-GUTI and the UE does not hold a 4G-GUTI, the UE NAS does not provide the lower layers with the 5G-S-TMSI or the registered GUAMI.
The UE NAS also provides the lower layers with the identity of the selected PLMN (see 3GPP specification document\) if the The UE NAS layer may provide the lower layers with an NSSAI as specified in subclause Re-establishment of the N1 NAS signalling connection the UE has no pending NAS procedure and no pending uplink user data for PDU session(s) with user-plane resources already established, the UE shall: a) enter 5GMM-IDLE mode; and b) initiate the registration procedure for mobility and periodic registration update and include the Uplink data status IE in the REGISTRATION REQUEST message indicating the PDU session(s) for which user-plane resources were active prior to receiving the fallback indication, if any (see subclause for further details).
a) enter 5GMM-IDLE mode; and b) initiate the service request procedure and include the Uplink data status IE in the SERVICE REQUEST message indicating the PDU session(s) for which user-plane resources were active prior to receiving the fallback indication (see subclause for further details).
a) enter 5GMM-IDLE mode; IE in the SERVICE REQUEST message, or in the REGISTRATION REQUEST message, indicating the PDU layers and the UE has pending user data to be sent over 3GPP access, if any, and the PDU session(s) for which user-plane resources were active prior to receiving the fallback indication, if any (see subclauses and for further details).
registration procedure, the UE shall: indicating the PDU session(s) for which user-plane resources were active prior to receiving the fallback indication, if any (see subclause for further details); and c) upon successful service request procedure co mpletion, proceed with any pending procedure.
a) enter 5GMM-IDLE mode; and b) initiate the registration procedure for mobility and periodic registration update.
The UE shall not include the Uplink data status IE in the REGISTRATION REQUEST message except if the PDU session for which user- plane resources were active is an emergency PDU session, or if the UE is configured for high priority access in the selected PLMN.
Release of the N1 NAS signalling connection The signalling procedure for the release of the N1 NAS signalling connection is initiated by the network.
In N1 mode, upon indication from lower layers that the access stratum connection has been released, the UE shall enter 5GMM-IDLE mode and consider the N1 NAS signalling connection released.
If the UE in 3GPP access is configured for eCall only mode as specified in 3GPP specification document then: if the N1 NAS signalling connection that was released had been established for eCall over IMS, the UE shall start timer T3444; and non-emergency MSISDN or URI for test or terminal rec onfiguration service, the UE shall start timer T344 The UE shall start the timer T3447 if not already running when the N1 NAS signalling connection is released as To allow the network to release the N1 NAS signalling connection, the UE: a) shall start the timer T3540 if the UE receives any of the 5GMM cause values #7, #11, #12, #13, #15, #27, #31, 3) the UE has not included the Uplink data status IE in the REGISTRATION REQUEST message, or the UE has included the Uplink data status IE in the REGISTRATION REQUEST message but the REGISTRATION ACCEPT message indicates that no user-plane resources of any PDU sessions are to be re-established; Allowed PDU session status IE in the REGISTRATION REQUEST message but the REGISTRATION ACCEPT message does not indicate that any user-plane resources of any PDU sessions are to be re-established; 5) the registration procedure has been initiated in 5GMM-IDLE mode; 6) the user-plane resources for PDU sessions have not been set up; and 7) the UE does not have to request resources for V2X communication over PC5 reference point (see 3GPP specification document [6C]); NOTE 1: The lower layers indicate when the user-plane resources for PDU sessions are successfully established or the 5GMM cause value #9 or #10; the 5GMM cause value #9, #10 or #28; e) shall start the timer T3540 if: indication IE with the Registration bit set to "registration requested" and with: i) either new allowed NSSAI information or new configured NSSAI information or both included; ii) the network slicing subscription change indication; or iii) no other parameters; 2) the user-plane resources for PDU sessions have not been set up; and 3) no emergency PDU session has been established; f) shall start the timer T3540 if: Uplink data status IE in the SERVICE REQUEST message, or the UE has included the Uplink data status IE in the SERVICE REQUEST message but the SERVICE ACCEPT message indicates that no user-plane resources of any PDU sessions are to be re-established; 3) the UE has not included the Allowed PDU session status IE or has included the Allowed PDU session status IE indicating there is no PDU session(s) for which the UE allowed the user-plane resource to be re-established over 3GPP access in the SERVICE ACCEPT message, or the UE has included the Allowed PDU session status IE in the SERVICE REQUEST message but the SERVICE ACCEPT message does not indicate that any user-plane resources of any PDU sessions are to be re-established; 4) the service request procedure has been initiated in 5GMM-IDLE mode; 5) the user-plane resources for PDU sessions have not been set up; and 6) the UE does not have to request resources for V2X communication over PC5 reference point (see 3GPP specification document [6C]); or NOTE 2: The lower layers indicate when the user-plane resources for PDU sessions are successfully established or g) may start the timer T3540 if the UE receives any of the 5GMM cause values #3 or #6 or if it receives an AUTHENTICATION REJECT message.
- in cases c) and d) the UE shall locally release the established N1 NAS signalling connection and the UE shall initiate the registration procedure as described in subclause or ; or registration procedure as specified in subclause access or establishing an emergency PDU session, the UE shall stop timer T3540 and shall locally release the N1 NAS signalling connection, before proceeding as specified in subclause In case b) and f), upon an indication from the lower layers that the user-plane resources for PDU sessions are set up, the UE shall network-initiated de-registration request via the existing N1 NAS signalling connection as specified in subclause ; respond to the network-initiated 5GMM common procedure via the existing N1 NAS signalling connection as specified in subclause ; the UE shall stop timer T3540 and shall locally release the N1 NAS signalling connection, before proceeding as specified in subclause ; emergency PDU session, the UE shall wait for the local release of the established N1 NAS signalling connection upon expiry of timer T3540 or wait for timer T3540 being stopped, before initiating NAS signalling; or signalling via the existing N1 NAS signalling connection.
In case c) and d), upon an indication from the lower layers that the access stratum connection has been released, the UE shall stop access or establishing an emergency PDU session, the UE shall stop timer T3540 and shall locally release the N1 NAS signalling connection, before proceeding as specified in subclause upon an indication from the lower layers that the access stratum connection has been released, the UE shall stop upon an indication from the lower layers that the user-plane resources for PDU sessions are set up, the UE shall stop timer T3540 and may send user data via user plane.
NOTE 3: In this case, the new registration procedure is performed when the UE moves to the 5GMM-IDLE mode.
NAS signalling connection, before proceeding as specified in subclause If the UE had set the Follow-on request indicator to "Follow-on request pending" in the REGISTRATION REQUEST message due to pending uplink signalling but cannot send the pending signalling due to network not supporting the feature as indicated in the REGISTRATION ACCEPT message (f or example UE set the "Follow-on request pending" to send SMS over NAS but AMF notified "SMS over NAS not allowed") and if there is no further pending data or signalling and user plane resources have not been set up, the UE may locally release the established N1 NAS signalling connection upon completion of the registration procedure.
5GMM-CONNECTED mode with RRC inactive indication This subclause is only applicable for UE's 5GMM mode over 3GPP access.
The 5GMM-CONNECTED mode with RRC inactive indication is not supported when the UE is in NB-N1 mode.
The UE is in 5GMM-CONNECTED mode with RRC inactive indication when the UE is in: a) 5GMM-CONNECTED mode over 3GPP access at the NAS layer; and b) RRC_INACTIVE state at the AS layer (see 3GPP specification document\).
Unless stated otherwise, the UE behaviour in 5GMM-CONNECTED mode with RRC inactive indication follows the UE behaviour in 5GMM-CONNECTED over 3GPP access, except that: a) the UE shall apply the mobility restrictions; and b) the UE shall perform the PLMN selection procedures as in 5GMM-IDLE mode over 3GPP access.
The UE shall transition from 5GMM-CONNECTED mode over 3GPP access to 5GMM-CONNECTED mode with RRC inactive indication upon receiving an indication from the lower layers that the RRC connection has been NOTE 0: Any pending procedure or uplink data packet when receiving an indication from the lower layers that the.
REQUEST message with the NG-RAN-RCU bit of the 5GS update type IE set to "UE radio capability update needed"; or the UE in 5GMM-CONNECTED mode with RRC inactive indication over 3GPP access shall request the lower layers to transition to RRC_CONNECTED state (see 3GPP specification document\).
set to "UE radio capability update needed", the UE in 5GMM-CONNECTED mode with RRC inactive indication shall move to 5GMM-IDLE mode over 3GPP access and proceed with the registration procedure for mobility and periodic registration as specified in subclause The UE shall transition from 5GMM-CONNECTED mode with RRC inactive indication to 5GMM-CONNECTED mode over 3GPP access upon receiving an indication from the lower layers that the UE has transitioned to RRC_CONNECTED state (see 3GPP specification document\).
NOTE 1: The AMF can be aware of the transition between 5GMM-CONNECTED mode and 5GMM- mode upon receiving REFRESH command from the UICC as specified in subclause If the UE in 5GMM-CONNECTED mode with RRC inactive indication receives an indication from the lower layers that the RRC connection has been suspended, the UE shall stay in 5GMM-CONNECTED mode with RRC inactive indication.
The UE shall re-initiate any pending procedure that had triggered the request to the lower layers to transition to RRC_CONNECTED state, if still needed.
` layers, and the UE has no pending NAS procedure and no pending uplink user data for PDU session(s) with user-plane resources already established, the UE shall: a) enter 5GMM-IDLE mode; and b) initiate the registration procedure for mobility and periodic registration update and include the Uplink data status IE in the REGISTRATION REQUEST message indicating the PDU session(s) for which user-plane resources were active prior to receiving the fallback indication, if any (see subclause for further details).
data status IE in the SERVICE REQUEST message, the CONTROL PLANE SERVICE REQUEST message or in the REGISTRATION REQUEST message, indicating the PDU session(s) without active user-plane resources for which the UE has pending user data to be sent, if any, and the PDU session(s) for which user-plane resources were active prior to receiving the fallback indication, if an y (see subclauses and for further details).
procedure, upon fallback indication from lower layers, the UE shall: 1) enter 5GMM-IDLE mode; 2) initiate the service request procedure and include the Uplink data status IE in the SERVICE REQUEST message or the CONTROL PLANE SERVICE REQUEST message indicating the PDU session(s) for which user-plane resources were active prior to receiving the fallback indication, if any (see subclause for further details).
If the procedure that triggered the request to the lower layers to transition to RRC_CONNECTED state is the UE-initiated NAS transport procedure and the UE had SMS, location services message, or CIoT user data to send, the UE shall also include the SMS, location services message, or CIoT user data in the CONTROL PLANE SERVICE REQUEST message as described in subclause ; and 3) upon successful service request procedure co mpletion, proceed with any pending procedure.
1) enter 5GMM-IDLE mode; and 2) initiate the service request procedure and include the Uplink data status IE in the SERVICE REQUEST message or the CONTROL PLANE SERVICE REQUEST message indicating the PDU session(s) for which user-plane resources were active prior to receiving the fallback indication (see subclause for further details).
If the UE in 5GMM-CONNECTED mode with RRC inactive indication receives an indication from the lower layers that the resumption of the RRC connection has failed, and: 1) stay in 5GMM-CONNECTED mode with RRC inactive indication; b) else, the UE shall: 1) enter 5GMM-IDLE mode; and 2) initiate the registration procedure for mobility and periodic registration update used for mobility (i.
the 5GS registration type IE set to "mobility registration updating" in the REGISTRATION REQUEST message) for N1 NAS signalling connection recovery as specified in subclause NOTE 2: An indication from the lower layer that the RRC connection has been released with cause "RRC resume failure" can be considered as an indication that the resumption of the RRC connection has failed.
The UE shall transition from 5GMM-CONNECTED mode with RRC inactive indication to 5GMM-IDLE mode over 3GPP access upon receiving from the lower layers: a) indication of transition from RRC_INACTIVE state to RRC_IDLE state; or b) indication of cell selection to E-UTRAN or another RAT that the UE supports.
Upon receiving AMF paging indication from the lower layers, the UE shall transition from 5GMM-CONNECTED mode with RRC inactive indication to 5GMM-IDLE mode over 3GPP access and handle the AMF paging same as the paging request received in the 5GMM-IDLE mode over 3GPP access as specified in subclause Suspend and resume of the N1 NAS signalling connection Suspend of the N1 NAS signalling connection can be initiated by the network in 5GMM-CONNECTED mode when user plane CIoT 5GS optimization is used.
Resume of the suspended N1 NAS signalling connection is initiated by the UE.
In the UE, when user plane CIoT 5GS optimization is used: Upon idle suspend indication from the lower layers, the UE shall enter 5GMM-IDLE mode with suspend indication, shall not consider the N1 NAS signalling co nnection released and shall not consider the secure exchange of NAS messages terminated (see subclause and\).
5GS update type IE set to "UE radio capability update needed", enter 5GMM-IDLE mode without suspend indication and proceed with the registration procedure; or ii) otherwise, request the lower layer to resume the RRC connection.
NOTE 1: In NB-N1 mode, in the request to the lower layer the data volume information of the initial NAS message is provided to the lower layers.
Interactions between the NAS and the lower layers in order to obtain the data volume information of the initial NAS message (see 3GPP specification document [25E], 3GPP specification document\) is left to implementations.
Upon indication from the lower layers that the RRC connection has been resumed when in 5GMM-IDLE mode with suspend indication, the UE shall enter 5GMM-CONNECTED mode.
If the pending NAS message is: i) a SERVICE REQUEST message, the service type IE is not set to "emergency services fallback", and the UE did not include the NAS message container IE in the SERVICE REQUEST message; or ii) a CONTROL PLANE SERVICE REQUEST message, and the UE did not include the CIoT small data container IE or the NAS message container IE in the CONTROL PLANE SERVICE REQUEST message, the message shall not be sent.
Otherwise the UE shall cipher the message as specified in subclause and send the pending initial NAS message upon entering 5GMM-CONNECTED mode; - Upon fallback indication from the lower layers at RRC connection resume when in 5GMM-IDLE mode with suspend indication, the UE shall enter 5GMM-IDLE mode without suspend indication, send any pending initial NAS message and proceed as if RRC connection establishment had been requested; Upon indication from the lower layers that the RRC connection resume has failed and indication from the lower layers that the RRC connection is suspended, the UE shall enter 5GMM-IDLE mode with suspend indication and restart the ongoing NAS procedure if required; and Upon indication from the lower layers that the RRC connection resume has failed and indication from the lower layers that the RRC connection is not idle suspended, the UE shall enter 5GMM-IDLE mode without suspend indication and restart the ongoing NAS procedure if required.
In the network, when user plane CIoT 5GS optimization is used: Upon idle suspend indication from the lower layers, the network shall enter 5GMM-IDLE mode with suspend indication, shall not consider the N1 NAS signalling co nnection released and shall not consider the secure exchange of NAS messages terminated; and Upon indication from the lower layers that the RRC connection has been resumed when in 5GMM-IDLE mode with suspend indication, the network shall enter 5GMM-CONNECTED mode.
A globally unique permanent identity, the 5G subscription perm anent identifier (SUPI), is allocated to each subscriber The structure of the SUPI and its derivatives are specified in 3GPP specification document .
a NAI as specified in 3GPP specification document .
5G-GUTI is not available; b) in the IDENTITY RESPONSE message, if the SUCI is requested by the network during the identification 5G-GUTI is not available.
The UE shall use the "null-scheme" if: b) the home network has configured "null-scheme" to be used for the UE; before the registration procedure for emergency services was completed successfully, and the UE does not have a valid 5G-GUTI for the selected PLMN; or de-registration procedure that was initiated before the registration procedure for emergency services was completed successfully.
restriction indication and the EUI-64 are the only PEI formats supported by 5GS.
The structure of the PEI and its formats are specified in 3GPP specification document .
Each UE supporting at least one 3GPP access technology (i .
NG-RAN, E-UTRAN, UTRAN or GERAN) contains a PEI in the IMEI format and shall be able to provide an IMEI and an IMEISV upon request from the network.
Each UE not supporting any 3GPP access technologies and supporting NAS over untrusted or trusted non-3GPP access connect to the 5GC.
a) when neither SUPI nor valid 5G-GUTI is available to use for emergency services in the REGISTRATION REQUEST message with 5GS registration type IE set to "emergency registration"; b) when the network requests the PEI by using the identification procedure, in the IDENTITY RESPONSE c) when the network requests the IMEISV by using the security mode control procedure, in the SECURITY MODE an equipment identifier" otherwise the MAC address usage restriction indication set to "no restrictions".
The 5G-RG containing neither an IMEI nor an IMEISV and the W-AGF acting on behalf of the FN-RG shall include the PEI containing the MAC address together with the MAC address usage restriction indication: a) when neither SUPI nor valid 5G-GUTI is available to use for emergency services in the REGISTRATION REQUEST message with 5GS registration type IE set to "emergency registration"; b) when the network requests the PEI by using the identification procedure, in the IDENTIFICATION RESPONSE c) when the network requests the IMEISV by using the security mode control procedure, in the SECURITY MODE NOTE 1: In case c) above, the MAC address is provided even though AMF requests the IMEISV.
NOTE 2: The MAC address of an N5GC device is universally/globally unique.
The AMF can request the PEI at any time by using the identification procedure.
identification within the signalling procedures.
In case of PLMN the 5G-GUTI is globally unique and in case of SNPN the 5G-GUTI is unique within an SNPN.
When the UE is re gistered to the same PLMN or SNPN over 3GPP and non- registration with another PLMN or SNPN over the non-3GPP access.
In the paging and service request procedures, a specified in 3GPP specification document .
The 5G-GUTI has two main components (see 3GPP specification document\): a) the GUAMI; and b) the 5G-TMSI that provides an unambiguous identity of the UE within the AMF(s) identified by the GUAMI.
NOTE: The UE registered with an SNPN over non-3GPP access refers to the UE accessing SNPN services via a The 5G-S-TMSI has three main components: a) the AMF set ID that uniquely identifies the AMF set within the AMF region; b) the AMF pointer that identifies one or more AMFs within the AMF set; and before the release of the N1 NAS signalling connection as specified in subclause the old 5G-GUTI as invalid, stops timer T3519 if running, and deletes any stored SUCI.
The new 5G-GUTI is configuration update procedure is received.
the 5GS, the concept of "registration to multiple tracking areas" applies: 1) one or more TACs; and ii) multiple SNPN identities; or iii) one or more PLMN identities and one or more SNPN identities; b) In order to reduce the tracking area update signalling within the 5GS, the AMF can assign several tracking areas generating the TAI list, the AMF shall include only TAIs that are applicable on the access where the TAI list is procedure for mobility and periodic registration update used for mobility (i.
the 5GS registration type IE set to "mobility registration updating" in the REGISTRATION REQUEST message) as long as the UE stays in one of the tracking areas of the list of tracking areas received from the AMF.
mobility and periodic registration update or generic UE configuration update procedure, or the UE is registration request is accepted or the TAI list is reallo cated by the AMF, the AMF shall provide at least one list to the UE during mobility registration update or periodic registration update.
e) The TAI list can be reallocated by the AMF.
f)- When the UE is deregistered from the 5GS, the TAI list in the UE is invalid.
g) The AMF allocates one 5G-GUTI, which is common between 3GPP access and non-3GPP access, to the UE when the UE is registered to the same PLMN over both accesses.
h) The UE includes the last visited registered TAI, if availa ble, to the AMF.
The last visited registered TAI is stored memory in the ME, as described in annex C.
Service area restrictions are applicable only to 3GPP access and to wireline access.
Subclause applies when the UE accesses 5GCN over 3GPP access.
Subclause applies when the 5G-RG or the W-AGF acting on behalf of an FN-CRG (or on behalf of the N5GC device) access 5GCN over wireline access.
3GPP access service area restrictions tracking areas belong to either the registered PLMN or its equivalent PLMNs in the registration area.
The allowed area can contain up to 16 tracking areas or include all tracking ar eas in the registered PLMN and its equivalent PLMN(s) in UE configuration update procedure: a) if the "Type of list" included in the Service area list IE does not indicate "all TAIs belonging to the PLMNs in the registration area are allowed area", the UE shall dele te the old list of "allowed tracking areas" and store the allowed tracking areas", the UE shall delete that list; or b) if the "Type of list" included in the Service area list IE indicates "all TAIs belonging to the PLMNs in the registration area are allowed area", the UE shall treat all tr acking areas in the registered PLMN and its equivalent PLMN(s) as allowed area and delete the stored list of "all owed tracking areas" or the stored list of "non-allowed generic UE configuration update procedure, the UE shall delete the old list of "non-allowed tracking areas" and store "allowed tracking areas", the UE shall delete that list.
NORMAL-SERVICE and is allowed to initiate any 5GMM and 5GSM procedures; whose TAI is not in the list of "allowed tracking areas", the UE shall enter the state 5GMM-REGISTERED.
NON-ALLOWED-SERVICE, and: 1) if the UE is in 5GMM-IDLE mode or 5GMM-IDLE mode with suspend indication over 3GPP access, the i) shall not perform the registration procedure for mobility and periodic registration update with Uplink data status IE except for emergency services or for high priority access; sending an SOR transparent container; 2) if the UE is in 5GMM-CONNECTED mode or 5GMM-CONNECTED mode with RRC inactive indication over 3GPP access, the UE: i) shall not perform the registration procedure for mobility and periodic registration update with Uplink data status IE except for emergency services or for high priority access; high priority access; - emergency services; iv) shall not perform the NAS transport procedure except for the sending: an SOR transparent container; - a UE policy container; - a UE parameters update transparent container; or - a CIoT user data container.
whose TAI is not in the list of "non-allowed tracking areas", the UE shall stay in, or enter, the state 5GMM- REGISTERED.
NORMAL-SERVICE and is allowed to initiate any 5GMM and 5GSM procedures; and 1) if the UE is in 5GMM-IDLE mode or 5GMM-IDLE mode with suspend indication over 3GPP access, the i) shall not perform the registration procedure for mobility and periodic registration update with Uplink data status IE except for emergency services or for high priority access; and of 3GPP PS data off UE status; and 2) if the UE is in 5GMM-CONNECTED mode or 5GMM-CONNECTED mode with RRC inactive indication over 3GPP access, the UE: i) shall not perform the registration procedure for mobility and registration update with the Uplink data status IE except for emergency services or for high priority access; emergency services; - high priority access; or - responding to paging or responding to notification received over non-3GPP access; iii) shall not initiate a 5GSM procedure except for: high priority access; or iv) shall not perform the NAS transport procedure except for the sending: a) the UE is switched off; and b) the UICC containing the USIM is removed or an entry of the "list of subscriber data" with the SNPN identity of the SNPN is updated.
tracking areas for regional provision of service" as specified in the subclauses or , the tracking area shall be removed from the list of "allowed tracking areas" if the tracking area is already present in the list of "allowed tracking areas" and from the list of "non-allowed tracking areas " if the tracking area is already present in the list of Wireline access service area restrictions.
a) a SERVICE REJECT message with the 5GMM cause #28 "Restricted service area"; b) a DL NAS TRANSPORT message with the Payload container type IE set to "N1 SM information" and the 5GMM cause #28 "Restricted service area"; or c) a REGISTRATION ACCEPT message includes the PDU session reactivation result error cause IE with the 5GMM cause #28 "Restricted service area"; is received over wireline access then the 5G-RG or the W-AGF acting on behalf of the FN-CRG (or on behalf of the N5GC device) shall start enforcing the wireline access se rvice area restrictions and shall enter the state 5GMM- While in the state 5GMM-REGISTERED.
NON-ALLOWED-SERVICE, the 5G-RG or the W-AGF acting on behalf of the FN-CRG (or on behalf of the N5GC device) shall: a) if in 5GMM-IDLE mode over wireline access: 1) shall not perform the registration procedure for mobility and periodic registration update with Uplink data status IE except for emergency services or for high priority access; and b) if in 5GMM-CONNECTED mode over wireline access: status IE except for emergency services or for high priority access; 3) shall not initiate a 5GSM procedure except for emergency services or high priority access; over the wireline access.
When the 5G-RG is switched off, the UICC containing the USIM is removed or the 5G-RG starts using another wireline access network, the 5G-RG shall stop enforcing the wireline access service area restrictions, if enforced.
When the W-AGF acting on behalf of the FN-CRG determines that the FN-CRG is switched off, the W-AGF acting on behalf of the FN-CRG stops enforcing the wireline access service area restrictions, if enforced.
When the W-AGF acting on behalf of the N5GC device determines that the FN-CRG serving the N5GC device is switched off, the W-AGF acting on behalf of the N5GC device stops enforcing the wireline access service area restrictions, if enforced.
3GPP specification document and 3GPP specification document\).
The UE shall not request use of MICO mode over non-3GPP access.
Furthermore, the UE in 3GPP access shall not request the use of MICO mode during: a) a registration procedure for initial registration for emergency services (see subclause\); b) a registration procedure for initial registration for initiating an emergency PDU session (see subclause\); c) a registration procedure for mobility and periodic registration update (see subclause\) for initiating an emergency PDU session if the UE is in the state 5GMM-REGISTERED.
ATTEMPTING-REGISTRATION- d) a registration procedure for mobility and periodic registration update (see subclause\) when the UE has an emergency PDU session established.
indication when accepting the registration procedure.
The UE may use MICO mode only if the network has provided the MICO indication IE during the last registration procedur e.
The UE may also request an active time value together with the MICO mode indication during the registration procedure.
If the network accepts the use of MICO mode and does not include an active time value in T3324 IE to the UE, the AMF may include an "all PLMN registration area allocated" indication in the MICO indication IE to the UE.
If the UE indicated the support for strictly periodic registration timer in the MICO indication IE to the network, the network may include a "strictly periodic registration timer supported" indication in the MICO indication IE to the UE.
If the UE requested the use of active time by including an active time value and the network accepts the use of MICO mode and the use of active time, the AMF shall include an active time value in the T3324 IE to the UE.
If the AMF indicates active time value to the UE, AMF should not indicate "all PLMN registration area allocated" indication in the MICO indication IE to the UE.
Upon entering 5GMM-IDLE mode, AMF shall start the active timer with the active time value indicated to the UE and shall consid er the UE is reachable for paging as long as the timer is running.
If the UE enters 5GMM-CONNECTED mode over 3GPP access when the active timer is running, the AMF shall stop the active timer.
NOTE 1: The active time value assigned by AMF can be different from the active time value requested by the UE.
AMF assigns the active time value based on several factors, e.
local configuration, expected UE behaviour, UE requested active time value, UE subscription information, network policies etc.
If the network accepts the use of MICO mode, the UE may deactivate the AS layer and activate MICO mode by entering the state 5GMM-REGISTERED.
NO-CELL-AVAILABLE if: a) the UE is in 5GMM-IDLE mode over3GPP access; b) the UE is in the 5GMM-REGISTERED.
NORMAL-SERVICE state for 3GPP access; and c) no T3324 value is received from the network.
procedure, the UE shall start the timer T3324 with the value received from the network after entering 5GMM-IDLE mode over 3GPP access.
At the expiry of the timer T3324, the UE may activate MICO mode by entering the state 5GMM-REGISTERED.
NO-CELL-AVAILABLE if the UE is in the 5GMM-REGISTERED.
NORMAL-SERVICE state for 3GPP access.
If the UE enters 5GMM-CONNECTED mode over 3GPP access when the timer T3324 is running, the UE shall stop the timer T332 When MICO mode is activated, all NAS timers are stopped and associated procedures aborted except for timers T3512, HPLMN or EHPLMN or higher prioritized PLMNs (see 3GPP specification document\).
NOTE 2: When MICO mode is activated and if the UE is also registered over the non-3GPP access, the AMF will The UE may deactivate MICO mode and activate the AS layer at any time.
Upon deactivating MICO mode, the UE may initiate 5GMM procedures (e.
for the transfer of mobile originated signalling or user data).
implementation-specific duration of time before requesting the use of MICO mode after the release of the emergency PDU session.
If the AMF accepts the use of MICO mode and does not indicate "strictly periodic registration timer supported" in the MICO indication IE to the UE, the AMF starts the implicit de-registration timer for 3GPP access when entering 5GMM-IDLE mode for 3GPP access.
If AMF accepts the use of MICO mode and indicates "strictly periodic registration timer supported" in the MICO indication IE to the UE, AMF shall start the strictly periodic monitoring timer with T3512 value indicated in the T3512 value IE after the registration procedure is completed.
The AMF shall neither stop nor reset the strictly periodic monitoring timer when the NAS signalling connection is established or the UE, AMF shall restart the strictly periodic monitoring timer with the T3512 value, otherwise AMF shall start the implicit de-registration timer.
When an emergency PDU session is successfully established and the MICO mode is disabled, the UE shall stop timer T3512 if running and the AMF shall stop strictly periodic monitoring timer if running.
The UE and the AMF shall behave as if no "strictly periodic registration timer supported" indication was given to the UE in the last registration Upon successful completion of an attach procedure or track ing area updating procedure after inter-system change from N1 mode to S1 mode (see 3GPP specification document\), the UE operating in single-registration mode shall locally disable MICO mode.
After inter-system change from S1 mode to N1 mode, the UE operating in single-registration mode may re-negotiate MICO mode with the network during the registration procedure for mobility and periodic registration update.
Handling of the periodic registration update timer and mobile The periodic registration update procedure is used over 3GPP access to periodically notify the availability of the UE to the network.
The procedure is controlled in the UE by the periodic registration update timer, T351 If the UE is registered over the 3GPP access, the AMF main tains an implicit de-registration timer to control when the UE is considered implicitly de-registered over the 3GPP acc ess.
If the UE is registered over the non-3GPP access, the N1 NAS signalling connection over non-3GPP access is released.
signalling connection over non-3GPP access is released.
The non-3GPP de-registration timer is stopped when the UE enters 5GMM-CONNECTED mode over non-3GPP access or the 5GMM-DEREGISTERED state over non-3GPP access.
The non-3GPP implicit de-registration timer shall be longer than the non-3GPP de-registration timer.
The value of timer T3512 is sent by the network to the UE in the REGISTRATION ACCEPT message.
The UE shall periodic registration update timer only applies to the UE registered to the 5GS services over 3GPP access.
deactivated or the timer value is zero, then timer T3512 is deactivated and the UE shall not perform the periodic NOTE 1: The UE does not perform the periodic regi stration update procedure for non-3GPP access.
If during the registration procedure, the AMF does not indicate "strictly periodic registration timer supported" in the MICO indication IE to the UE, timer T3512 is reset and started with its initial value, when the UE changes from 5GMM-CONNECTED over 3GPP access to 5GMM-IDLE mode over 3GPP access.
Timer T3512 is stopped when the UE enters 5GMM-CONNECTED mode over 3GPP access or the 5GMM-DEREGISTERED state over 3GPP access.
a) the UE in 5GMM-CONNECTED mode over 3GPP access shall reset and start the timer T3512 with its initial b) the UE in 5GMM-IDLE mode over 3GPP access shall perform the periodic registration procedure.
the periodic registration update procedure shall be started.
NON-ALLOWED-SERVICE over 3GPP access when timer T3512 expires, the periodic registration update procedure is delayed until the UE returns to 5GMM-REGISTERED.
NORMAL-SERVICE over 3GPP access.
NOTE 2: When the UE returns to 5GMM-REGISTERED.
NORMAL-SERVICE and it needs to initiate other 5GMM procedure than the periodic registration update procedure then, based on UE implementation, the 5GMM procedure can take precedence.
The network supervises the periodic registration update proced ure of the UE by means of the mobile reachable timer.
If the UE is not registered for emergency services, the mobi le reachable timer shall be longer than the value of timer T351 In this case, by default, the mobile reachable timer is 4 minutes greater than the value of timer T351 The network behaviour upon expiry of the mobile reachable timer is network dependent, but typically the network stops sending paging messages to the UE on the first expiry, and may take other appropriate actions.
T351 When the mobile reachable timer expires, the AMF shall locally de-register the UE.
The mobile reachable timer shall be reset and started with the value as indicated above, when the AMF releases the Upon expiry of the mobile reachable timer the network shall start the implicit de-registration timer over 3GPP access.
The value of the implicit de-registration timer over 3GPP access is network dependent.
If MICO mode is activated, the network shall start the implicit de-registration timer over 3GPP access when the UE enters 5GMM-IDLE mode at the AMF over 3GPP access.
The default value of the implicit de-registration timer over 3GPP access is 4 minutes greater than the value of timer T351 If the implicit de-registration timer expires before the UE contacts the network, the network shall implicitly de-register If the non-3GPP implicit de-registration timer expires before the UE contacts the network over the non-3GPP access, If the non-3GPP de-registration timer expires before the UE contacts the network over the non-3GPP access, the UE If the AMF provides T3346 value IE in the DEREGISTRATION REQUEST message with Access type set to "Non- mobility and periodic registration update or SERVICE REJECT message and the value of timer T3346is greater than the value of timer T3512, the AMF sets the mobile reachable timer and the implicit de-registration timer such that the sum of the timer values is greater than the value of timer T334 If the UE receives T3346 value IE in the DEREGISTRATION REQUEST message with Access type set to "3GPP Handling of timer T3502 The default value of this timer is also used by the UE in the following cases: registration attempt counter is equal to 5 and no REGISTRATION REJECT message was received from the new d) the network indicates that the timer is "deactivated".
Handling of NAS level mob ility management conge stion control The AMF may detect 5GMM signalling congestion and perform general NAS level congestion control.
Under the 5GMM signalling congestion conditions the AMF may reject 5GMM signalling requests from UEs as specified in 3GPP specification document .
The AMF should not reject the following: a) requests for emergency services; b) requests for emergency services fallback; c) requests from UEs configured for high priority access in selected PLMN; d) DEREGISTRATION REQUEST message; and off timer T3346 in the reject messages.
The UE starts the timer T3346 with the value received in the 5GMM reject messages.
To avoid that large numbers of UEs simultaneously initiate deferred requests, the AMF should select the value for the timer T3346 for the rejected UEs so that timeouts are not synchronised.
If the UE is registered in the same PLMN over the 3GPP access and non-3GPP access, and the UE receives the timer T3346 from the AMF, the timer T3346 shall apply to both 3GPP access and non-3GPP access.
If the UE receives the paging message or NOTIFICATION message when timer T3346 is running and the UE is registered to the same PLMN over 3GPP access and non-3GPP access, the UE shall stop the timer T3346 for both accesses and initiate the service request procedure as specified in subclause If the timer T3346 is running when the UE enters state 5GMM-DEREGISTERED, the UE remains switched on, and the shall set the 5GS update status to 5U2 NOT UPDATED and enter state 5GMM-REGISTERED.
the UE needs to initiate signalling for emergency services or emergency services fallback, then the UE is allowed to NOTE: UE can, based on implementation, restrict lower layers of non-3GPP access from establishing access 0 Handling of DNN based congestion control The AMF may detect and start performing DNN based conge stion control when one or more DNN congestion criteria When DNN based congestion control is activated at the AMF, the AMF performs the congestion control as specified in subclause and the UE performs the congestion control as specified in subclause and subclause 1 Handling of S-NSSAI based congestion control When S-NSSAI based congestion control is activated at the AMF, the AMF performs the congestion control as specified in subclause and the UE performs the congestion control as specified in subclause and 2 Handling of local emergency numbers access and registration procedures via non-3GPP access.
REGISTRATION ACCEPT message, by including the Emergency number list IE and the Extended emergency number list IE, respectively.
The Local emergency numbers list can be updated as described in 3GPP specification document , subclause The user equipment shall store the local emergency numbers list and the extended local emergency numbers list, as provided by the network.
The local emergency numbers list stored in the user equipment shall be replaced on each receipt of the Emergency number list IE.
The extended local em ergency numbers list stored in the user equipment shall be replaced on each receipt of the Extended emergency num ber list IE.
The received local emergency numbers list or the received extended local emergency numbers list or both shall be provided to the upper layers.
current country of the UE, the UE shall keep the stored lo cal emergency numbers list and the extended local emergency The emergency number(s) received in the Extended emergency number list IE are valid only in: networks in the same country as the PLMN from which this IE is received, if the Extended Emergency Number List Validity (EENLV) field within the Extended emergency number list IE indicates "Extended Local Emergency Numbers List is valid in the country of the PLMN from which this IE is received"; and the PLMN from which this IE is received, if the EENLV field within the Extended emergency number list IE indicates "Extended Local Emergency Numbers List is valid only in the PLMN from which this IE is received".
If no Extended Local Emergency Numbers List is contained in the REGISTRATION ACCEPT message, and the registered PLMN has not changed, then the stored Extended Local Emergency Numbers List in the user equipment shall be kept.
If no Extended Local Emergency Numbers List is contained in the REGISTRATION ACCEPT message, but the registered PLMN has changed, then: if the last received indication in the EENLV field within the Extended emergency number list IE indicates "Extended Local Emergency Numbers List is valid only in the PLMN from which this IE is received", the stored Extended Local Emergency Numbers List in the user equipment shall be deleted; and if the last received indication in the EENLV field within the Extended emergency number list IE indicates from that of the PLMN that sent the stored list.
or agree on the setting of the Extended emergency number list IE in accordance to national agreement – The local emergency numbers list and the extended local emergency numbers list shall be deleted at switch off or removal of the USIM.
The user equipment shall be able to store up to ten entries in the local emergency numbers list and up to twenty entries in the Extended local emergency numbers list, received from the network.
3GPP specification document , subclause 2A Handling of local emergency numbers received via 3GPP access.
The requirements in subclause 2 with the clarifications and additional conditions in subclause 2A apply to a attach procedures (see 3GPP specification document\) or registration procedures via 3GPP access; and registration procedures via non-3GPP access.
The UE shall ignore the presence or absence of local emerge ncy numbers list, extended local emergency numbers list or For the purposes of subclause 2A, the UE is consid ered neither registered nor attached over 3GPP access if: 1) the UE supports 3GPP access to EPC, the UE does not support 3GPP access to 5GC, and: a) the EMM sublayer is in the EMM-NULL state, EMM-DEREGISTERED state or EMM-DEREGISTERED- 2) the UE supports 3GPP access to 5GC, the UE does not support 3GPP access to EPC, and: 3) supports both 3GPP access to EPC and 3GPP access to 5GC, and: a) the EMM sublayer is in the EMM-NULL state, EMM-DEREGISTERED state or EMM-DEREGISTERED- a) the 5GMM sublayer is is in the 5GMM-NULL state, 5GMM-DEREGISTERED state or 5GMM- If the UE can determine the current country and after switch on or after removal of the USIM, has not been registered or has not been attached via 3GPP access in the current country, then the UE shall store the local emergency numbers list or the extended local emergency numbers list or both, as provided by the network with an MCC matching the current country via non-3GPP access.
NOTE: The UE determines, as the current country, the country in which it is located in accordance with 3GPP specification document .
was also received via non-3GPP access or the previously stored extended local emergency numbers list was also received via non-3GPP access.
the stored indication in the EENLV field within the Ex tended emergency number list IE indicates "Extended Local Emergency Numbers List is valid only in the PLMN from which this IE is received".
3GPP access and the UE is neither registered nor attached over 3GPP access, the stored extended local emergency numbers list in the UE shall be discarded if: that country is different from that of the PLMN that sent the stored list via 3GPP access; or "Extended Local Emergency Numbers List is valid only in the PLMN from which this IE is received".
3 Lists of 5GS forbidden tracking areas for regional provision of service" per SNPN.
Within the 5GS, these lists are managed independently per access type, i.
, 3GPP access or non-3GPP access.
These lists shall be erased when a) the UE is switched off or the UICC containing the USIM is removed or an entry of the "list of subscriber data" with the SNPN identity of the current SNPN is updated; and Over 3GPP access, when the lists are erased, the UE perf orms cell selection according to 3GPP specification document .
A DEREGISTRATION REQUEST message is received with the 5GMM cause #12 "tracking area not allowed", #13 "roaming not allowed in this tracking area", or #15 "no suitable cells in tracking area".
3A Forbidden PLMN lists In N1 mode, two lists of forbidden PLMN are managed independently per access type, i.
, 3GPP access or non-3GPP access.
: the list of "forbidden PLMNs" as defined in 3GPP specification document is applicable for 3GPP access in N1 mode.
The same list is used by 5GMM for 3GPP access, EMM, GMM and MM (see 3GPP specification document and 3GPP specification document\), regardless whether the UE is operating in single-registration mode or dual-registration mode.
the list of "forbidden PLMNs for non-3GPP access to 5GCN" as defined in 3GPP specification document is applicable for 5GMM for non-3GPP access.
The list of "forbidden PLMNs for GPRS service" as defined in 3GPP specification document and 3GPP specification document is applicable for 3GPP access in N1 mode.
The same list is used by 5GMM for 3GPP access, EMM and GMM (see 3GPP specification document and 3GPP specification document\), regardless whether the UE is operating in single-registration mode or dual-registration mode.
4 List of equivalent PLMNs 3GPP specification document and 3GPP specification document\) except for the case when the UE operates in dual-registration mode equivalent PLMNs as downloaded by the network plus the PLMN code of the registered PLMN that downloaded the list.
When the UE is switched off, the UE shall keep the stored list so that it can be used for PLMN selection after switch on.
The UE shall delete the stored list if the USIM is removed or when the UE registered for emergency services enters the state 5GMM-DEREGISTERED.
The maximum number of possible entries in the stored list is 1 5 Transmission failure abnormal case in the UE The abnormal case 5GMM uplink message transmission failure indication by lower layers can be identified for 5GMM When it is specified in the relevant procedure that it is up to the UE implementation to re-run the ongoing NOTE: The transmission failure can happen due to TAI change.
The lower layer might take some time to read the information is up to UE implementation.
the UE and accepted by the network: if the UE is in WB-N1 mode, eDRX is used when the UE is in 5GMM-IDLE mode or in 5GMM-CONNECTED mode with RRC inactive indication; or if the UE is in NB-N1 mode, eDRX is used when the UE is in 5GMM-IDLE mode.
NOTE 1: eDRX is not supported by NR connected to 5GCN.
The network accepts the request to use the eDRX by providing the Negotiated extended DRX parameters IE when accepting the registration procedure.
The UE shall use eDRX only if it received the Negotiated extended DRX parameters IE during the last registration procedure and the UE does not have an emergency PDU session.
NOTE 2: If the UE wants to keep using eDRX, the UE includes the Extended DRX parameters IE in each If the network has provided the Negotiated extended DRX parameters IE during the last registration procedure, upon successful completion of the PDU session release procedure of the emergency PDU session, the network shall resume If the UE or the network locally releases an emergency PDU session, the UE or the network shall not use eDRX until If the UE did not receive the Negotiated extended DRX parame ters IE, or if the UE has an emergency PDU session, the UE shall use the stored UE specific DRX parameter, if available.
If the network did not accept the request to use eDRX, or if the UE has an emergency PDU session, the network shall use the stored UE specific DRX parameter, if available.
If the network provided the Negotiated extended DRX parameters IE which was different from the one requested by the procedure, the network shall use the stored UE specific DRX parameter, if available, with the old 5G-GUTI and use the eDRX provided by the network with the new 5G-GUTI until the old 5G-GUTI can be considered as invalid by the network (see subclauses and\).
7 Service Gap Control Service gap control (SGC) only applies to 3GPP access.
The network may control the frequency with which UEs can transition from 5GMM-IDLE mode to 5GMM- CONNECTED mode via the SGC as specified in 3GPP specification document and 3GPP specification document .
If the network supports SGC and the service gap time value i.
T3447 value is available in the 5GMM context of the UE, the AMF shall consider SGC as active for the UE.
The UE and the network negotiate usage of SGC during the registration procedure for initial registration and registration procedure for mobility and periodic registration update: the UE supporting SGC indicates its support in the REGISTRATION REQUEST message.
If the UE supports SGC and the SGC is active for the UE, the AMF includes T3447 value IE in the REGISTRATION ACCEPT message (see subclause and subclause\).
The UE stores the T3447 value; and specified in subclause applies.
The UE shall start timer T3447 when the N1 NAS signalling connection is released and if: the UE supports SGC, and the T3447 value is available in the UE and does not indicate zero; and - the N1 NAS signalling connection released was not established for: paging; - registration procedure for initial registration with Follow-on request indicator set to "No follow-on request registration procedure for mobility and periodic registration update with Follow-on request indicator set to "No follow-on request pending" and without Uplink data status IE included; requests for emergency services; or - requests for exception data reporting.
If the SGC is active in the network, after the UE transitions from 5GMM-CONNECTED mode to 5GMM-IDLE mode except when the UE was in 5GMM-CONNECTED mode due to: registration procedure for initial registration with Follow-on request indicator set to "No follow-on request registration procedure for mobility and periodic registration update with Follow-on request indicator set to "No follow-on request pending" and without Uplink data status IE included, requests for emergency services; or requests for exception data reporting, the network shall start timer T3447 if not already running: with the T3447 value available in the 5GMM context minus 4 minutes, if the UE supports SGC and the T3447 with the T3447 value available in the 5GMM context if the UE does not support SGC.
When timer T3447 is running, the network allows: requests for emergency service; requests for emergency service fallback; - requests for high priority access; - requests for exception data reporting; registration procedure for initial registration with Follow-on request indicator set to "No follow-on request registration procedure for mobility and periodic registration update without Uplink data status IE included and with Follow-on request indicator set to "No follow-on request pending"; or service request procedure or registration procedure for mobility and periodic registration update triggered by paging and subsequent MO signalling or MO data, if any, until the UE enters 5GMM-IDLE mode.
NOTE: If the UE transitions from 5GMM-IDLE mode to 5GMM-CONNECTED mode due to registration procedure for initial registration with Follow-on request indicator set to "No follow-on request pending" or mobility and periodic registration update request without Uplink data status IE and with Follow-on request indicator set to "No follow-on request pending", the UE initiates no further MO signalling except for mobility and periodic registration update requests without Uplink data status and with Follow-on request indicator set to "No follow-on request pe nding" until the UE receives mobile terminated signalling (e.
DL NAS TRANSPORT message for MT SMS) or MT data over user plane, or after the UE has moved to 5GMM-IDLE state and the service gap timer is not running.
If timer T3447 is running when the UE changes PLMN or enters state 5GMM-DEREGISTERED, the UE remains switched on, and the USIM in the UE remains the same, then timer T3447 is kept running until it expires.
If the AMF determines that the UE operating in single-registration mode has performed an inter-system change from N1 mode to S1 mode and the timer T3447 is running in the AMF, the AMF stops the T 344 UE, and the T3447 value IE is included in the REGISTRATION ACCEPT message received from the AMF (see subclause and subclause\), the UE shall keep T3447 r unning.
Additionally, the UE shall store and replace the currently stored service gap time value with the received T3447 value.
Upon expiry of the running T3447 timer, the UE shall use the new value when starting T3447 again.
and the USIM in the UE remains the same: 8 Restriction on use of enhanced coverage coverage indicates its support for restriction on use of enhanced coverage in the REGISTRATION REQUEST message.
If the UE supports restriction on use of enhanced coverage, the AMF indicates in the REGISTRATION ACCEPT message (see subclause and subclause\) that: b) when in NB-N1 mode, whether the use of enhanced coverage is restricted or not for the UE.
a) the use of enhanced coverage is restricted; the UE shall not use enhanced coverage in the registered PLMN and in any PLMN which is in the list of equivalent a) the use of enhanced coverage is not restricted for the UE; or b) the UE is in 5GMM-CONNECTED mode and there is no ongoing registration procedure, the AMF shall initiate the generic UE configuration update procedure to indicate registration requested and release of the N1 NAS signalling connection not requested as described in subclause After the successful completion of the registration procedure for mobility registration update including change of the restriction on the use of enhanced coverage, for any SMF with which the UE has an established PDU session, the AMF updates the SMF with the indication on the use of extended NAS timer setting as described in 3GPP specification document and 3GPP specification document .
The network may activate congestion control for transport of user data via the control plane, as specified in 3GPP specification document .
If the UE has indicated support for the control plane CIoT 5GS optimizations and the network decides to activate the data back-off timer T3448 in REGISTRATION ACCEPT, SERVICE ACCEPT or SERVICE REJECT message, and The network sends REGISTRATION ACCEPT message or SERVICE ACCEPT message without T3448 value IE to stop the timer T3448 r unning in the UE as specified in subclause and subclause Based on the stored control plane data back-off time for the UE , the network may reject the transfer of user data via the control plane initiated by the UE.
While the timer T3448 is running, the UE in 5GMM-IDLE mode does not initiate the transport of user data via the control plane procedure, except if the UE is allowed to use exception data reporting (see the ExceptionDataReportingAllowed leaf of the NAS configuration MO in 3GPP specification document or the USIM file NASCONFIG in 3GPP specification document\) and the user data is related to an exceptional event.
The UE is allowed to respond to paging with CONTROL PLANE SERVICE REQUEST message without uplink data even if the timer T3448 is started the timer T3448, or upon being switched off while the timer T3448 is running, the UE stops the timer T344 9a Specific requirements for UE configured to use timer T3245 3GPP access or non-3GPP access, and timer T3245 (see 3GPP specification document\) is not running, the UE shall start timer T3245 as specified in 3GPP specification document , subclause Upon expiry of the timer T3245, the UE shall erase the "forbidden PLMN list" and "forbidden PLMNs for GPRS service" list and set the USIM to valid for 5GS services for 3GPP access and non-3GPP access.
When the lists are erased, the UE performs cell selec tion according to 3GPP specification document .
and the USIM in the UE remains the same:.
protection with specific 5GMM causes.
NOTE: Additional UE requirements for this case, requirements for other 5GMM causes, and requirements for the case when the UE receives an integrity protected reject message are specified in subclauses and The UE shall maintain: a list of PLMN-specific attempt counters (see 3GPP specification document\).
The maximum number of possible entries in the list is implementation dependent.
This list is applicable to access attempts via 3GPP access only; a list of PLMN-specific attempt counters for non-3GPP access, if the UE supports non-3GPP access.
The maximum number of possible entries in the list is implementation dependent.
This list is applicable to access attempts via non-3GPP access only; a list of PLMN-specific N1 mode attempt counters for 3GPP access.
The maximum number of possible entries in the list is implementation dependent.
This list is applicable to access attempts via 3GPP access only; a list of PLMN-specific N1 mode attempt counters for non-3GPP access, if the UE supports non-3GPP access.
The maximum number of possible entries in the list is im plementation dependent.
This list is applicable to access attempts via non-3GPP access only; one counter for "SIM/USIM considered invalid for GPRS services" events (see 3GPP TS 2 008\); and one counter for "USIM considered invalid for 5GS serv ices over non-3GPP access" events, if the UE supports A UE supporting non-EPS services shall maintain one counter for "SIM/USIM considered invalid for non-GPRS services" events (see 3GPP specification document\).
The UE shall store the above lists of attempt counters and the event counters in its non-volatile memory.
The UE shall shall not be affected by the activation or deactivation of MI CO mode or power saving mode (see 3GPP specification document\).
The UE implementation-specific maximum value for any of the above counters shall not be greater than 1 NOTE 1: Different counters can use different UE implementation-specific maximum values.
exchange of NAS messages for the N1 NAS signalling connection, the UE shall stop timer T3510 or T3517 if running, 1) if the 5GMM cause value received is #3, #6 or #7, and: a) if the 5GMM cause value is received over 3GPP access, the UE shall: i) if the UE is already registered over another access: store the current TAI in the list of "5GS forbidden tracking areas for roaming", memorize the current TAI was stored in the list of "5GS forbidden track ing areas for roaming" for non-integrity protected set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete 5G-GUTI, last visited registered TAI, TAI list and ngKSI for if the 5GMM cause value received is #3 or #6, delete the list of equivalent PLMNs if any; increment the counter for "SIM/USIM consid ered invalid for GPRS services" events; if the 5GMM cause value received is #3 or #6, and if the counter for "SIM/USIM considered invalid request procedure was performed, reset the service request attempt counter; if the UE is operating in single-registration mode, handle the EMM parameters EMM state, EPS update status, EPS attach attempt counter or tracking area updating attempt counter, 4G-GUTI, TAI list, eKSI as specified in 3GPP specification document for the case when the EPS attach or tracking area store the current TAI in the list of "5GS forbidden tracking areas for roaming", memorize the current TAI was stored in the list of "5GS forbidden track ing areas for roaming" for non-integrity protected NAS reject message and enter the state 5GMM-DEREGISTERED.
LIMITED-SERVICE; and iii) otherwise proceed as specified in subclauses and ; b) if the 5GMM cause value is received over non-3GPP access, the UE shall: i) if the UE is already registered over another access: enter the state 5GMM-DEREGISTERED.
LIMITED-SERVICE; and may perform registration attempt over the non-3GPP access if another access point for non-3GPP access is available; or ii) otherwise, if the counter for "USIM considered invalid for 5GS services over non-3GPP access" events set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete the 5G-GUTI, last visited registered TAI, TAI list and ngKSI for enter the state 5GMM-DEREGISTERED.
LIMITED-SERVICE; increment the counter for "USIM considered inva lid for 5GS services over non-3GPP access" events; 3GPP access if another access point for non-3GPP access is available, or if 3GPP access is available, and the SIM/USIM is not considered invalid for 5GS services over 3GPP access, perform registration attempt over the 3GPP access; and iii) otherwise proceed as specified in subclauses and ; a) if the 5GMM cause value is received over 3GPP access, non-3GPP access is available, the UE is not registered over non-3GPP access yet, and the SIM/USIM is not considered invalid for 5GS services over non-3GPP access, perform registration attempt over the non-3GPP access; or b) if the 5GMM cause value is received over non-3GPP access, 3GPP access is available, the UE is not registered over 3GPP access yet, and the SIM/USIM is not considered invalid for 5GS services over 3GPP access, perform registration attempt over the 3GPP access; 3) if the 5GMM cause value received is #11 or #73 and the UE is in its HPLMN or EHPLMN: a) if the 5GMM cause value is received over 3GPP access, the UE shall: set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete, the 5G-GUTI, last visited registered TAI, TAI list, ngKSI for 3GPP if the UE is operating in single-registration mode, handle the EMM parameters EMM state, EPS update store the current TAI in the list of "5GS forbidden tracking areas for roaming", memorize the current TAI was stored in the list of "5GS forbidden tracking areas for roaming" for non-integrity protected NAS reject message and enter the state 5GMM-DEREGISTERED.
LIMITED-SERVICE; and b) if the 5GMM cause value is received over non-3GPP access, the UE shall: set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to may perform registration attempt over the non-3GPP access if another access point for non-3GPP access is available, or if 3GPP access is available, the UE is not registered over 3GPP access yet, and the SIM/USIM is not considered invalid for 5GS services over 3GPP access, perform registration attempt over the 3GPP access; 4) if the 5GMM cause value received is #11 or #73 and the UE is not in its HPLMN or EHPLMN, in addition to the UE requirements specified in subclause and : if the message was received via 3GPP access and if the PLMN-specific attempt counter for the PLMN if the message was received via non-3GPP access and if the PLMN-specific attempt counter for non-3GPP 5) if the 5GMM cause value received is #27, the UE shall proceed as specified in subclauses and may discard the message or alternatively the UE should: set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to store the current TAI in the list of "5GS forbidden tracking areas for roaming", memorize the current TAI was stored in the list of "5GS forbidden tracking areas for roaming" for non-integrity protected NAS 3GPP specification document [25C].
Upon expiry of timer T3247, the UE shall: the list of "5GS forbidden tracking areas for roaming", which were stored in these lists for non-integrity protected NAS reject message; remove all tracking areas from the list of "forbidden track ing areas for regional provision of service" and the list of "forbidden tracking areas for roaming" (see 3GPP specification document\), which were stored in these lists for non-integrity protected NAS reject message; set the USIM to valid for 5GS services for 3GPP access, if: set the USIM to valid for 5GS services for non-3GPP access, if: set the USIM to valid for non-EPS services, if: specific maximum value, remove the respective PLMN from the list of "forbidden PLMNs"; UE implementation-specific maximum value, remove the respective PLMN from the list of "forbidden PLMNs for non-3GPP access to 5GCN"; re-enable the N1 mode capability for 3GPP access and, for each PLMN-specific N1 mode attempt counter for remove the respective PLMN from the list of PLMNs where N1 mode is not allowed for 3GPP access (see 3GPP specification document\); re-enable the N1 mode capability for non-3GPP access and, for each PLMN-specific N1 mode attempt counter PLMN selection according to 3GPP specification document .
and less than the UE implementation-specific maximum value, remove the respective PLMN from the list of "forbidden PLMNs".
When the USIM is removed, the UE should perform this action.
NOTE 3: If the respective PLMN was stored in the extension of the "forbidden PLMNs" list, then according to 3GPP specification document the UE will delete the contents of this extension when the USIM is removed.
Requirements for UE in an SNPN If the UE is operating in SNPN access mode, the UE shall maintain, for each of the entries in the "list of subscriber data": The counter is applicable to access attempts via 3GPP access only; one SNPN-specific attempt counter for non-3GPP access.
The counter is applicable in case of accessing SNPN one counter for "the entry for the current SNPN considered invalid for 3GPP access" events, if the UE supports one counter for "the entry for the current SNPN considered invalid for non-3GPP access" events.
The counter is NOTE 1: The term "non-3GPP access" used in the counter for "SNPN-specific attempt counter for non-3GPP The UE implementation-specific maximum value for any of the above counters shall not be greater than 1 NOTE 2: Different counters can use different UE implementation-specific maximum values.
a) 15 minutes and 30 minutes for 5GMM cause value #74; or b) 30 minutes and 60 minutes for other 5GMM cause values; if the timer is not running, and take the following actions: Editor's note [WI: Vertical_LAN, CR#1453]: It is FFS whether 5GMM cause value # 72 "Non-3GPP access to 5GCN not allowed" is impacted by the requirements captured in the clause.
a) if the 5GMM cause value received is #3, #6, or #7: 1) if the 5GMM cause value is received over 3GPP access: i) if the UE is already registered over another access, the UE shall: A) store the current TAI in the list of "5GS forbidden tracking areas for roaming", memorize the current TAI was stored in the list of "5GS forbidden track ing areas for roaming" for non-integrity protected NAS reject message and enter the state 5GMM-DEREGISTERED.
LIMITED-SERVICE; and ii) otherwise if the counter for "the entry for the current SNPN considered invalid for 3GPP access" events B) increment the counter for "the entry for the curre nt SNPN considered invalid for 3GPP access" events; D) store the current TAI in the list of "5GS forbidden tracking areas for roaming" for the current SNPN, memorize the current TAI was stored in the list of "5GS forbidden tracking areas for roaming" for the current SNPN for non-integrity protected NAS reject message, and enter the state 5GMM-DEREGISTERED.
LIMITED-SERVICE; and iii) otherwise, the UE shall proceed as specified in subclauses and ; 2) if the 5GMM cause value is received over non-3GPP access: NOTE 3: A 5GMM cause value "received over non-3GPP access" in this subclause refers to a 5GMM cause value i) if the UE is already registered over another access, the UE shall enter the state 5GMM- ii) otherwise if the counter for "the entry for the current SNPN considered invalid for non-3GPP access" A) set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete the 5G-GUTI, last visited registered TAI, TAI list, and ngKSI for non-3GPP access; B) enter the state 5GMM-DEREGISTERED.
LIMITED-SERVICE; and C) increment the counter for "the entry for the cu rrent SNPN considered invalid for non-3GPP access" subscriber data" with the SNPN identity of the current SNPN is not considered invalid for 3GPP iii) otherwise, the UE shall proceed as specified in subclauses and ; b) if the 5GMM cause value received is #12, #13, or #15, the UE shall proceed as specified in subclauses and.
2) if the 5GMM cause value is received over non-3GPP access, 3GPP access is available, the UE is not registered to the current SNPN over 3GPP access yet, and the entry of the "list of subscriber data" with the SNPN identity of the current SNPN is not consid ered invalid for 3GPP access, the UE may make a registration attempt over 3GPP access; NOTE 4: The network does not send 5GMM cause value #13 to the UE operating in SNPN access mode in this c) if the 5GMM cause value received is #27, the UE shall proceed as specified in subclauses and the UE shall increment the SNPN-specific attempt counter for 3GPP access for the SNPN; or 2) if the message was received via non-3GPP access and if the SNPN-specific attempt counter for non-3GPP Upon expiry of timer T3247, the UE shall: remove, for each SNPN whose identity is included in the " list of subscriber data", all tracking areas from the list of "5GS forbidden tracking areas for regional provision of service" and the list of "5GS forbidden tracking areas for roaming", which were stored in these lists for non-integrity protected NAS reject message; set each entry of the "list of subscriber data" to valid for 3GPP access, if the corresponding counter for "the entry set each entry of the "list of subscriber data" to va lid for non-3GPP access, if the corresponding counter for "the remove each SNPN identity in the "list of subscriber data" from the "permanently forbidden SNPNs" list or remove each SNPN identity in the "list of subscriber data" from the "permanently forbidden SNPNs" list for non-3GPP access or "temporarily forbidden SNPNs" li st for non-3GPP access, if the corresponding SNPN- specific maximum value and the SNPN identity is included in any of the "permanently forbidden SNPNs" list for non-3GPP access or "temporarily forbidden SNPNs" list for non-3GPP access; and SNPN selection according to 3GPP specification document .
When the UE is switched off: implementation-specific maximum value, the UE shall remove the respective SNPN identity from the "permanently forbidden SNPNs" list or "temporarily forbidden SNPNs" list, if available; and UE implementation-specific maximum value, the UE shall remove the respective SNPN identity from the "permanently forbidden SNPNs" list for non-3GPP access or "temporarily forbidden SNPNs" list for non-3GPP access, if available.
When an entry of the "list of subscriber data" is updated: greater than zero and less than the UE implementation-specific maximum value, the UE shall remove the SNPN identity corresponding to the entry from the "permanently forbidden SNPNs" list or "temporarily forbidden SNPNs" list, if available; and greater than zero and less than the UE implementation-specific maximum value, the UE shall remove the SNPN identity corresponding to the entry from the "permanently forbidden SNPNs" list for non-3GPP access or "temporarily forbidden SNPNs" list for non-3GPP access, if available.
optimizations can indicate the 5GS CIoT network behaviour the UE can support and prefers to use during the registration procedure (see 3GPP specification document\).
The UE may indicate the support for control plane CIoT 5GS optimization, user plane CIoT 5GS optimization, N3 data transfer and header compression (see subclause\).
Furthermore, the UE may, separately from the indication of support, indicate preference for control plane CIoT 5GS optimization or user plane CIoT 5GS optimization (see subclause A).
The indication of preference is also considered as the request to use.
A UE supporting CIoT EPS optimizations can also indicate the EPS CIoT network behaviour the UE can support during the registration procedure.
Furthermore, the UE may, separately from the indication of support, indicate preference for control plane CIoT EPS optimization or user plane CIoT EPS optimization.
NOTE 1: CIoT 5GS optimizations are not supported by NR connected to 5GCN.
NOTE 2: If the UE does not support user plane CIoT 5GS optimization, it does not indicate preference for user plane CIoT 5GS optimization.
The UE can be in NB-N1 mode or WB-N1 mode when requesting the use of CIoT 5GS optimizations during the registration procedure.
A UE in NB-N1 mode always indicates support for control plane CIoT 5GS optimization.
In NB-N1 mode, the UE, when requesting the use of CIoT 5GS optimizations, does not: indicate UE's usage setting during the registration procedure.
The network does not indicate to the UE support of emergency services when the UE is in NB-N1 mode (see The control plane CIoT 5GS optimization enables support of efficient transport of user data (IP, Ethernet and The support of control plane CIoT 5GS optimization is mandatory for the network in NB-N1 mode and optional in WB-N1 mode.
Optional header compression of IP data and Ethe rnet data can be applied to PDU sessions with IP PDU session type and Ethernet PDU session type that are configured to support header compression.
For IP header compression, Robust Header Compression (ROHC) protocol specified in IETF RFC 5795 [39B] is used.
For Ethernet header compression, Ethernet Header Compression (EHC\) protocol specified in 3GPP specification document is used.
PLANE SERVICE REQUEST message when location services are requested (see subclause in 3GPP specification document [6B]).
If the UE supports user plane CIoT 5GS optimization, it shall also support N3 data transfer.
If the UE indicates support of one or more CIoT 5GS optimizations and the network supports one or more CIoT 5GS optimizations and decides to accept the registration request, the network indicates the supported CIoT 5GS optimizations to the UE per registration area when accep ting the UE request.
Network indication of support is UE and the network can then use the accepted CIoT 5GS optimizations for the transfer of user data (IP, Ethernet, Unstructured and SMS).
A UE in NB-N1 mode or WB-N1 mode can request the use of SMS over NAS by setting the SMS requested bit of the 5GS update type IE in the REGISTRATION REQUEST message as specified in subclauses and the SMS allowed bit of the 5GS registration result IE in the REGISTRATION ACCEPT message as specified in subclauses and a) if NEF PDU session is to be established for unstru ctured data type, the AMF includes Control plane only indication for the requested PDU session to the SMF; b) if N6 PDU session is to be established and the DNN or S-NSSAI of the newly requested N6 PDU session supports interworking with EPS as specified in specification document : 1) if there are existing N6 PDU sessions supporting interworking with EPS for this UE that were established with the Control plane only indication, the AMF includes the Control plane only indication for the newly requested N6 PDU session to the SMF; or 2) if there are existing N6 PDU sessions supporting interworking with EPS for this UE that were established without the Control plane only indication, the AMF does not include the Control plane only indication for the newly requested N6 PDU session to the SMF; 3) if there is no existing N6 PDU session supporting interworking with EPS for this UE, the AMF determines whether to include the Control plane only indication for the newly requested N6 PDU session to the SMF based on local policies, the UE's preferred CIoT network behaviour and the supported CIoT network behaviour; and c) if N6 PDU session is to be established and the DNN or S-NSSAI of the N6 PDU session does not support interworking with EPS as specified in specification document , the AMF determines whether to include the Control plane only indication for the newly requested N6 PDU session to the SMF based on local policies, the UE's preferred CIoT network behaviour and the supported CIoT network behaviour.
In NB-N1 mode, if the UE or the network does not support N3 data transfer, then when receiving the UE's request for a PDU session establishment, the AMF decides whether the PDU session should be NEF PDU session or N6 PDU session as specified in 3GPP specification document and then includes the Control plane only indication for the requested PDU session to the SMF.
If the network supports user plane CIoT 5GS optimization, it shall also support N3 data transfer.
Broadcast system information may provide information about support of CIoT 5GS optimizations (see 3GPP specification document [25A]).
At reception of new broadcast system information, the lower layers deliver it to the 5GMM layer in the UE.
The information provided by lower layers is per PLMN and used by the UE to determine whether certain CIoT 5GS optimizations are supported in the cell.
exceeds the UE' s maximum number of supported user-plane resources.
The UE in NB-N1 mode shall not: number of supported user-plane resources; or access to the 3GPP access, if: 1) the UE has indicated preference for user plane CIoT 5GS optimization; 2) the network accepted the use of user plane CIoT 5GS optimization; and 3) the UE currently has user-plane resources established fora number of PDU sessions that is equal to the UE' s maximum number of supported user-plane resources.
based on the UE's maximum number of supported user-plane resources as follows: resources support bit is set to "Multiple user-plane resources not supported", or user plane CIoT 5GS optimization, the UE shall pass an indication of the requested CIoT 5GS optimizations to the lower layers.
If the UE requests the use of N3 data transfer without user plane CIoT 5GS optimization, then the UE shall also pass an indication of user plane CIoT 5GS optimization to lower layers.
control plane CIoT 5GS optimization or user plane CIoT 5GS optimization, the UE shall pass an indication of the requested CIoT 5GS optimizations to the lower layers.
2 Interaction between MICO mode with active time and extended idle If the network accepts the use of both MICO mode with active time (see subclause\) and eDRX (see subclause 6), the extended DRX parameters provided to the UE should allow for multiple paging occasions before the active timer expires.
3 Forbidden wireline access area wireline access network with the 5GMM cause #77 "wireline access area not allowed": a) the 5G-RG shall not access 5GCN over the wireline access network until the 5G-RG is switched off, the UICC containing the USIM is removed, or the 5G-RG starts using another wireline access network; b) the W-AGF acting on behalf of the FN-CRG (or on behalf of the N5GC device) shall not access 5GCN until the W-AGF acting on behalf of the FN-CRG determines that the FN-CRG is switched off; and c) the W-AGF acting on behalf of the N5GC device shall not access 5GCN until the W-AGF acting on behalf of the FN-CRG determines that the FN-CRG serving the N5GC device is switched off.
A UE supporting reception of WUS assistance information in dicates its capability for reception of WUS assistance information during registration procedure (see 3GPP specification document\).
The UE supporting WUS assistance information may include its UE paging probability information in the Requested WUS assistance information IE in the REGISTRATION REQUEST message (see 3GPP specification document\).
The UE shall not include its UE paging probability information during an initial registration for emergency services.
The UE and the network may negotiate the UE paging probability information during registration procedure when the UE is not registered for emergency services .
The UE paging probability information is an assistance information used to determine the WUS group for paging UE (see 3GPP specification document , 3GPP specification document [25B]).
NOTE: The determination of UE paging probability information is up to UE implementation.
If the UE does not have emergency PDU session and the network accepts the use of the WUS assistance information for the UE, the network determines the negotiated UE paging probability information for the UE based on the requested UE paging probability information, if any, local configuration or previous statistical information for the UE, and then indicates the negotiated UE paging probability information in the Negotiated WUS assistance information IE to the UE in the REGISTRATION ACCEPT message.
The network shall store the negotiated UE paging probability information in the 5GMM context of the UE for paging.
the last registration procedure, the UE shall not use WUS assistance.
If the network did not accept the request to use WUS assist ance information, the network shall delete the stored negotiated UE paging probability information for the UE, if available.
When an emergency PDU session is successfully established after the UE received the Negotiated WUS assistance the successful completion of the PDU session release procedure of the emergency PDU session; or Primary authentication and key agreement procedure.
The purpose of the primary authentication and key agreement procedure is to enable mutual authentication between the UE and the network and to provide keying material that can be used between the UE and network in subsequent security procedures, as specified in 3GPP specification document .
Two methods are defined: a) EAP based primary authentication and key agreement procedure.
b) 5G AKA based primary authentication and key agreement procedure.
The UE and the AMF shall support the EAP based primary authentication and key agreement procedure and the 5G AKA based primary authentication and key agreement procedure.
EAP based primary authentication and key agreement procedure.
The purpose of the EAP based primary authentication and key agreement procedure is to pr ovide mutual authentication Extensible authentication protocol (EAP) as specified in IETF RFC 3748 enables authentication using various EAP methods.
EAP defines four types of EAP messages: a) an EAP-request message; b) an EAP-response message; c) an EAP-success message; and d) an EAP-failure message.
achieve the authentication (see example in figure\).
The EAP based primary authentication and key agreement proced ure is always initiated and controlled by the network.
The EAP-response message is transported from the UE to the network using the AUTHENTICATION RESPONSE message of the EAP message reliable transport procedure.
procedure after the EAP based primary authentication and key agreement procedure and the security mode control procedure intends to bring into use the partial native 5G NAS security context created by the EAP based primary authentication and key agreement procedure, then the EAP-success message and the ngKSI are transported from the network to the UE using the SECURITY MODE COMMAND message of the security mode control procedure (see subclause\).
control procedure bringing into use the partial native 5G NAS security context created by the EAP based primary authentication and key agreement procedure, then the EAP-success message, and the ngKSI are transported from the network to the UE using the AUTHENTICATION RESULT me ssage of the EAP result message transport procedure.
The AMF shall set the authenticator retransmission timer specified in IETF RFC 3748 subclause to infinite therefore retransmissions at the EAP layer do not occur.
The AUSF and the AMF support exchange of EAP messages using N1 The UE shall detect and handle any duplication of EAP message as specified in IETF RFC 3748 .
Stop T3560Start T3560AUTHENTICATION RESPONSE <EAP-response message to EAP-request message A> <EAP-response message to EAP-request message B> <EAP-failure message>ORSECURITY MODE COMMAND <EAP-success message or EAP-failure message>OR EAP based primary authentication and key agreement procedure The UE shall support acting as EAP-AKA' peer as specified in IETF RFC 5448 .
The AUSF may support acting as EAP-AKA' server as specified in IETF RFC 5448 .
The EAP-AKA' enables mutual authentication of the UE and the network.
The UE can reject the EAP-request/AKA'-challenge message sent by the network.
The UE shall proceed with an EAP- the USIM.
CK and IK are then used by the ME as key material to generate an EMSK.
In order to initiate the EAP based primary authentication and key agreement procedure using EAP-AKA', the AUSF shall send an EAP-request/AKA'-challenge message as specified in IETF RFC 5448 .
The AUSF shall set the AT_KDF_INPUT attribute of the EAP-request/AKA'-challenge message to the SNN.
The SNN is in format described in subclause The AUSF may include AT_RESULT_IND attribute in the EAP-request/AKA'-challenge message.
The network shall select an ngKSI value.
If an ngKSI is contained in an initial NAS message during a 5GMM along with each EAP message.
The network shall send the ABBA value as described in subclause 0 to the UE along with the EAP request message and EAP-success message.
the key derivation function indicated in AT_KDF attributes as specified in IETF RFC 5448 , and if the value of the Key derivation function field within the received AT _KDF attribute, is of value 1, shall check: a) whether the network name field of the AT_KDF_I NPUT attribute is the SNN constructed according to b) whether the network name field of the AT_KDF_INPUT attribute matches the PLMN identity or the SNPN identity saved in the UE.
When not operating in SNPN access mode, the PLMN identity the UE uses for the above network name check is as follows: a) when the UE moves from 5GMM-IDLE mode to 5GMM-CONNECTED mode, until the first handover, the UE shall use the PLMN identity of the selected PLMN; and b) after handover or inter-system change to N1 mode in 5GMM-CONNECTED mode: identity that is part of the 5G-GUTI; and shall use the PLMN identity that is part of the 4G-GUTI.
When operating in SNPN access mode, the SNPN identity the UE uses for the above network name check is the SNPN identity of the selected SNPN.
UE successfully authenticates network specified in IETF RFC 5448 .
The USIM shall derive CK and IK and compute the authentication response (RES) using the 5G authentication challenge data received from the ME, and pass RES to the ME.
The ME shall derive CK' and IK' from CK and IK, and EMSK from CK' and IK'.
Furthermore, the ME may generate K AUSF from the EMSK, the message as specified in IETF RFC 5448 .
If the EAP-request/AKA'-challenge message contains AT_RESULT_IND attribute, the UE may include AT_RESULT_IND attribute in the EAP-response/AKA'-challenge message as specified in IETF RFC 5448 .
Errors when handling EAP-request/AKA'-challenge message challenge message as specified in IETF RFC 5448 , the UE shall send an EAP-response/AKA'-authentication-reject message as specified in IETF RFC 5448 .
during handling of the EAP-request/AKA'-challenge message as specified in IETF RFC 5448 , the UE shall send an EAP-response/AKA'-synchronization-failure message as specified in IETF RFC 5448 .
error during handling of the EAP-request/AKA'-challenge message as specified in IETF RFC 5448 , the UE shall send an EAP-response/AKA'-client-error message as specified in IETF RFC 5448 .
For any of the above, the UE shall start timer T3520 when the AUTHENTICATION RESPONSE message containing the EAP-response message is sent.
Furthermore, the UE shall stop any of the retransmission timers that are running (e.
T3510, T3517 or T3521).
Upon receiving an AUTHENTICATION REQUEST message with the EAP message IE containing an EAP-request/AKA'-challenge from the network, the UE shall stop timer T3520, if running, and then process the EAP-request/AKA'-challenge information as normal.
Network successfully authenticates UE Upon reception of the EAP-response/AKA'-challenge message, if procedures for handling an EAP-response/AKA'- challenge message as specified in IETF RFC 5448 are successful, the AUSF shall generate EMSK, the K AT_RESULT_IND attribute is included in the EAP-response/AKA'-challenge message and: a) if the AT_RESULT_IND attribute is included in the EAP-response/AKA'-challenge message, the AUSF shall send an EAP-request/AKA'-notification message as specified in IETF RFC 5448 ; and b) if the AT_RESULT_IND attribute is not included in the EAP-response/AKA'-challenge message, the AUSF shall send an EAP-success message as specified in IETF RFC 5448 and shall consider the procedure complete.
NOTE: The AUSF provides the K UE handling EAP-AKA' notification message Upon receiving an EAP-request/AKA'-notification message, the UE shall send an EAP-response/AKA'-notification message as specified in IETF RFC 5448 .
A EAP based Identification initiation by the network If AUSF decides to initiate the EAP based identification procedure, the AUSF shall send an EAP-Request/Identity or EAP-Request/AKA'-Identity message as specified in IETF RFC 5448 .
Upon receipt of the AUTHENTICATION REQUEST message with EAP-Request/Identity message the UE shall send an AUTHENTICATION RESPONSE message with EAP-Response/Identity to the network.
In the EAP- Response/Identity message, the UE shall provide the requested identity according to 3GPP specification document annex F.
2, in the UE identity in the EAP-Response/Identity message as specified in IETF RFC 5448 .
Upon receipt of the AUTHENTICATION REQUEST message with EAP-Request/AKA'-Identity message the UE shall 3GPP specification document annex F.
2, in the EAP-Response/AKA'-Identity message, as specified in IETF RFC 5448 .
If the EAP-Request/AKA'-Identity carries the AT_PERMANENT_REQ, the UE shall respond with EAP- Response/AKA'-Client-Error with the error code "unable to process packet".
Network sending EAP-success message Upon reception of the EAP-response/AKA'-notification message, if earlier procedures for handling an EAP- request/AKA'-challenge message as specified in IETF RFC 5448 were successful, the AUSF shall send an EAP-success message as specified in IETF RFC 5448 and shall consider the procedure complete.
NOTE: The AUSF provides the K UE handling EAP-success message described in subclause , the ME shall: The UE shall consider the procedure complete.
Network not successfully authenticates UE Upon reception of the EAP-response/AKA'-challenge message, if procedures for handling an EAP-response/AKA'- challenge message as specified in IETF RFC 5448 are not successful, the AUSF shall send an EAP-request/AKA'- notification message that implies failure as specified in IETF RFC 5448 .
0 Network sending EAP-failure message Upon reception of the EAP-response/AKA'-notification message, if earlier procedures for handling an EAP- request/AKA'-challenge message as specified in IETF RFC 5448 were not successful, the AUSF shall send an EAP-failure message as specified in IETF RFC 5448 and shall consider the procedure complete.
If the authentication response (RES) returned by the UE in the AT_RES attribute of the EAP-response/AKA'-challenge message is not valid, the network handling depends upon the type of identity used by the UE in the initial NAS message, that is: if the 5G-GUTI was used; or message of the EAP result message transport procedure, initia te an identification procedure to retrieve SUCI from the UE and restart the EAP based primary authentication and key agreement procedure with the received SUCI.
and key agreement procedure, or the network decides not to initiate the identification procedure to retrieve SUCI from the UE after an unsuccessful EAP based primary authentic ation and key agreement procedure, the network should transport the EAP-failure message in an AUTHENTICATION REJECT message of the EAP result message transport procedure.
procedure with 5GS registration type IE set to "emergency registration" and the AMF is configured to allow emergency registration without user identity, the AMF needs not follow the procedures specified for transporting the EAP-failure 1 UE handling EAP-failure message Upon receiving an EAP-failure message, the UE shall delete the partial native 5G NAS security context if any was created as described in subclause The UE shall consider the procedure complete.
If the EAP-failure message is received in an AUTHENTICATION REJECT message: 1) if the AUTHENTICATION REJECT message has been successfully integrity checked by the NAS: The UE shall set the update status to 5U3 ROAMING NOT ALLOWED, delete the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI; In case of PLMN, the USIM shall be considered inva lid until switching off the UE or the UICC containing the USIM is removed; In case of SNPN, the entry of the "list of subscriber data" with the SNPN identity of the current SNPN shall be considered invalid until the UE is switched off or the entry is updated.
Additionally, the UE shall consider the USIM as invalid for the current SNPN until switching off or the UICC containing the USIM is removed; The UE shall set: i) the counter for "SIM/USIM considered invalid for GPRS services" events, the counter for "USIM considered invalid for 5GS services over non-3GPP access" events, and the counter for "SIM/USIM considered invalid for non-GPRS services" events if maintained by the UE, in case of PLMN; or ii) the counter for "the entry for the current SNPN considered invalid for 3GPP access" events and the counter for "the entry for the current SNPN considered invalid for non-3GPP access" events in case of SNPN; to UE implementation-specific maximum value; and If the UE is operating in single-registration mode, the UE shall handle EMM parameters, 4G-GUTI, last visited registered TAI, TAI list and eKSI as specified in 3GPP specification document for the case when the authentication procedure is not accepted by the network.
The USIM shall be considered as invalid also for non-EPS services until switching off or the UICC containing the USIM is removed; and 2) if the AUTHENTICATION REJECT message is received without integrity protection, the UE shall start timer a) if the AUTHENTICATION REJECT message is received over 3GPP access, and the counter for "SIM/USIM considered invalid for GPRS services" events in case of PLMN or the counter for "the entry for the current of subclause (if the UE is not operating in SNPN access mode) or list item a)-2) of subclause (if the UE is operating in SNPN access mode) for the case that the 5GMM cause value received is #3; i) if the AUTHENTICATION REJECT message is received over 3GPP access: The UE shall set the update status for 3GPP access to 5U3 ROAMING NOT ALLOWED, delete for 3GPP access only the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI.
In case of PLMN, the UE shall consider the USIM as invalid for 5GS services via 3GPP access and invalid for non-EPS service until switching off the UE or the UICC containing the USIM is removed.
In case of SNPN, the UE shall consider the entry of the "list of subscriber data" with the SNPN identity of the current SNPN shall be considered invalid for 3GPP access until the UE is switched off or the entry is updated.
Additionally, the UE shall consider the USIM as invalid for the current SNPN via 3GPP access until switching off or the UICC containing the USIM is removed.
The UE shall set: the counter for "SIM/USIM considered invalid for GPRS services" events and the counter for "SIM/USIM considered invalid for non-GPRS services" events if maintained by the UE, in case of PLMN; or the counter for "the entry for the current SNPN considered invalid for 3GPP access" events in case to UE implementation-specific maximum value.
If the UE is operating in single-registration mode, the UE shall handle 4G-GUTI, TAI list and eKSI as specified in 3GPP specification document for the case when the authentication pro cedure is not accepted by the network.
The USIM shall be considered as invalid also for non-EPS services until switching off or the UICC containing the USIM is removed; and ii) if the AUTHENTICATION REJECT message is received over non-3GPP access: the UE shall set the update status for non-3GPP access to 5U3 ROAMING NOT ALLOWED, delete for non-3GPP access only the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI; in case of PLMN, the UE shall consider the USIM as invalid for 5GS services via non-3GPP access until switching off the UE or the UICC containing the USIM is removed.
In case of SNPN, the UE shall consider the entry of the "list of subscriber data" with the SNPN identity of the current SNPN as invalid for non-3GPP access until the UE is switched off or the entry is updated.
Additionally, the UE shall consider the USIM as invalid for the current SNPN and for non-3GPP access until switching off or the UICC containing the USIM is removed; and the UE shall set: implementation-specific maximum value in case of PLMN; or the counter for "the entry for the current SNPN considered invalid for non-3GPP access" events to UE implementation-specific maximum value in case of SNPN.
If the AUTHENTICATION REJECT message is received by the UE, the UE shall abort any 5GMM signalling procedure, stop any of the timers T3510, T3517, T3519 or T3521 (if they were running), enter state 5GMM- DEREGISTEREDand delete any stored SUCI.
a) EAP-request/AKA'-challenge message with the key derivation function indicated in AT_KDF attributes set to a The UE shall act as specified in IETF RFC 5448 subclause for the case when the AUTN had been.
The UE may support acting as EAP-TLS peer as specified in 3GPP specification document .
The AUSF may support acting as EAP-TLS server as specified in 3GPP specification document .
The EAP-TLS enables mutual authentication of the UE and the network.
When initiating an EAP based primary authentication and key agreement procedure using EAP-TLS, the network shall select an ngKSI value.
If an ngKSI is contained in an in itial NAS message during a 5GMM procedure, the network shall message.
The network shall send the ABBA value as described in subclause 0 to the UE along with the EAP-request message and EAP-success message.
When the EAP based primary authentication and key agreem ent procedure uses EAP-TLS, the ME and the AUSF shall as described in 3GPP specification document .
ngKSI value received together with the EAP-request message in subclause , in the volatile memory of the partial native 5G NAS security context.
If the UE does not accept the server certificate of the network, the UE shall start timer T3520 when the AUTHENTICATION RESPONSE message containing the EAP-response message is sent.
Furthermore, the UE shall stop any of the retransmission timers that are runni ng (e.
T3510, T3517 or T3521).
Upon receiving an AUTHENTICATION REQUEST message with the EAP message IE containing an EAP-request message from the network, the UE shall stop timer T3520, if running, and then process the EAP-request message as normally.
If the network does not accept the client certificate of the UE, the network handling depends upon the type of identity used by the UE in the initial NAS message, that is: if the 5G-GUTI was used; or if the SUCI was used.
If the 5G-GUTI was used, the network should transport the EAP-failure message in the AUTHENTICATION RESULT message of the EAP result message transport procedure, initia te an identification procedure to retrieve SUCI from the UE and restart the EAP based primary authentication and key agreement procedure with the received SUCI.
procedure with 5GS registration type IE set to "emergency registration" and the AMF is configured to allow emergency registration without user identity, the AMF needs not follow the procedures specified for transporting the EAP-failure If the EAP-failure message is received in an AUTHENTICATION REJECT message: a) if the AUTHENTICATION REJECT message has been successfully integrity checked by the NAS: 1) the UE shall set the update status to 5U3 ROAMING NOT ALLOWED, delete the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI.
In case of PLMN, the USIM shall be considered inva lid until switching off the UE or the UICC containing the USIM is removed; In case of SNPN, the entry of the "list of subscriber data" with the SNPN identity of the current SNPN shall be considered invalid until the UE is switched off or the entry is updated; 2) the UE shall set: i) the counter for "SIM/USIM considered invalid for GPRS services" events, the counter for "USIM considered invalid for 5GS services over non-3GPP access" events, and the counter for "SIM/USIM considered invalid for non-GPRS services" events if maintained by the UE, in case of PLMN; or ii) the counter for "the entry for the current SNPN considered invalid for 3GPP access" events and the counter for "the entry for the current SNPN considered invalid for non-3GPP access" events in case of SNPN; NOTE 2: The term "non-3GPP access" used in the counter for "the entry for the current SNPN considered invalid to UE implementation-specific maximum value; and 3) if the UE is operating in single-registration mode, the UE shall handle EMM parameters, 4G-GUTI, last visited registered TAI, TAI list and eKSI as specified in 3GPP specification document for the case when the authentication procedure is not accepted by the network.
The USIM shall be considered as invalid also for non-EPS services until switching off or the UICC containing the USIM is removed; and b) if the AUTHENTICATION REJECT message is received without integrity protection, the UE shall start timer not running (see subclause 0).
Additionally, the UE shall: 1) if the AUTHENTICATION REJECT message is received over 3GPP access, and the counter for "SIM/USIM considered invalid for GPRS services" events in case of PLMN or the counter for "the entry for the current 2) if the AUTHENTICATION REJECT message is received over non-3GPP access, and the counter for "USIM subclause (if the UE is operating in SNPN access mode) for the case that the 5GMM cause value received is #3; or 3) otherwise: 3GPP access only the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI.
In case of PLMN, the UE shall consider the USIM as invalid for 5GS services via 3GPP access and invalid for non-EPS service until switching off the UE or the UICC containing the USIM is removed.
In case of SNPN, the UE shall consider the entry of the "list of subscriber data" with the SNPN identity of the current SNPN shall be considered invalid for 3GPP access until the UE is switched off or the entry is updated; B) the UE shall set: the counter for "SIM/USIM considered invalid for GPRS services" events and the counter for "SIM/USIM considered invalid for non-GPRS services" events if maintained by the UE, in case of PLMN; or the counter for "the entry for the current SNPN considered invalid for 3GPP access" events in case to UE implementation-specific maximum value; and C) If the UE is operating in single-registration mode, the UE shall handle 4G-GUTI, TAI list and eKSI as specified in 3GPP specification document for the case when the authentication pro cedure is not accepted by the UICC containing the USIM is removed; and ii) if the AUTHENTICATION REJECT message is received over non-3GPP access: A) the UE shall set the update status for non-3GPP access to 5U3 ROAMING NOT ALLOWED, delete for non-3GPP access only the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI.
In case of PLMN, the USIM shall be considered invalid for 5GS services via non-3GPP access until switching off the UE or the UICC containing the USIM is removed.
In case of SNPN, the UE shall consider the entry of the "list of subscriber data" with the SNPN identity of the current SNPN shall be considered invalid for non-3GPP access until the UE is switched off or the entry is updated; and B) the UE shall set the counter for "USIM considered invalid for 5GS services over non-3GPP access" events in case of PLMN or the counter for "the entry for the current SNPN considered invalid for non-3GPP access" events in case of SNPN to UE implementation-specific maximum value.
If the AUTHENTICATION REJECT message is received by the UE, the UE shall abort any 5GMM signalling procedure, stop any of the timers T3510, T3517, T3519 or T3521 (if they were running), enter state 5GMM-DEREGISTERED and delete any stored SUCI.
handling the EAP-request message which resulted into generation of EMSK as described above , the ME shall generate native 5G NAS security context.
The UE shall consider the procedure complete.
Upon receiving an EAP-failure message, the UE shall delete the partial native 5G NAS security context if any was created when handling the EAP-request message which resulted into generation of EMSK as described above.
The UE shall consider the procedure complete.
A Procedures related to EAP methods other than EAP-AKA' and EAP-TLS.
This subclause applies when an EAP method: b) supporting EMSK generation; and c) other than EAP-AKA' and EAP-TLS; is used for primary authentication and key agreement in an SNPN.
The UE may support acting as EAP peer of such EAP method as specified in 3GPP specification document .
The AUSF may support acting as EAP server of such EAP method as specified in 3GPP specification document .
When initiating an EAP based primary authentication and key agreement procedure using such EAP method, the each EAP message.
The network shall send the ABBA value as described in subclause 0 to the UE along with the EAP-request message and EAP-success message.
When the EAP based primary authentication and key agreement procedure uses such EAP method, the ME and the AUSF shall generate EMSK as described in 3GPP specification document .
When handling of an EAP-request message results into generation of EMSK, the ME may generate the K ngKSI value received together with the EAP-request message in subclause , in the volatile memory of the partial native 5G NAS security context.
If the UE fails to authenticate the network, the UE shall start timer T3520 when the AUTHENTICATION RESPONSE message containing the EAP-response message is sent.
Furthermore, the UE shall stop any of the retransmission timers that are running (e.
T3510, T3517 or T3521).
Upon receiving an AUTHENTICATION REQUEST message with the EAP message IE containing an EAP-request message from the network, the UE shall stop timer T3520, if running, and then process the EAP-request message as normally.
If the network fails to authenticate the UE, the network handling depends upon the type of identity used by the UE in the initial NAS message, that is: if the 5G-GUTI was used; or if the SUCI was used.
If the 5G-GUTI was used, the network should transport the EAP-failure message in the AUTHENTICATION RESULT message of the EAP result message transport procedure, initia te an identification procedure to retrieve SUCI from the UE and restart the EAP based primary authentication and key agreement procedure with the received SUCI.
and key agreement procedure, or the network decides not to initiate the identification procedure to retrieve SUCI from the UE after an unsuccessful the EAP based primary authen tication and key agreement procedure, the network should transport the EAP-failure message in an AUTHENTICATION REJECT message of the EAP result message transport procedure.
If the EAP-failure message is received in an AUTHENTICATION REJECT message: a) if the AUTHENTICATION REJECT message has been successfully integrity checked by the NAS: 1) the UE shall set the update status to 5U3 ROAMING NOT ALLOWED, delete the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI.
The entry of the "list of subscriber data" with the SNPN identity of the current SNPN shall be considered invalid until the UE is switched off or the entry is updated; and of SNPN to UE implementation-specific maximum value; and NOTE 2: The term "non-3GPP access" used in the counter for "the entry for the current SNPN considered invalid b) if the AUTHENTICATION REJECT message is received without integrity protection, the UE shall start timer 1) if the AUTHENTICATION REJECT message is received over 3GPP access, and the counter for "the entry specific maximum value, proceed as specified in list item a) 1) of subclause for the case that the 5GMM cause value received is #3; 2) if the AUTHENTICATION REJECT message is received over non-3GPP access, and the counter for "the i) if the AUTHENTICATION REJECT message is received over 3GPP access: the UE shall set the update status for 3GPP access to 5U3 ROAMING NOT ALLOWED, delete for 3GPP access only the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI.
The entry of the "list of subscriber data" with the SNPN identity of the current SNPN shall be considered invalid for 3GPP access until the UE is switched off or the entry is updated; and events to UE implementation-specific maximum value; and ii) if the AUTHENTICATION REJECT message is received over non-3GPP access: the UE shall set the update status for non-3GPP access to 5U3 ROAMING NOT ALLOWED, delete for non-3GPP access only the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI.
The entry of the "list of subscriber data" with the SNPN identity of the current SNPN shall be considered invalid for non-3GPP access until the UE is switched off or the entry is updated; and the UE shall set the counter for "the entry for the current SNPN considered invalid for non-3GPP access" events to UE implementation-specific maximum value.
NOTE 3: The AUTHENTICATION REJECT message "received over non-3GPP access" in this subclause refers to If the AUTHENTICATION REJECT message is received by the UE, the UE shall abort any 5GMM signalling procedure, stop any of the timers T3510, T3517, T3519 or T3521 (if they were running), enter state 5GMM-DEREGISTERED and delete any stored SUCI.
handling the EAP-request message which resulted into generation of EMSK as described above , the ME shall generate native 5G NAS security context.
The UE shall consider the procedure complete.
Upon receiving an EAP-failure message, the UE shall delete the partial native 5G NAS security context if any was created when handling the EAP-request message which resulted into generation of EMSK as described above .
The UE shall consider the procedure complete.
This subclause applies when an EAP method: a) supporting mutual authentication; and b) other than EAP-AKA', is used for primary authentication of an N5GC device, when an W-AGF supports acting on behalf of the N5GC device, the AMF supports serving the W-AGF acting on behalf of the N5GC device and the AUSF supports authentication of the N5GC device.
EAP-TLS is an example of such EAP method.
NOTE 1: Neither the N5GC device nor the AUSF derive any 5G related keys during or after the primary 3GPP specification document , which is also supported by the AUSF.
The W-AGF acting on behalf of the N5GC device provides to the N5GC device an EAP-request message, an EAP- success message or an EAP-failure message received from the network according to subclause and sends to the network according to subclause an EAP-respon se provided by the N5GC device.
The N5GC device can inform the W-AGF acting on behalf of the N5GC device that the N5GC device fails to authenticate the network.
Details of communication between the N5GC device and the W-AGF acting on behalf of the N5GC device are out of scope of When initiating an EAP based primary authentication and key agreement procedure using such EAP method, the network shall select an ngKSI value.
The network shall send the selected ngKSI value to the W-AGF acting on behalf of the N5GC device along with each EAP message.
The network shall send the ABBA value as described in subclause 0 to the W-AGF acting on behalf of the N5GC device along with the EAP-request message and EAP-success message.
The W-AGF acting on behalf of the N5GC device shall not forward the ngKSI value or the ABBA value to the N5GC device.
NOTE 2: The network provides the ngKSI value and the ABBA value since the ngKSI IE and the ABBA IE are mandatory IEs in AUTHENTICATION REQUEST message.
The W-AGF acting on behalf of the N5GC device does not use the ngKSI value or the ABBA value provided by the network.
If the N5GC device fails to authenticate the network, the W- AGF acting on behalf of the N5GC device shall start timer T3520 when the AUTHENTICATION RESPONSE message containing the EAP-response message is sent.
Furthermore, the W-AGF acting on behalf of the N5GC device shall stop any of the retransmission timers that are running (e.
T3510, T3517 or T3521).
Upon receiving an AUTHENTICATION REQUEST message with the EAP message IE containing an EAP-request message from the network, the W-AGF acting on behalf of the N5GC device shall stop timer T3520, if running, and then provides the EAP-request message to the N5GC device as normally.
If the network fails to authenticate the N5GC device, the network handling depends upon the type of identity used by the W-AGF acting on behalf of the N5GC device in the initial NAS message, that is: a) if the 5G-GUTI was used; or b) if the SUCI was used.
If the 5G-GUTI was used, the network should transport the EAP-failure message in the AUTHENTICATION RESULT message of the EAP result message transport procedure, initia te an identification procedure to retrieve SUCI from the W-AGF acting on behalf of the N5GC device and restart the EAP based primary authentication and key agreement procedure with the received SUCI.
and key agreement procedure, or the network decides not to initiate the identification procedure to retrieve SUCI from the W-AGF acting on behalf of the N5GC device after an unsuccessful EAP based primary authentication and key If the EAP-failure message is received in an AUTHENTICATION REJECT message, the W-AGF acting on behalf of b) otherwise, set the update status to 5U3 ROAMING NOT ALLOWED, delete the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI.
The USIM shall be considered invalid for 5GS services via non-3GPP access until switching off or the UICC containing the USIM is removed.
If the AUTHENTICATION REJECT message is received by the W-AGF acting on behalf of the N5GC device, the W-AGF acting on behalf of the N5GC device shall abort any 5GMM signalling procedure, stop any of the timers T3510, T3517, T3519 or T3521 (if they were running), enter state 5GMM-DEREGISTERED and delete any stored SUCI.
Upon receiving an EAP-success message, the W-AGF acting on behalf of the N5GC device shall consider the Upon receiving an EAP-failure message, the W-AGF acting on behalf of the N5GC device shall consider the procedure EAP message reliable transport procedure.
message, the ngKSI and the ABBA from the network to the UE and of an EAP-response message from the UE to the The EAP message reliable transport procedure is initiat ed by an AUTHENTICATION REQUEST message with the EAP message reliable transport procedure initiation by the network In order to initiate the EAP message reliable transport procedure, the AMF shall create an AUTHENTICATION The AMF shall set the EAP message IE of the AUTHENTICATION REQUEST message to the EAP-request message to be sent to the UE.
The AMF shall set the ngKSI IE of the AUTHENTICATION REQUEST message to the ngKSI value selected in subclause , subclause or subclause In this release of specification, the AMF shall set the ABBA IE of the AUTHENTICATION REQUEST message with the length of ABBA IE to 2 and the ABBA contents to be 2 octets in length with value 0000H as described in subclause The AMF shall send the AUTHENTICATION REQUEST message to the UE, and the AMF shall start timer T3560 (see example in figure\).
EAP message reliable transport procedure Upon receipt of an AUTHENTICATION REQUEST message with the EAP message IE, the UE handles the EAP message received in the EAP message IE and the ABBA of the AUTHENTICATION REQUEST message.
EAP message reliable transport procedure accepted by the UE The UE shall create an AUTHENTICATION RESPONSE message.
If the received EAP message is an EAP-request message, the UE shall set the EAP message IE of the AUTHENTICATION RESPONSE message to the EAP-response message responding to the received EAP-request message.
The UE shall send the AUTHENTICATION RESPONSE message to the AMF.
Upon receipt of an AUTHENTICATION RESPONSE message, the AMF shall stop timer T356 If the EAP message IE is included in the AUTHENTICATION RESPONSE message, the AMF handles the EAP message received in the EAP message IE of the AUTHENTICATION RESPONSE message.
Abnormal cases on the network side The following abnormal cases can be identified: a) Expiry of timer T356 The AMF shall, on the first expiry of the timer T3560, retransmit the AUTHENTICATION REQUEST message and shall reset and start timer T356 This retransmission is repeated four times, i.
on the fifth expiry of timer T3560, the AMF shall abort the EAP based primary au thentication and key agreement procedure and any ongoing 5GMM specific procedure, and release the N1 NAS signalling connection.
b) Lower layers indication of non-delivered NAS PDU due to handover.
If the AUTHENTICATION REQUEST message could not be delivered due to an intra AMF handover and the target TA is included in the TAI list, then upon successful completion of the intra AMF handover the AMF shall Abnormal cases in the UE The following abnormal cases can be identified: NOTE 1: Upon receipt of an AUTHENTICATION FAILURE message from the UE with 5GMM cause #71 "ngKSI already in use", the network can also re-initiate the EAP based primary authentication and key agreement procedure (see subclause\).
request message from the network, the UE shall stop timer T3520, if running, process the EAP-request message as normal.
ngKSI and EAP-request message is received), the UE shall send the AUTHENTICATION RESPONSE message to the network and shall start any retransmission timers (e.
T3510, T3517 or T3521) if they were running and stopped when the UE received the first failed AUTHENTICATION REQUEST message.
b) Transmission failure of AUTHENTICATION RESPONSE message or AUTHENTICATION FAILURE The UE shall stop the timer T3520, if running, and re-initiate the registration procedure for mobility and periodic c) Transmission failure of AUTHENTICATION RESPONSE message or AUTHENTICATION FAILURE The UE shall stop the timer T3520, if running.
If the current TAI is not in the TAI list, the EAP based primary authentication and key agreement procedure If the current TAI is still part of the TAI list, it is up to the UE implementation how to re-run the ongoing d) Transmission failure of AUTHENTICATION RESPONSE message or AUTHENTICATION FAILURE message indication without TAI change from lower layers (if the authentication procedure is triggered by a The UE shall stop the timer T3520, if running.
It is up to the UE implementation how to re-run the ongoing e) Network failing the authentication check.
If the UE deems that the network has failed the authentication check, then it shall request RRC to locally release the RRC connection and treat the active cell as barred (see 3GPP specification document\).
The UE shall start any retransmission timers (e.
T3510, T3517 or T3521), if they were running and stopped when the UE received the first AUTHENTICATION REQUEST message containing an ngKSI that was already in use.
The UE shall stop timer T3520, if the timer is running and the UE enters 5GMM-IDLE mode, e.
upon The UE shall deem that the network has failed the authentication check or assume that the authentication is not the timer T3520 expires; the UE detects any combination of the EAP-based authentication failures: transmission of AUTHENTICATION FAILURE message with 5GMM cause #71 "ngKSI already in use", transmission of AUTHENTICATION RESPONSE message with an EAP-response message after detecting an error as of the server certificate shall be co nsidered as consecutive only, if the EAP-request messages causing the second and third not accepting of the server certificate are received by the UE, while the timer T3520 started after the previous EAP request message causing the previous not accepting of the server certificate is running.
NOTE 2: Reception of an EAP-failure message is not considered when determining the three consecutive authentication challenges or three consecutive not accepting of the server certificate.
AUTHENTICATION FAILURE message to the AMF with the 5GMM cause appropriate for this cases (i.
#71) or an AUTHENTICATION RESPONSE message containing an EAP-response message as described in subclause , containing an EAP-response message after not accepting of the server certificate as described in subclause or containing an EAP-response message after failing to authenticate the network as described in subclause A.
1, and receives the SECURITY MODE COMMAND message before the timeout of timer T3520, the UE shall deem that the network has passed the authentication check successfully, stop timer T3520, respectively, and execute the security mode control procedure.
T3520 expires, the UE shall not deem that the network has failed the authentication check and not behave as described in item e.
Instead the UE shall continue using the current security context, if any, release all non-emergency PDU sessions, if any, by initiating UE-requested PDU session release procedure.
If there is an ongoing PDU session establishment procedure, the UE shall release all non-emergency PDU sessions upon completion of the PDU session establishment procedure.
The UE shall start any retransmission timers (e.
they were running and stopped when the UE received the AUTHENTICATION REQUEST message and detected an authentication failure; the procedures associated with these timers have not yet been completed.
The UE shall consider itself to be registered for emergency services.
EAP result message transport procedure.
The purpose of the EAP result message transport procedure is to provide an EAP-success message or an EAP-failure message, and ngKSI from the network to the UE, when the EAP message cannot be piggybacked by another NAS The EAP result message transport procedure is initiated: by an AUTHENTICATION RESULT message with the EAP message IE carrying the EAP-success message or the EAP-failure message; or by an AUTHENTICATION REJECT message with the EAP message IE carrying the EAP-failure message.
EAP result message transport procedure initiation by the network In order to initiate the EAP result message transport procedure, the AMF shall create an AUTHENTICATION RESULT message or an AUTHENTICATION REJECT message.
The AMF shall set the EAP message IE of the AUTHENTICATION RESULT message to an EAP-success message or an EAP-failure message to be sent to the UE.
The AMF shall set the EAP message IE of the AUTHENTICATION REJECT message to an EAP-failure message to be sent to the UE.
The AMF shall set the ngKSI IE of the The AMF shall send the AUTHENTICATION RESULT message or the AUTHENTICATION REJECT message to the UE (see example in figure\).
EAP result message transport procedure Upon receipt of an AUTHENTICATION RESULT message or an AUTHENTICATION REJECT message with the EAP message IE, the UE handles the EAP message received in the EAP message IE and the ABBA if received of the AUTHENTICATION RESULT message or in the AUTHENTICATION REJECT message.
5G AKA based primary authentication and key agreement procedure.
The cases when the 5G AKA based primary authentication and key agreement procedure is used are defined in 3GPP specification document .
The network initiates the 5G AKA based primary authentication and key agreement procedure by sending an AUTHENTICATION REQUEST message to the UE without the EAP message IE.
The network shall include the ngKSI and the ABBA in AUTHENTICATION REQUEST message.
The 5G AKA based primary authentication and key agreement procedure is always initiated and controlled by the network.
However, the UE can reject the 5G authentication challenge sent by the network.
A partial native 5G NAS security context is established in the UE and the network when a 5G authentication is AMF.
K AMF is stored in the 5G NAS security contexts (see 3GPP specification document\) of both the network and in the volatile memory of the ME while registered to the network, and is the root for the 5GS integrity protection and ciphering key hierarchy.
The 5G AKA based primary authentication and key agreement procedure is initiated by an AUTHENTICATION REQUEST message without the EAP message IE.
CONNECTED mode at any time.
For restrictions applicable after handover or inter-system change to N1 mode in 5GMM-CONNECTED mode, see subclause The network initiates the 5G AKA based primary authentication and key agreement procedure by sending an AUTHENTICATION REQUEST message to the UE and starting the timer T3560 (see example in figure\).
The AUTHENTICATION REQUEST message shall contain the parameters necessary to calculate the authentication response (see 3GPP specification document\).
This message shall include the ngKSI that will be used by the UE and AMF to AMF and the partial native security context that is created if the authentication is successful.
This message shall also include the ABBA parameter.
In this release of specification, the network shall set the length of ABBA IE to 2 and the ABBA contents to be 2 octets in length with value 0000H as described in subclause ngKSI value in the AUTHENTICATION REQUEST message when it initiates a 5G AKA based primary authentication and key agreement procedure.
5G AKA based primary authentication and key agreement procedure Authentication response by the UE The UE shall respond to an AUTHENTICATION REQUEST message.
With the exception of the cases described in subclause , the UE shall process the 5G authentication challenge data and respond with an AUTHENTICATION RESPONSE message to the network.
of the new K AMF from the 5G authentication challenge data according to the following rules: a) When the UE moves from 5GMM-IDLE mode to 5GMM-CONNECTED mode, until the first handover, the UE shall use the PLMN identity of the selected PLMN; and b) After handover or inter-system change to N1 mode in 5GMM-CONNECTED mode, identity that is part of the 5G-GUTI; and shall use the PLMN identity that is part of the 4G-GUTI.
shall store the received RAND together with the RES*, in the volatile memory of the ME.
When the UE receives a subsequent AUTHENTICATION REQUEST message, if the stored RAND value is equal to the new received value in the AUTHENTICATION REQUEST message, then the ME shall not pass the RAND to the USIM, but shall send the AUTHENTICATION RESPONSE message with the stored RES*.
If there is no valid stored RAND in the ME or the stored RAND is different from the new received value in the AUTHENTICATION REQUEST message, the ME shall pass the RAND to the USIM, shall override any previously stored RAND and RES* with the new ones and start, or reset and restart timer T351 The RAND and RES* values stored in the ME shall be deleted and timer T3516, if running, shall be st opped: a) upon receipt of a 1) SECURITY MODE COMMAND message, 2) SERVICE REJECT message, 3) REGISTRATION REJECT message, 4) REGISTRATION ACCEPT message, 5) AUTHENTICATION REJECT message, or 6) SERVICE ACCEPT message; b) upon expiry of timer T3516; c) if the UE enters the 5GMM state 5GMM-DEREGISTERED or 5GMM-NULL; or d) if the UE enters 5GMM-IDLE mode.
Authentication completion by the network Upon receipt of an AUTHENTICATION RESPONSE message, the network stops the timer T3560 and checks the correctness of RES* (see 3GPP specification document\).
If the 5G AKA based primary authentication and key agreement procedure has been completed successfully and the Upon receipt of an AUTHENTICATION FAILURE message, the network stops the timer T356 In the case where the 5GMM cause #21 "synch failure" is received, the core network may renegotiate with the UDM/AUSF and provide the UE with new authentication parameters.
Authentication not accepted by the network If the authentication response (RES) returned by the UE is not valid, the network response depends upon the type of identity used by the UE in the initial NAS message, that is: if the 5G-GUTI was used; or if the SUCI was used.
If the 5G-GUTI was used, the network should initiate an identification procedure to retrieve SUCI from the UE and restart the 5G AKA based primary authentication and key agreement procedure with the received SUCI.
authentication and key agreement procedure, or the network decides not to initiate the identification procedure to retrieve SUCI from the UE after an unsuccessful 5G AKA based primary authentication and key agreement procedure, the network should send an AUTHENTICATION REJECT message to the UE.
the UE shall set the update status to 5U3 ROAMING NOT ALLOWED, delete the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI; In case of PLMN, the USIM shall be considered inva lid until switching off the UE or the UICC containing the USIM is removed.
In case of SNPN, the entry of the "list of subscriber data" with the SNPN identity of the current SNPN shall be considered invalid until the UE is switched off or the entry is updated.
Additionally, the UE shall consider the USIM as invalid for the current SNPN until switching off or the UICC containing the USIM is removed; The UE shall set: i) the counter for "SIM/USIM considered invalid for GPRS services" events, the counter for "USIM considered invalid for 5GS services over non-3GPP access" events, and the counter for "SIM/USIM considered invalid for non-GPRS services" events if maintained by the UE, in case of PLMN; or ii) the counter for "the entry for the current SNPN considered invalid for 3GPP access" events and the counter for "the entry for the current SNPN considered invalid for non-3GPP access" events in case of SNPN; to UE implementation-specific maximum value; and if the UE is operating in single-registration mode, the UE shall handle EMM parameters, 4G-GUTI, last visited registered TAI, TAI list and eKSI as specified in 3GPP specification document for the case when the authentication procedure is not accepted by the network.
The USIM shall be considered as invalid also for non-EPS services until switching off or the UICC containing the USIM is removed.
2) if the AUTHENTICATION REJECT message is received without integrity protection, the UE shall start timer a) if the AUTHENTICATION REJECT message is received over 3GPP access, and the counter for "SIM/USIM considered invalid for GPRS services" events in case of PLMN or the counter for "the entry for the current subclause (if the UE is not operating in SNPN access mode) or list item a)-1) of subclause (if the UE is operating in SNPN access mode) for the case that the 5GMM cause value received is #3; b) if the AUTHENTICATION REJECT message is received over non-3GPP access, and the counter for "USIM of subclause (if the UE is not operating in SNPN access mode) or list item a)-2) of subclause (if the UE is operating in SNPN access mode) for the case that the 5GMM cause value received is # i) if the AUTHENTICATION REJECT message is received over 3GPP access: The UE shall set the update status for 3GPP access to 5U3 ROAMING NOT ALLOWED, delete for 3GPP access only the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI.
In case of PLMN, the UE shall consider the USIM as invalid for 5GS services via 3GPP access and non-EPS service until switching off the UE or the UICC containing the USIM is removed.
In case of SNPN, the UE shall consider the entry of the "list of subscriber data" with the SNPN identity of the current SNPN shall be considered invalid for 3GPP access until the UE is switched off or the entry is updated.
Additionally, the UE shall consider the USIM as invalid for the current SNPN via 3GPP access until switching off or the UICC containing the USIM is removed.
The UE shall set: PLMN; or the counter for "the entry for the current SNPN considered invalid for 3GPP access" events in case to UE implementation-specific maximum value.
If the UE is operating in single-registration mode, the UE shall handle 4G-GUTI, TAI list and eKSI as specified in 3GPP specification document for the case when the authentication pro cedure is not accepted by the network.
The USIM shall be considered as invalid also for non-EPS services until switching off or the UICC containing the USIM is removed; and ii) if the AUTHENTICATION REJECT message is received over non-3GPP access: the UE shall set the update status for non-3GPP access to 5U3 ROAMING NOT ALLOWED, delete for non-3GPP access only the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI; in case of PLMN, the UE shall consider the USIM as invalid for 5GS services via non-3GPP access until switching off the UE or the UICC containing the USIM is removed.
In case of SNPN, the UE shall consider the entry of the "list of subscriber data" with the SNPN identity of the current SNPN as invalid for non-3GPP access until the UE is switched off or the entry is updated.
Additionally, the UE shall consider the USIM as invalid for the current SNPN and for non-3GPP access until switching off or the UICC containing the USIM is removed; and the UE shall set: implementation-specific maximum value in case of PLMN; or the counter for "the entry for the current SNPN considered invalid for non-3GPP access" events to UE implementation-specific maximum value in case of SNPN.
If the AUTHENTICATION REJECT message is received by the UE, the UE shall abort any 5GMM signalling procedure, stop any of the timers T3510, T3516, T3517, T3519 or T3521 (if they were running), enter state 5GMM-DEREGISTERED and delete any stored SUCI.
procedure with 5GS registration type IE set to "emergency registration" and the AMF is configured to allow emergency registration without user identity, the AMF needs not follow the procedures specified for the authentication failure in Authentication not accepted by the UE In the 5G authentication challenge, the UE shall check the 5G authentication challenge data (RAND, AUTN and ngKSI) received in the AUTHENTICATION REQUEST message to verify authenticity of the 5G core network.
The ME shall check that ngKSI received in the AUTHENTICATION REQUEST message is not already in use.
The ME shall forward the RAND and AUTN to the USIM to check.
The UE may reject the core network due to an incorrect AU TN or ngKSI parameter.
If the UE has to reject the 5G value indicating the reason for the failure (see 3GPP specification document\).
Incorrect 5G authentication challenge data contains four possible causes for authentication failure: a) MAC code failure: If the UE finds the MAC code (supplied by the core network in the AUTN parameter) to be invalid, the UE shall send an AUTHENTICATION FAILURE message to the network, with the 5GMM cause #20 "MAC failure".
The UE shall then follow the procedure described in subclause , item c.
b) Non-5G authentication unacceptable: authentication unacceptable" (see subclause in 3GPP specification document\).
The UE shall then follow the procedure described in subclause , item d.
c) ngKSI already in use: If the UE detects that ngKSI received in the AUTHENTICATION REQUEST message is already in use in the UE shall send an AUTHENTICATION FAILURE message to the network, with the 5GMM cause #71 "ngKSI already in use".
The UE shall then follow the procedure described in subclause , item e.
If the UE finds the sequence number SQN (supplied by the core network in the AUTN parameter) to be out of range, the UE shall send an AUTHENTICATION FAILURE message to the network, with the 5GMM cause If the UE returns an AUTHENTICATION FAILURE message to the network, the UE shall delete any previously stored RAND and RES* and shall stop timer T3516, if running.
a) Lower layer failure.
Upon detection of lower layer failure before the AUTHENTICATION RESPONSE message is received, the network shall abort the procedure.
b) Expiry of timer T356 The network shall, on the first expiry of the timer T3560, retransmit the AUTHENTICATION REQUEST message and shall reset and start timer T356 This retransmission is repeated four times, i.
on the fifth expiry of timer T3560, the network shall abort the 5G AKA based primary authentication and key agreement procedure and any ongoing 5GMM specific procedure and release the N1 NAS signalling connection.
c) Authentication failure (5GMM cause #20 "MAC failure").
The UE shall send an AUTHENTICATION FAILURE message, with 5GMM cause #20 "MAC failure" according to subclause , to the network and start timer T3520 (see example in figure\).
Furthermore, the UE shall stop any of the retransmission timers that are running (e.
T3510, T3517 or T3521).
Upon the first receipt of an AUTHENTICATION FAILURE message from the UE with 5GMM cause #20 "MAC failure", the network may initiate the identification procedure described in subclause This is to allow the network to obtain the SUCI from the UE.
The network may then check that the 5G-GUTI originally used in the 5G authentication challenge corresponded to the correct SUPI.
Upon receipt of the IDENTITY REQUEST message from the network, the UE shall proceed as specified in subclause NOTE 1: Upon receipt of an AUTHENTICATION FAILURE message from the UE with 5GMM cause #20 "MAC failure", the network may also terminate the 5G AKA based primary authentication and key agreement procedure (see subclause\).
AUTHENTICATION REQUEST message to the UE.
Upon receiving the new AUTHENTICATION REQUEST message from the network, the UE shall stop the timer T3520, if running, and then process the 5G challenge information as normal.
If the mapping of 5G-GUTI to SUPI in the network was correct, the network should terminate the 5G AKA based primary authentication and key agreement procedure by sending an AUTHENTICATION REJECT message (see subclause\).
and MAC is received), the UE shall send the AUTHENTICATION RESPONSE message to the network and shall start any retransmission timers (e.
T3510, T3517 or T3521) if they were running and stopped when the UE received the first failed AUTHENTICATION REQUEST message.
If the SQN is invalid, the UE shall proceed as specified in item f.
Start T3520 Stop T3560AUTHENTICATION FAILURE (cause = "xxx")Start T3560 Stop T3560AUTHENTICATION RESPONSEStart T3560 Authentication failure during 5G AKA based primary authentication and key d) Authentication failure (5GMM cause #26 "non-5G authentication unacceptable").
The UE shall send an AUTHENTICATION FAILURE message, with 5GMM cause #26 "non-5G authentication unacceptable", to the network and start the timer T3520 (see example in figure\).
Furthermore, the UE shall stop any of the retransmission timers that are runn ing (e.
T3510, T3517 or T3521).
Upon the first receipt of an AUTHENTICATION FAILURE message from the UE with 5GMM cause #26 "non-5G authentication unacceptable", the network may initiate the identification procedure described in subclause This is to allow the network to obtain the SUCI from the UE.
The network may then check that the 5G-GUTI originally used in the 5G authentication challenge corresponded to the correct SUPI.
Upon receipt of the IDENTITY REQUEST message from the network, the UE shall proceed as specified in subclause NOTE 2: Upon receipt of an AUTHENTICATION FAILURE message from the UE with 5GMM cause #26 "non- 5G authentication unacceptable", the network may also terminate the 5G AKA based primary authentication and key agreement procedure (see subclause\).
AUTHENTICATION REQUEST message to the UE.
Upon receiving the new AUTHENTICATION REQUEST message from the network, the UE shall stop the timer T3520, if running, and then process the 5G challenge information as normal.
If the mapping of 5G-GUTI to SUPI in the network was correct, the network should terminate the 5G AKA based primary authentication and key agreement authentication procedure by sending an AUTHENTICATION REJECT message (see subclause\).
authentication challenge is received), the UE shall send the AUTHENTICATION RESPONSE message to the network and shall start any retransmission timers (e.
T3510, T3517 or T3521) if they were running and st opped when the UE received the first failed AUTHENTICATION REQUEST message.
e) Authentication failure (5GMM cause #71 "ngKSI already in use").
The UE shall send an AUTHENTICATION FAILURE message, with 5GMM cause #71 "ngKSI already in use", to the network and start the timer T3520 (see example in figure\).
Furthermore, the UE shall stop any of the retransmission timers that are running (e.
T3510, T3 517 or T3521).
Upon the first receipt of an AUTHENTICATION FAILURE message from the UE with 5GMM cause #71 "ngKSI already in use", the UE.
key agreement procedure (see subclause\).
Upon receiving the new AUTHENTICATION REQUEST message from the network, the UE shall stop the timer T3520, if running, and then process the 5G challenge information as normal.
ngKSI, SQN and MAC is received), the UE shall send the AUTHENTICATION RESPONSE message to the network and shall start any retransmission timers (e.
T3510, T3517 or T3521) if they were running and st opped when the UE received the first failed AUTHENTICATION REQUEST message.
f) Authentication failure (5GMM cause #21 "synch failure").
The UE shall send an AUTHENTICATION FAILURE message, with 5GMM cause #21 "synch failure", to the network and start the timer T3520 (see example in figure\).
Furthermore, the UE shall stop any of the retransmission timers that are running (e.
T3510, T3517 or T3521).
Upon the first receipt of an AUTHENTICATION FAILURE message from the UE with the 5GMM cause #21 "synch failure", the network shall use the returned AUTS parameter from the authentication failure parameter IE in the AUTHENTICATION FAILURE message, to re-synchronise.
The re-synchronisati on procedure requires the AMF to delete all unused complete, the network shall initiate the 5G AKA based primary authentication and key agreement procedure.
Upon receipt of the AUTHENTICATION REQUEST message, the UE shall stop the timer T3520, if running.
NOTE 4: Upon receipt of two consecutive AUTHENTICATION FAILURE messages from the UE with 5GMM cause #21 "synch failure", the network may terminate the 5G AKA based primary authentication and key agreement procedure by sending an AUTHENTICATION REJECT message.
If the network is validated successfully (a new AUTHENTICATION REQUEST message is received which RESPONSE message to the network and shall start any retransmission timers (e.
T3510, T3517 or T3521), if they were running and stopped when the UE received the first failed AUTHENTICATION REQUEST message.
Upon receipt of an AUTHENTICATION REJECT message, the UE shall perform the actions as specified in g) Network failing the authentication check.
If the UE deems that the network has failed the authentication check, then it shall request RRC to locally release the RRC connection and treat the active cell as barred (see 3GPP specification document\).
The UE shall start any retransmission timers (e.
T3510, T3517 or T3521), if they were running and stopped when the UE received the first AUTHENTICATION REQUEST message containing an incorrect authentication challenge data causing authentication failure.
h) Transmission failure of AUTHENTICATION RESPONSE message or AUTHENTICATION FAILURE The UE shall stop the timer T3520, if running, and re-initiate the registration procedure for mobility and periodic i) Transmission failure of AUTHENTICATION RESPONSE message or AUTHENTICATION FAILURE The UE shall stop the timer T3520, if running.
If the current TAI is not in the TAI list, the 5G AKA based primary authentication and key agreement procedure If the current TAI is still part of the TAI list, it is up to the UE implementation how to re-run the ongoing procedure that triggered the 5G AKA based prim ary authentication and key agreement procedure.
The UE shall stop the timer T3520, if running.
It is up to the UE implementation how to re-run the ongoing procedure that triggered the 5G AKA based prim ary authentication and key agreement procedure.
k) Lower layers indication of non-delivered NAS PDU due to handover.
If the AUTHENTICATION REQUEST message could not be delivered due to an intra AMF handover and the target TA is included in the TAI list, then upon successful completion of the intra AMF handover the AMF shall The UE shall stop timer T3520, if the timer is running and the UE enters 5GMM-IDLE mode, e.
upon The UE shall deem that the network has failed the authentication check or assume that the authentication is not the timer T3520 expires; the UE detects any combination of the 5G authentication failures: 5GMM causes #20 "MAC failure", #21 "synch failure", #26 "non-5G authentication unacceptable" or #71 "ngKSI already in use", during three consecutive authentication challenges.
The 5G authenticat ion challenges shall be considered as consecutive by the UE, while the timer T3520 started after the previous 5G authentication failure is running.
Depending on local requirements or operator preference for emergency services, if the UE has an emergency integrity protection algorithm" 5G-IA0, "null ciphering algorithm" 5G-EA0 or may abort the 5G AKA based primary authentication and key agreement procedure and cont inue using the current security context, if any.
The there is an ongoing PDU session establishment pro cedure, the AMF shall release all non-emergency PDU sessions upon completion of the PDU session establishment procedure.
The network shall behave as if the UE is registered for emergency services.
AUTHENTICATION FAILURE message to the AMF with the 5GMM cause appropriate for these cases (#20, #21, #26, or #71 respectively) and receives the SECURITY MODE COMMAND message before the timeout of timer T3520, the UE shall deem that the network has passed the authentication check successfully, stop timer T3520, respectively, and execute the security mode control procedure.
T3520 expires, the UE shall not deem that the network has failed the authentication check and not behave as described in item g.
Instead the UE shall continue using the current security context, if any, release all non-emergency PDU sessions, if any, by initiating UE-requested PDU session release procedure.
If there is an ongoing PDU session establishment procedure, the UE shall release all non-emergency PDU sessions upon completion of the PDU session establishment procedure.
The UE shall start any retransmission timers (e.
they were running and stopped when the UE received the AUTHENTICATION REQUEST message and detected an authentication failure; the procedures associated with these timers have not yet been completed.
The UE shall behave as if the UE is registered for emergency services.
The purpose of the NAS security mode control procedure is to take a 5G NAS security context into use, and initialise and start NAS signalling security between the UE and the AMF with the corresponding 5G NAS keys and 5G NAS Furthermore, the network may also initiate the security mode control procedure in the following cases: b) in order to change the value of uplink NAS COUNT used in the latest SECURITY MODE COMPLETE message as described in 3GPP specification document , subclause ; and c) in order to provide the Selected EPS NAS security algorithms to the UE.
procedures in the AS or inside the core network see 3GPP specification document , subclause NAS security mode control initiation by the network to the UE and starting timer T3560 (see example in figure\).
The AMF shall reset the downlink NAS COUNT counter and use it to integrity protect the initial SECURITY MODE COMMAND message if the security mode control procedure is initiated: authentication and key agreement procedure or the EAP based primary authentication and key agreement context (i.
the type of security context flag is set to "mapped security context" in the NAS key set identifier IE included in the SECURITY MODE COMMAND message).
The AMF shall send the SECURITY MODE COMMAND message unciphered, but shall integrity protect the message with the 5G NAS integrity key based on K AMF or mapped K' AMF indicated by the ngKSI included in the message.
The AMF shall set the security header type of the message to "integrity protected with new 5G NAS security context".
ngKSI value in the NAS key set identifier IE set to "000" and 5G-IA0 and 5G-EA0 as the selected NAS security a) during an initial registration procedure for emergency services if no shared 5G NAS security context is available; PDU session if no shared 5G NAS security context is available; context is available; or context is not possible.
When the AMF sends the SECURITY MODE COMMAND message including an ngKSI value in the NAS key set identifier IE set to "000" and 5G-IA0 and 5G-EA0 as the selected NAS security algorithms, if: a) the AMF supports N26 interface; b) the UE set the S1 mode bit to "S1 mode supported" in the 5GMM capability IE of the REGISTRATION the SECURITY MODE COMMAND message shall also include the Selected EPS NAS security algorithms IE.
The selected EPS NAS security algorithms shall be set to EIA0 and EEA identifier IE set to "000" and 5G-IA0 and 5G-EA0 as the selected NAS security algorithms and, if accepted, create a AMF when the security mode control procedure is initiated: a) during an initial registration procedure for emergency services; session or is establishing an emergency PDU session.
NOTE 1: The process for creation of the locally generated K AMF by the AMF and the UE is implementation context indicated by the UE, the AMF shall either: a) indicate the use of the new mapped 5G NAS security context to the UE by setting the type of security context flag in the NAS key set identifier IE to "mapped security context" and the KSI value related to the security context of the source system; or b) set the ngKSI value "000" in the NAS key set identifier IE if the AMF sets 5G-IA0 and 5G-EA0 as the selected The AMF shall include the replayed security capabilities of the UE (including the security capabilities with regard to NAS, RRC and UP (user plane) ciphering as well as NAS and RRC integrity, and other possible target network security capabilities, i.
E-UTRAN if the UE included them in the message to network), the selected 5GS ciphering and integrity algorithms and the ngKSI.
agreement procedure when the UE attempts to register ov er the other access to the same PLMN, the AMF shall take into use the UE's current 5G NAS security context over the other access that the UE is registering.
In this case, SECURITY MODE COMMAND message is not sent to the UE.
If the UE is registered to the same AMF and the same PLMN over both 3GPP access and non-3GPP access, and the UE is in 5GMM-CONNECTED mode over both the 3GPP and non-3GPP accesses, then at any time the primary authentication and key agreement procedure has successfully completed over: a) the 3GPP access, the AMF includes the ngKSI in the SECURITY MODE COMMAND message over the 3GPP access.
When the AMF sends the SECURITY MODE COMMAND message to UE over the non-3GPP access to take into use the new 5G NAS security context, the AMF shall include the same ngKSI in the SECURITY MODE COMMAND message to identify the new 5G NAS security context; or b) the non-3GPP access, the AMF includes the ngKSI in the SECURITY MODE COMMAND message over the non-3GPP access.
When the AMF sends the SECURITY MODE COMMAND message to UE over the 3GPP access to take into use the new 5G NAS security context, the AMF shall include the same ngKSI in the SECURITY MODE COMMAND message to identify the new 5G NAS security context.
a) the REGISTRATION REQUEST message does not successfully pass the integrity check at the AMF; or b) the AMF can not decipher the value part of the NAS message container IE in the REGISTRATION REQUEST the AMF shall include the Additional 5G security information IE with the RINMR bit set to "Retransmission of the initial NAS message requested" in the SECURITY MODE COMMAND message requesting the UE to send the entire REGISTRATION REQUEST message in the SECURITY MODE COMPLETE message as described in 3GPP specification document .
Additionally, the AMF may request the UE to include its IMEISV in the SECURITY MODE COMPLETE message.
If the AMF supports N26 interface and the UE set the S1 mo de bit to "S1 mode supported" in the 5GMM capability IE of the REGISTRATION REQUEST message, the AMF shall select ciphering and integrity algorithms to be used in the EPS and indicate them to the UE via the Selected EPS NAS security algorithms IE in the SECURITY MODE COMMAND message.
NOTE 2: The AS and NAS security capabilities are the same, i.
if the UE supports one algorithm for NAS, the same algorithm is also supported for AS.
If the AMF performs horizontal key derivation e.
during the mobility and periodic registration update or when the UE is already registered in the PLMN with another access type as described in 3GPP specification document , the AMF shall include horizontal derivation parameter in the SECURITY MODE COMMAND message.
If the security mode control procedure is initiated after successful EAP based primary authentication and key agreement procedure and the security mode control procedure intends to bring into use the partial native 5G NAS security context created by the EAP based primary authentication and key ag reement procedure, the AMF shall set the EAP message IE of the SECURITY MODE COMMAND message to an EAP-success message to be sent to the UE.
SECURITY MODE COMMANDStart T3560 SECURITY MODE COMPLETEStop T3560.
When the SECURITY MODE COMMAND message includes an EAP-success message the UE handles the EAP- success message and the ABBA as described in subclause , , A.
a) the UE is registered for emergency services, performing initial registration for emergency services or establishing an emergency PDU session; b) the W-AGF acts on behalf of the FN-RG; or c) the W-AGF acts on behalf of the N5GC device, and the SECURITY MODE COMMAND message is received with ngKSI value "000" and 5G-IA0 and 5G-EA0 as selected 5G NAS security algorithms, the UE shall locally de rive and take in use 5G NAS security context.
The UE shall delete existing current 5G NAS security context.
5G-IA0 as the selected 5G NAS integrity algorithm only if the message is received when the UE is registered for emergency services, performing initial registration for emergency services or establishing an emergency PDU session or when the W-AGF acts on behalf of the FN-RG, or when the W-AGF acts on behalf of the N5GC device.
If the type of security context flag included in the SECURITY MODE COMMAND message is set to "native security The UE shall ignore the Replayed S1 UE security capabilities IE if this IE is included in the SECURITY MODE If the SECURITY MODE COMMAND message can be accepted, the UE shall take the 5G NAS security context indicated in the message into use.
The UE shall in addition reset the uplink NAS COUNT counter if: a) the SECURITY MODE COMMAND message is received in order to take a 5G NAS security context into use or the EAP based primary authentication and key agreement procedure; or b) the SECURITY MODE COMMAND message received includes the type of security context flag set to "mapped if the SECURITY MODE COMMAND message has been successfully integrity checked using an estimated downlink NAS COUNT equal to 0, then the UE shall set the downlink NAS COUNT of this new 5G NAS security context to 0; otherwise the UE shall set the downlink NAS COUNT of this new 5G NAS security context to the downlink NAS COUNT that has been used for the successful integrity checking of the SECURITY MODE COMMAND message.
If the SECURITY MODE COMMAND message includes the horizontal derivation parameter indicating "K derivation in mobility, and set both uplink and downlink NAS COUNTs to zero.
When the new 5G NAS security context is taken into use for current access and the UE is registered with the same PLMN over the 3GPP access and the non-3GPP access: shall set the downlink NAS COUNT and uplink NAS COUNT to zero for the non-current access; or b) the UE is in 5GMM-CONNECTED mode over the non-current access, the AMF shall send the SECURITY MODE COMMAND message over the non-current access to activate the new 5G NAS security context that was activated over the current access as described in 3GPP specification document .
The AMF shall include the same ngKSI in the SECURITY MODE COMMAND message to identify the new 5G NAS security context.
If the SECURITY MODE COMMAND message includes the horizontal derivation parameter indicating "K AMF a) the UE is in 5GMM-IDLE mode over the non-current access, the AMF and the UE shall activate the new 5G COUNT and uplink NAS COUNT to zero for the non-current access, otherwise the downlink NAS COUNT and uplink NAS COUNT for the non-3GPP access are not changed; or b) the UE is in 5GMM-CONNECTED mode over the non-current access, the AMF shall send the SECURITY MODE COMMAND message over the non-current access to activate the new 5G NAS security context that was activated over the current access as described in 3GPP specification document .
The AMF shall include the same ngKSI in the SECURITY MODE COMMAND message to identify the new 5G NAS security context.
AMF or mapped K' AMF if the type of security context flag is set to "mapped security context" indicated by the ngKSI.
When the SECURITY MODE COMMAND message includes the type of security context flag set to "mapped Furthermore, if the SECURITY MODE COMMAND message can be accepted, the UE shall cipher the SECURITY MODE COMPLETE message with the selected 5GS ciphering algorithm and the 5GS NAS ciphering key based on the K AMF or mapped K' AMF indicated by the ngKSI.
The UE shall set the security header type of the message to "integrity protected and ciphered with new 5G NAS security context".
From this time onward the UE shall cipher and integrity protect all NAS signalling messages with the selected 5GS integrity and ciphering algorithms.
If the AMF indicated in the SECURITY MODE COMMAND message that the IMEISV is requested and: a) if the UE: 1) supports at least one 3GPP access technology, the UE shall include its IMEISV in the IMEISV IE of the SECURITY MODE COMPLETE message; or 2) does not support any 3GPP access technology (i.
NG-RAN, E-UTRAN, UTRAN or GERAN) and supports NAS over untrusted or trusted non-3GPP access, the UE shall include its EUI-64 in the non-IMEISV PEI IE of the SECURITY MODE COMPLETE message; or b) if the 5G-RG contains neither an IMEISV nor an IMEI or when the W-AGF acts on behalf of the FN-RG (or on specified in subclause in the non-IMEISV PEI IE in the SECURITY MODE COMPLETE message.
COMMAND message which includes the Additional 5G security information IE with the RINMR bit set to use the IE according to 3GPP specification document .
S1 mode to N1 mode in 5GMM-CONNECTED mode, the UE shall set the value of the Selected EPS NAS security algorithms IE in the 5G NAS security context to the NAS security algorithms that were received from the source MME when the UE was in S1 mode.
NAS security mode control completion by the network The AMF shall, upon receipt of the SECURITY MODE COMPLETE message, stop timer T356 From this time onward the AMF shall integrity protect and encipher all signalling messages with the selected 5GS integrity and ciphering algorithms.
REQUEST message, the AMF shall complete the ongoing registration procedure by considering the REGISTRATION REQUEST message contained in the NAS message container IE as the message that triggered the procedure.
procedure in order to provide the selected EPS NAS security algorithms to the UE as described in subclause message, the AMF shall complete the ongoing service request procedure by considering the SERVICE REQUEST message contained in the NAS message container IE as the message that triggered the procedure.
SERVICE REQUEST message, the AMF shall complete the ongoing service request procedure by considering the CONTROL PLANE SERVICE REQUEST message contained in the NAS message container IE as the message that triggered the procedure.
NAS security mode command not accepted by the UE #23 UE security capabilities mismatch.
#24 security mode rejected, unspecified.
If the UE detects that the received Replayed UE security capabilities IE has been altered compared to the latest values that the UE sent to the network, the UE shall set the cause value to #23 "UE security capabilities mismatch".
Upon receipt of the SECURITY MODE REJECT message, the AMF shall stop timer T356 The AMF shall also abort Both the UE and the AMF shall apply the 5G NAS security context in use before the initiation of the security mode control procedure, if any, to prot ect the SECURITY MODE REJECT message and any other subsequent messages according to the rules in subclause and Abnormal cases in the UE The following abnormal cases can be identified: The UE shall abort the security mode control pro cedure and re-initiate the registration procedure.
b) Transmission failure of SECURITY MODE COMPLETE message or SECURITY MODE REJECT message procedure shall be initiated.
If the current TAI is still part of the TAI list, the security mode control procedure shall be aborted and it is up to the UE implementation how to re-run the ongoing procedure that triggered the security mode control procedure.
c) Transmission failure of SECURITY MODE COMPLETE message or SECURITY MODE REJECT message The security mode control procedure shall be aborted and it is up to the UE implementation how to re-run the ongoing procedure that triggered the security mode control procedure.
Abnormal cases on the network side The following abnormal cases can be identified: a) Lower layer failure before the SECURITY MODE COMPLETE or SECURITY MODE REJECT message is The network shall abort the security mode control procedure.
b) Expiry of timer T356 The network shall, on the first expiry of the timer T3560, retransmit the SECURITY MODE COMMAND message and shall reset and start timer T356 This retransmission is repeated four times, i.
on the fifth expiry of timer T3560, the procedure shall be aborted.
c) Collision between security mode control procedure and registration, service request or de-registration procedure not indicating switch off.
The network shall abort the security mode control pr ocedure and proceed with the UE initiated procedure.
d) Collision between security mode control procedure and other 5GMM procedures than in item c.
The network shall progress both procedures.
e) Lower layers indication of non-delivered NAS PDU due to handover: If the SECURITY MODE COMMAND message could not be delivered due to an intra AMF handover and the target TA is included in the TAI list, then upon successful completion of the intra AMF handover the AMF shall.
concealed SUPI and the IMEI, the IMEISV, the EUI-64 and the MAC address are formats of PEI.
Identification response by the UE A UE shall be ready to respond to an IDENTITY REQUEST message at any time whilst in 5GMM-CONNECTED mode.
Upon receipt of the IDENTITY REQUEST message: a) if the Identity type IE in the IDENTITY REQUEST message is not set to "SUCI", the UE shall send an IDENTITY RESPONSE message to the network.
The IDENTITY RESPONSE message shall contain the identification parameters as requested by the network; and b) if the Identity type IE in the IDENTITY REQUEST message is set to "SUCI", the UE shall: IDENTITY RESPONSE message with the SUCI, start timer T3519 and store the value of the SUCI sent in the IDENTITY RESPONSE message; and 2) if timer T3519 is running, send an IDENTITY RESPONSE message with the stored SUCI.
Identification completion by the network Upon receipt of the IDENTITY RESPONSE the network shall stop the timer T357 Abnormal cases in the UE The following abnormal cases can be identified: a) Transmission failure of the IDENTITY RESPONSE messa ge (if the identification procedure is triggered by a The UE shall re-initiate the registration procedure.
b) Requested identity is not available If the UE cannot encode the requested identity in the IDENTITY RESPONSE message, e.
because no valid USIM is available, then it shall encode the identity type as "No identity".
Abnormal cases on the network side The following abnormal cases can be identified: a) Lower layer failure.
b) Expiry of timer T357 The network shall, on the first expiry of the timer T3570, retransmit the IDENTITY REQUEST message and reset and restart the timer T357 This retransmission is repeated four times, i.
on the fifth expiry of timer "emergency registration" in the 5GS registration type IE before the ongoing identification procedure has been completed and no registration procedure is pending on the network (i.
no REGISTRATION ACCEPT/REJECT with the registration procedure for initial registration.
ACCEPT/REJECT message has to be sent as an answer to an earlier REGISTRATION REQUEST message), then: If one or more of the information elements in the REGISTRATION REQUEST message differ from the ones received within the previous REGISTRATION REQUEST message, the network shall proceed with the new registration procedure for initial registration; or If the information elements do not differ, then the network shall not treat any further this new updating" or "periodic registration updating" in the 5GS registration type IE before the ongoing identification procedure has been completed, the ne twork shall progress both procedures.
registration type IE before the ongoing identification procedure has been completed, the network shall abort the identification procedure and shall progress the UE-initiated de-registration procedure; Else the network shall complete the identification procedure and shall respond to the UE-initiated de-registration procedure as described in subclause Generic UE configuration update procedure.
The purpose of this procedure is to: and provided by the AMF by providing new parameter information within the command; or network to update access and mobility management-relat ed parameters decided and provided by the AMF (see The following parameters are supported by the generic UE configuration update procedure without the need to request the UE to perform the registration procedure for mobility and periodic registration update: b) TAI list; c) Service area list; d) Network identity and time zone information (Full name for network, short name for network, local time zone, universal time and local time zone, network daylight saving time); f) Rejected NSSAI; g) void; h) Operator-defined access category definitions; j) Service gap time value; k) "CAG information list"; l) UE radio capability ID; m) 5GS registration result; and n) Truncated 5G-S-TMSI configuration.
mobility and periodic registration update: b) Configured NSSAI; or c) Network slicing subscription change indication.
b) UE radio capability ID deletion indication; and c) Additional configuration indication.
The following parameters are sent over 3GPP access only: a) LADN information; b) MICO indication; c) TAI list; d) Service area list; f) "CAG information list"; g) UE radio capability ID; h) UE radio capability ID deletion indication; i) Truncated 5G-S-TMSI configuration; and j) Additional configuration indication.
The following parameters are managed and sent per access type i.
, independently over 3GPP access or non-3GPP a) Allowed NSSAI; and b) Rejected NSSAI (when the NSSAI is rejected for the current registration area).
The following parameters are managed commonly and sent over 3GPP access or non-3GPP access: a) 5G-GUTI; b) Network identity and time zone information; c) Rejected NSSAI (when the NSSAI is rejected for the current PLMN or rejected for the failed or revoked d) Configured NSSAI; e) SMS indication; f) 5GS registration result.
CONFIGURATION UPDATE COMPLETEStart T3555
Generic UE configuration update procedure Generic UE configuration update procedure initiated by the network The AMF shall initiate the generic UE configuration update procedure by sending the CONFIGURATION UPDATE COMMAND message to the UE.
The AMF shall in the CONFIGURATION UPDATE COMMAND message either: a) include one or more of the following parameters: 5G-GUTI, TAI list, allowed NSSAI that may include the mapped S-NSSAI(s), LADN information, service area list, MICO indication, NITZ information, configured NSSAI that may include the mapped S-NSSAI(s), rejected NSSAI, network slicing subscription change indication, operator-defined access category definitions , SMS indication, service gap time value, "CAG If an acknowledgement from the UE is requested, the AMF shall indicate "acknowledgement requested" in the Acknowledgement bit of the Configuration update indication IE in the CONFIGURATION UPDATE COMMAND message and shall start timer T355 Acknowledgement shall be requested for all parameters except when only NITZ is To initiate parameter re-negotiation between the UE and network, the AMF shall indicate "registration requested" in the Registration requested bit of the Configuration update indication IE in the CONFIGURATION UPDATE COMMAND message.
AMF shall indicate "registration requested" in the Registration requested bit of the Configuration update indication IE and include the Allowed NSSAI IE in the CONFIGURATION UPDATE COMMAND message.
configured NSSAI requires an AMF reloca tion as specified in 3GPP specification document , the AMF shall indicate "registration requested" in the Registration requested bit of the Configuration update indication IE in the message.
If the CONFIGURATION UPDATE COMMAND message is initiated only due to changes to the allowed NSSAI and described in subclause 8, the AMF shall indicate "registration requested" in the Registration requested bit of the Configuration update indication IE and "release of N1 NAS signalling connection not required" in the Signalling connection maintain request bit of the Additional configuration indication IE in the CONFIGURATION UPDATE COMMAND message.
a) success, the AMF shall include this S-NSSAI in the allowed NSSAI; or b) failure, the AMF shall include this S-NSSAI in the rejected NSSAI for the failed or revoked NSSAA with the If authorization is revoked for an S-NSSAI that is in the current allowed NSAAI for an access type, the AMF shall: which the authorization is revoked, with the reject cause "S-NSSAI is not available due to the failed or revoked network slice-specific authorization and authentication".
The allowed NSSAI and the rejected NSSAI shall be included in the CONFIGURATION UPDATE COMMAND message to reflect the result of the procedures subject to network slice-specific authentication and authorization.
CONFIGURATION UPDATE COMMAND messages.
If the AMF includes the Network slicing indication IE in the CONFIGURATION UPDATE COMMAND message with the Network slicing subscription change indication set to "Network slicing subscription changed", and changes to the shall additionally indicate "registration requested" in the Registration requested bit of the Configuration update indication IE and shall not include an allowed NSSAI.
If the AMF needs to update the "CAG information list", the AMF shall include the CAG information list IE in the CONFIGURATION UPDATE COMMAND message.
If the AMF needs to update the "CAG information list" and the UE: a) has an emergency PDU session; and 1) a CAG cell and none of the CAG-ID(s) supported by the CAG cell is included in the "allowed CAG list" for the current PLMN in the updated "CAG information list"; or 2) a non-CAG cell and the entry for the current PLMN in the updated "CAG information list" includes an "indication that the UE is only allowed to access 5GS via CAG cells"; 5GS optimization, the AMF shall include the Truncated 5G-S-TMSI configuration IE in the CONFIGURATION message, the AMF shall indicate "registration requested" in the Registration requested bit of the Configuration update indication IE.
If the AMF needs to redirect the UE to EPC as described in subclause A.
2, the AMF shall indicate "registration requested" in the Registration requested bit of the Configuration update indication IE and "release of N1 NAS signalling connection not required" in the Signalling connection maintain request bit of the Additional configuration indication IE in the CONFIGURATION UPDATE COMMAND message.
During an established 5GMM context, the network may send none, one, or more CONFIGURATION UPDATE COMMAND messages to the UE.
If more than one CONFIGURATION UPDATE COMMAND message is sent, the messages need not have the same content.
Generic UE configuration update accepted by the UE Upon receiving the CONFIGURATION UPDATE COMMAND message, the UE shall stop timer T3346 if running and use the contents to update appropriate information stored within the UE.
If "acknowledgement requested" is indicated in the Acknowledgement bit of the Configuration update indication IE in otherwise, the UE shall consider the old 5G-GUTI as valid.
The UE shall provide the 5G-GUTI to the lower layer of 3GPP access if the CONFIGURATION UPDATE COMMAND message is sent over the non-3GPP access, and the UE is in 5GMM-REGISTERED in both 3GPP access and non-3GPP access in the same PLMN.
new TAI list as valid and the old TAI list as invalid; othe rwise, the UE shall consider the old TAI list as valid.
configuration as invalid; otherwise, the UE shall consid er the old truncated 5G-S-TMSI configuration as valid.
old service area list, if any, as valid.
the old NITZ information as valid.
consider the old LADN information as invalid and the new LADN information as valid, if any; otherwise, the UE shall consider the old LADN information as valid.
COMMAND message, the UE shall consider the new allowed NSSAI as valid for the associated access type, store the allowed NSSAI for the associated access type as specified in subclause and consider the old allowed NSSAI for the associated access type as invalid; otherwise, the UE shall consider the old Allowed NSSAI as valid for the associated access type.
For each of the PDU session(s) active in the UE, if the CONFIGURATION UPDATE COMMAND message indicates consider the new configured NSSAI for the registered PLMN as valid and the old configured NSSAI for the registered PLMN as invalid; otherwise, the UE shall consider the old configured NSSAI for the registered PLMN as valid The UE shall store the new configured NSSAI as specified in subclause If the UE receives the Network slicing indication IE in the CONFIGURATION UPDATE COMMAND message with the Network slicing subscription change indication set to "Network slicing subscription changed", the UE shall delete the network slicing information for each and every PLMN except for the current PLMN as specified in If the UE receives Operator-defined access category de finitions IE in the CONFIGURATION UPDATE COMMAND message and the Operator-defined access category definitions IE contains one or more operator-defined access category definitions, the UE shall delete any operator-defined access category definitions stored for the RPLMN and shall store the received operator-defined access category definitions for the RPLMN.
If the UE receives the Operator-defined access category definitions IE in the CONFIGURATION UPDATE COMMAND message and the Operator-defined access category definitions IE contains no operator-defined access category definitions, the UE shall delete any operator-defined access category definitions stored for the RPLMN.
If the CONFIGURATION UPDATE COMMAND message does not contain the Operator-defined access category definitions IE, the UE shall not delete the operator-defined access category definitions stored for the RPLMN.
If the UE receives the SMS indication IE in the CONFIGURATION UPDATE COMMAND message with the SMS availability indication set to: a) "SMS over NAS not available", the UE shall consider that SMS over NAS transport is not allowed by the procedure for mobility and periodic registration update as specified in subclause , after the completion of the generic UE configuration update procedure.
If the UE receives the CAG information list IE in the CONFIGURATION UPDATE COMMAND message, the UE shall: b) replace the serving VPLMN's entry of the "CAG information list" stored in the UE with the serving VPLMN's current PLMN in the received "CAG information list" does not include any of the CAG-ID(s) supported by the current CAG cell, and: 1) the entry for the current PLMN in the received "CAG information list" does not include an "indication that with the updated "CAG information list"; or 2) the entry for the current PLMN in the received "CAG information list" includes an "indication that the UE is only allowed to access 5GS via CAG cells" and: i) if the entry for the current PLMN in the received "CAG information list" includes one or more CAG-IDs, cell according to 3GPP specification document with the updated "CAG information list"; or ii) if the entry for the current PLMN in the received "CAG information list" does not include any CAG-ID A) the UE does not have an emergency PDU session, then the UE shall enter the state 5GMM- DEREGISTERED.
PLMN-SEARCH and shall apply the PLMN selection process defined in 3GPP specification document with the updated "CAG information list"; or associated with 3GPP access except for the emergency PDU session; or for the current PLMN in the received "CAG information list" includes an "indication that the UE is only allowed to access 5GS via CAG cells" and: 1) if the "allowed CAG list" for the current PLMN in the received "CAG information list" includes one or more 2) if the entry for the current PLMN in the received "CAG information list" does not include any CAG-ID and: i) the UE does not have an emergency PDU session, then the UE shall enter the state 5GMM- DEREGISTERED.
PLMN-SEARCH and shall apply the PLMN selection process defined in 3GPP specification document with the updated "CAG information list"; or associated with 3GPP access except for the emergency PDU session.
If the CONFIGURATION UPDATE COMMAND message indicates "registration requested" in the Registration requested bit of the Configuration update indication IE and: configured NSSAI or the Network slicing subscription change indication, and: 1) an emergency PDU session exists, the UE shall, after the completion of the generic UE configuration update procedure and the release of the emergency PDU session, release the existing N1 NAS signalling connection, 2) no emergency PDU Session exists, the UE shall, after the completion of the generic UE configuration update not included in the CONFIGURATION UPDATE COMMAND message, procedure for mobility and registration update as specified in subclause ; or d) a UE radio capability ID deletion indication IE set to "Network-assigned UE radio capability IDs deletion requested" is included, and: 1) the UE is not in NB-N1 mode; 3) the UE has set the RACS bit to "RACS supported" in the 5GMM capability IE of the REGISTRATION procedure for mobility and registration update as specified in subclause The UE receiving the rejected NSSAI in the CONFIGURATION UPDATE COMMAND message takes the following actions based on the rejection cause in the rejected S-NSSAI(s): "S-NSSAI not available in the current PLMN or SNPN" The UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the current PLMN as specified in subclause and shall not attempt to use this S-NSSAI(s) in the current PLMN until switching off the UE, the UICC containing the USIM is removed, the entry of the "list of subscriber data" with the SNPN identity of the current SNPN is updated, or the rejected S-NSSAI(s) are removed or deleted as described in "S-NSSAI not available in the current registration area" The UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the current registration area as specified in subclause and shall not attempt to use this S-NSSAI(s) in the current registration area until switching off the UE, the UE moving out of the current registration area, the UICC containing the USIM is removed, the entry of the "list of subscriber data" with the SNPN identity of the current SNPN is updated, or the rejected S- NSSAI(s) are removed or deleted as described in subclause "S-NSSAI is not available due to the failed or revoked network slice-specific authentication and authorization" The UE shall add the rejected S-NSSAI(s) in the reject ed NSSAI for the failed or revoked NSSAA as specified in subclause and shall not attempt to use this S-NSSAI in the current PLMN over any access until switching off the UE, the UICC containing the USIM is removed, the entry of the "list of subscriber data" with the SNPN identity of the current SNPN is updated, or the rejected S-NSSAI(s) are removed or deleted as described in subclause and with the received value in the T3447 value IE, and if neither zero nor deactivated use the received T3447 value with the timer T3447 next time it is started.
If the received T3447 value is zero or deactivated, then the UE shall stop the timer If the UE is not in NB-N1 mode, the UE has set the RACS bit to "RACS supported" in the 5GMM capability IE of the REGISTRATION REQUEST message and the CONFIGURATION UPDATE COMMAND message includes: a) a UE radio capability ID deletion indication IE set to "Network-assigned UE radio capability IDs deletion requested", the UE shall delete any network-assigned UE radio capability IDs associated with the RPLMN or RSNPN stored at the UE; and b) a UE radio capability ID IE, the UE shall store the UE radio capability ID as specified in annex C.
Generic UE configuration update completion by the network Upon receipt of the CONFIGURATION UPDATE COMPLETE message, the AMF shall stop the timer T355 the new 5G-GUTI as valid and the old 5G-GUTI as invalid.
new TAI list as valid and the old TAI list as invalid.
the AMF shall consider the new truncated 5G-S-TMSI co nfiguration as valid and the old truncated 5G-S-TMSI consider the new service area list as valid and the old service area list as invalid.
If new allowed NSSAI information was included in the CONFIGURATION UPDATE COMMAND message, the AMF shall consider the new allowed NSSAI information as valid and the old allowed NSSAI information as invalid.
If new configured NSSAI information was included in the CONFIGURATION UPDATE COMMAND message, the AMF shall consider the new configured NSSAI information as valid and the old configured informa tion as invalid.
If there are active PDU sessions associated with S-NSSAI(s) not included in the new allowed NSSAI, the AMF shall notify the to subclause in the present specification and subclause in 3GPP specification document .
If "registration requested" was indicated in the Registration requested bit of the Configuration update indication IE in the CONFIGURATION UPDATE COMMAND message and: a) the CONFIGURATION UPDATE COMMAND message contained: 2) the Network slicing indication IE with the Network slicing subscription change indication set to "Network slicing subscription changed"; or 3) no other parameters; and b) no emergency PDU session has been established for the UE; then the AMF shall initiate the release of the N1 NAS signalling connection.
consider the old LADN information as invalid and the new LADN information as valid, if any.
In this case, if the tracking area identity list in the new LADN information does not include the current TA, the AMF shall indicate UE presence in LADN service area to the SMF (see 3GPP specification document and 3GPP specification document\).
consider the new UE radio capability ID as valid and the old UE radio capability ID as invalid.
Abnormal cases in the UE The following abnormal cases can be identified: If the current TAI is not in the TAI list, the generic UE configuration update procedure shall be aborted and a registration procedure for mobility and periodic registration update shall be initiated.
If the current TAI is still part of the TAI list, it is up to the UE implementation how to re-run the ongoing procedure that triggered the generic UE configuration update procedure.
b) Transmission failure of CONFIGURATION UPDATE COMPLETE message indication without TAI change It is up to the UE implementation how to re-run the ongoing procedure that triggered the generic UE c) Generic UE configuration update and de-registration procedure collision REQUEST message and the access type included in the DEREGISTRATION REQEUST message is same as the access in which the CONFIGURATION UPDATE COMMAND message is received, then the UE shall ignore the CONFIGURATION UPDATE COMMAND message and proceed with the de-registration procedure.
Otherwise, the UE shall pro ceed with both the procedures.
e) Generic UE configuration update and service request procedure collision procedure has been completed, the UE shall proceed with both the procedures.
f) "CAG information list" is received and the UE is operating in SNPN access mode If the UE receives the CAG information list IE in the CONFIGURATION UPDATE COMMAND message and the UE is operating in SNPN access mode, the UE shall ignore the content of CAG information list IE.
Abnormal cases on the network side The following abnormal cases can be identified: a) Expiry of timer T355 The network shall, on the first expiry of the timer T3555, retransmit the CONFIGURATION UPDATE COMMAND message and shall reset and start timer T355 This retransmission is repeated four times, i.
on the fifth expiry of timer T3555, the procedure shall be aborted.
In addition, if the CONFIGURATION UPDATE COMMAND message includes the 5G-GUTI IE, the network shall behave as described in case b)-1) below.
b) Lower layer failure.
1) if the CONFIGURATION UPDATE COMMAND message includes the 5G-GUTI IE, the old and the new 5G-GUTI shall be considered as valid until the old 5G- GUTI can be considered as invalid by the AMF.
If a new TAI list was provided in the CONFIGURATION UPDATE COMMAND message, the old and new TAI list shall also be considered as valid until the old TAI list can be considered as invalid by the AMF.
During this period the AMF: i) may first use the old 5G-S-TMSI from the old 5G-GUTI for paging within the area defined by the old TAI list for an implementation dependent number of paging attempts for network originated transactions.
valid if it was provided with this 5G-GUTI in the CONFIGURATION UPDATE COMMAND message; and UE uses the old 5G-GUTI; or 2) if the CONFIGURATION UPDATE COMMAND message does not include the 5G-GUTI IE, the network shall abort the procedure.
c) Generic UE configuration update and UE initiated de-registration procedure collision.
update procedure has been completed, the network sha ll abort the generic UE configuration update procedure and shall progress the de-registration procedure.
d) Generic UE configuration update and registration pr ocedure for mobility and periodic registration update update procedure has been completed, the network sha ll abort the generic UE configuration update procedure and shall progress the registration procedure for mobility and periodic registration update procedure.
procedure has been completed, both the procedures shall be progressed.
type of the payload is identified by the Payload container type IE and includes one of the following: a) a single 5GSM message; b) SMS; c) an LPP message (see 3GPP specification document\); d) an SOR transparent container; e) a UE policy container; f) a UE parameters update transparent container; g) a location services message (see 3GPP specification document [13A]); h) a CIoT user data container; or i) Multiple payloads.
For payload type a) to e) and h), along with the payload, the NAS transport procedure may transport the associated information (e.
PDU session information for 5GSM message payload).
container entry contains the payload and optional associat ed information (e.
PDU session information for 5GSM message payload).
UE-initiated NAS transport procedure 
a) a single 5GSM message as defined in subclause ; b) SMS (see 3GPP specification document\); c) an LPP message; d) an SOR transparent container; e) a UE policy container; or f) a UE parameters update transparent container; g) a location services message; h) a CIoT user data container; or i) multiple of the above types.
for a) to e) and h), optional associated payload ro uting information from the UE to the AMF in a 5GMM entry contains the payload and optional associated payload routing information (e.
PDU session information for 5GSM message payload).
UE-initiated NAS transport procedure initiation In the connected mode, the UE initiates the NAS transport procedure by sending the UL NAS TRANSPORT message to the AMF, as shown in figure In case a) in subclause , the UE shall: include the PDU session information (PDU session ID, old PDU session ID, S-NSSAI, mapped S-NSSAI (if available in roaming scenarios), DNN, request type), if available; set the Payload container type IE to "N1 SM information"; and - set the Payload container IE to the 5GSM message.
The UE shall set the PDU session ID IE to the PDU session ID.
If an old PDU session ID is to be included, the UE shall set the Old PDU session ID IE to the old PDU session ID.
If an S-NSSAI is to be included, the UE shall set the S-NSSAI IE to the S-NSSAI selected for the PDU session from the provided along 5GSM messages other than the PDU SESSION ESTABLISHMENT REQUEST message and the PDU SESSION MODIFICATION REQUEST message.
If an MA PDU session information is to be included, the UE shall set the MA PDU session information IE to the MA PDU session information.
The MA PDU session information is not provided along 5GSM messages other than the PDU In case b) in subclause , the UE shall: set the Payload container type IE to "SMS"; and - set the Payload container IE to the SMS payload.
described in 3GPP specification document : when SMS over NAS is preferred to be sent over 3GPP access: the UE attempts to deliver MO SMS over NAS via the 3GPP access if the UE is registered over both 3GPP access and non-3GPP access.
If the delivery of SMS over NAS via the 3GPP access is not available, the UE attempts to deliver MO SMS over NAS via the non-3GPP access; and when SMS over NAS is preferred to be sent over non-3GPP access: the UE attempts to deliver MO SMS over NAS via the non-3GPP access if the UE is registered over both 3GPP access and non-3GPP access.
If the delivery of SMS over NAS via the non-3GPP access is not available, the UE attempts to deliver MO SMS over NAS via the 3GPP access.
In case c) in subclause , the UE shall: set the Payload container type IE to "LTE Positioning Protocol (LPP) message container"; set the Payload container IE to the LPP message payload; and set the Additional information IE to the routing information provided by the upper layer location services In case d) in subclause , the UE shall: set the Payload container type IE to "SOR transparent container"; and set the Payload container IE to the UE acknowledgeme nt due to successful reception of steering of roaming information (see 3GPP specification document\).
In case e) in subclause , the UE shall: set the Payload container type IE to "UE policy container"; and set the contents of the Payload container IE as specified in Annex D.
In case f) in subclause , the UE shall: set the Payload container type IE to "UE parameters update transparent container"; and parameters update data (see 3GPP specification document\).
In case g) in subclause , the UE shall: set the Payload container type IE to "Location services message container"; set the Payload container IE to the Location services message payload; and set the Additional information IE to the routing information, if provided by the upper layer location services In case h) in subclause , the UE shall: include the PDU session ID, and Release assistance indication (if available); set the Payload container type IE to "CIoT user data container"; and - set the Payload container IE to the user data container.
- set each payload container entry of the Payload container IE (see subclause 9), as follows: Payload container type IE as specified in cases a) to h) above; ii) set the payload container entry contents field of the payload container entry to the payload container contents set in the Payload container IE as specified in cases a) to h) above, and iii) set the optional IE fields, if any, to the optional associated payload routing information as specified in cases a) to h) above.
UE-initiated NAS transport procedure UE-initiated NAS transport of messages accepted by the network 1) the UE and the PDU session ID IE in case the Old PDU session ID IE is not included, and: NOTE 1: If the Old PDU session ID IE is not included in the UL NAS TRANSPORT message and the AMF has IE is either not included or is included but set to other value than "initial request", "existing PDU session", "initial emergency request", "existing emergency PDU session" or "MA PDU request", the AMF shall forward the 5GSM message, and the PDU session ID IE towards the SMF identified by the SMF ID of the PDU session routing context; routing context indicates that the PDU session is not an emergency PDU session, the Request type IE is included and is set to "existing PDU session" or "MA PDU request", and the S-NSSAI associated with the PDU session identified by the PDU session ID is allowed for the target access type, the AMF shall forward the 5GSM message, the PDU session ID, the S-NSSAI, the mapped S-NSSAI (if available in roaming scenarios), the DNN (if received) and the requ est type towards the SMF identified by the SMF ID of the PDU session routing context; Request type IE is included and is set to "initial request" or "MA PDU request": A) the AMF shall select an SMF with following handlings: If the S-NSSAI IE is not included and the user's subscription context obtained from UDM: contains one default S-NSSAI, the AMF shall use the default S-NSSAI as the S-NSSAI; contains two or more default S-NSSAIs, the AMF shall use one of the default S-NSSAIs selected by operator policy as the S-NSSAI; and Editor's note [eNS; CR# 1996]: It is FFS how the AMF selects an S-NSSAI for the PDU session if {none of the subscribed S-NSSAIs marked as default is included in the allowed NSSAI} or {all subscribed S-NSSAIs If the DNN IE is included, the AMF shall use the UE requested DNN as the DNN determined by the If the DNN IE is not included, and the user's subscription context obtained from UDM: contains the default DNN for the S-NSSAI, the AMF shall use the default DNN as the DNN determined by the AMF; and as the DNN determined by the AMF; and NOTE 2: SMF selection is outside the scope of the present document.
from the DNN determined by the AMF.
B) if the SMF selection is successful: the SMF ID in the stored PDU session routing context to the SMF ID corresponding to the DNN in the user's subscription context obtained from the UDM; and the AMF shall forward the 5GSM message, the PDU session ID, the S-NSSAI, the mapped S- NSSAI (if available in roaming scenarios), the DNN determined by the AMF, DNN selected by the network (if different from DNN determined by the AMF), the request type, the MA PDU session information and UE presence in LADN se rvice area (if DNN received corresponds to an LADN DNN) towards the SMF identified by the SMF ID of the PDU session routing context; type IE is included and is set to "existing PDU session" or "MA PDU request", and the AMF retrieves an SMF ID associated with: A) the PDU session ID matching the PDU session ID received from the UE, if any; or B) the DNN matching the DNN received from the UE, otherwise; SMF ID in the stored PDU session routing context to the retrieved SMF ID; and B) the AMF shall forward the 5GSM message, the PDU session ID, the S-NSSAI, the mapped S-NSSAI (if available in roaming scenarios), the DNN (if received) and the request type towards the SMF identified by the SMF ID of the PDU session routing context; routing context for another PDU session ID of the UE indicating that the PDU session is an emergency PDU session: A) the AMF shall select an SMF.
The AMF shall use the emergency DNN from the AMF emergency shall store an indication that the PDU session is an emergency PDU session in the stored PDU session routing context; and the AMF shall forward the 5GSM message, the PDU session ID, the S-NSSAI (if configured in the AMF emergency configuration data), the DNN (if configured in the AMF emergency configuration data), and the request type towards the SMF identified by the SMF ID of the PDU session routing context; and context for the other PDU session ID of the UE; and B) the AMF shall forward the 5GSM message, the PDU session ID, the S-NSSAI (if configured in the AMF emergency configuration data), the DNN (if configured in the AMF emergency configuration data) and the request type towards the SMF identified by the SMF ID of the PDU session routing context; or routing context indicates that the PDU session is an emergency PDU session, and the Request type IE is included and is set to "existing emergency PDU session", the AMF shall forward the 5GSM message, the PDU session ID, the S-NSSAI (if configured in the AMF emergency configuration data), the DNN (if configured in the AMF emergency configuration data), and the request type towards the SMF identified by the SMF ID of the PDU session routing context; and Request type IE is included and is set to "existing emergency PDU session", and the AMF retrieves an corresponding to the current PLMN, then: B) the AMF shall forward the 5GSM message, the PDU session ID, the S-NSSAI (if configured in the AMF emergency configuration data), the DNN (if configured in the AMF emergency configuration data), and the request type towards the SMF identified by the SMF ID of the PDU session routing context; or 2) the UE and the Old PDU session ID IE in case the Old PDU session ID IE is included, and: PDU session routing context for the PDU session ID and the UE, the Request type IE is included and is roaming scenarios), the DNN, the request type and UE presence in LADN service area (if DNN received corresponds to an LADN DNN) towards the SMF identi fied by the SMF ID of the PDU session routing by operator policy as the S-NSSAI; and policy as the S-NSSAI.
Editor's note [eNS; CR# 1996]: It is FFS how the AMF selects an S-NSSAI for the PDU session if {none of the subscribed S-NSSAIs marked as default is included in the allowed NSSAI} or {all subscribed S-NSSAIs B) if the SMF selection is successful: SMF ID of the PDU session routing context to the SMF ID of the selected SMF; and the AMF shall forward the 5GSM message, the PDU session ID, the old PDU session ID, the S- NSSAI, the mapped S-NSSAI (if available in roaming scenarios), the DNN, the request type, the MA PDU session information and UE presence in LADN service area (if DNN received corresponds to an LADN DNN) towards the SMF identified by the SMF ID of the PDU session routing context for the PDU session ID and the UE; b) "SMS", the AMF shall forward the content of the Payload container IE to the SMSF associated with the UE; c) "LTE Positioning Protocol (LPP) message container", the AMF shall forward the Payload container type and the content of the Payload container IE to the LMF associ ated with the routing information included in the Additional information IE of the UL NAS TRANSPORT message; d) "SOR transparent container", the AMF shall forward the content of the Payload container IE to the UDM; e) "UE policy container", the AMF shall forward the content of the Payload container IE to the PCF.
f) "UE parameters update transparent container", the AMF shall forward the content of the Payload container IE to g) "Location services message container": 1) if the Additional information IE is not included in the UL NAS TRANSPORT message, the AMF shall provide the Payload container type and the content of the Payload container IE to the location services 2) if the Additional information IE is included in the UL NAS TRANSPORT message, the AMF shall forward the Payload container type and the content of the Payload container IE to an LMF associated with routing information included in the Additional information IE of the UL NAS TRANSPORT message.
1) forward the content of the Payload container IE to wards the SMF identified by the SMF ID of the PDU session routing context; and 2) initiate the release of the N1 NAS signalling connection: i) if the Release assistance indication IE is included in the UL NAS TRANSPORT message and the DDX field of the Release assistance indication IE indicates "No further uplink and no further downlink data transmission subsequent to the uplink data transmission is expected" and if there is no downlink signalling or downlink data for the UE; or uplink data transmission subsequent to the uplink data transmission is expected" and if there is no additional downlink signalling or downlink data for the UE.
i) "Multiple payloads", the AMF shall first decode the content of the Payload container IE (see subclause 9) to obtain the number of payload cont ainer entries and for each payload container entry, the i) decode the payload container type field; ii) decode the optional IE fields and the payload contai ner contents field in the payload container entry; and iii) handle the content of each payload container entry the same as the content of the Payload container IE and the associated optional IEs as specified in bullets a) to h) above according to the payload container type field.
UE-initiated NAS transport of messages not accepted by the network Upon reception of an UL NAS TRANSPORT message, if the Payload container type IE is set to "N1 SM information" and the UE is not configured for high priority access in selected PLMN, and: a) if the Request type IE is set to "initial request" or "existing PDU session"; 1) DNN based congestion control is activated for the DNN included in the UL NAS TRANSPORT message, or 2) S-NSSAI and DNN based congestion control is activated for the S-NSSAI and DNN included in the UL NAS TRANSPORT message, or S-NSSAI and DNN based congestion control is activated for the S-NSSAI included in the UL NAS TRANSPORT message and the selected DNN in case of no DNN included in the UL NAS TRANSPORT message, or S-NSSAI and DNN based congestion control is activated for the selected S-NSSAI in case of no S-NSSAI included in the UL NAS TRANSPORT message and the DNN 3) S-NSSAI only based congestion control is activated for the S-NSSAI included in the UL NAS TRANSPORT message, or S-NSSAI based congestion control is activat ed for the selected S-NSSAI in case of no S-NSSAI b) if the Request type IE is set to "MA PDU request"; 1) DNN based congestion control is activated for the DNN included in the UL NAS TRANSPORT message, or 2) S-NSSAI and DNN based congestion control is activated for the S-NSSAI and DNN included in the UL NAS TRANSPORT message, or S-NSSAI and DNN based congestion control is activated for the S-NSSAI included in the UL NAS TRANSPORT message and the selected DNN in case of no DNN included in the UL NAS TRANSPORT message, or S-NSSAI and DNN based congestion control is activated for the selected S-NSSAI in case of no S-NSSAI included in the UL NAS TRANSPORT message and the DNN included in the UL NAS TRANSPORT message, or S-NSSAI and DNN based congestion control is activated for the selected S-NSSAI and the selected DNN in case of no S-NSSAI and no DNN included in the UL NAS TRANSPORT message, e.
configured by operation and maintenance, the AMF shall send back to the UE 3) S-NSSAI only based congestion control is activated for the S-NSSAI included in the UL NAS TRANSPORT message, or S-NSSAI based congestion control is activat ed for the selected S-NSSAI in case of no S-NSSAI included in the UL NAS TRANSPORT message, e.
configured by operation and maintenance, the AMF c) if the Request type IE is set to "modification request" and the PDU session is not an emergency PDU session; 1) DNN based congestion control is activated for the stored DNN, e.
configured by operation and 2) S-NSSAI and DNN based congestion control is activated for the stored S-NSSAI and DNN, e.
configured 3) S-NSSAI only based congestion control is activated for the stored S-NSSAI, e.
configured by operation and d) the timer T3447 is running and the UE does not su pport service gap control: 1) the Request type IE: i) is set to "initial request"; ii) is set to "existing PDU session"; or 2) the current NAS signalling connection was not triggered by paging; and 3) mobile terminated signalling has not been sent or no user-plane resources have been established for any PDU session after the establishment of the current NAS signalling connection, the AMF shall send back to the UE the message which was not forwarded, send the 5GMM cause #22 the Request type IE is set to "initial request", "existing PDU session" or "MA PDU request", and the AMF determines that the PLMN's maximum number of PDU sessions has already been reached for the UE, the AMF shall send back to the UE the 5GSM message which was not forwarded and 5GMM cause #65 "maximum number of PDU sessions reached" as specified in subclause case h).
the Request type IE is set to "initial request", and a) the UE is in NB-N1 mode; b) the UE has indicated preference for user plane CIoT 5GS optimization; c) the network accepted the use of user plane CIoT 5GS optimization; and the UE' s maximum number of supported user-plane resources (see 3GPP specification document\), the AMF shall either: a) send back to the UE the message which was not forwarded as specified in in subclause case h1); or Upon reception of an UL NAS TRANSPORT message, if the Payload container type IE is set to "CIoT user data container", the UE is not configured for high priority access in selected PLMN, and: a) the timer T3447 is running and the UE does not su pport service gap control; b) the current NAS signalling connection was not triggered by paging; and c) mobile terminated signalling has not been sent or no user-plane resources have been established for any PDU session after the establishment of the current NAS signalling connection; the AMF shall send back to the UE the CIoT user data which was not forwarded, send the 5GMM cause #22 the Request type IE is set to "existing PDU session", and a) the UE is in NB-N1 mode; b) the UE has indicated preference for user plane CIoT 5GS optimization; c) the network accepted the use of user plane CIoT 5GS optimization; and the UE's maximum number of supported user-plane resources (see 3GPP specification document\), the AMF shall send back to the UE the message which was not forwarded as specified in in subclause Upon reception of an UL NAS TRANSPORT message, if the Payload container type IE is set to "SMS" or "LTE Positioning Protocol (LPP) message container", the UE is not configured for high priority access in selected PLMN, and: a) the timer T3447 is running and the UE does not su pport service gap control; b) the current NAS signalling connection was not triggered by paging; and c) mobile terminated signalling has not been sent or no user-plane resources have been established for any PDU session after the establishment of the current NAS signalling connection; the AMF shall abort the procedure.
NOTE: In this state the NAS signalling connection can be released by the network.
Abnormal cases on the network side The following abnormal cases in AMF are identified: a) if the Payload container type IE is set to "N1 SM information" and: 1) if the Old PDU session ID IE is not included in the UL NAS TRANSPORT message, the AMF does not have a PDU session routing context for the PDU session ID and the UE, the Request type IE is set to "initial request" or "MA PDU request", and the SMF selection fails, then the AMF shall send back to the UE the 5GSM message which was not forwarded as specified in subclause case e) or case f); subclause case e) or case f).
If the S-NSSAI IE is not included and the user's subscription context obtained from UDM: i) contains one default S-NSSAI, the AMF shall use the default S-NSSAI as the S-NSSAI; ii) contains two or more default S-NSSAIs, the AMF shall use one of the default S-NSSAIs selected by operator policy as the S-NSSAI; and Editor's note [eNS; CR# 1996]: It is FFS how the AMF selects an S-NSSAI for the PDU session if {none of the subscribed S-NSSAIs marked as default is included in the allowed NSSAI} or {all subscribed S-NSSAIs If the DNN IE is not included, and the user's subscription context obtained from UDM: i) contains the default DNN for the S-NSSAI, the AMF shall use the default DNN as the DNN; and ID and the UE, set the SMF ID in the stored PDU session routing context to the selected SMF ID, and forward the 5GSM message, the PDU session ID, the old PDU session ID, the S-NSSAI, the mapped S- NSSAI (if available in roaming scenarios), the DNN determined by the AMF, DNN selected by the network (if different from DNN determined by the AMF), the request type and UE presence in LADN service area (if DNN selected by the network corresponds to an LADN DNN) towards the SMF ID of the PDU session routing context.
If the SMF selection fails, then the AMF shall send back to the UE the 5GSM message which was not forwarded as specified in subclause case e) or case f).
context indicates that the PDU session is an emergency PDU session, the Request type IE is set to "initial emergency request", the AMF should forward the 5GSM message, the PDU session ID, the S-NSSAI (if configured in the AMF emergency configuration data), the DNN (if configured in the AMF emergency configuration data) and the request type towards the SMF ID of the PDU session routing context.
6) if the Request type IE is set to "initial emergency request" and the S-NSSAI or the DNN is received, the AMF ignores the received S-NSSAI or the DNN and uses the emergency DNN from the AMF emergency configuration data, if any.
type IE of the UL NAS TRANSPORT message is either not provided or is provided but set to other value then "initial request", "existing PDU session", "initial emergency request", "existing emergency PDU session" and "MA PDU request", then the AMF may send back to the UE the 5GSM message which was not forwarded as specified in subclause case e) or case f).
SMF ID, then the AMF may send back to the UE the 5GSM message which was not forwarded as specified in subclause case e) or case f).
9) the Old PDU session ID IE is included in the UL NAS TRANSPORT message, the AMF does not have a If the S-NSSAI IE is not included and the user's subscription context obtained from UDM: i) contains one default S-NSSAI, the AMF shall use the default S-NSSAI as the S-NSSAI; ii) contains two or more default S-NSSAIs, the AMF shall use one of the default S-NSSAIs selected by operator policy as the S-NSSAI; and Editor's note [eNS; CR# 1996]: It is FFS how the AMF selects an S-NSSAI for the PDU session if {none of the subscribed S-NSSAIs marked as default is included in the allowed NSSAI} or {all subscribed S-NSSAIs If the DNN IE is not included, and the user's subscription context obtained from UDM: i) contains the default DNN for the S-NSSAI, the AMF shall use the default DNN as the DNN; and ID and the UE, set the SMF ID in the stored PDU session routing context to the selected SMF ID, and forward the 5GSM message, the PDU session ID, the old PDU session ID, the S-NSSAI, the mapped S-NSSAI (if available in roaming scenarios), the DNN determined by the AMF, DNN selected by the network (if different from DNN determined by the AMF), the request type and UE presence in LADN service area (if DNN selected by the network corresponds to an LADN DNN) towards the SMF ID of the PDU session If the SMF selection fails, then the AMF shall send back to the UE the 5GSM message which was not forwarded as specified in subclause case e) or case f).
context indicates that the PDU session is not an emergency PDU session, and the Request type IE is included and is set to "existing emergency PDU session", the AMF may send back to the UE the 5GSM message which was not forwarded as specified in subclause case e) or case f).
context indicates that the PDU session is an emergency PDU session, and the Request type IE is included and is set to "existing PDU session", the AMF may forward the 5GSM message, the PDU session ID, the S- NSSAI (if configured in the AMF emergency configuration data), the DNN (if configured in the AMF emergency configuration data), and the request type towards the SMF identified by the SMF ID of the PDU session routing context.
13) if the Request type IE is set to "initial request" and the S-NSSAI IE contains an S-NSSAI that is not allowed by the network, then the AMF shall send back to the UE the 5GSM message which was not forwarded as specified in subclause case e) or case f).
emergency PDU session, and the S-NSSAI associated with the PDU session identified by the PDU session ID is not allowed for the target access type, the AMF shall send back to the UE the 5GSM message which was not forwarded as specified in subclause case e) or case f).
15) if the Request type IE is set to "initial request", "existing PDU session", "modification request" or "MA PDU request", the UE is not configured for high priority access in selected PLMN, and the UE is in non-allowed area or is not in allowed area, the AMF shall send back to the UE the 5GSM message which was not forwarded, and 5GMM cause #28 "Restricted service area" as specified in subclause case i).
16) if the Request type IE is set to "initial request" or "MA PDU request", the AMF is pending the receipt of a REGISTRATION REQUEST message indicating "mobility registration updating" in the 5GS registration type IE, and an emergency PDU session exists for the UE (see subclause\), the AMF shall send back to the UE the 5GSM message which was not forwarded as specified in subclause case e) or case f).
i) the Request type IE: A) is set to "initial request"; B) is set to "existing PDU session"; or ii) the UE is not configured for hi gh priority access in selected PLMN; iii) the current NAS signalling connection was not triggered by paging; and iv) mobile terminated signalling has not been sent or no user-plane resources have been established for any PDU session after the establishment of the current NAS signalling connection, then the AMF shall send back to the UE the 5GSM message which was not forwarded as specified in subclause case e) or case f).
included, the UE is not configured for high priority access in selected PLMN, and the PDU session is not an emergency PDU session, then the AMF shall forward the 5GSM message, and the PDU session ID IE towards the SMF identified by the SMF ID of the PDU session routing context with: i) an exemptionInd attribute indicating "message was exempted from the DNN based congestion activated in the AMF" as specified in 3GPP specification document [20A], if DNN based congestion control is activated for the ii) an exemptionInd attribute indicating "message was exempted from the S-NSSAI and DNN based congestion activated in the AMF" as specified in 3GPP specification document [20A], if S-NSSAI and DNN based congestion control is activated for the selected S-NSSAI and the selected DNN; or iii) an exemptionInd attribute indicating "message was exempted from the S-NSSAI only based congestion activated in the AMF" as specified in 3GPP specification document [20A], if S-NSSAI only based congestion control is activated for the selected S-NSSAI.
19) if the Request type IE is set to "MA PDU request" and the S-NSSAI IE contains an S-NSSAI that is not allowed by the network on neither access, then the AMF shall send to the UE the 5GSM message which was not forwarded as specified in subclause case e) or case f).
20) if the Request type IE is set to "initial request" and the UE is registered for emergency services over the current access, then the AMF may send back to the UE the 5GSM message which was not forwarded as specified in subclause case e) or case f).
3GPP access to non-3GPP access, and the PDU session is associated with control plane only indication then the AMF shall send back to the UE the 5GSM message which was not forwarded as specified in subclause case e).
SMSF address available in the AMF, the AMF shall abort the procedure.
c) If the Payload container type IE is set to "LTE Positioning Protocol (LPP) message container" and if the Additional information IE is not included in the UL NAS TRANSPORT message or the AMF cannot forward the content of the Payload container IE to the LMF asso ciated with the routing information included in the Additional information IE, the AMF shall abort the procedure.
associated with the UE or the AMF cannot forward the cont ent of the Payload container IE to the PCF associated with the PCF address available in the AMF, the AMF shall abort the procedure.
e) If the Payload container type IE is set to "Location services message container" and if the Additional information IE is included in the UL NAS TRANSPORT message and the AMF cannot forward the content of the Payload container IE to an LMF associated wi th the routing information included in the Additional information IE, the AMF shall abort the procedure.
f) If the Payload container type IE is set to "SMS" or "LTE Positioning Protocol (LPP) message container": 1) the timer T3447 is running and the UE su pports service gap control; 2) the UE is not configured for hi gh priority access in selected PLMN; 3) the current NAS signalling connection was not triggered by paging; and 4) mobile terminated signalling has not been sent or no user-plane resources have been established for any PDU session after the establishment ofthe UE in 5GMM-CONNECTED mode receives mobile terminated signalling or downlink data over the user-plane the current NAS signalling connection, the AMF shall abort the procedure.
NOTE: In this state the N1 NAS signalling connection can be released by the network.
g) If the Payload container type IE is set to "CIoT user data container" and: 2) if the AMF unsuccessfully attempted to forward the user data container and the PDU session ID, then the AMF may send back to the UE the CIoT user data container which was not forwarded as specified in h) If the Payload container type IE is set to "CIoT user data container": 2) the UE is not configured for hi gh priority access in selected PLMN; 3) the current N1 NAS signalling connection was not triggered by paging; and 4) mobile terminated signalling has not been sent or no user-plane resources have been established for any PDU session after the establishment of the current NAS signalling connection, then the AMF shall send back to the UE the CIoT user data container which was not forwarded as specified in Abnormal cases in the UE The following abnormal cases can be identified: a) The lower layers indicate that the access attempt is barred.
The UE shall not start the UE-initiated NAS transport procedure.
The UE stays in the current serving cell and applies the normal cell reselection process.
transmit the UL NAS TRANSPORT message via non-3GPP access, if available.
Otherwise, the UE-initiated NAS transport procedure is started, if still needed, when the lower layers indicate that the barring is alleviated for the access category with which the access attempt was associated.
aa) The lower layers indicate that access barring is appli cable for all access categories except categories 0 and 2 and the access category with which the access attempt was associated is other than 0 and The UE shall proceed as specified for case a.
For additional UE requirements see subclause b) If the Payload container type IE is set to "N1 SM information", the Request type IE is set to "initial request" or "MA PDU request" and registration procedure for mobility and periodic registration update is pending due to receipt by the UE of new network slicing information via the generic UE configuration update procedure with re- registration request; and an emergency PDU session exists then: 1) The UE shall not send the UL NAS TRANSPORT message; and and periodic registration update.
c) Transmission failure of the UL NAS TRANSPORT message with TAI change from lower layers.
If the current TAI is not in the TAI list, the UE-initiated NAS transport procedure shall be aborted and a registration procedure for mobility and periodic registration update shall be initiated.
The UL NAS If the current TAI is still part of the TAI list, it is up to the UE implementation how to re-run the ongoing procedure that triggered the UE-ini tiated NAS transport procedure.
d) Transmission failure of the UL NAS TRANSPORT message indication without TAI change from lower layers.
It is up to the UE implementation how to re-run the ongoing procedure that triggered the UE-initiated NAS f) Timer T3447 is running.
The UE shall not send the UL NAS TRANSPORT message unless: 1) the Payload container type IE is set to "N1 SM information" and: i) the Request type IE is set to: A) "initial emergency request"; B) "existing emergency PDU session"; or C) "modification request" and the PDU session being modified is an emergency PDU session (see error cases described in subclause and subclause\); or The UL NAS TRANSPORT message can be sent, if still necessary, when timer T3447 expires.
g) The lower layers indicate that the RRC connection has been suspended.
h) Timer T3346 is running.
The UE shall not send the UL NAS TRANSPORT message unless: 1) the Payload container type IE is set to "N1 SM information" and: i) the Request type IE is set to: A) "initial emergency request"; B) "existing emergency PDU session"; or C) "modification request" and the PDU session being modified is an emergency PDU session; or The UL NAS TRANSPORT message can be sent, if still necessary, when timer T3346 expires.
i) NAS-MAC calculation indication from lower layers.
If lower layers indicate to calculate an NAS-MAC, the UE shall calculate an NAS_MAC as specified in 3GPP specification document and then provide the calculated NAS_MAC and 5 least significant bits of the uplink NAS COUNT used to calculate the NAS-MAC to lower layers (see 3GPP specification document [25A]).
The UE shall increase the uplink NAS COUNT by one after the calculation of the NAS_MAC.
Network-initiated NAS transport procedure 
a) a single 5GSM message; c) an LPP message; d) an SOR transparent container; e) a single uplink 5GSM message which was not forwarded due to routing failure; f) a single uplink 5GSM message which was not forwarded due to congestion control; g) a UE policy container; h) a single uplink 5GSM message which was not forwarded, because the PLMN's maximum number of PDU sessions has been reached; h1) a single uplink 5GSM message which was not forwarded, because the maximum number of PDU sessions with active user-plane resources has been reached; h2) a single uplink 5GSM message which was not forwarded, because of ongoing network slice-specific authentication and authorization procedure for the S-NSSAI that is requested; i) a single uplink 5GSM message which was not forwarded due to service area restrictions; j) a UE parameters update transparent container; k) a location services message; l) a CIoT user data container; l2) a single uplink CIoT user data container which was not forwarded due to congestion control; or m) multiple of the above types.
from the AMF to the UE in a 5GMM message.
Network-initiated NAS transport procedure initiation In 5GMM-CONNECTED mode, the AMF initiates the NAS transport procedure by sending the DL NAS TRANSPORT message, as shown in figure In case a) in subclause , i.
upon reception from an SMF of a 5GSM message without an N1 SM delivery skip a) include the PDU session information (PDU session ID) in the PDU session ID IE; b) set the Payload container type IE to "N1 SM information"; and c) set the Payload container IE to the 5GSM message.
In case b) in subclause , i.
upon reception from an SMSF of an SMS payload, the AMF shall: a) set the Payload container type IE to "SMS"; b) set the Payload container IE to the SMS payload; and c) select the access type to deliver the DL NAS TRANSPORT message as follows in case the access type selection 1) if the UE to receive the DL NAS TRANSPORT message is registered to the network via both 3GPP access and non-3GPP access, the 5GMM context of the UE indicates that SMS over NAS is allowed, the UE is in MICO mode, and the UE is in 5GMM-IDLE mode for 3GPP access and in 5GMM-CONNECTED mode for non-3GPP access, then the AMF selects non-3GPP access.
Otherwise, the AMF selects either 3GPP access or non-3GPP access.
If the delivery of the DL NAS TRANSPORT message over 3GPP access has failed, the AMF may re-send the DL NAS TRANSPORT message over the non-3GPP access.
If the delivery of the DL NAS TRANSPORT message over non-3GPP access has failed, the AMF may re- send the DL NAS TRANSPORT message over the 3GPP access; and 2) otherwise, the AMF selects 3GPP access.
NOTE 1: The AMF selects an access type between 3GPP access and non-3GPP access based on operator policy.
In case c) in subclause i.
upon reception from an LMF of an LPP message payload, the AMF shall: a) set the Payload container type IE to "LTE Positioning Protocol (LPP) message container"; b) set the Payload container IE to the LPP message payload received from the LMF; c) set the Additional information IE to an LCS correlation identifier received from the LMF from which the LPP NOTE 2: The LCS Correlation Identifier is assigned originally by the AMF except for LPP message transfer associated with event reporting for periodic or triggered location as described in subclause of 3GPP specification document [6B], where the LMF assigns the correlation identifier.
AMF and LMF assigned correlation octets) to enable an AMF to distinguish one from the other when received in the Additional Information IE in an UL NAS Transport message.
a) set the Payload container type IE to "SOR transparent container"; and b) set the Payload container IE to the steering of roaming information (see 3GPP specification document\) received from the routing failure, the AMF shall: a) include the PDU session ID in the PDU session ID IE; b) set the Payload container type IE to "N1 SM information"; c) set the Payload container IE to the 5GSM message which was not forwarded; and d) set the 5GMM cause IE to the 5GMM cause #90 "payload was not forwarded" or 5GMM cause #91 "DNN not supported or not subscribed in the slice".
The AMF sets the 5GMM cause IE to the 5GMM cause #91 "DNN not supported or not subscribed in the slice", if the 5GSM message could not be forwarded since SMF selection fails because: 1) the DNN is not supported in the slice identified by the S-NSSAI used by the AMF; or 2) neither the DNN provided by the UE nor the wildcard DNN are in the subscribed DNN list of the UE for the S-NSSAI used by the AMF.
Otherwise, the AMF sets the 5GMM cause IE to the 5GMM cause #90 "payload was not forwarded".
congestion control, the AMF shall: a) include the PDU session ID in the PDU session ID IE; b) set the Payload container type IE to "N1 SM information"; c) set the Payload container IE to the 5GSM message which was not forwarded; d) set the 5GMM cause IE to the 5GMM cause #22 "Congestion", the 5GMM cause #67 "insufficient resources for specific slice and DNN" or the 5GMM cause #69 "insufficient resources for specific slice"; and e) include the Back-off timer value IE.
a) set the Payload container type IE to "UE policy container"; and b) set the Payload container IE to the UE policy container received from the PCF.
the PLMN's maximum number of PDU sessions has been reached, the AMF shall: a) include the PDU session ID in the PDU session ID IE; b) set the Payload container type IE to "N1 SM information"; c) set the Payload container IE to the 5GSM message which was not forwarded; and d) set the 5GMM cause IE to the 5GMM cause #65 "maximum number of PDU sessions reached".
the maximum number of PDU sessions with active user-plane resources has been reached, the AMF shall: a) include the PDU session ID in the PDU session ID IE; of ongoing network slice-specific authentication and authorization procedure for the S-NSSAI that is requested, and for which: a) the AMF determined to reject the request based on local policy; or b) the network slice-specific authentication and authorization has failed for the S-NSSAI or the authorization has been revoked for the S-NSSAI but the AMF has not yet updated the allowed NSSAI for the UE, a) include the PDU session ID in the PDU session ID IE; b) set the Payload container type IE to "N1 SM information"; c) set the Payload container IE to the 5GSM message which was not forwarded; and d) set the 5GMM cause IE to the 5GMM cause #90 "payload was not forwarded".
service area restrictions, the AMF shall: a) include the PDU session ID in the PDU session ID IE; b) set the Payload container type IE to "N1 SM information"; c) set the Payload container IE to the 5GSM message which was not forwarded; and d) set the 5GMM cause IE to the 5GMM cause #28 "Restricted service area".
In case j) in subclause i.
upon reception of UE parameters update data (see 3GPP specification document\) from the UDM to be forwarded to the UE, the AMF shall: a) set the Payload container type IE to "UE parameters update transparent container"; and b) set the contents of the Payload container IE to the UE parameters update data (see 3GPP specification document\) received payload, the AMF shall: a) set the Payload container type IE to "Location services message container"; and b) set the Payload container IE to the Location services message payload.
a) set the Payload container type IE to "Location services message container"; b) set the Payload container IE to the Location services message payload; and c) set the Additional information IE to routing information associated with the LMF from which the Location services message payload was received.
an AMF, the Additional information IE is not included.
a) include the PDU session ID in the PDU session ID IE; b) set the Payload container type IE to "CIoT user data container"; and which was not forwarded due to routing failure, the AMF shall: a) include the PDU session ID in the PDU session ID IE; b) set the Payload container type IE to " CIoT user data container"; c) set the Payload container IE to the CIoT user data cont ainer or control plane user data which was not forwarded; d) set the 5GMM cause IE to the 5GMM cause #90 "payload was not forwarded".
control plane user data in the CONTRON PLANE SERVICE REQUEST message which was not forwarded due to routing failure.
a) include the PDU session ID in the PDU session ID IE; b) set the Payload container type IE to " CIoT user data container"; c) set the Payload container IE to the CIoT user data container which was not forwarded; d) set the 5GMM cause IE to the 5GMM cause #22 "Congestion" and include the Back-off timer value IE.
In case m) in subclause , the AMF shall: a) set the Payload container type IE to "Multiple payloads"; b) set each payload container entry of the Payload container IE (see subclause 9) as follows: Payload container type IE as specified for cases a) to l2) above; ii) set the payload container entry contents field of the payload container entry to the payload container contents set in the Payload container IE as specified for cases a) to l2) above; iii) set the optional IE fields, if any, to the optional associated information as specified for cases a) to l2) above.
Network-initiated NAS transport procedure Network-initiated NAS transport of messages a) "N1 SM information" and the 5GMM cause IE is not included in the DL NAS TRANSPORT message, the 5GSM message in the Payload container IE and the PDU session ID are handled in the 5GSM procedures specified in clause 6; b) "SMS", the UE shall forward the content of the Payload container IE to the SMS stack entity; upper layer location services application; d) "SOR transparent container" and if the Payload container IE: technology combinations is provided and the list type indicates: i) "PLMN ID and access technology list", then the ME shall replace the highest priority entries in the "Operator Controlled PLMN Selector with Access Tec hnology" list stored in the ME and shall proceed with the behaviour as specified in 3GPP specification document annex C; or data download, data coding scheme set to class 2 message and SMS payload as secured packet contents of SOR transparent container IE.
The SMS payload is forwarded to UICC as specified in 3GPP specification document [4A] and the ME shall proceed with the behaviour as specified in 3GPP specification document annex C; or 2) does not successfully pass the integrity check (see 3GPP specification document\) then the UE shall proceed with the behaviour as specified in 3GPP specification document annex C.
g) "N1 SM information" and: 1) the 5GMM cause IE is set to the 5GMM cause #22 "Congestion", the UE passes to the 5GSM sublayer an indication that the 5GSM message was not forwarded due to DNN based congestion control along with the 5GSM message from the Payload container IE of the DL NAS TRANSPORT message, and the time value from the Back-off timer value IE; 2) the 5GMM cause IE is set to the 5GMM cause #28 "Restricted service area", the UE passes to the 5GSM sublayer an indication that the 5GSM message was not forwarded due to service area restrictions along with the 5GSM message from the Payload container IE of the DL NAS TRANSPORT message, enters the state 5GMM-REGISTERED.
NON-ALLOWED-SERVICE and, if the DL NAS TRANSPORT message is received over 3GPP access, performs the registration procedure for mobility and periodic registration update (see subclauses and\); 3) the 5GMM cause IE is set to the 5GMM cause #65 "maximum number of PDU sessions reached", the UE passes to the 5GSM sublayer an indication that the 5GSM message was not forwarded because the PLMN's maximum number of PDU sessions has been reached, along with the 5GSM message from the Payload container IE of the DL NAS TRANSPORT message; 4) the 5GMM cause IE is set to the 5GMM cause #67 "insufficient resources for specific slice and DNN", the UE passes to the 5GSM sublayer an indication that the 5GSM message was not forwarded due to S-NSSAI and DNN based congestion control along with the 5GSM message from the Payload container IE of the DL NAS TRANSPORT message, and the time value from the Back-off timer value IE; 5) the 5GMM cause IE is set to the 5GMM cause #69 "insufficient resources for specific slice", the UE passes to the 5GSM sublayer an indication that the 5GSM message was not forwarded due to S-NSSAI only based congestion control along with the 5GSM message from the Payload container IE of the DL NAS TRANSPORT message, and the time value from the Back-off timer value IE; 6) the 5GMM cause IE is set to the 5GMM cause #90 "payload was not forwarded", the UE passes to the 5GSM sublayer an indication that the 5GSM message was not forwarded due to routing failure along with the 5GSM message from the Payload container IE of the DL NAS TRANSPORT message; 7) the 5GMM cause IE is set to the 5GMM cause #91 "DNN not supported or not subscribed in the slice", the h) "UE policy container", the UE policy container in the Payload container IE is handled in the UE policy delivery procedures specified in Annex D; i) "UE parameters update transparent container" and if the Payload container IE 1) successfully passes the integrity check (see 3GPP specification document\): set type indicating "Routing indicator update data", A) the ME shall behave as if an SMS is received with protocol identifier set to SIM data download, data coding scheme set to class 2 message and SMS payload as secured packet contents of UE parameters update transparent container IE.
The SMS payload is forwarded to UICC as specified in 3GPP specification document [4A]; and B) if the ACK bit of the UE parameters update header in the UE parameters update transparent container is set to "acknowledgment requested" and if the ME receives status bytes from the UICC indicating that the UICC has received the secured packet succes sfully, the ME shall send an acknowledgement in the Payload container IE of an UL NAS TRANSPORT message with Payload type IE set to "UE parameters update transparent container" as specified in subclause ; and if the REG bit of the UE parameters update header in the UE parameters update transparent container IE is set to "re-registration requested", and: C1) the UE is registered over 3GPP access, then the UE shall wait until it enters 5GMM-IDLE mode over 3GPP access or 5GMM-CONNECTED mode with RRC inactive indication, and then C2) the UE is registered over non-3GPP access and does not have emergency services ongoing over non-3GPP access, then the UE shall locally release the N1 NAS signalling connection and C3) the UE is registered over non-3GPP access and has an emergency services ongoing over non- set type indicating "Default configured NSSAI update data", A) if the ACK bit of the UE parameters update header in the UE parameters update transparent container B) the ME shall replace the stored default configured NSSAI with the default configured NSSAI included in the default configured NSSAI update data; and content of the payload container IE; j) "Location services message container" and the 5GMM cause IE is not included in the DL NAS TRANSPORT message, the UE shall forward the payload container type, the content of the Payload container IE and the routing information in the Additional information IE if included to the upper layer location services application; k) "CIoT user data container", the UE shall forward the content of the Payload container IE and the PDU session ID to the 5GSM sublayer; and l) "CIoT user data container" and: 1) the 5GMM cause IE is set to the 5GMM cause #22 "Congestion", the UE passes to the 5GSM sublayer an indication that the CIoT user data was not forwarded due to DNN based congestion control along with the CIoT user data from the Payload container IE of the DL NAS TRANSPORT message, and the time value from the Back-off timer value IE.
2) the 5GMM cause IE is set to the 5GMM cause #90 "payload was not forwarded", the UE passes to the 5GSM user data container from the Payload container IE and the PDU session ID from the PDU session ID IE of the DL NAS TRANSPORT message.
m) "Multiple payloads", the UE shall first decode the content of the Payload container IE (see subclause 9) to obtain the number of payload container entries and for each payload container entry, the UE shall: 1) decode the payload container type field; 2) decode the optional IE fields and the payload container contents field in the payload container entry; and 3) handle the content of each payload container entry the same as the content of the Payload container IE and the associated optional IEs as specified in bullets a) to l) above according to the payload container type field.
The purpose of the 5GMM status procedure is to report at any time in the 5GMM STATUS message certain error conditions detected upon receipt of 5GMM protocol data in the AMF or in the UE.
The 5GMM STATUS message can be sent by both the AMF and the UE (see example in figure\).
5GMM status procedure radio interface, i.
local actions are possible.
The local actions to be taken by UE on receipt of a 5GMM STATUS message are implementation dependent.
5GMM status received in the network On receipt of a 5GMM STATUS message in the AMF, no state transition and no specific action shall be taken as seen from the radio interface, i.
local actions are possible.
The local actions to be taken by the AMF on receipt of a 5GMM STATUS message are implementation dependent.
Network slice-specific authentication and authorization procedure.
The purpose of the network slice-specific authentication and authorization procedure is to enable the authentication, authorization and accounting server (AAA-S) via the Network Slice Specific Authentication and Authorization Function (NSSAAF) to (re-)authenticate or (re-)authorize the upper layers of the UE.
3GPP specification document and subclause of 3GPP specification document\).
The network (re-)authenticates the UE using the EAP as specified in IETF RFC 3748 .
EAP has defined four types of EAP messages: a) an EAP-request message; b) an EAP-response message; c) an EAP-success message; and d) an EAP-failure message.
The EAP-request message is transported from the network to the UE using the NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message of the network slice-specific EAP message reliable transport procedure.
The EAP-response message to the EAP-request message is transported from the UE to the network using the NETWORK SLICE-SPECIFIC SESSION AUTHENTICATION COMPLETE message of the network slice-specific EAP message reliable transport procedure.
If the (re-)authentication of the UE completes successfully or unsuccessfully, the EAP-success message or the EAP- failure message, respectively, is transported from the network to the UE using the NETWORK SLICE-SPECIFIC AUTHENTICATION RESULT message of the network slice-specific result message transport procedure.
AAA-S via the Network Slice Specific Authentication and Authorization Function (NSSAAF) to complete the (re-)authentication and (re-)authorization of the request for an S-NSSAI (see example in figure\).
The AMF shall set the authenticator retransmission timer specified in subclause of IETF RFC 3748 to infinite value.
EAP messages and therefore retransmissions at the EAP layer of the AMF do not occur.
Network slice-specific authentication and authorization procedure Network slice-specific EAP message reliable transport procedure Network slice-specific EAP message reliable transport procedure initiation In order to initiate the network slice-specific EAP message reliable transport procedure, the AMF shall create a NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message.
The AMF shall set the EAP message IE of the NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message to the EAP-request message which is generated by the AMF or provided by the AAA-S via the Network Slice Specific Authentication and Authorization Function (NSSAAF).
The AMF shall set the S-NSSAI IE of the NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message to the HPLMN S-NSSAI to which the EAP-request message is related.
The AMF shall send the NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message and start timer T3575 per S-NSSAI (see example in figure\).
The UE shall pass: a) the EAP-request message received in the EAP message IE; and b) the HPLMN S-NSSAI in the S-NSSAI IE; to the upper layers.
Apart from this action, the network slice-specific authentication and authorization procedure is transparent to the 5GMM layer of the UE.
When the upper layers provide an EAP-response message associated with the HPLMN S-NSSAI, the UE shall create a NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message.
The UE shall set the EAP message IE of the NETWORK SLICE-SPECIFIC SESSION AUTHENTICATION COMPLETE message to the EAP-response message.
The UE shall set the S-NSSAI IE of the NETWORK SLICE-SPECIFIC SESSION AUTHENTICATION COMPLETE message to the HPLMN S-NSSAI associated with the EAP-response message.
The UE shall send the NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message.
Apart from this action, the network slice-specific authen tication and authorization procedure is transparent to the 5GMM layer of the a) pass the EAP-request message received in the EAP message IE of the NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message associated with the HPLMN S-NSSAI in the S-NSSAI IE to the upper layers; or b) provide the EAP-response message received in the EAP message IE of the NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message associated with the HPLMN S-NSSAI in the S-NSSAI IE to the AAA-S via the Network Slice Specific Authentication and Authorization Function (NSSAAF).
Abnormal cases on the network side The following abnormal cases can be identified: The AMF shall, on the first expiry of the timer T3575, retransmit the NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message and shall reset and start timer T357 This retransmission is b) Lower layers indication of non-delivered NAS PDU due to handover If the NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message could not be delivered due to an intra AMF handover and the target TAI is included in the TAI list, then upon successful completion of the signalling connection exists, the AMF shall retransmit the NETWORK SLICE-SPECIFIC AUTHENTICATION c) Network slice-specific authentication and authorization procedure and de-registration procedure collision authentication and authorization pr ocedure has been completed and the access type included in the DEREGISTRATION REQUEST message is the same as the one for which the network slice-specific authentication and authorization procedure is ongoing, the network shall abort the network slice-specific authentication and authorization procedure and shall pr ogress the UE-initiated de-registration procedure.
The AMF may initiate the network slice-specific authentication and authorization procedure for the S-NSSAI via is Abnormal cases in the UE The following abnormal cases can be identified: a) Transmission failure of the NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message with TAI change from lower layers registration updating" in the 5GS registration type IE of the REGISTRATION REQUEST message shall be initiated.
If the current TAI is still part of the TAI list, it is up to the UE implementation how to re-run the ongoing procedure that triggered the network slice-speci fic authentication and authorization procedure.
b) Transmission failure of NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message indication without TAI change from lower layers It is up to the UE implementation how to re-run the ongoing procedure that triggered the network slice-specific authentication and authorization procedure.
c) Network slice-specific authentication and authorization procedure and de-registration procedure collision If the UE receives NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message after sending a DEREGISTRATION REQUEST message and the access type included in the DEREGISTRATION REQUEST shall proceed with both procedures.
Network slice-specific EAP result message transport procedure Network slice-specific EAP result message transport procedure initiation The AMF shall set the EAP message IE of the NETWORK SLICE-SPECIFIC AUTHENTICATION RESULT message to the EAP-success or EAP-failure message provided by the AAA-S via the Network Slice Specific Authentication and Authorization Function (NSSAAF).
The AMF shall set the S-NSSAI IE of the NETWORK SLICE-SPECIFIC AUTHENTICATION RESULT message to the HPLMN S-NSSAI to which the EAP-success or EAP-failure message is related.
The AMF shall send the NETWORK SLICE-SPECIFIC AUTHENTICATION RESULT message.
The AMF shall retain the authentication result for the UE and the HPLMN S-NSSAI while the UE is registered to the PLMN (see subclause 0 in 3GPP specification document\).
a) the EAP-success or EAP-failure message received in the EAP message IE; and b) the HPLMN S-NSSAI in the S-NSSAI IE; to the upper layers.
Apart from this action, the network slice-specific authentication and authorization procedure is transparent to the 5GMM layer of the UE.
The registration procedure is always initiated by the UE and used for initial registration as specified in subclause or mobility and periodic registration update as specified in subclause When the UE needs to initiate registration over both 3GPP access and non-3GPP access in the same PLMN (e.
the 3GPP access and the selected N3IWF are located in the same PLMN), the UE: implementation.
a) registration state and state machine over non-3GPP access; b) 5G NAS security context; A registration attempt counter is used to limit the number of subsequently rejected registration attempts.
The registration attempt counter shall be incremented as specified in subclause or subclause Depending on the value of the registration attempt counter, specific actions shall be performed.
The registration attempt counter shall be reset when: the UE is powered on; a USIM is inserted; - a registration procedure is successfully completed; an EPS attach or combined EPS attach procedure is su ccessfully completed in S1 mode and the UE is operating in single-registration mode.
In this case, the UE shall reset the registration attempt counter for 3GPP access; NOTE 2: The registration attempt counter for non-3GPP access is not impacted by the EPS attach and the combined EPS attach procedure.
a registration procedure is rejected with cause #11, #12, #13, #15, #27, #31, #62, #72, #73, #74, #75, #76 or #77; - a network initiated deregistration procedure is completed with cause #11, #12, #13, #15, #27; #72, #74, #75, #76 a new PLMN is selected.
Additionally, the registration attempt counter shall be reset when the UE is in substate 5GMM- DEREGISTERED.
ATTEMPTING-REGISTRATION-UPDATE, and: a new tracking area is entered; timer T3502 expires; or timer T3346 is started.
When the registration attempt counter is reset, the UE shall stop timer T3519 if running, and delete any stored SUCI.
The lower layers indicate to NAS whether the network supports emergency services for the UE in limited service state (see 3GPP specification document\).
This information is taken into account when deciding whether to initiate an initial registration for emergency services.
Registration procedure for initial registration.
a) when the UE performs initial registration for 5GS services; b) when the UE performs initial registration for emergency services; c) when the UE performs initial registration for SMS over NAS; and coverage and the following applies: 2) the UE has performed 5G-SRVCC from NG-RAN to UTRAN as specified in 3GPP specification document [6A], or registration procedure in N1 mode, with the following clarifications to initial registration for emergency services: a) the UE shall not initiate an initial registration for emergency services over the current access, if the UE is already registered for emergency services over the non-current access, unless the initial registration has to be initiated to perform handover of an existing emergency PDU session from the non-current access to the current access; and NOTE 1: Transfer of an existing emergency PDU session between 3GPP access and non-3GPP access is needed e.
if the UE determines that the current access is no longer available.
b) the UE can only initiate an initial registration for emergency services over non-3GPP access if it cannot register for emergency services over 3GPP access.
During initial registration the UE handles the 5GS mobile identity IE in the following order: i) was previously registered in S1 mode before entering state EMM-DEREGISTERED; and ii) has received an "interworking without N26 interface not supported" indication from the network; and then the UE shall create a 5G-GUTI mapped from the valid 4G-GUTI and indicate the mapped 5G-GUTI in the 5GS mobile identity IE.
The UE shall include the UE status IE with the EMM registration status set to "UE is not in EMM-REGISTERED state" and shall include an ATTACH REQUEST message as specified in 3GPP specification document in the EPS NAS message container IE.
the REGISTRATION REQUEST message in the following order: 1) a valid 5G-GUTI that was previously assigned by the same PLMN with which the UE is performing the 2) a valid 5G-GUTI that was previously assigned by an equivalent PLMN, if available; and same PLMN with which the UE is performing the registration, the UE shall indicate the 5G-GUTI in the 5GS equivalent PLMN, the UE shall indicate the 5G-GUTI in the 5GS mobile identity IE; PLMN, the UE shall indicate the 5G-GUTI in the 5GS mobile identity IE; services, the PEI shall be included in the 5GS mobile identity IE.
If the SUCI is included in the 5GS mobile identity IE and the timer T3519 is not running, the UE shall start timer T3519 and store the value of the SUCI sent in the REGISTRATION REQUEST message.
The UE shall include the stored SUCI in the REGISTRATION REQUEST message while timer T3519 is running.
If the UE is operating in the dual-registration mode and it is in EMM state EMM-REGISTERED, the UE shall include the UE status IE with the EMM registration status set to "UE is in EMM-REGISTERED state".
NOTE 2: Inclusion of the UE status IE with this setting corresponds to the indication that the UE is "moving from EPC" as specified in 3GPP specification document .
NOTE 3: The value of the 5GMM registration status included by the UE in the UE status IE is not used by the If the last visited registered TAI is available, the UE shall include the last visited registered TAI in the REGISTRATION REQUEST message.
If the UE requests the use of SMS over NAS, the UE shall include the 5GS update type IE in the REGISTRATION REQUEST message with the SMS requested bit set to "SMS over NAS supported".
When the 5GS update type IE is included in the REGISTRATION REQUEST for reasons other than requesting the use of SMS over NAS, and the UE does not need to register for SMS over NAS, the UE shall set the SMS requested bit of the 5GS update type IE to "SMS over NAS not supported" in the REGISTRATION REQUEST message.
If the UE supports MICO mode and requests the use of MICO mode, then the UE shall include the MICO indication IE in the REGISTRATION REQUEST message.
If the UE requests to use an active time value, it shall include the active time value in the T3324 IE in the REGISTRATION REQUEST message.
Additionally, if the UE supports strictly periodic registration timer, the UE shall set the Strictly Periodic Registration Timer Indication bit of the MICO indication IE in the REGISTRATION REQUEST message to "strictly periodic registration timer supported".
If the UE needs to use the UE specific DRX parameters, the UE shall include the Requested DRX parameters IE in the If the UE is in NB-N1 mode and if the UE needs to use the UE specific DRX parameters for NB-N1 mode, the UE shall include the Requested NB-N1 mode DRX parameters IE in the REGISTRATION REQUEST message.
If the UE supports eDRX and requests the use of eDRX, the UE shall include the Requested extended DRX parameters IE in the REGISTRATION REQUEST message.
as specified in 3GPP specification document , the UE shall in clude the LADN indication IE in the REGISTRATION REQUEST DNN for which the UE requests LADN information; or NSSAI for the current PLMN; NSSAI for the current PLMN; or from the configured NSSAI for which no corresponding S-NSSAI is present in the allowed NSSAI and those are neither in the rejected NSSAI for the current PLMN nor in the rejected NSSAI for the current registration area nor in the rejected NSSAI for the failed or revoked NSSAA.
a) include the S-NSSAI(s) in the Requested NSSAI IE of the REGISTRATION REQUEST message using the default configured NSSAI; and b) include the Network slicing indication IE with the Default configured NSSAI indication bit set to "Requested NSSAI created from default configured NSSAI" in the REGISTRATION REQUEST message.
The subset of configured NSSAI provided in the requested NSSAI consists of one or more S-NSSAIs in the configured NSSAI applicable to the current PLMN, if the S-NSSAI is ne ither in the rejected NSSAI for the current PLMN nor in the rejected NSSAI for the current registration area nor in the rejected NSSAI for the failed or revoked NSSAA.
The subset of allowed NSSAI provided in the requested NSSAI consists of one or more S-NSSAIs in the allowed NSSAI for the current PLMN.
NOTE 4: How the UE selects the subset of configured NS SAI or allowed NSSAI to be provided in the requested NSSAI is implementation specific.
The UE can take preferences indicated by the upper layers (e.
policies like URSP, app lications) into account.
NOTE 5: The number of S-NSSAI(s) included in the requested NSSAI cannot exceed eight.
If the UE initiates an initial registration for emergency services or needs to prolong the established NAS signalling connection after the completion of the initial registration procedure (e.
due to uplink signalling pending), the UE shall set the Follow-on request indicator to "Follow-on request pending".
NOTE 6: The UE does not have to set the Follow-on request indicator to 1, even if the UE has to request resources for V2X communication over PC5 reference point.
If the UE supports S1 mode, the UE shall: set the S1 mode bit to "S1 mode supported" in the 5GMM capability IE of the REGISTRATION REQUEST include the S1 UE network capability IE in the REGISTRATION REQUEST message; and attach bit to "attach request message containing PDN connectivity request with request type set to handover to transfer PDU session from N1 mode to S1 mode supported" in the 5GMM capability IE of the REGISTRATION If the UE supports the LTE positioning protocol (LPP) in N1 mode as specified in 3GPP specification document , the UE shall set the LPP bit to "LPP in N1 mode supported" in the 5GMM capability IE of the REGISTRATION REQUEST message.
If the UE supports the Location Services (LCS) notification mechanisms in N1 mode as specified in 3GPP specification document [6B], the UE shall set the 5G-LCS bit to "LCS notification mechanisms supported" in the 5GMM capability IE of the REGISTRATION REQUEST message.
optimization supported" in the S1 UE network capability IE of the REGISTRATION REQUEST message.
If the UE supports N3 data transfer and multiple user-plane resources in NB-N1 mode (see 3GPP specification document [25D], 3GPP specification document [25A]), then the UE shall set the Multiple user-plane resources support bit to "Multiple user-plane resources supported" in the 5GMM capability IE of the REGISTRATION REQUEST message.
If the UE supports 5G-SRVCC from NG-RAN to UTRAN as specified in 3GPP specification document [6A], the UE shall: set the 5G-SRVCC from NG-RAN to UTRAN capability bit to "5G-SRVCC from NG-RAN to UTRAN supported" in the 5GMM capability IE of the REGISTRATION REQUEST message; and include the Mobile station classmark 2 IE and the Supported codecs IE in the REGISTRATION REQUEST If the UE supports service gap control, then the UE shall set the SGC bit to "service gap control supported" in the 5GMM capability IE of the REGISTRATION REQUEST message.
If the UE supports the restriction on use of enhanced coverage, the UE shall set the RestrictEC bit to "Restriction on use of enhanced coverage supported" in the 5GMM cap ability IE of the REGISTRATION REQUEST message.
If the UE supports network slice-specific authentication and authorization, the UE shall set the NSSAA bit to "network slice-specific authentication and authorization suppor ted" in the 5GMM capability IE of the REGISTRATION If the UE supports CAG feature, the UE shall set the CAG bit to "CAG Supported" in the 5GMM capability IE of the When the UE is not in NB-N1 mode, if the UE supports RACS, the UE shall: a) set the RACS bit to "RACS supported" in the 5GMM capability IE of the REGISTRATION REQUEST b) if the UE has an applicable network-assigned UE radio capability ID for the current UE radio configuration in the selected PLMN or SNPN, include the applicable network-assigned UE radio capability ID in the UE radio capability ID IE of the REGISTRATION REQUEST message; and c) if the UE: 1) does not have an applicable network-assigned UE radio capability ID for the current UE radio configuration in the selected PLMN or SNPN; and 2) has an applicable manufacturer-assigned UE radio capability ID for the current UE radio configuration, include the applicable manufacturer-assigned UE radio capability ID in the UE radio capability ID IE of the HPLMN or the selected PLMN, the UE shall set the Payload container type IE to "UE policy container" and include the UE STATE INDICATION message (see annex D) in the Payload container IE of the REGISTRATION REQUEST message.
NOTE 7: In this version of the protocol, the UE can only include the Payload container IE in the REGISTRATION REGISTRATION REQUEST message including the NAS message container IE as described in subclause If the including the NAS message container IE.
The UE shall set the WUSA bit to "WUS assistance inform ation reception supported" in the 5GMM capability IE if the UE supports WUS assistance information.
The UE may include its UE paging probability information in the Requested WUS assistance information IE if the UE has set the WUSA bit to "WUS assistance inform ation reception supported" in the 5GMM capability IE and the UE is not performing the initial registration for emergency services.
REGISTRATION REQUEST message that is obtained from the NAS message container IE as described in subclause If the UE supports V2X as specified in 3GPP specification document [19B], the UE shall set the V2X bit to "V2X supported" in the 5GMM capability IE of the REGISTRATION REQUEST messag e.
If the UE supports V2X communication over E- UTRA-PC5 as specified in 3GPP specification document [19B], the UE shall set the V2XCEPC5 bit to "V2X communication over E-UTRA-PC5 supported" in the 5GMM capability IE of the REGISTRATION REQUEST message.
If the UE supports V2X communication over NR-PC5 as specified in 3GPP specification document [19B], the UE shall set the V2XCNPC5 bit to "V2X communication over NR-PC5 supported" in th e 5GMM capability IE of the REGISTRATION REQUEST If the W-AGF acting on behalf of an N5GC device initiates an initial registration as specified in 3GPP specification document [6D], the W-AGF acting on behalf of the N5GC device shall include the N5GC indication IE with the N5GC device indication bit set to "N5GC device registration is requested" in the REGISTRATION REQUEST message.
Registration procedure for initial registration during the registration procedure, depending on the information received in the REGISTRATION REQUEST message.
to support emergency registration for unauthenticated SUCIs, the AMF may choose to skip the authentication procedure even if no 5G NAS security context is available and pro ceed directly to the execution of the security mode control Initial registration accepted by the network For each of the information elements: 5GMM capability, S1 UE network capability, and UE security capability, the AMF shall store all octets received from the UE in the REGISTRATION REQUEST message, up to the maximum length defined for the respective information element.
NOTE 1: This information is forwarded to the new AMF during inter-AMF handover or to the new MME during inter-system handover to S1 mode.
NOTE 2: The N3GPP TAI is operator-specific.
NOTE 3: When assigning the TAI list, the AMF can take into account the eNodeB's capability of support of CIoT The AMF may include service area restrictions in the Service area list IE in the REGISTRATION ACCEPT message.
in the forbidden PLMN list as specified in subclause 3A.
In addition, the UE shall add to the stored list the PLMN code of the registered PLMN that sent the list.
The UE shall replace the stored list on each receipt of the shall delete the stored list.
If the initial registration procedure is not for emergency services, and if the PLMN identity of the registered PLMN is a member of the forbidden PLMN list as specified in subclause 3A, any such PLMN identity shall be deleted from the corresponding list(s).
If the Service area list IE is not included in the REGIST RATION ACCEPT message, any tracking area in the registered PLMN and its equivalent PLMN(s) in the registration area is considered as an allowed tracking area as described in If the REGISTRATION REQUEST message contains the LADN indication IE, based on the LADN indication IE, UE subscription information, UE location and local configuration about LADN and: if the LADN indication IE includes requested LADN DNNs, the UE subscribed DNN list includes the requested LADN DNNs or the wildcard DNN, and the LADN service area of the requested LADN DNN has an intersection with the current registration area, the AMF shall determine the requested LADN DNNs included in the LADN indication IE as LADN DNNs for the UE; area has an intersection with the current registration area as LADN DNNs for the UE; or if no requested LADN DNNs included in the LADN indication IE and the wildcard DNN is not included in the UE subscribed DNN list, the AMF shall determine the LADN DNN(s) included in the UE subscribed DNN list whose LADN service area has an intersection with the current registration area as LADN DNNs for the UE.
If the LADN indication IE is not included in the REGISTRATION REQUEST message, the AMF shall determine the LADN DNN(s) included in the UE subscribed DNN list whose service area has an intersection with the current registration area as LADN DNNs for the UE, except for the wildcard DNN included in the UE subscribed DNN list.
If the UE supports WUS assistance information and the AMF supports and accepts the use of WUS assistance information for the UE, then the AMF shall determine the negotiated UE paging probability information for the UE, store it in the 5GMM context of the UE, and if the UE is not performing the initial registration for emergency services, the AMF shall include it in the Negotiated WUS assistance information IE in the REGISTRATION ACCEPT message.
The AMF may consider the UE paging probability information received in the Requested WUS assistance information IE when determining the negotiated UE paging probability information for the UE.
NOTE 4: Besides the UE paging probability information requested by the UE, the AMF can take local UE paging probability information for the UE.
The AMF shall include the LADN information which consists of the determined LADN DNNs for the UE and LADN service area(s) available in the current registration area in the LADN information IE of the REGISTRATION ACCEPT message.
The UE, upon receiving the REGISTRATION ACCEPT message with the LADN information, shall store the received LADN information.
If there exists one or more LADN DNNs which are included in the LADN indication IE of the REGISTRATION REQUEST message and are not included in the LADN information IE of the REGISTRATION ACCEPT message, the UE considers such LADN DNNs as not available in the current registration area.
The 5G-GUTI reallocation shall be part of the initial registration procedure.
During the initial registration procedure, if in the REGISTRATION ACCEPT message the new assigned 5G-GUTI together with the assigned TAI list.
If the UE has set the CAG bit to "CAG supported" in the 5GMM capability IE of the REGISTRATION REQUEST message and the AMF needs to update the "CAG information list" stored in the UE, the AMF shall include the CAG information list IE in the REGISTRATION ACCEPT message.
If a 5G-GUTI or the SOR transparent container IE is included in the REGISTRATION ACCCEPT message, the AMF shall start timer T3550 and enter state 5GMM-COMMON-PROCEDURE-INITIATED as described in If the Operator-defined access category definitions IE, the Extended emergency number list IE or the CAG information list IE are included in the REGISTRATION ACCCEPT message, the AMF shall start timer T3550 and enter state 5GMM-COMMON-PROCEDURE-INITIATED as described in subclause If the UE is not in NB-N1 mode and the UE has set the RACS bit to "RACS supported" in the 5GMM Capability IE of capability ID deletion indication IE in the REGISTRATION ACCEPT message.
If the UE radio capability ID IE or the UE radio capability ID deletion indication IE is included in the REGISTRATION ACCCEPT message, the AMF shall start timer T3550 and enter state 5GMM-COMMON-PROCEDURE-INITIATED as described in subclause The AMF shall include the MICO indication IE in the REGISTRATION ACCEPT message only if the MICO indication IE was included in the REGISTRATION REQUEST message, the AMF supports and accepts the use of MICO mode.
If the AMF supports and accepts the use of MICO mode, the AMF may indicate "all PLMN registration area allocated" in the MICO indication IE in the REGI STRATION ACCEPT message.
If "all PLMN registration area allocated" is indicated in the MICO indication IE, the AMF shall not assign and include the TAI list in the REQUEST message was sent over the 3GPP access.
The AMF shall include the non-3GPP de-registration timer value IE in the REGISTRATION ACCEPT message only if the REGISTRATION REQUEST message was sent for the non-3GPP access.
If the UE requests "control plane CIoT 5GS optimization" in the 5GS update type IE, indicates support of control plane CIoT 5GS optimization in the 5GMM capability IE and the AMF decides to accept the requested CIoT 5GS optimization and the registration request, the AMF shall indicate "control plane CIoT 5GS optimization supported" in the 5GS network feature support IE of the REGISTRATION ACCEPT message.
The AMF may include the T3447 value IE set to the service gap time value in the REGISTRATION ACCEPT message the UE has indicated support for service gap control in the REGISTRATION REQUEST message; and a service gap time value is available in the 5GMM context.
in the REGISTRATION REQUEST message, the AMF shall ignore the flag and proceed as if the flag was not received except for the following cases: a) the UE is configured for high priority access in the selected PLMN; or b) the 5GS registration type IE in the REGISTRATION REQUEST message is set to "emergency registration".
If the UE has indicated support for the control plane CIoT 5GS optimizations, and the AMF decides to activate the congestion control for transport of user da ta via the control plane, then the AMF shall include the T3448 value IE in the.
the UE in NB-N1 mode is using control plane CIoT 5GS optimization; and the network is configured to provide the truncated 5G-S-TMSI configuration for control plane CIoT 5GS the AMF shall include the Truncated 5G-S-TMSI configuration IE in the REGISTRATION ACCEPT message and set the "Truncated AMF Set ID value" and the "Truncated AMF Pointer value" in the Truncated 5G-S-TMSI configuration IE based on network policies.
The AMF shall start timer T3550 and enter state 5GMM-COMMON-PROCEDURE- INITIATED as described in subclause Upon receipt of the REGISTRATION ACCEPT message, the UE shall reset the registration attempt counter, enter state 5GMM-REGISTERED and set the 5GS update status to 5U1 UPDATED.
attempt counter for that PLMN for the specific access type for which the message was received.
The UE shall also reset the PLMN-specific N1 mode attempt counter for that PLMN for the specific access type for which the message was received.
If the message was received via 3GPP access, the UE shall reset the counter for "SIM/USIM considered invalid for GPRS services" events and the counter for "SIM /USIM considered invalid for non-GPRS services" events, if any.
If the message was received via non-3GPP access, the UE shall reset the counter for "USIM considered invalid for 5GS services over non-3GPP" events.
If the UE receives the REGISTRATION ACCEPT message from an SNPN, then the UE shall reset the SNPN-specific attempt counter for the current SNPN for the specific access type for which the message was received.
If the message was received via 3GPP access, the UE shall reset the counter for "the entry for the current SNPN considered invalid for 3GPP access" events.
If the message was received via non-3GPP access, the UE shall reset the counter for "the entry for the current SNPN considered invalid for non-3GPP access" events.
value in non-3GPP de-registration timer value IE as non-3GPP de-registration timer.
COMPLETE message to the AMF to acknowledge the received 5G-GUTI, stop timer T3519 if running, and delete any message is sent over the non-3GPP access, and the UE is in 5GMM-REGISTERED in both 3GPP access and non-3GPP access in the same PLMN.
If the REGISTRATION ACCEPT message contains the Network slicing indication IE with the Network slicing new configured NSSAI for the current PLMN and optionally the mapped S-NSSAI(s) for the configured NSSAI for the If the REGISTRATION ACCEPT message contains the CAG in formation list IE and the UE had set the CAG bit to "CAG supported" in the 5GMM capability IE of the REGISTRATION REQUEST message, the UE shall: a) replace the "CAG information list" stored in the UE wi th the received CAG information list IE when received in b) replace the serving VPLMN's entry of the "CAG information list" stored in the UE with the serving VPLMN's VPLMN, if any, in the received CAG information list IE are ignored.
The UE shall store the "CAG information list" received in the CAG information list IE as specified in annex C.
If the received "CAG information list" includes an entry containing the identity of the registered PLMN, the UE shall the received "CAG information list" does not include any of the CAG-ID(s) supported by the current CAG cell, 1) the entry for the registered PLMN in the received "CAG information list" does not include an "indication that with the updated "CAG information list"; or 2) the entry for the registered PLMN in the received "CAG information list" includes an "indication that the UE is only allowed to access 5GS via CAG cells" and: i) if the entry for the registered PLMN in the received "CAG information list" includes one or more CAG- IDs, the UE shall enter the state 5GMM-REGISTERED.
LIMITED-SERVICE and shall search for a suitable cell according to 3GPP specification document with the updated "CAG information list"; or ii) if the entry for the registered PLMN in the received "CAG information list" does not include any CAG-ID A) the UE does not have an emergency PDU session, then the UE shall enter the state 5GMM- DEREGISTERED.
PLMN-SEARCH and shall apply the PLMN selection process defined in 3GPP specification document with the updated "CAG information list"; or associated with 3GPP access except for the emergency PDU session; or via CAG cells" and: 1) if the "allowed CAG list" for the registered PLMN in the received "CAG information list" includes one or 2) if the entry for the registered PLMN in the received "CAG information list" does not include any CAG-ID i) the UE does not have an emergency PDU session, then the UE shall enter the state 5GMM- DEREGISTERED.
PLMN-SEARCH and shall apply the PLMN selection process defined in 3GPP specification document with the updated "CAG information list"; or associated with 3GPP access except for the emergency PDU session.
If the REGISTRATION ACCEPT message contains the UE radio capability ID IE or the UE radio capability ID 5GMM-REGISTERED.
The 5G-GUTI, if sent in the REGISTRATION ACCEPT message, shall be considered as valid, and the UE radio capability ID, if sent in the REGISTRATION ACCEPT, shall be considered as valid.
If the 5GS update type IE was included in the REGISTRATION REQUEST message with the SMS requested bit set to "SMS over NAS supported", and SMSF selection is successful, then the AMF shall send the REGISTRATION ACCEPT message after the SMSF has confirmed that the activation of the SMS service was successful.
When sending the REGISTRATION ACCEPT message, the AMF shall: a) set the SMS allowed bit of the 5GS registration result IE to "SMS over NAS allowed" in the REGISTRATION ACCEPT message, if the UE has set the SMS requested bit of the 5GS update type IE to "SMS over NAS supported" in the REGISTRATION REQUEST message and the network allows the use of SMS over NAS for the UE; and b) store the SMSF address and the value of the SMS allowed bit of the 5GS registration result IE in the UE 5GMM context and consider the UE available for SMS over NAS.
a) the SMSF selection in the AMF is not successful; b) the SMS activation via the SMSF is not successful; c) the AMF does not allow the use of SMS over NAS; d) the SMS requested bit of the 5GS update type IE was set to "SMS over NAS not supported" in the REGISTRATION REQUEST message; or e) the 5GS update type IE was not included in the REGISTRATION REQUEST message; then the AMF shall set the SMS allowed bit of the 5GS registration result IE to "SMS over NAS not allowed" in the When the UE receives the REGISTRATION ACCEPT message, if the UE is also registered over another access to the same PLMN, the UE considers the value indicated by the SMS allowed bit of the 5GS registration result IE as applicable for both accesses over which the UE is registered.
The AMF shall include the 5GS registration result IE in the REGISTRATION ACCEPT message.
If the 5GS registration result IE value indicates: - if in 5GMM-REGISTERED state over non-3GPP access and on the same PLMN as 3GPP access, shall enter state 5GMM-DEREGISTERED.
ATTEMPTING-REGISTRATION over non-3GPP access and set the 5GS update status to 5U2 NOT UPDATED over non-3GPP access; b) "Non-3GPP access", the UE: shall consider itself as being registered to non-3GPP access only; and if in the 5GMM-REGISTERED state over 3GPP access and is on the same PLMN as non-3GPP access, shall enter the state 5GMM-DEREGISTERED.
ATTEMPTING-REGISTRATION over 3GPP access and set the 5GS update status to 5U2 NOT UPDATED over 3GPP access; or c) "3GPP access and Non-3GPP access", the UE shall consider itself as being registered to both 3GPP access and The AMF shall include the allowed NSSAI for the current PLMN and shall include the mapped S-NSSAI(s) for the allowed NSSAI contained in the requested NSSAI from the UE if available, in the REGISTRATION ACCEPT message if the UE included the requested NSSAI in the REGISTRATION REQUEST message and the AMF allows one or more S-NSSAIs in the requested NSSAI.
The AMF may also include rejected NSSAI in the REGISTRATION ACCEPT message.
Rejected NSSAI contains S- NSSAI(s) which was included in the requested NSSAI but rej ected by the network associated with rejection cause(s).
If the UE indicated the support for network slice-specific authentication and authorization, and if the Requested NSSAI IE includes one or more S-NSSAIs subject to network slice-specific authentication and authorization, the AMF shall in the REGISTRATION ACCEPT message include: a) the allowed NSSAI containing the S-NSSAI(s) or the mapped S-NSSAI(s), if any: 1) which are not subject to network slice-specific authentication and authorization and are allowed by the AMF; 2) for which the network slice-specific authentication and authorization has been successfully performed; b) optionally, the rejected NSSAI for the failed or revoked NSSAA; c) pending NSSAI containing one or more S-NSSAIs for which network slice-specific authentication and authorization will be performed or is ongoing, if any; and d) the "NSSAA to be performed" indicator in the 5GS registration result IE set to indicate whether network slice- specific authentication and authorization procedure will be performed by the network, if the allowed NSSAI is not included in the REGISTRATION ACCEPT message.
If the UE indicated the support for network slice-specific authentication and authorization, and if: a) the UE did not include the requested NSSAI in the REGISTRATION REQUEST message or none of the S- NSSAIs in the requested NSSAI in the REGISTRATION REQUEST message areallowed; and b) all subscribed S-NSSAIs marked as default are subject to network slice-specific authentication and authorization; the AMF shall in the REGISTRATION ACCEPT message include: a) the "NSSAA to be performed" indicator in the 5GS registration result IE to indicate whether network slice- specific authentication and authorization procedure will be performed by the network; and b) pending NSSAI containing one or more subscribed S-NSSAIs marked as default for which network slice- specific authentication and authorization will be performed or is ongoing.
If the UE indicated the support for network slice-specific authentication and authorization, and if: a) the UE did not include the requested NSSAI in the REGISTRATION REQUEST message or none of the S- NSSAIs in the requested NSSAI in the REGISTRATION REQUEST message are allowed; and the AMF shall in the REGISTRATION ACCEPT message include: a) pending NSSAI containing one or more subscribed S-NSSAIs marked as default for which network slice- specific authentication and authorization will be performed or is ongoing, if any; and b) allowed NSSAI containing one or more subscribed S-NSSAIs marked as default which are not subject to network slice-specific authentication and authorization or for which the network slice-specific authentication and authorization has been successfully performed.
which network slice-specific authentication and authorization will be performed or is ongoing from the requested NSSAI of the REGISTRATION REQUEST message that was received over the 3GPP access, non-3GPP access, or both the 3GPP access or non-3GPP access.
a) the REGISTRATION REQUEST message did not include the requested NSSAI; b) the REGISTRATION REQUEST message included the requested NSSAI containing an S-NSSAI that is not valid in the serving PLMN; c) the REGISTRATION REQUEST message included the requested NSSAI containing S-NSSAI(s) with incorrect d) the REGISTRATION REQUEST message included the Network slicing indication IE with the Default configured NSSAI indication bit set to "Requested NSSAI created from default configured NSSAI".
shall also include the mapped S-NSSAI(s) for the configured NSSAI for the current PLMN if available in the REGISTRATION ACCEPT message.
In this case the AMF shall start timer T3550 and enter state 5GMM-COMMON- PROCEDURE-INITIATED as described in subclause If the UE requests ciphering keys for ciphered broadcast assistance data in the REGISTRATION REQUEST message shall include the ciphering key data in the Ciphering key data IE of the REGISTRATION ACCEPT message.
The AMF shall include the Network slicing indication IE with the Network slicing subscription change indication set to "Network slicing subscription changed" in the REGISTRATION ACCEPT message if the UDM has indicated that the subscription data for network slicing has changed.
In this case the AMF shall start timer T3550 and enter state 5GMM-COMMON-PROCEDURE-INITIATED as described in subclause The UE receiving the pending NSSAI in the REGISTRATION ACCEPT message shall store the S-NSSAI(s) in the pending NSSAI as specified in subclause If the regi stration area contains TAIs belonging to different PLMNs, which are equivalent PLMNs, the UE shall store the recei ved pending NSSAI for each of the equivalent PLMNs as The UE receiving the rejected NSSAI in the REGISTRATION ACCEPT message takes the following actions based on the rejection cause in the rejected S-NSSAI(s): "S-NSSAI not available in the current PLMN or SNPN" The UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the current PLMN as specified in subclause and shall not attempt to use this S-NSSAI(s) in the current PLMN until switching off the UE, the UICC containing the USIM is removed, the entry of the "list of subscriber data" with the SNPN identity of the current SNPN is updated, or the rejected S-NSSAI(s) are removed or deleted as described in subclause "S-NSSAI not available in the current registration area" The UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the current registration area as specified in subclause and shall not attempt to use this S-NSSAI(s) in the current registration area until switching off the UE, the UE moving out of the current registration area, the UICC containing the USIM is removed, the entry "S-NSSAI not available for the failed or revoked network slice-specific authentication and authorization" The UE shall store the rejected S-NSSAI(s) in the re jected NSSAI due to the failed or revoked NSSAA as specified in subclause and shall not attempt to use this S-NSSAI in the current PLMN over any access until switching off the UE, the UICC containing the USIM is removed, the entry of the "list of subscriber data" with the SNPN identity of the current SNPN is updated, or the rejected S-NSSAI(s) are removed or deleted as described in subclause and If the UE set the NSSAA bit in the 5GMM capability IE to "Network slice-specific authentication and authorization not a) if the Requested NSSAI IE only includes the S-NSSAI(s) subject to network slice-specific authentication and 1) the allowed NSSAI containing the subscribed S-NSSAIs marked as default which are not subject to network slice-specific authentication and authorization; and 2) the rejected NSSAI containing the S-NSSAI(s) subject to network slice specific authentication and authorization with the rejection cause indicating "S-NSSAI not available in the current PLMN or SNPN"; or b) if the Requested NSSAI IE includes one or more S-NS SAIs subject to network slice-specific authentication and authorization, the AMF shall in the REGISTRATION ACCEPT message include: 1) the allowed NSSAI containing the S-NSSAI(s) or the mapped S-NSSAI(s) which are not subject to network slice-specific authentication and authorization; and 2) the rejected NSSAI containing: i) the S-NSSAI(s) subject to network slice specific auth entication and authorization with the rejection cause indicating "S-NSSAI not available in the current PLMN or SNPN"; and ii) the S-NSSAI(s) which was included in the requested NSSAI but rejected by the network associated with the rejection cause indicating "S-NSSAI not available in the current PLMN or SNPN" or the rejection cause indicating "S-NSSAI not available in the current registration area", if any.
If the UE does not indicate support for network slice-specific authentication and authorization, and if: a) the UE did not include the requested NSSAI in the REGISTRATION REQUEST message; or b) none of the S-NSSAIs in the requested NSSAI in the REGISTRATION REQUEST message are allowed; S-NSSAI) marked as default which are not subject to ne twork slice-specific authentication and authorization are available, the AMF shall put the subscribed S-NSSAIs mark ed as default and not subject to network slice-specific authentication and authorization in the allowed NSSAI of the REGISTRATION ACCEPT message.
The AMF shall If the REGISTRATION ACCEPT message contains the Network slicing indication IE with the Network slicing subscription change indication set to "Network slicing subscription changed", the UE shall delete the network slicing information for each and every PLMN except for the current PLMN as specified in subclause If the REGISTRATION ACCEPT message contains the allowed NSSAI, then the UE shall store the included allowed NSSAI together with the PLMN identity of the register ed PLMN and the registration area as specified in subclause If the registration area contains TAIs be longing to different PLMNs, which are equivalent PLMNs, the UE shall store the received allowed NSSAI in each of allowed NSSAIs which are associated with each of the PLMNs.
current PLMN and optionally the mapped S-NSSAI(s) for the configured NSSAI for the current PLMN, the UE shall the UE shall not initiate a: a) 5GSM procedure except for emergency services or high priority access until the UE receives an allowed NSSAI; b) service request procedure except for cases f) and i) in subclause If the UE included S1 mode supported indication in the REGISTRATION REQUEST message, the AMF supporting interworking with EPS shall set the IWK N26 bit to either: a) "interworking without N26 interface not supported" if the AMF supports N26 interface ; or b) "interworking without N26 interface supported" if the AMF does not support N26 interface in the 5GS network feature support IE in the REGISTRATION ACCEPT message.
The UE supporting S1 mode shall operate in the mode for interworking with EPS as follows: a) if the IWK N26 bit in the 5GS network feature support IE is set to "interworking without N26 interface not supported", the UE shall operate in single-registration mode; b) if the IWK N26 bit in the 5GS network feature support IE is set to "interworking without N26 interface supported" and the UE supports dual-registration mode, the UE may operate in dual-registration mode; or NOTE 6: The registration mode used by the UE is implementation dependent.
c) if the IWK N26 bit in the 5GS network feature support IE is set to "interworking without N26 interface supported" and the UE only supports single-registration mode, the UE shall operate in single-registration mode.
The UE shall treat the received interworking without N26 interface indicator for interworking with EPS as valid in the entire PLMN and its equivalent PLMN(s).
The network informs the UE about the support of specific features, such as IMS voice over PS session, location services (5G-LCS), emergency services, emergency services fa llback and ATSSS, in the 5GS network feature support upper layers.
When initiating an emergency call, the upper layers also take the IMS voice over PS session indicator, the Emergency services support indicator, and the Emergency serv ices fallback indicator into account for the access domain The AMF shall set the EMF bit in the 5GS network feature support IE to: a) "Emergency services fallback supported in NR connected to 5GCN and E-UTRA connected to 5GCN" if the network supports the emergency services fallback procedure when the UE is in an NR cell connected to 5GCN or an E-UTRA cell connected to 5GCN; b) "Emergency services fallback supported in NR connected to 5GCN only" if the network supports the emergency services fallback procedure when the UE is in an NR cell connected to 5GCN and does not support the emergency services fallback procedure when the UE is in an E-UTRA cell connected to 5GCN; c) "Emergency services fallback supported in E-UTRA connected to 5GCN only" if the network supports the emergency services fallback procedure when the UE is in an E-UTRA cell connected to 5GCN and does not support the emergency services fallback procedure when the UE is in an NR cell connected to 5GCN; or d) "Emergency services fallback not supported" if network does not support the emergency services fallback procedure when the UE is in any cell connected to 5GCN.
services fallback not supported".
NOTE 8: Even though the AMF's support of emergency services fallback is indicated per RAT, the UE's support of emergency services fallback is not per RAT, i.
the UE's support of emergency services fallback is the same for both NR connected to 5GCN and E-UTRA connected to 5GCN.
If the UE is not operating in SNPN access mode: a) the network informs the UE that the use of access identity 1 is valid in the RPLMN or equivalent PLMN by setting the MPS indicator bit of the 5GS network feature support IE to "Access identity 1 valid", in the REGISTRATION ACCEPT message.
Based on operator policy, the AMF sets the MPS indicator bit in the REGISTRATION ACCEPT message based on the MPS priority information in the user's subscription context obtained from the UDM; NG-RAN of the registered PLMN and its equivalent PLMN s.
The MPS indicator bit in the 5GS network feature support IE provided in the REGISTRATION ACCEPT message is valid until the UE receives a REGISTRATION ACCEPT message with the MPS indicator bit set to "Access identity 1 not valid" or until the c) the network informs the UE that the use of access identity 2 is valid in the RPLMN or equivalent PLMN by setting the MCS indicator bit of the 5GS network feat ure support IE to "Access identity 2 valid", in the REGISTRATION ACCEPT message.
Based on operator policy, the AMF sets the MCS indicator bit in the REGISTRATION ACCEPT message based on the MCS priori ty information in the user's subscription context obtained from the UDM; and If the UE is operating in SNPN access mode: a) the network informs the UE that the use of access identit y 1 is valid in the RSNPN by setting the MPS indicator bit of the 5GS network feature support IE to "Acce ss identity 1 valid", in the REGISTRATION ACCEPT c) the network informs the UE that the use of access identit y 2 is valid in the RSNPN by setting the MCS indicator bit of the 5GS network feature support IE to "Acce ss identity 2 valid", in the REGISTRATION ACCEPT message.
Based on operator policy, the AMF sets the MCS indicator bit in the REGISTRATION ACCEPT message based on the MCS priority information in the user's subscription context obtained from the UDM; and c) in NB-N1 mode, the AMF decides to restrict the use of enhanced coverage for the UE, then the AMF shall set the RestrictEC bit to "Use of enhanced coverage is restricted", in the 5GS network feature support IE in the REGISTRATION ACCEPT message.
If the UE has set the Follow-on request indicator to "Follow-on request pending" in the REGISTRATION REQUEST message, or the network has downlink signalling pending, the AMF shall not immediately release the NAS signalling connection after the completion of the registration procedure.
If the UE is authorized to use V2X communication over PC5 reference point based on: a) at least one of the following bits in the 5GMM capability IE of the REGISTRATION REQUEST message set by the UE, or already stored in the 5GMM context in the AMF during the previous registration procedure as 1) the V2XCEPC5 bit to "V2X communication over E-UTRA-PC5 supported"; or 2) the V2XCNPC5 bit to "V2X communication over NR-PC5 supported"; and b) the user's subscription context obtained from the UDM as defined in 3GPP specification document [6C]; the AMF should not immediately release the NAS signalling connection after the completion of the registration If the Requested DRX parameters IE was included in the REGISTRATION REQUEST message, the AMF shall include the Negotiated DRX parameters IE in the REGISTRATION ACCEPT message.
The AMF may set the Negotiated DRX parameters IE based on the received Requested DRX parameters IE and operator policy if available.
If the Requested NB-N1 mode DRX parameters IE was included in the REGISTRATION REQUEST message, the AMF shall include the Negotiated NB-N1 mode DRX parameters IE in the REGISTRATION ACCEPT message.
The AMF may set the Negotiated NB-N1 mode DRX parameters IE based on the received Requested NB-N1 mode DRX parameters IE and operator policy if available.
The AMF shall include the Negotiated extended DRX parameters IE in the REGISTRATION ACCEPT message only if the Requested extended DRX parameters IE was included in the REGISTRATION REQUEST message, and the AMF supports and accepts the use of eDRX.
The AMF may set the Negotiated extended DRX parameters IE based on the.
a) the UE's USIM is configured with indication that the UE is to receive the SOR transparent container IE, the SOR transparent container IE is not included in the REGISTRATION ACCEPT message or the SOR transparent container IE does not successfully pass the integrity check (see 3GPP specification document\); and b) if the UE attempts obtaining service on another PLMNs as specified in 3GPP specification document annex C; container IE successfully passes the integrity check (see 3GPP specification document\): a) the UE shall proceed with the behaviour as specified in 3GPP specification document annex C; and b) if the registration procedure is performed over 3G PP access and the UE attempts obtaining service on another REGISTRATION COMPLETE message and not release the current N1 NAS signalling connection locally.
If an acknowledgement is requested in the SOR transparent container IE of the REGISTRATION ACCEPT message, If the SOR transparent container IE successfully passes the integrity check (see 3GPP specification document\), indicates list of preferred PLMN/access technology combinations is provided and the list type indicates: a) "PLMN ID and access technology list", then the ME shall replace the highest priority entries in the "Operator Controlled PLMN Selector with Access Technology" list st ored in the ME and shall proceed with the behaviour as specified in 3GPP specification document annex C; or download, data coding scheme set to class 2 message and SMS payload as secured packet contents of SOR transparent container IE.
The SMS payload is forwarded to UICC as specified in 3GPP specification document [4A] and the ME shall proceed with the behaviour as specified in 3GPP specification document annex C.
If required by operator policy, the AMF shall include the NSSAI inclusion mode IE in the REGISTRATION ACCEPT message (see table of subclause\).
Upon receipt of the REGISTRATION ACCEPT message: a) if the message includes the NSSAI inclusion mode IE, the UE shall operate in the NSSAI inclusion mode indicated in the NSSAI inclusion mode IE over the current access within the current PLMN and its equivalent PLMN(s), if any, in the current registration area; or 1) if the UE has NSSAI inclusion mode for the current PLMN and access type stored in the UE, the UE shall operate in the stored NSSAI inclusion mode; 2) if the UE does not have NSSAI inclusion mode for the current PLMN and the access type stored in the UE and if the UE is performing the registration procedure over: the current access type; or current access type; or 3) if the 5G-RG does not have NSSAI inclusion mode for the current PLMN and wireline access stored in the 5G-RG, and the 5G-RG is performing the registration procedure over wireline access, the 5G-RG shall The AMF may include operator-defined access category definitions in the REGISTRATION ACCEPT message.
If the UE receives Operator-defined access category definitions IE in the REGISTRATION ACCEPT message and the contains no operator-defined access category definitions, the UE shall delete any operator-defined access category definitions stored for the RPLMN.
If the REGISTRATION ACCEPT message does not contain the Operator-defined access category definitions IE, the UE shall not delete the operator-defined access category definitions stored for the RPLMN.
If the UE has indicated support for service gap control in the REGISTRATION REQUEST message and: the REGISTRATION ACCEPT message contains the T3447 value IE, then the UE shall store the new T3447 value, erase any previous stored T3447 value if exists and use the new T3447 value with the timer T3447 next time it is started; or the REGISTRATION ACCEPT message does not contain the T3447 value IE, then the UE shall erase any previous stored T3447 value if exists and stop the timer T3447 if running.
If the T3448 value IE is present in the received REGISTRATION ACCEPT message and the value indicates that this timer is neither zero nor deactivated, the UE shall: If the UE is using 5GS services with control plane CIoT 5GS optimization, the T3448 value IE is present in the REGISTRATION ACCEPT message and the value indicates that this timer is either zero or deactivated, the UE shall ignore the T3448 value IE and proceed as if the T3448 value IE was not present.
If the REGISTRATION ACCEPT message contains the Truncated 5G-S-TMSI configuration IE, then the UE shall AMF to acknowledge reception of the truncated 5G-S-TMSI configuration.
NOTE 7: The UE provides the truncated 5G-S-TMSI configuration to the lower layers.
If the UE is not in NB-N1 mode, the UE has set the RACS bit to "RACS supported" in the 5GMM Capability IE of the REGISTRATION REQUEST message and the REGISTRATION ACCEPT message includes: a) a UE radio capability ID deletion indication IE set to "Network-assigned UE radio capability IDs deletion b) a UE radio capability ID IE, the UE shall store the UE radio capability ID as specified in annex C.
Initial registration not accepted by the network If the initial registration request is rejected due to general NAS level mobility management congestion control, the If the REGISTRATION REJECT message with 5GMM cause #76 was received without integrity protection, then the UE shall discard the message.
Based on operator policy, if the initial registration request is rejected due to core network redirection for CIoT optimizations, the network shall set the 5GMM cause value to #31 "Redirection to EPC required".
NOTE 1: The network can take into account the UE's S1 mode capability, the EPS CIoT network behaviour supported by the UE or the EPS CIoT network behaviour supported by the EPC to determine the rejection with the 5GMM cause value #31 "Redirection to EPC required".
If the initial registration request is rejected because: a) all the S-NSSAI(s) included in the requested NSSAI are either rejected for the current PLMN, rejected for the current registration area, or rejected due to the failed or revoked NSSAAs; and b) the UE set the NSSAA bit in the 5GMM capability IE to: 1) "Network slice-specific authentication and authorization supported" and: i) there are no subscribed S-NSSAIs marked as default; or ii) all subscribed S-NSSAIs marked as default are not allowed; or 2) "Network slice-specific authentication and authorization not supported"; and i) there are no subscribed S-NSSAIs which are marked as default; or ii) all subscribed S-NSSAIs marked as default are eith er not allowed or are subject to network slice-specific the network shall set the 5GMM cause value to #62 "No network slices available" and may include the rejected NSSAI.
reference point, the network shall set the 5GMM cause value to #72 "Non-3GPP access to 5GCN not allowed".
If the initial registration request is rejected due to that the UE is not authorized in the current CAG cell or the UE is authorized to access 5GS via CAG cell only, the network sh all set the 5GMM cause value to #76 "Not authorized for this CAG or authorized for CAG cells only" and may include the "CAG information list" in the CAG information list IE in the REGISTRATION REJECT message.
NOTE 2: The network cannot be certain that "CAG information list" stored in the UE is updated as result of sending of the REGISTRATION REJECT message with the CAG information list IE, as the REGISTRATION REJECT message is not necessarily delivered to the UE (e.
due to abnormal radio conditions).
The UE shall take the following actions depending on the 5GMM cause value received in the REGISTRATION REJECT message.
#3 (Illegal UE); or #6 (Illegal ME).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
In case of PLMN, the UE shall consider the USIM as invalid for 5GS services until switching off or the UICC containing the USIM is removed; In case of SNPN, the UE shall consider the entry of the "list of subscriber data" with the SNPN identity of the current SNPN as invalid until the UE is switched off or the entry is updated.
Additionally, if EAP based primary authentication and key agreement procedure using EAP-AKA' or 5G AKA based primary authentication and key agreement procedure was performed in the current SNPN, the UE shall consider the USIM as invalid for the current SNPN until switching off or the UICC containing the USIM is removed.
The UE shall delete the list of equivalent PLMNs (if any) and enter the state 5GMM-DEREGISTERED.
If the message has been successfully integrity checked by the NAS, then the UE shall: 1) set the counter for "USIM considered invalid for GPRS services" events and the counter for "SIM/USIM considered invalid for 5GS services over non-3GPP access" events in case of PLMN; or 2) set the counter for "the entry for the current SNPN considered invalid for 3GPP access" events and the counter for "the entry for the current SNPN considered invalid for non-3GPP access" events in case of 3) delete the 5GMM parameters stored in non-volatile memory of the ME as specified in annex C.
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list and If the message has been successfully integrity checked by the NAS and the UE also supports the registration procedure over the other access, the UE shall in add ition handle 5GMM parameters and 5GMM state for this access, as described for this 5GMM cause value.
#7 (5GS services not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
In case of PLMN, the UE shall consider the USIM as invalid for 5GS services until switching off or the UICC containing the USIM is removed; EAP based primary authentication and key agreement procedure using EAP-AKA' or 5G AKA based primary authentication and key agreement procedure was performed in the current SNPN, the UE shall consider the USIM as invalid for the current SNPN until switching off or the UICC containing the USIM is removed.
The UE shall enter the state 5GMM-DEREGISTERED.
If the message has been successfully integrity checked by the NAS, then the UE shall: 1) set the counter for "USIM considered invalid for GPRS services" events and the counter for "SIM/USIM considered invalid for 5GS services over non-3GPP access" events in case of PLMN; or 2) set the counter for "the entry for the current SNPN considered invalid for 3GPP access" events and the counter for "the entry for the current SNPN considered invalid for non-3GPP access" events in case of SNPN; 3) delete the 5GMM parameters stored in non-volatile memory of the ME as specified in annex C.
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list and eKSI as specified in 3GPP specification document for the case when the EPS attach request procedure is rejected with the EMM cause with the same value.
If the message has been successfully integrity checked by the NAS and the UE also supports the registration procedure over the other access, the UE shall in addition handle 5GMM parameters and 5GMM state for this access, as described for this 5GMM cause value.
#11 (PLMN not allowed).
of the UE is specified in subclause The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
The UE shall delete the list of equivalent PLMNs and reset the registration attempt counter and store the PLMN identity in the forbidden PLMN list as specified in subclause 3A.
The UE shall enter state 5GMM- message has been successfully integrity checked by the NAS, the UE shall set the PLMN-specific attempt counter and the PLMN-specific attempt counter for non-3GPP access for that PLMN to the UE implementation-specific maximum value.
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall in addition handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI and attach attempt counter as specified in 3GPP specification document for the case when the EPS attach request procedure is rejected with the EMM cause with the same value.
If the message has been successfully integrity checked by the NAS and the UE also supports the registration procedure over the other access to the same PLMN, the UE shall in addition handle 5GMM parameters and 5GMM state for this access, as described for this 5GMM cause value.
#12 (Tracking area not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
Additionally, the UE shall reset the registration attempt counter.
1) the UE is not operating in SNPN access mode, the UE shall store the current TAI in the list of "5GS forbidden tracking areas for regional provision of service" and enter the state 5GMM-DEREGISTERED.
If the REGISTRATION REJECT message is not integrity protected, the UE shall memorize the current TAI was stor ed in the list of "5GS forbidden tracking areas for regional provision of service" for non-integrity protected NAS reject message; or DEREGISTERED.
If the REGISTRATION REJECT is not integrity protected, the UE shall memorize the current TAI was stored in the list of "5GS forbidden tracking areas for regional provision of service" for the current SNPN for non-integrity protected NAS reject message.
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI and attach attempt counter as specified in 3GPP specification document for the case when the EPS attach request procedure is rejected with the EMM cause with the same value.
#13 (Roaming not allowed in this tracking area).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
Additionally, the UE shall delete the list of equivalent PLMNs (if available) and reset the registration attempt counter.
1) the UE is not operating in SNPN access mode, the UE shall store the current TAI in the list of "5GS forbidden tracking areas for roaming" and enter the state 5GMM-DEREGISTERED.
LIMITED-SERVICE or optionally 5GMM-DEREGISTERED.
If the REGISTRATION REJECT message is not areas for roaming" for non-integrity protected NAS reject message; or 2) the UE is operating in SNPN access mode, the UE shall store the current TAI in the list of "5GS forbidden tracking areas for roaming" for the current SNPN and enter the state 5GMM-DEREGISTERED.
LIMITED-SERVICE or optionally 5GMM-DEREGISTERED.
If the REGISTRATION REJECT message is not integrity protected, the UE shall memorize the current TAI was stored in the list of "5GS forbidden tracking areas for roaming" for the current SN PN for non-integrity protected NAS reject message.
If the UE is registered in S1 mode and operating in dual-registration mode, the PLMN that the UE chooses to If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI and attach attempt counter as specified in 3GPP specification document for the case when the EPS attach request procedure is rejected with the EMM cause with the same value.
#15 (No suitable cells in tracking area).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
Additionally, the UE shall reset the registration attempt counter.
1) the UE is not operating in SNPN access mode, the UE shall store the current TAI in the list of "5GS forbidden tracking areas for roaming" and enter the state 5GMM-DEREGISTERED.
If the REGISTRATION REJECT message is not integrity protected, the UE shall memorize the current TAI was stored in the list of "5GS forbidden tracking areas for roaming" for non-integrity protected NAS reject 2) the UE is operating in SNPN access mode, the UE shall store the current TAI in the list of "5GS forbidden tracking areas for roaming" for the current SNPN and enter the state 5GMM-DEREGISTERED.
If the REGISTRATION REJECT message is not integrity protected, the UE shall memorize the current TAI was stored in the list of "5GS forbidden tracking areas for roaming" for the current SNPN for non-integrity protected NAS reject message.
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI #22 (Congestion).
If the T3346 value IE is present in the REGISTRATION REJECT message and the value indicates that this timer is neither zero nor deactivated, the UE shall proceed as de scribed below; otherwise it shall be considered as an abnormal case and the behaviour of the UE for this case is specified in subclause The UE shall abort the initial registration procedure, set the 5GS update status to 5U2 NOT UPDATED, reset the registration attempt counter and enter state 5GMM-DEREGISTERED.
The UE shall stop timer T3346 if it is running.
If the REGISTRATION REJECT message is integrity protected, the UE shall start timer T3346 with the value provided in the T3346 value IE.
If the REGISTRATION REJECT message is not integrity protected, the UE shall start timer T3346 with a random value from the default range specified in 3GPP specification document .
The UE stays in the current serving cell and applies the normal cell reselection process.
The initial registration procedure is started if still needed when timer T3346 expires or is stopped.
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status, and attach attempt counter as specified in 3GPP specification document for the case when the EPS attach request procedure is rejected with the EMM cause with the same value.
#27 (N1 mode not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
Additionally, the UE shall reset the registration attempt counter and shall enter the state 5GMM-DEREGISTERED.
If the message has been successfully integrity checked by the NAS, the UE shall set: 1) the PLMN-specific N1 mode attempt counter for 3GPP access and the PLMN-specific N1 mode attempt counter for non-3GPP access for that PLMN in case of PLMN; or 2) the SNPN-specific attempt counter for 3GPP access for the current SNPN in case of SNPN; to the UE implementation-specific maximum value.
The UE shall disable the N1 mode capability for the specific access type for which the message was received If the message has been successfully integrity checked by the NAS, the UE shall disable the N1 mode capability also for the other access type (see subclause\).
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall in addition set the EPS update status to EU3 ROAMING NOT ALLOWED and shall delete any 4G-GUTI, last visited registered TAI, TAI list and eKSI.
Additionally, the UE shall reset the attach attempt counter and enter #62 (No network slices available).
The UE shall abort the initial registration procedure, set the 5GS update status to 5U2 NOT UPDATED and enter state 5GMM-DEREGISTERED.
Additionally, the UE shall reset the registration attempt counter.
The UE receiving the rejected NSSAI in the REGISTRATION REJECT message takes the following actions based on the rejection cause in the rejected S-NSSAI(s): "S-NSSAI not available in the current PLMN or SNPN" The UE shall store the rejected S-NSSAI(s) in the rejected NSSAI for the current PLMN or SNPN as specified in subclause and shall not attempt to use this S-NSSAI(s) in the current PLMN or SNPN "S-NSSAI not available in the current registration area" The UE shall store the rejected S-NSSAI(s) in the rejected NSSAI for the current registration area as described in subclause and shall not attempt to use this S-NSSAI(s) in the current registration area until switching off the UE, the UE moving out of the current registration area, the UICC containing the USIM is removed, the entry of the "list of subscriber data" with the SNPN identity of the current SNPN is updated, or the rejected S-NSSAI(s) are removed or deleted as described in subclause "S-NSSAI not available due to the failed or revoked network slice-specific authentication and authorization" The UE shall store the rejected S-NSSAI(s) in the rejected NSSAI for the failed or revoked NSSAA as specified in subclause and shall not attempt to use this S-NSSAI in the current PLMN over any access until switching off the UE, the UICC containing the USIM is removed, the entry of the "list of subscriber data" with the SNPN identity of the current SNPN is updated, or the rejected S-NSSAI(s) are removed or deleted as described in subclause and If the UE has an allowed NSSAI or configured NSSAI that contains S-NSSAI(s) which are not included any of #72 (Non-3GPP access to 5GCN not allowed).
When received over non-3GPP access the UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause 2) and shall delete 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
Additionally, the UE shall reset the registration attempt counter and enter the state 5GMM-DEREGISTERED.
If the message has been successfully integrity checked by the NAS, the UE shall set the PLMN-specific N1 mode attempt counter for non-3GPP access for that PLMN to the UE implementation-specific maximum value.
NOTE 3: The 5GMM sublayer states, the 5GMM parameters and the registration status are managed per access type independently, i.
3GPP access or non-3GPP access (see subclauses and\).
The UE shall disable the N1 mode capability for non-3GPP access (see subclause\).
As an implementation option, the UE may enter the state 5GMM-DEREGISTERED.
PLMN-SEARCH in order If received over 3GPP access the cause shall be considered as an abnormal case and the behaviour of the UE for this case is specified in subclause of the UE is specified in subclause The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
The UE shall delete the list of equivalent PLMNs, reset the registration attempt counter, store the PLMN identity in the forbidden PLMN list as specified in subclause 3A, and enter state 5GMM-DEREGISTERED.
PLMN- specific attempt counter for non-3GPP access for that PLMN to the UE implementation-specific maximum If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall in addition set the EPS update status to EU3 ROAMING NOT ALLOWED and shall delete any 4G-GUTI, last #74 (Temporarily not authorized for this SNPN).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
The UE shall reset the registration attempt counter and store the SNPN identity in the "temporarily forbidden SNPNs" list for the specific access type for which the message was received.
The UE shall enter state 5GMM- DEREGISTERED.
PLMN-SEARCH and perform an SNPN selection according to 3GPP specification document .
If the message has been successfully integrity checked by the NAS, the UE shall set the SNPN-specific attempt counter for 3GPP access and the SNPN-specific attempt counter for non-3GPP access for the current SNPN to the UE implementation-specific maximum value.
If the message has been successfully integrity checked by the NAS and the UE also supports the registration procedure over the other access to the same SNPN, the UE shall in addition handle 5GMM parameters and 5GMM state for this access, as described for this 5GMM cause value.
NOTE 4: When 5GMM cause #74 is received over 3GPP access, the term "other access" in "the UE also supports #75 (Permanently not authorized for this SNPN).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
The UE shall reset the registration attempt counter and store the SNPN identity in the "permanently forbidden SNPNs" list for the specific access type for which the message was received.
The UE shall enter state 5GMM- DEREGISTERED.
PLMN-SEARCH and perform an SNPN selection according to 3GPP specification document .
If the message has been successfully integrity checked by the NAS, the UE shall set the SNPN-specific attempt counter for 3GPP access and the SNPN-specific attempt counter for non-3GPP access for the current SNPN to the UE implementation-specific maximum value.
If the message has been successfully integrity checked by the NAS and the UE also supports the registration procedure over the other access to the same SNPN, the UE shall in addition handle 5GMM parameters and 5GMM state for this access, as described for this 5GMM cause value.
NOTE 5: When 5GMM cause #75 is received over 3GPP access, the term "other access" in "the UE also supports #31 (Redirection to EPC required); over non-3GPP access is considered as an abnormal case and the behaviour of the UE is specified in of the UE is specified in subclause The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
Additionally, the UE shall reset the registration attempt counter.
The UE shall enable the E-UTRA capability if it was disabled, disable the N1 mode capability for 3GPP access (see subclause\) and enter the 5GMM-DEREGISTERED.
with the same value.
#76 (Not authorized for this CAG or authorized for CAG cells only).
of the UE is specified in subclause The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED, store the 5GS update status according to clause , and reset the registration attempt counter.
If 5GMM cause #76 is received from: 1) a CAG cell, and if the UE receives a "CAG information list" in the CAG information list IE included in the REGISTRATION REJECT message, the UE shall delete any stored "CAG information list" and shall store the received "CAG information list".
Otherwise, then the UE shall delete the CAG-ID(s) of the cell from the "allowed CAG list" for the current PLMN.
In addition: i) if the entry in the "CAG information list" for the current PLMN does not include an "indication that the UE is only allowed to access 5GS via CAG cells" or if the entry in the "CAG information list" for the current PLMN includes an "indication that the UE is only allowed to access 5GS via CAG cells" and the ii) if the entry in the "CAG information list" for the current PLMN includes an "indication that the UE is only allowed to access 5GS via CAG cells" and the updated "allowed CAG list" for the current PLMN does not include any CAG-ID, then the UE shall enter the state 5GMM-DEREGISTERED.
PLMN- SEARCH and shall apply the PLMN selection proce ss defined in 3GPP specification document with the updated 2) a non-CAG cell, and if the UE receives a "CAG information list" in the CAG information list IE included in the REGISTRATION REJECT message, the UE shall delete any stored "CAG information list" and shall store the received "CAG information list".
Otherwise, the UE shall store an "indication that the UE is only allowed to access 5GS via CAG cells" in the entry of the "CAG information list" for the current PLMN.
In addition: i) if the "allowed CAG list" for the current PLMN includes one or more CAG-IDs, then the UE shall enter 3GPP specification document with the updated CAG information; or ii) if the "allowed CAG list" for the current PLMN does not includes any CAG-ID, then the UE shall enter the state 5GMM-DEREGISTERED.
PLMN-SEARCH and shall apply the PLMN selection process defined in 3GPP specification document with the updated "CAG information list".
#77 (Wireline access area not allowed).
access network and 5GMM cause #77 received by the W-AGF acting on behalf of the FN-BRG are considered as abnormal cases and the behaviour of the UE is specified in subclause When received over wireline access network, the 5G-RG and the W-AGF acting on behalf of the FN-CRG shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\), shall delete 5G-GUTI, last visited registered TAI, TAI list and ngKSI, shall reset the registration attempt counter, shall enter the state 5GMM-DEREGISTERED and shall act as specified in subclause NOTE 6: The 5GMM sublayer states, the 5GMM parameters and the registration status are managed per access type independently, i.
3GPP access or non-3GPP access (see subclauses and\).
Other values are considered as abnormal cases.
The behaviour of the UE in those cases is specified in subclause enter the state 5GMM-DEREGISTERED.
If the REGISTRATION REJECT message is received, over 3GPP access; or over non-3GPP access and is integrity protected; and the UE also supports the registration procedure over the other access, the UE shall in addition handle 5GMM parameters and 5GMM state for this access, as described for this 5GMM cause value.
Upon receiving the REGISTRATION REJECT message including 5GMM cause value which is not #5 "PEI not accepted", the UE shall perform the actions as described in subclause with the following addition: the UE shall inform the upper layers of the failure of the procedure.
NOTE 1: This can result in the upper layers requesting implementation specific mechanisms, e.
procedures specified in 3GPP specification document can result in the emergency call being attempted to another IP-CAN.
If the initial registration request for emergency services fails due to abnormal cases, the UE shall perform the actions as described in subclause and inform the upper layers of the failure to access the network or the failure of the procedure.
NOTE 2: This can result in the upper layers requesting other implementation specific mechanisms, e.
procedures specified in 3GPP specification document can result in the emergency call being attempted to another IP-CAN.
a) inform the upper layers of the failure of the procedure; or NOTE 3: The upper layers can request implementation specific mechanisms, e.
procedures specified in 3GPP specification document that can result in the emergency call being attempted to another IP-CAN.
was not already attempted with the selected PLMN and the REGISTRATION REQUEST message, for which the REGISTRATION REJECT message was received, is: PDU session", initiate an initial registration for emergency services with the selected PLMN; or i) the selected PLMN is an equivalent PLMN, initiate an initial registration for emergency services with the registration for emergency services with the selected PLMN if an initial registration for emergency services was not already attempted with the selected PLMN.
a) inform the upper layers of the failure of the procedure; or NOTE 4: The upper layers can request implementation specific mechanisms, e.
procedures specified in 3GPP specification document that can result in the emergency call being attempted to another IP-CAN.
was not already attempted with the selected PLMN and the REGISTRATION REQUEST message is: PDU session", initiate an initial registration for emergency services with the selected PLMN; or i) the selected PLMN is an equivalent PLMN, initiate an initial registration for emergency services with the registration for emergency services with the selected PLMN if an initial registration for emergency services was not already attempted with the selected PLMN.
accepted by the network perform the procedures as described in subclause Then if the UE is in the same selected PLMN where the last initial registration request was attempted, the UE shall: a) inform the upper layers of the failure of the procedure; or NOTE 1: This can result in the upper layers requesting implementation specific mechanisms, e.
procedures specified in 3GPP specification document can result in the emergency call being attempted to another IP-CAN.
b) attempt initial registration for emergency services.
registration type IE set to "initial registration" and the PDU session needs to be established due to handover of an existing PDN connection for emergency bearer services, the UE shall perform the procedures as described in subclause Then if the UE is in the same selected PLMN or equivalent PLMN where the last initial registration request was attempted, the UE shall attempt initial registration for emergency services.
"initial registration" fails due to abnormal case b) in subclause , the UE shall perform the actions as described in subclause and inform the upper layers of the failure to access the network.
NOTE 2: This can result in the upper layers requesting implementation specific mechanisms, e.
procedures specified in 3GPP specification document can result in the emergency call being attempted to another IP-CAN.
a) the same selected PLMN where the last initial registration request was attempted and the PDU session does not need to be established due to handover of an existi ng PDN connection for emergency bearer services, the UE inform the upper layers of the failure of the procedure; or NOTE 3: This can result in the upper layers requesting implementation specific mechanisms, e.
procedures specified in 3GPP specification document can result in the emergency call being attempted to another IP-CAN.
attempt initial registration for emergency services; or b) the same selected PLMN or equivalent PLMN where the last initial registration request was attempted and the PDU session needs to be established due to handover of an existing PDN connection for emergency bearer services, attempt initial registration for emergency services.
Abnormal cases in the UE The following abnormal cases can be identified: a) Timer T3346 is running.
The UE shall not start the registration procedure for initial registration unless: and: the UE is allowed to use exception data reporting (see the ExceptionDataReportingAllowed leaf of the NAS configuration MO in 3GPP specification document or the USIM file EF NASCONFIG in 3GPP specification document\); timer T3346 was not started when N1 NAS signalling connection was established with RRC establishment cause set to "mo-ExceptionData"; or 5) the UE needs to initial registration procedure with 5GS registration type IE set to "initial registration" for initiating of an emergency PDU session, upon request of the upper layers to establish the emergency PDU The UE stays in the current serving cell and applies the normal cell reselection process.
while timer T3346 is running independent on whether timer T3346 was started due to an abnormal case or b) The lower layers indicate that the access attempt is barred.
The UE shall not start the initial registration procedure.
The UE stays in the current serving cell and applies the normal cell reselection process.
Receipt of the access barred indication shall not trigger the selection of a different core network type (EPC or 5GCN).
The initial registration procedure is started, if still needed, when the lower layers indicate that the barring is alleviated for the access category with which the access attempt was associated.
ba) The lower layers indicate that access barring is applicable for all access categories except categories 0 and 2 and the access category with which the access attempt was associated is other than 0 and If the REGISTRATION REQUEST message has not been sent , the UE shall proceed as specified for case b.
If The UE shall abort the registration procedure for initial registration and the NAS signalling connection, if any, shall be released locally if the initial registration request is neither for emergency services nor for initiating a PDU session for emergency services with request type set to "existing emergency PDU session".
The UE shall proceed as described below.
d) REGISTRATION REJECT message, other 5GMM cause values than those treated in subclause , and cases of 5GMM cause values #11, #22, #31, #72, #73, #74, #75, #76 and #77, if considered as abnormal cases according to subclause If the registration request is neither an initial registration request for emergency services nor an initial emergency PDU session", upon reception of the 5GMM causes #95, #96, #97, #99 and #111 the UE should set the registration attempt counter to The UE shall proceed as described below.
e) Lower layer failure or release of the NAS signalling connection received from lower layers before the REGISTRATION ACCEPT or REGISTRATION REJECT message is received.
The UE shall abort the registration procedure for in itial registration and proceed as described below.
REGISTERED-INITIATED the de-registration procedure shall be aborted and the initial registration procedure NOTE 2: The above collision case is valid if the DEREGISTRATION REQUEST message indicates the access type over which the initial registration procedure is attempted otherwise both the procedures are progressed.
completed, the registration procedure for initial regist ration shall be aborted and re-initiated immediately.
1) if the new tracking area is in the TAI list, the UE sends the REGISTRATION COMPLETE message to the 2) otherwise, the registration procedure for initial registration shall be aborted and the registration procedure for mobility registration update shall be initiated.
If a 5G-GUTI was allocated during the registration procedure, this 5G-GUTI shall be used in the registration i) Transmission failure of REGISTRATION COMPLETE message indication with TAI change from lower layers.
1) If the current TAI is still part of the TAI list, the UE resends the REGISTRATION COMPLETE message to 2) otherwise, the registration procedure for initial registration shall be aborted and the registration procedure for mobility registration update shall be initiated.
j) Transmission failure of REGISTRATION COMPLETE message indication without TAI change from lower It is up to the UE implementation how to re-run the ongoing procedure.
k) Transmission failure of REGISTRATION REQUEST message indication from the lower layers.
The registration procedure for initial registration shall be aborted and re-initiated immediately.
l) Timer T3447 is running.
The UE shall not start the registration procedure for initial registration with Follow-on request indicator set to "Follow-on request pending" unless: 2) the UE needs to perform the registration procedure for initial registration for emergency services.
The UE stays in the current serving cell and applies the normal cell reselection process.
The registration procedure for initial registration is started, if still necessary, when timer T3447 expires.
Timer T3510 shall be stopped if still running.
counter shall be incremented, unless it was already set to If the registration attempt counter is less than 5: if the initial registration request is not for emergency services, timer T3511 is started and the state is changed to 5GMM-DEREGISTERED.
When timer T3511 expires the registration procedure for initial registration shall be restarted, if still required.
If the registration attempt counter is equal to 5 the UE shall delete 5G-GUTI, TAI list, last visited registered TAI, list of equivalent PLMNs (if any), and ngKSI, start timer T3502 and shall set the 5GS update status to 5U2 NOT UPDATED.
The state is changed to 5GMM-DEREGISTERED.
ATTEMPTING-REGISTRATION or optionally to 5GMM- 3GPP specification document .
if the procedure is performed via 3GPP access and the UE is operating in single-registration mode: the UE shall in addition handle the EMM parameters EPS update status, EMM state, 4G-GUTI, TAI list, last visited registered TAI, list of equivalent PLMNs and eKSI as specified in 3GPP specification document for the abnormal cases when an EPS attach procedure fails and the attach attempt counter is equal to 5; and the UE shall attempt to select E-UTRAN radio access technology and proceed with appropriate EMM specific procedures.
Additionally, The UE may disable the N1 mode capability as specified in subclause Abnormal cases on the network side The following abnormal cases can be identified: a) Lower layer failure UE and timer T3550 is running, the AMF shall locally abort the registration procedure for initial registration, GUTI was assigned to the UE in the registration procedure for initial registration, the AMF shall consider both the old and the new 5G-GUTI as valid until the old 5G- GUTI can be considered as invalid by the AMF or the REGISTRATION REJECT message with one of the following 5GMM cause values: #96 invalid mandatory information; #99 information element non-existent or not implemented; #100 conditional IE error; or #111 protocol error, unspecified.
On the first expiry of the timer, the AMF shall retransmit the REGISTRATION ACCEPT message and shall reset and restart timer T355 allocated in the REGISTRATION ACCEPT message, the AMF shall consider both the old and the new 5G-d) REGISTRATION REQUEST message received after the REGISTRATION ACCEPT message has been sent and before the REGISTRATION COMPLETE message is received, if the REGISTRATION COMPLETE message is expected.
1) If one or more of the information elements in the REGISTRATION REQUEST message differ from the ones received within the previous REGISTRATION REQUEST message, the previously initiated the registration procedure for initial registration shall be aborted if the REGISTRATION COMPLETE message has not been received and the new registration procedure for initial registration shall be progressed; or 2) if the information elements do not differ, then the REGISTRATION ACCEPT message shall be resent and the timer T3550 shall be restarted.
In that case, the retransmission counter related to T3550 is not incremented.
e) More than one REGISTRATION REQUEST message with 5GS registration type IE set to "initial registration" received and no REGISTRATION ACCEPT or REGISTRATION REJECT message has been sent.
1) If one or more of the information elements in the REGISTRATION REQUEST message with 5GS registration type IE set to "initial registration" differs from the ones received within the previous REGISTRATION REQUEST message with 5GS registration type IE set to "initial registration", the previously initiated the registration procedure for initial registration shall be aborted and the new the registration procedure for initial registration shall be executed; 2) if the information elements do not differ, then the network shall continue with the previous the registration procedure for initial registration and shall ignore the second REGISTRATION REQUEST message.
f) REGISTRATION REQUEST message with 5GS registration ty pe IE set to "initial registration" received in state NOTE 1: The network can determine that the UE is genuine by executing the authentication procedure as described g) REGISTRATION REQUEST message with 5GS registration type IE set to "mobility registration updating" or "periodic registration updati ng" received before REGISTRATION COMPLETE message, if the REGISTRATION COMPLETE message is expected.
Timer T3550 shall be stopped.
The allocated 5G-GUTI in the registration procedure for initial registration shall be considered as valid and the registration procedure for mobility and periodic update shall be progressed as described in subclause h) DEREGISTRATION REQUEST message received before REGISTRATION COMPLETE message, if the REGISTRATION COMPLETE message is expected.
The AMF shall abort the registration procedure for initial registration and shall progress the de-registration procedure as described in subclause i) UE security capabilities invalid or unacceptable If the REGISTRATION REQUEST message is received with invalid or unacceptable UE security capabilities (e.
no 5GS encryption algorithms (all bits zero), no 5GS integrity algorithms (all bits zero), mandatory 5GS NOTE 2: 5GMM cause value to be used in REGISTRATION REJECT message is up to the network implementation.
network shall reject the initial registration with a 5GMM cause value other than the 5GMM cause #76 (Not authorized for this CAG or authorized for CAG cells only).
NOTE 3: 5GMM cause #7 (5GS services not allowed), 5GMM cause #11 (PLMN not allowed), 5GMM cause #27 (N1 mode not allowed), 5GMM cause #73 (Serving network not authorized) can be used depending on the subscription of the UE and whether the UE roams or not.
Registration procedure for mobility and periodic registration update.
This procedure used for periodic registration update of 5GS services is controlled in the UE by timer T351 When timer T3512 expires, the registration procedure for mobility and periodic registration area updating is started.
Start and reset of timer T3512 is described in subclause 1 Mobility and periodic registration update initiation registered in the AMF; b) when the periodic registration updating timer T3512 expires in 5GMM-IDLE mode; in the Registration requested bit of the Configuration update indication IE as specified in subclauses ; d) when the UE in state 5GMM-REGISTERED.
ATTEMPTING-REGISTRATION-UPDATE either receives a 3GPP access for PDU sessions associated with 3GPP access; e) upon inter-system change from S1 mode to N1 mode and if the UE previously had initiated an attach procedure f) when the UE receives an indication of "RRC Connection failure" from the lower layers and does not have signalling pending (i.
when the lower layer requests NAS signalling connection recovery) except for the case specified in subclause ; g) when the UE changes the 5GMM capability or the S1 UE network capability or both; h) when the UE's usage setting changes; from the upper layers to establish an emergency PDU session or perform emergency services fallback; or de-register from SMS over NAS; session(s) as specified in subclauses and ; n) when the UE in 5GMM-IDLE mode changes the radio capability for NG-RAN or E-UTRAN; p) void; q) when the UE needs to request new LADN information; r) when the UE needs to request the use of MICO mode or needs to stop the use of MICO mode or to request the use of new T3324 value; registration area belonging to an equivalent PLMN of the registered PLMN and not belonging to the registered with the 5GMM cause value set to #28 "Restricted service area"; different extended DRX parameters, or needs to stop the use of eDRX; NOTE 1: A change in the eDRX usage conditions at the UE can include e.
a change in the UE configuration, a change in requirements from upper layers or the battery running low at the UE.
v) when the UE supporting 5G-SRVCC from NG-RAN to UTRAN changes the mobile station classmark 2 or the w) when the UE in state 5GMM-REGISTERED.
ATTEMPTING-REGISTRATION-UPDATE decides to request new network slices after being rejected due to no allowed network slices requested; x) when the UE is not in NB-N1 mode and the applicable UE radio capability ID for the current UE radio mobility under the same AMF needs to be clarified in SA integrity protection over another access; z) when the UE needs to request new cipheri ng keys for ciphered broadcast assistance data; zb) when the UE needs to start, stop or change the conditions for using the WUS assistance information.
zc) when the UE changes the UE specific DRX parameters in NB-N1 mode.
If case b) is the only reason for initiating the registration procedure for mobility and periodic registration update, the UE shall indicate "periodic registration updating" in the 5GS registration type IE; otherwise the UE shall indicate "mobility registration updating".
If the UE indicates "mobility registration updating" in the 5GS registration type IE and the UE supports S1 mode, the set the S1 mode bit to "S1 mode supported" in the 5GMM capability IE of the REGISTRATION REQUEST include the S1 UE network capability IE in the REGISTRATION REQUEST message; and attach bit to "attach request message containing PDN connectivity request with request type set to handover to If the UE supports the LTE positioning protocol (LPP) in N1 mode as specified in 3GPP specification document , the UE shall set the LPP bit to "LPP in N1 mode supported" in the 5GMM capability IE of the REGISTRATION REQUEST message.
If the UE supports the Location Services (LCS) notification mechanisms in N1 mode as specified in 3GPP specification document [6B], the UE shall set the 5G-LCS bit to " LCS notification mechanisms supported" in the 5GMM capability IE of the REGISTRATION REQUEST message.
For all cases except case b), when the UE is not in NB-N1 mode and the UE supports RACS, the UE shall set the RACS bit to "RACS supported" in the 5GMM capability IE of the REGISTRATION REQUEST message.
If the UE supports 5G-SRVCC from NG-RAN to UTRAN as specified in 3GPP specification document [6A], the UE shall set: in the 5GMM capability IE of the REGISTRATION REQUEST message for all cases except case b; and include the Mobile station classmark 2 IE and the Supported codecs IE in the REGISTRATION REQUEST message for all cases except case b.
If the UE supports the restriction on use of enhanced coverage, the UE shall set the RestrictEC bit to "Restriction on use of enhanced coverage supported" in the 5GMM cap ability IE of the REGISTRATION REQUEST message.
If the UE supports network slice-specific authentication and authorization, the UE shall set the NSSAA bit to "network slice-specific authentication and authorization suppor ted" in the 5GMM capability IE of the REGISTRATION REQUEST message for all cases except case b.
If the UE supports CAG feature, the UE shall set the CAG bit to "CAG Supported" in the 5GMM capability IE of the If the UE operating in the single-registration mode performs inter-system change from S1 mode to N1 mode and has NOTE 2: In this version of the protocol, the UE can only include the Payload container IE in the REGISTRATION requested bit of the 5GS update type IE in the REGISTRATION REQUEST message as specified in subclause If the UE no longer requires the use of SMS over NAS, then the UE shall include the 5GS update type IE in the REGISTRATION REQUEST message with the SMS requested bit set to "SMS over NAS not supported".
After sending the REGISTRATION REQUEST message to the AMF the UE shall start timer T351 If timer T3502 is currently running, the UE shall stop timer T350 If timer T3511 is currently running, the UE shall stop timer T351 If the last visited registered TAI is available, the UE shall include the last visited registered TAI in the The UE shall handle the 5GS mobile identity IE in the REGISTRATION REQUEST message as follows: a) if the UE is operating in the single-registration mode, performs inter-system change from S1 mode to N1 mode, 2) a valid 5G-GUTI that was previously assigned by an equivalent PLMN, if available; and 3) a valid 5G-GUTI that was previously assigned by any other PLMN, if available; and If the UE supports MICO mode and requests the use of MICO mode, then the UE shall include the MICO indication IE in the REGISTRATION REQUEST message.
If the UE requests to use an active time value, it shall include the active time value in the T3324 IE in the REGISTRATION REQUEST message.
Additionally, if the UE supports strictly periodic registration timer, the UE shall set the Strictly Periodic Registration Timer Indication bit of the MICO indication IE in the REGISTRATION REQUEST message to "strictly periodic registration timer supported".
If the UE needs to stop the use of MICO mode, then the UE shall not include the MICO indication IE in the REGISTRATION If the UE needs to use or change the UE specific DRX parameters, the UE shall include the Requested DRX parameters IE in the REGISTRATION REQUEST message.
If the UE is in NB-N1 mode and if the UE needs to use or change the UE specific DRX parameters for NB-N1 mode, the UE shall include the Requested NB-N1 mode DRX parameters IE in the REGISTRATION REQUEST message.
If the UE supports eDRX and requests the use of eDRX, the UE shall include the Requested extended DRX parameters IE in the REGISTRATION REQUEST message.
as specified in 3GPP specification document , the UE shall in clude the LADN indication IE in the REGISTRATION REQUEST DNN for which the UE requests LADN information; or If the UE is initiating the registration procedure for mobility and periodic registration update, the UE may include the Uplink data status IE to indicate which PDU session(s) that is: not associated with control plane only indication; associated with the access type the REGISTRATION REQUEST message is sent over; and - have pending user data to be sent over user plane.
If the UE has one or more active always-on PDU sessions associated with the access type over which the REGISTRATION REQUEST message is sent and the user-plane resources for these PDU sessions are not established, the UE shall include the Uplink data status IE and indicate th at the UE has pending user data to be sent for those PDU If the UE has one or more active PDU sessions which are not accepted by the network as always-on PDU sessions and no uplink user data pending to be sent for those PDU sessions, the UE shall not include those PDU sessions in the Uplink data status IE in the REGISTRATION REQUEST message.
When the registration procedure for mobility and periodic registration update is initiated in 5GMM-IDLE mode, the UE "activated" for the corresponding PDU session and the UE is not using the PDU session to send uplink IP packets for any of the 3GPP PS data off exempt services (see subclause 0).
If the UE operating in the single-registration mode performs inter-system change from S1 mode to N1 mode, the UE: a) shall include the UE status IE with the EMM registration status set to "UE is in EMM-REGISTERED state" in the REGISTRATION REQUEST message; NOTE 4: Inclusion of the UE status IE with this setting corresponds to the indication that the UE is "moving from EPC" as specified in 3GPP specification document , subclause and NOTE 5: The value of the 5GMM registration status included by the UE in the UE status IE is not used by the b) may include the PDU session status IE in the REGISTRATION REQUEST message indicating the status of the PDU session(s) mapped during the inter-system change from S1 mode to N1 mode from the PDN connection(s) for which the EPS indicated that interworking to 5GS is supported, if any (see subclause\); EPS NAS message container IE in the REGISTRATION REQUEST message if the registration procedure is initiated in 5GMM-IDLE mode; and d) shall include an EPS bearer context status IE in the REGISTRATION REQUEST message indicating which EPS bearer contexts are active in the UE , if the UE has locally deactivated EPS bearer context(s) for which interworking to 5GS is supported while the UE was in S1 mode without notifying the network.
a) is in NB-N1 mode and: 1) the UE needs to change the slice(s) it is currently registered to within the same registration area; or b) the UE is not in NB-N1 mode; the UE shall include the Requested NSSAI IE containing the S-NSSAI(s) corresponding to the network slices to which the UE intends to register and associated mapped S- NSSAI(s), if available, in the REGISTRATION REQUEST NOTE 6: The REGISTRATION REQUEST message can include both the Requested NSSAI and the Requested mapped NSSAI as described below.
If the UE has allowed NSSAI or configured NSSAI for the current PLMN, the Requested NSSAI IE shall include either: NSSAI for the current PLMN; NSSAI for the current PLMN; or from the configured NSSAI for which no corresponding S-NSSAI is present in the allowed NSSAI and those are neither in the rejected NSSAI for the current PLMN nor in the rejected NSSAI for the current registration area nor in the rejected NSSAI for the failed or revoked NSSAA.
a) each PDN connection that is established in S1 mode wh en the UE is operating in the single-registration mode and the UE is performing an inter-system change from S1 mode to N1 mode; or b) each active PDU session.
The Requested mapped NSSAI IE shall include mapped S-NSSAI(s), if available, when the UE does not have S-NSSAI(s) applicable in the current PLMN for: a) each PDN connection established in S1 mode when the UE is operating in the single-registration mode and the NOTE 7: The Requested NSSAI IE is used instead of Requested mapped NSSAI IE in REGISTRATION REQUEST message when the UE enters (E)HPLMN.
updating", if the UE is in NB-N1 mode and the procedure is initiated for all cases except case a), c), e), i), s), t), w), and x), the REGISTRATION REQUEST message shall not include the Requested NSSAI IE.
If the UE has: no allowed NSSAI for the current PLMN; no configured NSSAI for the current PLMN; neither active PDU session(s) nor PDN connection(s) to tr ansfer associated with an S-NSSAI applicable in the neither active PDU session(s) nor PDN connection(s) to transfer associated with mapped S-NSSAI(s); a) include the S-NSSAI(s) in the Requested NSSAI IE of the REGISTRATION REQUEST message using the default configured NSSAI; and b) include the Network slicing indication IE with the Default configured NSSAI indication bit set to "Requested NSSAI created from default configured NSSAI" in the REGISTRATION REQUEST message.
If the UE has: no allowed NSSAI for the current PLMN; - no configured NSSAI for the current PLMN; neither active PDU session(s) nor PDN connection(s) to tr ansfer associated with an S-NSSAI applicable in the neither active PDU session(s) nor PDN connection(s) to transfer associated with mapped S-NSSAI(s); and no default configured NSSAI the UE shall include neither Requested NSSAI IE nor Requested mapped NSSAI IE in the REGISTRATION The subset of configured NSSAI provided in the requested NSSAI consists of one or more S-NSSAIs in the configured NSSAI applicable to this PLMN, if the S-NSSAI is neither in the rejected NSSAI for the current PLMN nor in the rejected NSSAI for the current registration area nor in the rejected NSSAI for the failed or revoked NSSAA.
The subset of allowed NSSAI provided in the requested NSSAI consists of one or more S-NSSAIs in the allowed NSSAI for this PLMN.
policies, applications) into account.
NOTE 9: The number of S-NSSAI(s) included in the requested NSSAI cannot exceed eight.
The UE shall set the Follow-on request indicator to "Follow-on request pending", if the UE: a) initiates the mobility and periodic registration updating procedure upon request of the upper layers to establish an emergency PDU session; to perform emergency service fallback; or c) needs to prolong the established NAS signalling connect ion after the completion of the registration procedure for mobility and periodic registration update (e.
due to uplink signalling pending but no user data pending).
NOTE 10: The UE does not have to set the Follow-on request indicator to 1 even if the UE has to request resources for V2X communication over PC5 reference point.
For case n), the UE shall include the 5GS update type IE in the REGISTRATION REQUEST message with the NG-RAN-RCU bit set to " UE radio capability update needed".
Additionally, if the UE is not in NB-N1 mode, the UE supports RACS and the UE has an applicable UE radio capability ID for the new UE radio configuration in the serving PLMN or SNPN, the UE shall include the applicable UE radio capability ID in the UE radio capability ID of the If the UE is in the 5GMM-CONNECTED mode and the UE changes the radio capability for NG-RAN or E-UTRAN, the UE may locally release the established N1 NAS signalling connection and enter the 5GMM-IDLE mode.
Then, the UE shall initiate the registration procedure for mobility and periodic updating including the 5GS update type IE in the REGISTRATION REQUEST message with the NG-RAN-RCU bit set to " UE radio capability update needed".
For case o), the UE shall include the Uplink data status IE in the REGISTRATION REQUEST message indicating the PDU session(s) without active user-plane resources for which the UE has pending user data to be sent, if any, and the PDU session(s) for which user-plane resources were active prior to receiving the fallback indication, if any.
If the UE is receiving the fallback indication is an emergency PDU session, or if the UE is configured for high priority access in the selected PLMN as specified in subclause For case f), the UE shall include the Uplink data status IE in the REGISTRATION REQUEST message indicating the PDU session(s) for which user-plane resources were active prior to receiving "RRC Connection failure" indication from the lower layers, if any.
If the UE is in non-allowed area or not in allowed area, the UE shall not include the Uplink data status IE in REGISTRATION REQUEST message, except that the PDU session(s) for which user-plane resources were active prior to receiving the fallback indication is emergency PDU session(s), or that the UE is configured for high priority access in selected PLMN, as specified in subclause If the UE supports service gap control, then the UE shall set the SGC bit to "service gap control supported" in the 5GMM capability IE of the REGISTRATION REQUEST message.
For case a), x) or if the UE operating in the single-registrat ion mode performs inter-system change from S1 mode to N1 mode, the UE shall: a) if the UE has an applicable network-assigned UE radio capability ID for the current UE radio configuration in the selected PLMN or SNPN, include the applicable network-assigned UE radio capability ID in the UE radio capability ID IE of the REGISTRATION REQUEST message; and b) if the UE: 1) does not have an applicable network-assigned UE radio capability ID for the current UE radio configuration in the selected PLMN or SNPN; and 2) has an applicable manufacturer-assigned UE radio capability ID for the current UE radio configuration, include the applicable manufacturer-assigned UE radio capability ID in the UE radio capability ID IE of the for ciphered broadcast assistance data requested" in the REGISTRATION REQUEST message.
one or more ciphering keys stored at the UE is not applicable, the UE should include the Additional information requested IE with the CipherKey bit set to "ciphering keys for ciphered broadcast assistance data requested" in the REGISTRATION REQUEST message.
ciphering keys stored at the UE is less than timer T3512, the UE should include the Additional information requested IE with the CipherKey bit set to "ciphering keys for ciphered broadcast assistance data requested" in the REGISTRATION The UE shall set the WUSA bit to "WUS assistance inform ation reception supported" in the 5GMM capability IE if the UE supports WUS assistance information.
The UE may include its UE paging probability information in the Requested WUS assistance information IE if the UE has set the WUSA bit to "WUS assistance inform ation reception supported" in the 5GMM capability IE.
message after an inter-system change from S1 mode to N1 mode in 5GMM-IDLE mode, the UE shall send the REGISTRATION REQUEST message without including the NAS message container IE.
The UE shall include the entire REGISTRATION REQUEST message (i.
containing cleartext IEs and non-cleartext IEs, if any) in the NAS message container IE that is sent as part of the SECURITY MODE COMPLETE message as described in subclauses and If the UE indicates "mobility registration updating" in the 5GS registration type IE and supports V2X as specified in 3GPP specification document [19B], the UE shall set the V2X bit to "V2X supported" in the 5GMM capability IE of the REGISTRATION REQUEST message.
If the UE indicates "mobility registration updating" in the 5GS registration type IE and supports V2X communication over E-UTRA-PC5 as specified in 3GPP specification document [19B], the UE shall set the V2XCEPC5 bit to "V2X communication over E-UTRA-PC5 supported" in the 5GMM capability IE of the REGISTRATION REQUEST message.
If the UE indicates "mobility registration updating" in the 5GS registration type IE and supports V2X communication over NR-PC5 as specified in 3GPP specification document [19B], the UE shall set the V2XCNPC5 bit to "V2X communication over NR-PC5 supported" in the 5GMM capability IE of the REGISTRATION The UE shall send the REGISTRATION REQUEST message including the NAS message container IE as described in needs to send non-cleartext IEs; and b) when the UE is sending the message after an inter-system change from S1 mode to N1 mode in 5GMM-IDLE a) from 5GMM-IDLE mode; and b) after an inter-system change from S1 mode to N1 mode in 5GMM-IDLE mode.
If the UE is sending the REGISTRATION REQUEST message after an inter-system change from S1 mode to N1 mode in 5GMM-CONNECTED mode and the UE needs to send non-cleartext IEs, the UE shall cipher the NAS message container IE using the mapped 5G NAS security context and send the REGISTRATION REQUEST message including the NAS message container IE as described in subclause If the UE does not need to send non-cleartext IEs, the UE shall send the REGISTRATION REQUEST message without including the NAS message container IE.
REGISTRATION REQUEST message that is obtained from the NAS message container IE as described in subclause optimization supported" in the S1 UE network capability IE of the REGISTRATION REQUEST message.
If the registration procedure for mobility and periodic registration update is initiated and there is request from the upper without an Uplink data status IE.
If the UE supports N3 data transfer and multiple user-plane resources in NB-N1 mode (see 3GPP specification document [25D], 3GPP specification document [25A]), then the UE shall set the Multiple user-plane resources support bit to "Multiple user-plane resources supported" in the 5GMM capability IE of the REGISTRATION REQUEST message.
Registration procedure for mobility and periodic registration update 5GMM common procedure initiation The AMF may initiate 5GMM common procedures, e.
the identification, authentication and security procedures during the registration procedure, depending on the information received in the REGISTRATION REQUEST message.
The AMF may be configured to skip the authentication procedure even if no 5GS security context is available and proceed directly to the execution of the security mode co ntrol procedure as specified in subclause , during the The AMF shall not initiate a 5GMM authentication procedure before completion of the registration procedure for mobility and periodic registration update, if the following conditions apply: a) the UE initiated the registration procedure for mobility and periodic registration update after handover or inter- system change to N1 mode in 5GMM-CONNECTED mode; REGISTRATION REQUEST message, and the PLMN identity included in the 5G-GUTI is different from the selected PLMN identity of the target cell; or c.
2) the UE has included the 5G-GUTI mapped from the 4G-GUTI in the 5GS mobile identity IE and not included an Additional GUTI IE in the REGISTRATION REQUEST message, and the PLMN identity included in the 5G-GUTI is different from the selected PLMN identity of the target cell.
Mobility and periodic registration update accepted by the network indicating non-3GPP and the REGISTRATION REQUEST message includes the Allowed PDU session status IE.
For each of the information elements: 5GMM capability, S1 UE network capability, and UE security capability, the AMF shall store all octets received from the UE in the REGISTRATION REQUEST message, up to the maximum length defined for the respective information element.
NOTE 1: This information is forwarded to the new AMF during inter-AMF handover or to the new MME during inter-system handover to S1 mode.
The 5G-GUTI reallocation shall be part of the registration procedure for mobility registration update.
The 5G-GUTI configuration update procedure, the AMF shall include in the REGISTRATION ACCEPT message the new assigned If the UE has set the CAG bit to "CAG supported" in the 5GMM capability IE of the REGISTRATION REQUEST message and the AMF needs to update the "CAG information list" stored in the UE, the AMF shall include the CAG information list IE in the REGISTRATION ACCEPT message.
If a 5G-GUTI or the SOR transparent container IE is included in the REGISTRATION ACCCEPT message, the AMF shall start timer T3550 and enter state 5GMM-COMMON-PROCEDURE-INITIATED as described in If the Operator-defined access category definitions IE or the Extended emergency number list IE or the CAG information list IE are included in the REGISTRATION ACCCEPT message, the AMF shall start timer T3550 and enter state 5GMM-COMMON-PROCEDURE-INITIATED as described in subclause If the UE is not in NB-N1 mode and the UE has set the RACS bit to "RACS supported" in the 5GMM Capability IE of capability ID deletion indication IE in the REGISTRATION ACCEPT message.
If the UE radio capability ID IE or the UE radio capability ID deletion indication IE is included in the REGISTRATION ACCCEPT message, the AMF shall start timer T3550 and enter state 5GMM-COMMON-PROCEDURE-INITIATED as described in subclause NOTE 2: When assigning the TAI list, the AMF can take into account the eNodeB's capability of support of CIoT forbidden PLMN list as specified in subclause 3A, any such PLMN identity shall be deleted from the corresponding list(s).
The AMF may include new service area restrictions in the Service area list IE in the REGISTRATION ACCEPT If the Service area list IE is not included in the REGIST RATION ACCEPT message, any tracking area in the registered PLMN and its equivalent PLMN(s) in the registration area is considered as an allowed tracking area as described in The AMF shall include the MICO indication IE in the REGISTRATION ACCEPT message only if the MICO indication IE was included in the REGISTRATION REQUEST message, the AMF supports and accepts the use of MICO mode.
If the AMF supports and accepts the use of MICO mode, the AMF may indicate "all PLMN registration area allocated" in the MICO indication IE in the REGI STRATION ACCEPT message.
If "all PLMN registration area the REGISTRATION REQUEST message, the AMF may indicate "strictly periodic registration timer supported" in the UE shall restart T3512 with the new value received in the T3512 value IE.
The AMF shall include an active time value in the T3324 IE in the REGISTRATION ACCEPT message if the UE requested an active time value in the REGISTRATION REQUEST message and the AMF accepts the use of MICO mode and the use of active time.
If the UE does not include MICO indication IE in the REGISTRATION REQUEST message, then the AMF shall disable MICO mode if it was already enabled.
The AMF may include the T3512 value IE in the REGISTRATION ACCEPT message only if the REGISTRATION REQUEST message was sent over the 3GPP access.
The AMF may include the non-3GPP de-registration timer value IE in the REGISTRATION ACCEPT message only if the REGISTRATION REQUEST message was sent for the non-3GPP access.
If the UE requests "control plane CIoT 5GS optimization" in the 5GS update type IE, indicates support of control plane optimization and the registration request, the AMF shall indicate "control plane CIoT 5GS optimization supported" in the 5GS network feature support IE of the REGISTRATION ACCEPT message.
If the UE has indicated support for the control plane CIoT 5GS optimizations, and the AMF decides to activate the congestion control for transport of user da ta via the control plane, then the AMF shall include the T3448 value IE in the If the AMF decides to deactivate the congestion control for tr ansport of user data via the control plane, then the AMF in the REGISTRATION ACCEPT message.
If: the UE in NB-N1 mode is using control plane CIoT 5GS optimization; and - the network is configured to provide the truncated 5G-S-TMSI configuration for control plane CIoT 5GS optimizations; IE based on network policies.
The AMF shall start timer T3550 and enter state 5GMM-COMMON-PROCEDURE-INITIATED as described in subclause current 5G NAS security context in the REGISTRATION REQUEST message by which the REGISTRATION REQUEST message is integrity protected, the AMF shall take one of the following actions: a) if the AMF retrieves the current 5G NAS security context as indicated by the ngKSI and 5G-GUTI sent by the UE, the AMF shall integrity check the REGISTRATION REQUEST message using the current 5G NAS security context and integrity protect the REGISTRATION ACCEPT message using the current 5G NAS security context; b) if the AMF cannot retrieve the current 5G NAS security context as indicated by the ngKSI and 5G-GUTI sent by the UE, the AMF shall treat the REGISTRATION REQUEST message fails the integrity check and take actions as specified in subclause ; or c) if the UE has not included an Additional GUTI IE, the AMF may treat the REGISTRATION REQUEST message as in the previous item, i.
as if it cannot retrieve the current 5G NAS security context.
NOTE 3: The handling described above at failure to retrieve the current 5G NAS security context or if no For inter-system change from S1 mode to N1 mode in 5GMM-CONNECTED mode, the AMF shall integrity check REGISTRATION REQUEST message using the current K' AMF as derived when triggering the handover to N1 mode message.
The AMF shall then take one of the following actions: identifier IE, the AMF shall remove the non-current native 5G NAS security context, if any, for any 5G-GUTI for this UE.
The AMF shall then integrity protect and cipher the REGISTRATION ACCEPT message using the security context based on K' AMF and take the mapped 5G NAS security context into use; or control procedure to take the corresponding native 5G NAS security context into use and then integrity protect and cipher the REGISTRATION ACCEPT message using the corresponding native 5G NAS security context; and 2) otherwise, the AMF shall then integrity protect and cipher the REGISTRATION ACCEPT message using the security context based on K' AMF and take the mapped 5G NAS security context into use.
the corresponding native 5G NAS security context into use.
Upon receipt of the REGISTRATION ACCEPT message, the UE shall reset the registration attempt counter and service request attempt counter, enter state 5GMM-REGISTERED and set the 5GS update status to 5U1 UPDATED.
attempt counter for that PLMN for the specific access type for which the message was received.
The UE shall also reset the PLMN-specific N1 mode attempt counter for that PLMN for the specific access type for which the message was received.
If the message was received via 3GPP access, the UE shall reset the counter for "SIM/USIM considered invalid for GPRS services" events and the counter for "SIM/USIM considered invalid for non-GPRS services", if any.
If the message was received via non-3GPP access, the UE shall reset the counter for "USIM considered invalid for 5GS services over non-3GPP" events.
If the UE receives the REGISTRATION ACCEPT message from an SNPN, then the UE shall reset the SNPN-specific timer value in the UE, the UE shall use the default value of the non-3GPP de-registration timer.
The UE shall provide the 5G-GUTI to the lower layer of 3GPP access if the REGISTRATION ACCEPT message is sent over the non-3GPP access, and the UE is in 5GMM-REGISTERED in both 3GPP access and non-3GPP access in the same PLMN.
If the REGISTRATION ACCEPT message contains the Network slicing indication IE with the Network slicing If the REGISTRATION ACCEPT message contains the CAG in formation list IE and the UE had set the CAG bit to "CAG supported" in the 5GMM capability IE of the REGISTRATION REQUEST message, the UE shall: a) replace the "CAG information list" stored in the UE wi th the received CAG information list IE when received in b) replace the serving VPLMN's entry of the "CAG information list" stored in the UE with the serving VPLMN's VPLMN, if any, in the received CAG information list IE are ignored.
The UE shall store the "CAG information list" received in the CAG information list IE as specified in annex C.
If the received "CAG information list" includes an entry containing the identity of the registered PLMN, the UE shall the received "CAG information list" does not include any of the CAG-ID(s) supported by the current CAG cell, 1) the entry for the registered PLMN in the received "CAG information list" does not include an "indication that the UE is only allowed to access 5GS via CAG cells", then the UE shall enter the state 5GMM- with the updated "CAG information list"; or 2) the entry for the registered PLMN in the received "CAG information list" includes an "indication that the UE is only allowed to access 5GS via CAG cells" and: i) if the entry for the registered PLMN in the received "CAG information list" includes one or more CAG- IDs, the UE shall enter the state 5GMM-REGISTERED.
LIMITED-SERVICE and shall search for a suitable cell according to 3GPP specification document with the updated "CAG information list"; or ii) if the entry for the registered PLMN in the received "CAG information list" does not include any CAG-ID and: 3GPP specification document with the updated "CAG information list"; or associated with 3GPP access except for the emergency PDU session; or PLMN in the received "CAG information list" includes an "indication that the UE is only allowed to access 5GS via CAG cells" and: 1) if the "allowed CAG list" for the registered PLMN in the received "CAG information list" includes one or 2) if the entry for the registered PLMN in the received "CAG information list" does not include any CAG-ID i) the UE does not have an emergency PDU session, then the UE shall enter the state 5GMM- DEREGISTERED.
PLMN-SEARCH and shall apply the PLMN selection process defined in 3GPP specification document with the updated "CAG information list"; or associated with 3GPP access except for the emergency PDU session.
If the REGISTRATION ACCEPT message contains the UE radio capability ID IE or the UE radio capability ID If the T3448 value IE is present in the received REGISTRATION ACCEPT message and the value indicates that this timer is neither zero nor deactivated, the UE shall: a) stop timer T3448 if it is running; and b) start timer T3448 with the value provided in the T3448 value IE.
If the UE is using 5GS services with control plane CIoT 5GS optimization, the T3448 value IE is present in the REGISTRATION ACCEPT message and the value indicates that this timer is either zero or deactivated, the UE shall ignore the T3448 value IE and proceed as if the T3448 value IE was not present.
If the UE in 5GMM-IDLE mode initiated the registration procedure for mobility and periodic registration update and the REGISTRATION ACCEPT message does not include the T3448 value IE and if timer T3448 is running, then the UE shall stop timer T344 5GMM-REGISTERED.
The 5G-GUTI, if sent in the REGISTRATION ACCEPT message, shall be considered as valid, and the UE radio capability ID, if sent in the REGISTRATION ACCEPT message, shall be considered as valid.
If the 5GS update type IE was included in the REGISTRATION REQUEST message with the SMS requested bit set to "SMS over NAS supported" and: a) the SMSF address is stored in the UE 5GMM context and: 1) the UE is considered available for SMS over NAS; or SMS service is successful; or b) the SMSF address is not stored in the UE 5GMM context, the SMSF selection is successful and the SMSF has confirmed that the activation of the SMS service is successful; not considered available for SMS over NAS, then the AMF shall: a) store the SMSF address in the UE 5G MM context if not stored already; and b) store the value of the SMS allowed bit of the 5GS regi stration result IE in the UE 5GMM context and consider the UE available for SMS over NAS.
If SMSF selection in the AMF or SMS activation via the SMSF is not successful, or the AMF does not allow the use of SMS over NAS, then the AMF shall set the SMS allowed bit of the 5GS registration result IE to "SMS over NAS not allowed" in the REGISTRATION ACCEPT message.
If the 5GS update type IE was included in the REGISTRATION REQUEST message with the SMS requested bit set to "SMS over NAS not supported" or the 5GS update type IE was not included in the REGISTRATION REQUEST message, then the AMF shall: a) mark the 5GMM context to indicate that the UE is not available for SMS over NAS; and NOTE 5: The AMF can notify the SMSF that the UE is deregistered from SMS over NAS based on local b) set the SMS allowed bit of the 5GS registration result IE to "SMS over NAS not allowed" in the When the UE receives the REGISTRATION ACCEPT message, if the UE is also registered over another access to the same PLMN, the UE considers the value indicated by the SMS allowed bit of the 5GS registration result IE as applicable for both accesses over which the UE is registered.
If the 5GS update type IE was included in the REGISTRATION REQUEST message with the NG-RAN-RCU bit set to " UE radio capability update needed", the AMF shall delete the stored UE radio capability information for NG-RAN or the UE radio capability ID, if any.
The AMF shall include the 5GS registration result IE in the REGISTRATION ACCEPT message.
If the 5GS registration result IE value indicates: a) "3GPP access", the UE: shall consider itself as being registered to 3GPP access only; and if in 5GMM-REGISTERED state over non-3GPP access and on the same PLMN as 3GPP access, shall enter state 5GMM-DEREGISTERED.
ATTEMPTING-REGISTRATION over non-3GPP access and set the 5GS update status to 5U2 NOT UPDATED over non-3GPP access; b) "Non-3GPP access", the UE: shall consider itself as being registered to non-3GPP access only; and if in the 5GMM-REGISTERED state over 3GPP access and is on the same PLMN as non-3GPP access, shall enter the state 5GMM-DEREGISTERED.
ATTEMPTING-REGISTRATION over 3GPP access and set the 5GS update status to 5U2 NOT UPDATED over 3GPP access; or c) "3GPP access and Non-3GPP access", the UE shall consider itself as being registered to both 3GPP access and registered for emergency services and shall release locally PDU session(s) not associated with emergency services, if The AMF shall include the allowed NSSAI for the current PLMN and shall include the mapped S-NSSAI(s) for the allowed NSSAI contained in the requested NSSAI (i.
Requested NSSAI IE or Requested mapped NSSAI IE) from the UE if available, in the REGISTRATION ACCEPT message if the UE included the requested NSSAI in the REGISTRATION REQUEST message and the AMF allows one or more S-NSSAIs for the current PLMN in the Requested NSSAI IE or one or more mapped S-NSSAIs in the Requested NSSAI IE or Requested mapped NSSAI IE.
The S-NSSAI associated with each of the active PDN connections for which interworking to 5GS is supported, shall be The AMF may also include rejected NSSAI in the REGISTRATION ACCEPT message.
Rejected NSSAI contains S- NSSAI(s) which was included in the requested NSSAI but rej ected by the network associated with rejection cause(s).
If the UE indicated the support for network slice-specific authentication and authorization, and if the Requested NSSAI IE includes one or more S-NSSAIs subject to network slice-specific authentication and authorization, the AMF shall in the REGISTRATION ACCEPT message include: a) the allowed NSSAI containing the S-NSSAI(s) or the mapped S-NSSAI(s), if any: i) which are not subject to network slice-specific authen tication and authorization and are allowed by the AMF; ii) for which the network slice-specific authentication and authorization has been successfully performed; b) optionally, the rejected NSSAI for the failed or revoked NSSAA; c) pending NSSAI containing one or more S-NSSAIs for which network slice-specific authentication and authorization will be performed or is ongoing, if any; and d) the "NSSAA to be performed" indicator in the 5GS registration result IE set to indicate whether network slice- specific authentication and authorization procedure will be performed by the network, if the allowed NSSAI is not included in the REGISTRATION ACCEPT message.
If the UE indicated the support for network slice-specific authentication and authorization, and if: a) the UE did not include the requested NSSAI in the REGISTRATION REQUEST message or none of the S- NSSAIs in the requested NSSAI in the REGISTRATION REQUEST message are allowed; and b) all subscribed S-NSSAIs marked as default are subject to network slice-specific authentication and authorization; the AMF shall in the REGISTRATION ACCEPT message include: a) the "NSSAA to be performed" indicator in the 5GS registration result IE to indicate whether network slice- specific authentication and authorization procedure will be performed by the network; and b) pending NSSAI containing one or more subscribed S-NSSAIs marked as default for which network slice- specific authentication and authorization will be performed or is ongoing.
If the UE indicated the support for network slice-specific authentication and authorization, and if: a) the UE did not include the requested NSSAI in the REGISTRATION REQUEST message or none of the S- NSSAIs in the requested NSSAI in the REGISTRATION REQUEST message are allowed; and the AMF shall in the REGISTRATION ACCEPT message include: a) pending NSSAI containing one or more subscribed S-NSSAIs marked as default for which network slice- specific authentication and authorization will be performed or is ongoing, if any; and b) allowed NSSAI containing one or more subscribed S-NSSAIs marked as default which are not subject to network slice-specific authentication and authorization or for which the network slice-specific authentication and authorization has been successfully performed.
which network slice-specific authentication and authorization will be performed or is ongoing from the requested NSSAI of the REGISTRATION REQUEST message that was received over the 3GPP access, non-3GPP access, or both the 3GPP access or non-3GPP access.
mapping information to an S-NSSAI of the HPLMN; d) the REGISTRATION REQUEST message included the Network slicing indication IE with the Default configured NSSAI indication bit set to "Requested NSSAI created from default configured NSSAI"; or e) the REGISTRATION REQUEST message included the requested mapped NSSAI.
the configured NSSAI for the current PLMN if available in the REGISTRATION ACCEPT message.
In this case the AMF shall start timer T3550 and enter state 5GMM-COMMON-PROCEDURE-INITIATED as described in subclause The AMF shall include the Network slicing indication IE with the Network slicing subscription change indication set to "Network slicing subscription changed" in the REGISTRATION ACCEPT message if the UDM has indicated that the subscription data for network slicing has changed.
In this case the AMF shall start timer T3550 and enter state 5GMM-COMMON-PROCEDURE-INITIATED as described in subclause If the S-NSSAI(s) associated with the existing PDU session(s) of the UE is not included in the requested NSSAI of the The UE receiving the pending NSSAI in the REGISTRATION ACCEPT message shall store the S-NSSAI(s) in the pending NSSAI as specified in subclause If the regi stration area contains TAIs belonging to different PLMNs, which are equivalent PLMNs, the UE shall store the recei ved pending NSSAI for each of the equivalent PLMNs as The UE receiving the rejected NSSAI in the REGISTRATION ACCEPT message takes the following actions based on the rejection cause in the rejected S-NSSAI(s): "S-NSSAI not available in the current PLMN or SNPN" The UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the current PLMN as specified in subclause and shall not attempt to use this S-NSSAI(s) in the current PLMN until switching off the UE, the UICC containing the USIM is removed, the entry of the "list of subscriber data" with the SNPN identity of the current SNPN is updated, or the rejected S-NSSAI(s) are removed or deleted as described in "S-NSSAI not available in the current registration area" The UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the current registration area as specified in subclause and shall not attempt to use this S-NSSAI(s) in the current registration area until switching off the UE, the UE moving out of the current registration area, the UICC containing the USIM is removed, the entry of the "list of subscriber data" with the SNPN identity of the current SNPN is updated, or the rejected S-NSSAI(s) are removed or deleted as described in subclause "S-NSSAI not available for the failed or revoked network slice-specific authentication and authorization" The UE shall store the rejected S-NSSAI(s) in the re jected NSSAI due to the failed or revoked NSSAA as specified in subclause and shall not attempt to use this S-NSSAI in the current PLMN over any access until switching off the UE, the UICC containing the USIM is removed, the entry of the "list of subscriber data" with the SNPN identity of the current SNPN is updated, or the rejected S-NSSAI(s) are removed or deleted as described in subclause and If the UE set the NSSAA bit in the 5GMM capability IE to "Network slice-specific authentication and authorization not a) if the Requested NSSAI IE only includes the S-NSSAI(s) subject to network slice-specific authentication and authorization with the rejection cause indicating "S-NSSAI not available in the current PLMN or SNPN"; or b) if the Requested NSSAI IE includes one or more S-NS SAIs subject to network slice-specific authentication and authorization, the AMF shall in the REGISTRATION ACCEPT message include: 1) the allowed NSSAI containing the S-NSSAI(s) or the mapped S-NSSAI(s) which are not subject to network slice-specific authentication and authorization; and 2) the rejected NSSAI containing: i) the S-NSSAI(s) subject to network slice specific auth entication and authorization with the rejection cause indicating "S-NSSAI not available in the current PLMN or SNPN"; and ii) the S-NSSAI(s) which was included in the requested NSSAI but rejected by the network associated with the rejection cause indicating "S-NSSAI not available in the current PLMN or SNPN" or the rejection cause indicating "S-NSSAI not available in the current registration area", if any.
a) the UE is not in NB-N1 mode; and 1) the UE did not include the requested NSSAI in the REGISTRATION REQUEST message; or 2) none of the S-NSSAIs in the requested NSSAI in the REGISTRATION REQUEST message are allowed; and one or more subscribed S-NSSAIs marked as default wh ich are not subject to network slice-specific authentication and authorization are available, the AMF shall put the subs cribed S-NSSAIs marked as default and not subject to network slice-specific authentication and authorization in the allowed NSSAI of the REGISTRATION ACCEPT a) "periodic registration updating"; or b) "mobility registration updating" and the UE is in NB-N1 mode; NSSAI to the UE in the REGISTRATION ACCEPT message.
Additionally, if all the S-NSSAIs of the new allowed NSSAI require NSSAA, the REGISTRATION ACCEPT message shall include the "NSSAA to be performed" indicator set to "Network slice-specific authentication and authorization is to be performed" in the 5GS registration result IE of the REGISTRATION ACCEPT message.
If the REGISTRATION ACCEPT message contains the Network slicing indication IE with the Network slicing subscription change indication set to "Network slicing subscription changed", the UE shall delete the network slicing information for each and every PLMN except for the current PLMN as specified in subclause If the REGISTRATION ACCEPT message contains the allowed NSSAI, then the UE shall store the included allowed NSSAI together with the PLMN identity of the register ed PLMN and the registration area as specified in subclause If the registration area contains TAIs be longing to different PLMNs, which are equivalent PLMNs, the UE shall store the received allowed NSSAI in each of allowed NSSAIs which are associated with each of the PLMNs.
With respect to each of the PDU session(s) active in the UE, if the allowed NSSAI contains neither: a) an S-NSSAI matching to the S-NSSAI of the PDU session; nor b) a mapped S-NSSAI matching to the mapped S-NSSAI of the PDU session; mapped S-NSSAI of the PDU session, the UE shall locally update the S-NSSAI associated with the PDU session to the corresponding S-NSSAI received in the allowed NSSAI.
current PLMN and optionally the mapped S-NSSAI(s) for the configured NSSAI for the current PLMN, the UE shall store the contents of the configured NSSAI IE as specified in subclause If the REGISTRATION ACCEPT message: a) shall not perform the registration procedure for mobility and registration update with the Uplink data status IE except for emergency services or for high priority access; to paging or notification over non-3GPP access, for cases f) and i) in subclause ; that is related to an exceptional event.
a) "periodic registration updating"; or b) "mobility registration updating" and the UE is in NB-N1 mode; if the REGISTRATION ACCEPT message: a) includes the 5GS registration result IE with the "NSSAA to be performed" indicator set to "Network slice- specific authentication and authorization is not to be performed" or the message does not contain an allowed NSSAI, the UE considers the previously received allowed NSSAI as valid; or b) includes the 5GS registration result IE with the "NSSAA to be performed" indicator set to "Network slice- If the Uplink data status IE is included in the REGISTRATION REQUEST message: a) if the AMF determines that the UE is in non-allowed area or is not in allowed area, and the PDU session(s) indicated by the Uplink data status IE is non-emergency PDU session(s) or the UE is not configured for high priority access in selected PLMN, the AMF shall incl ude the PDU session reactivation result IE in the REGISTRATION ACCEPT message indicating that user-plane resources for the corresponding PDU session(s) cannot be re-established, and shall include the PDU session reactivation result error cause IE with the 5GMM cause set to #28 "Restricted service area"; b) otherwise, the AMF shall: 1) indicate the SMF to re-establish the user-plane resources for the corresponding PDU session; 2) include PDU session reactivation result IE in the REGISTRATION ACCEPT message to indicate the user- plane resources re-establishment result of the PDU sessions for which the UE requested to re-establish the user-plane resources; and If the Uplink data status IE is not included in the REGISTRATION REQUEST message and the REGISTRATION REQUEST message is sent for the trigger d) in subclause , the AMF may indicate the SMF to re-establish the user-plane resources for the PDU sessions.
the AMF side associated with the access type the REGISTRATION REQUEST message is sent over, but are indicated by the UE as being in 5GSM state PDU SESSION INACTIVE; and associated with the access type the REGISTRATION REQUEST message is sent over are active in the AMF.
If the Allowed PDU session status IE is included in the REGISTRATION REQUEST message, the AMF shall: a) for a 5GSM message from each SMF that has indicated pending downlink signalling only, forward the received 5GSM message via 3GPP access to the UE after the REGISTRATION ACCEPT message is sent; b) for each SMF that has indicated pending downlink data only: 1) notify the SMF that reactivation of the user-plane resources for the corresponding PDU session(s) associated with non-3GPP access cannot be performed if the corresponding PDU session ID(s) are not indicated in the Allowed PDU session status IE; and 2) notify the SMF that reactivation of the user-plane resources for the corresponding PDU session(s) associated with non-3GPP access can be performed if the corresponding PDU session ID(s) are indicated in the Allowed PDU session status IE.
c) for each SMF that have indicated pending downlink signalling and data: 1) notify the SMF that reactivation of the user-plane resources for the corresponding PDU session(s) associated with non-3GPP access cannot be performed if the corresponding PDU session ID(s) are not indicated in the Allowed PDU session status IE; 2) notify the SMF that reactivation of the user-plane resources for the corresponding PDU session(s) associated with non-3GPP access can be performed if the corresponding PDU session ID(s) are indicated in the Allowed PDU session status IE; and 3) discard the received 5GSM message for PDU session(s) associated with non-3GPP access; and d) include the PDU session reactivation result IE in the REGISTRATION ACCEPT message to indicate the successfully re-established user-plane resources for the corresponding PDU sessions, if any.
PDU session status IE, the UE considers the corresponding PDU session to be associated with the 3GPP access.
If the update the associated access type of the corresponding PDU session.
If an EPS bearer context status IE is included in the REGISTRATION REQUEST message, the AMF handles the received EPS bearer context status IE as specified in 3GPP specification document .
If the EPS bearer context status information is generated for the UE during the inter-system change from S1 mode to N1 mode as specified in 3GPP specification document and the AMF supports N26 interface, the AMF shall include an EPS bearer context status IE in the REGISTRATION ACCEPT message to indicate the UE which mapped EPS bearer contexts are active in the network.
result IE in the REGISTRATION ACCEPT message indicating that user-plane resources for the corresponding PDU session cannot be re-established, and: result error cause IE with the 5GMM cause set to #43 "LADN not available"; b) if the user-plane resources cannot be established becau se the SMF indicated to the AMF that only prioritized services are allowed (see 3GPP specification document [20A]), the AMF shall include the PDU session reactivation result error cause IE with the 5GMM cause set to #28 "restricted service area" c) if the user-plane resources cannot be established becau se the SMF indicated to the AMF that the resource is not available in the UPF (see 3GPP specification document [20A]), the AMF shall include the PDU session reactivation result error cause IE with the 5GMM cause set to #92 "insufficient user-plane resources for the PDU session"; or d) otherwise, the AMF may include the PDU session reactivation result error cause IE to indicate the cause of failure to re-establish the user-plane resources.
The AMF may include the LADN information IE in the REGISTRATION ACCEPT message as described in subclause The UE, upon receiving the REGISTRATION ACCEPT message with the LADN information IE, shall delete its old LADN information (if any) and store the received new LADN information.
If the AMF does not include the LADN information IE in the REGISTATION ACCEPT message during registration procedure for mobility and registration update, the UE shall delete its old LADN information.
release of all those PDU sessions associated with the access type the REGISTRATION ACCEPT message is sent over which are not in 5GSM state PDU SESSION INACTIVE or PDU SESSION ACTIVE PENDING on the UE side, but are indicated by the AMF as being in 5GSM state PDU SESSION INACTIVE.
d) the UE has received the IWK N26 bit set to "interworking without N26 interface supported"; the UE shall ignore the PDU session status IE if received in the REGISTRATION ACCEPT message.
If the EPS bearer context status IE is included in the REGISTRATION ACCEPT message, the UE shall locally delete all those QoS flow descriptions and all associated QoS rules, if any, which are associated with inactive EPS bearer contexts as indicated by the AMF in the EPS bearer context status IE.
If the UE included S1 mode supported indication in the REGISTRATION REQUEST message, the AMF supporting inter-system change with EPS shall set the IWK N26 bit to either: a) "interworking without N26 interface not supported" if the AMF supports N26 interface; or b) "interworking without N26 interface supported" if the AMF does not support N26 interface in the 5GS network feature support IE in the REGISTRATION ACCEPT message.
The UE supporting S1 mode shall operate in the mode for inter-system interworking with EPS as follows: a) if the IWK N26 bit in the 5GS network feature support IE is set to "interworking without N26 interface not supported", the UE shall operate in single-registration mode; b) if the IWK N26 bit in the 5GS network feature support IE is set to "interworking without N26 interface supported" and the UE supports dual-registration mode, the UE may operate in dual-registration mode; or supported" and the UE only supports single-registration mode, the UE shall operate in single-registration mode.
The UE shall treat the received interworking without N26 interface indicator for inter-system change with EPS as valid in the entire PLMN and its equivalent PLMN(s).
The network informs the UE about the support of specific features, such as IMS voice over PS session, location services (5G-LCS), emergency services, emergency services fa llback and ATSSS, in the 5GS network feature support sessions or calls.
When initiating an emergency call, the upper layers take the IMS voice over PS session indicator, The AMF shall set the EMF bit in the 5GS network feature support IE to: a) "Emergency services fallback supported in NR connected to 5GCN and E-UTRA connected to 5GCN" if the network supports the emergency services fallback procedure when the UE is in an NR cell connected to 5GCN or an E-UTRA cell connected to 5GCN; b) "Emergency services fallback supported in NR connected to 5GCN only" if the network supports the emergency services fallback procedure when the UE is in an NR cell connected to 5GCN and does not support the emergency services fallback procedure when the UE is in an E-UTRA cell connected to 5GCN; c) "Emergency services fallback supported in E-UTRA connected to 5GCN only" if the network supports the emergency services fallback procedure when the UE is in an E-UTRA cell connected to 5GCN and does not support the emergency services fallback procedure when the UE is in an NR cell connected to 5GCN; or d) "Emergency services fallback not supported" if network does not support the emergency services fallback procedure when the UE is in any cell connected to 5GCN.
NOTE 8: If the emergency services are supported in neither the EPS nor the 5GS homogeneously, based on operator policy, the AMF will set the EMF bit in th e 5GS network feature support IE to "Emergency services fallback not supported".
NOTE 9: Even though the AMF's support of emergency services fallback is indicated per RAT, the UE's support of emergency services fallback is not per RAT, i.
the UE's support of emergency services fallback is the same for both NR connected to 5GCN and E-UTRA connected to 5GCN.
If the UE is not operating in SNPN access mode: a) the network informs the UE that the use of access identity 1 is valid in the RPLMN or equivalent PLMN by setting the MPS indicator bit of the 5GS network feature support IE to "Access identity 1 valid", in the REGISTRATION ACCEPT message.
Based on operator policy, the AMF sets the MPS indicator bit in the REGISTRATION ACCEPT message based on the MPS priority information in the user's subscription context obtained from the UDM; NG-RAN of the registered PLMN and its equivalent PLMN s.
The MPS indicator bit in the 5GS network feature d) the network informs the UE that the use of access identity 2 is valid in the RPLMN or equivalent PLMN by setting the MCS indicator bit of the 5GS network feat ure support IE to "Access identity 2 valid", in the REGISTRATION ACCEPT message.
Based on operator policy, the AMF sets the MCS indicator bit in the REGISTRATION ACCEPT message based on the MCS priori ty information in the user's subscription context obtained from the UDM; f) during ongoing active PDU sessions that were set up relying on the MCS indicator bit being set to "Access If the UE indicates support for restriction on use of enhanced coverage in the REGISTRATION REQUEST message and: c) in NB-N1 mode, the AMF decides to restrict the use of enhanced coverage for the UE, then the AMF shall set the RestrictEC bit to "Use of enhanced coverage is restricted", in the 5GS network feature support IE in the REGISTRATION ACCEPT message.
If the UE is operating in SNPN access mode: a) the network informs the UE that the use of access identit y 1 is valid in the RSNPN by setting the MPS indicator bit of the 5GS network feature support IE to "Acce ss identity 1 valid", in the REGISTRATION ACCEPT message.
Based on operator policy, the AMF sets the MPS indicator bit in the REGISTRATION ACCEPT all NG-RAN of the registered SNPN.
The MPS indicator bit in the 5GS network feature support IE provided in c) during ongoing active PDU sessions that were set up relying on the MPS indicator bit being set to "Access the UE, the ongoing active PDU sessions are not affected by the change of the MPS indicator bit; d) the network informs the UE that the use of access identity 2 is valid in the RSNPN by setting the MCS indicator all NG-RAN of the registered SNPN.
The MCS indicator bit in the 5GS network feature support IE provided in with the MCS indicator bit set to "Access identity 2 not valid" or until the UE selects another SNPN.
Access identity 2 is only applicable while the UE is in N1 mode; and f) during ongoing active PDU sessions that were set up relying on the MCS indicator bit being set to "Access the UE, the ongoing active PDU sessions are not affected by the change of the MCS indicator bit.
If the UE has set the Follow-on request indicator to "Follow-on request pending" in the REGISTRATION REQUEST message, or the network has downlink signalling pending, the AMF shall not immediately release the NAS signalling connection after the completion of the registration procedure.
If the UE is authorized to use V2X communication over PC5 reference point based on: a) at least one of the following bits in the 5GMM capability IE of the REGISTRATION REQUEST message set by the UE, or already stored in the 5GMM context in the AMF during the previous registration procedure as 1) the V2XCEPC5 bit to "V2X communication over E-UTRA-PC5 supported"; or 2) the V2XCNPC5 bit to "V2X communication over NR-PC5 supported"; and b) the user's subscription context obtained from the UDM as defined in 3GPP specification document [6C]; the AMF should not immediately release the NAS signalling connection after the completion of the registration If the Requested DRX parameters IE was included in the REGISTRATION REQUEST message, the AMF shall include the Negotiated DRX parameters IE in the REGISTRATION ACCEPT message.
The AMF may set the Negotiated DRX parameters IE based on the received Requested DRX parameters IE and operator policy if available.
If the Requested NB-N1 mode DRX parameters IE was included in the REGISTRATION REQUEST message, the AMF shall include the Negotiated NB-N1 mode DRX parameters IE in the REGISTRATION ACCEPT message.
The AMF may set the Negotiated NB-N1 mode DRX parameters IE based on the received Requested NB-N1 mode DRX parameters IE and operator policy if available.
The AMF shall include the Negotiated extended DRX parameters IE in the REGISTRATION ACCEPT message only if If the UE included in the REGISTRATION REQUEST message the UE status information IE with the EMM registration status set to "UE is in EMM-REGISTERED state" and the AMF does not support N26 interface, the AMF shall operate as described in subclause value is available in the 5GMM context, the AMF may include the T3447 value IE set to the service gap time value in the REGISTRATION ACCEPT message.
If the UE requests ciphering keys for ciphered broadcast assistance data in the REGISTRATION REQUEST message shall include the ciphering key data in the Ciphering key data IE of the REGISTRATION ACCEPT message.
If the UE supports WUS assistance information and the AMF supports and accepts the use of WUS assistance information for the UE, then the AMF shall determine the negotiated UE paging probability information for the UE, Requested WUS assistance information IE when determining the negotiated UE paging probability information for the UE.
NOTE 10: Besides the UE paging probability information requested by the UE, the AMF can take local UE paging probability information for the UE.
If due to regional subscription restric tions or access restrictions the UE is not allowed to access the TA or due to CAG emergency PDU sessions (associated with 3GPP access if it is due to CAG restrictions) and informs the UE via the PDU session status IE in the REGISTRATION ACCEPT message.
The AMF shall not indicate to the SMF to release the emergency PDU session.
The network shall behave as if the UE is registered for emergency services.
If the REGISTRATION ACCEPT message includes the PDU session reactivation result error cause IE with the 5GMM cause set to #28 "Restricted service area", the UE shall enter the state 5GMM-REGISTERED.
NON-ALLOWED-SERVICE and behave as specified in subclause If the REGISTRATION ACCEPT message includes the SOR transparent container IE and: a) the SOR transparent container IE does not successfully pass the integrity check (see 3GPP specification document\); and b) if the UE attempts obtaining service on another PLMNs as specified in 3GPP specification document annex C; container IE successfully passes the integrity check (see 3GPP specification document\): a) the UE shall proceed with the behaviour as specified in 3GPP specification document annex C; and b) if the registration procedure is performed over 3G PP access and the UE attempts obtaining service on another acknowledgement is requested in the SOR transparent container IE of the REGISTRATION ACCEPT message, the UE acknowledgement is included in the SOR tran sparent container IE of the REGISTRATION COMPLETE If the SOR transparent container IE successfully passes the integrity check (see 3GPP specification document\), indicates list of preferred PLMN/access technology combinations is provided and the list type indicates: a) "PLMN ID and access technology list", then the ME shall replace the highest priority entries in the "Operator Controlled PLMN Selector with Access Technology" list st ored in the ME and shall proceed with the behaviour as specified in 3GPP specification document annex C; or download, data coding scheme set to class 2 message and SMS payload as secured packet contents of SOR transparent container IE.
The SMS payload is forwarded to UICC as specified in 3GPP specification document [4A] and the ME shall proceed with the behaviour as specified in 3GPP specification document annex C.
If required by operator policy, the AMF shall include the NSSAI inclusion mode IE in the REGISTRATION ACCEPT message (see table of subclause\).
Upon receipt of the REGISTRATION ACCEPT message: a) if the message includes the NSSAI inclusion mode IE, the UE shall operate in the NSSAI inclusion mode indicated in the NSSAI inclusion mode IE over the current access within the current PLMN and its equivalent PLMN(s), if any, in the current registration area; or 1) if the UE has NSSAI inclusion mode for the current PLMN and access type stored in the UE, the UE shall the current access type; or current access type; or 3) if the 5G-RG does not have NSSAI inclusion mode for the current PLMN and wireline access stored in the 5G-RG, and the 5G-RG is performing the registration procedure over wireline access, the 5G-RG shall The AMF may include operator-defined access category definitions in the REGISTRATION ACCEPT message.
indicator is set to "Follow-on request pending" in the REGISTRATION REQUEST message, the AMF shall ignore the Uplink data status IE or that the Follow-on request indicator is set to "Follow-on request pending" and proceed as if the Uplink data status IE was not received or the Follow-on requ est indicator was not set to "Follow-on request pending" except for the following case: the PDU session(s) indicated by the Uplink data status IE is emergency PDU session(s); If the UE receives Operator-defined access category definitions IE in the REGISTRATION ACCEPT message and the UE shall delete any operator-defined access category definitions stored for the RPLMN and shall store the received contains no operator-defined access category definitions, the UE shall delete any operator-defined access category definitions stored for the RPLMN.
If the REGISTRATION ACCEPT message does not contain the Operator-defined access category definitions IE, the UE shall not delete the operator-defined access category definitions stored for the RPLMN.
If the UE has indicated support for service gap control in the REGISTRATION REQUEST message and: the REGISTRATION ACCEPT message contains the T3447 value IE, then the UE shall store the new T3447 value, erase any previous stored T3447 value if exists and use the new T3447 value with the timer T3447 next time it is started; or the REGISTRATION ACCEPT message does not contain the T3447 value IE, then the UE shall erase any previous stored T3447 value if exists and stop the timer T3447 if running.
AMF to acknowledge reception of the truncated 5G-S-TMSI configuration.
NOTE 11: The UE provides the truncated 5G-S -TMSI configuration to the lower layers.
If the UE is not in NB-N1 mode, the UE has set the RACS bit to "RACS supported" in the 5GMM Capability IE of the REGISTRATION REQUEST message, and the REGISTRATION ACCEPT message includes: a) a UE radio capability ID deletion indication IE set to "Network-assigned UE radio capability IDs deletion b) a UE radio capability ID IE, the UE shall store the UE radio capability ID as specified in annex C.
Mobility and periodic registration update not accepted by the network When the UE performs inter-system change from S1 mode to N1 mode, if the AMF is informed that verification of the integrity protection of the TRACKING AREA UPDATE REQUEST message included by the UE in the EPS NAS message container IE of the REGISTRATION REQUEST message has failed in the MME, the AMF shall send REGISTRATION REJECT message including 5GMM cause #9 "UE identity cannot be derived by the network" if the AMF needs to reject the mobility and periodic registration update procedure.
If the REGISTRATION REJECT message with 5GMM cause #76 was received without integrity protection, then the UE shall discard the message.
Based on operator policy, if the mobility and periodic registration update request is rejected due to core network redirection for CIoT optimizations, the network shall set the 5GMM cause value to #31 "Redirection to EPC required".
NOTE 1: The network can take into account the UE's S1 mode capability, the EPS CIoT network behaviour supported by the UE or the EPS CIoT network behaviour supported by the EPC to determine the rejection with the 5GMM cause value #31 "Redirection to EPC required".
a) all the S-NSSAI(s) included in the requested NSSAI are either rejected for the current registration area, rejected for the current PLMN, or rejected due to the failed or revoked NSSAA; and b) the UE set the NSSAA bit in the 5GMM capability IE to: 1) "Network slice-specific authentication and authorization supported" and; i) there are no subscribed S-NSSAIs marked as default; or ii) all subscribed S-NSSAIs marked as default are not allowed; or 2) "Network slice-specific authentication and authorization not supported"; and i) there are no subscribed S-NSSAIs which are marked as default; or ii) all subscribed S-NSSAIs marked as default are eith er not allowed or are subject to network slice-specific the network shall set the 5GMM cause value to #62 "No network slices available" and may include the rejected NSSAI.
If the mobility and periodic registration update request is rej ected due to that the UE is not authorized in the current CAG cell or the UE is authorized to access 5GS via CAG cell only, the network shall set the 5GMM cause value to #76 "Not authorized for this CAG or authorized for CAG cells only" and may include the "CAG information list" in the CAG information list IE in the REGISTRATION REJECT message.
NOTE 2: The network cannot be certain that "CAG information list" stored in the UE is updated as result of sending of the REGISTRATION REJECT message with the CAG information list IE, as the REGISTRATION REJECT message is not necessarily delivered to the UE (e.
g due to abnormal radio conditions).
The UE shall take the following actions depending on the 5GMM cause value received in the REGISTRATION REJECT message.
#3 (Illegal UE); or The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
In case of SNPN, the UE shall consider the entry of the "list of subscriber data" with the SNPN identity of the current SNPN as invalid until the UE is switched off or the entry is updated.
Additionally, if EAP based primary authentication and key agreement proced ure using EAP-AKA' or 5G AKA based primary authentication and key agreement procedure was performed in the current SNPN, the UE shall consider the USIM as invalid for the current SNPN until switching off or the UICC containing the USIM is removed.
The UE shall delete the list of equivalent PLMNs (if any) and shall move to 5GMM-DEREGISTERED.
If the message has been successfully integrity checked by the NAS, then the UE shall: 1) set the counter for "SIM/USIM considered invalid for GPRS services" events and the counter for "USIM considered invalid for 5GS services over non-3GPP access" events in case of PLMN; or 2) set the counter for "the entry for the current SNPN considered invalid for 3GPP access" events and the counter for "the entry for the current SNPN considered invalid for non-3GPP access" events in case of SNPN; 3) delete the 5GMM parameters stored in non-volatile memory of the ME as specified in annex C.
to UE implementation-specific maximum value.
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list and rejected with the EMM cause with the same value.
The USIM shall be considered as invalid also for non-EPS services until switching off or the UICC containing the USIM is removed.
If the UE is in EMM-REGISTERED state, the UE shall move to EMM-DEREGISTERED state.
If the message has been successfully integrity services", then the UE shall set this counter to UE implementation-specific maximum value.
If the message has been successfully integrity checked by the NAS and the UE also supports the registration procedure over the other access, the UE shall in addi tion handle 5GMM parameters and 5GMM state for this access, as described for this 5GMM cause value.
#7 (5GS services not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
In case of PLMN, the UE shall consider the USIM as invalid for 5GS services until switching off or the UICC containing the USIM is removed; In case of SNPN, the UE shall consider the entry of the "list of subscriber data" with the SNPN identity of the current SNPN as invalid for 5GS services until the UE is switched off or the entry is updated.
Additionally, if EAP based primary authentication and key agreement procedure using EAP-AKA' or 5G AKA based primary authentication and key agreement procedure was performed in the current SNPN, the UE shall consider the USIM as invalid for the current SNPN until switching off or the UICC containing the USIM is removed.
The UE shall move to 5GMM-DEREGISTERED.
If the message has been successfully integrity checked by the NAS, then the UE shall: 1) set the counter for "SIM/USIM considered invalid for GPRS services" events and the counter for "USIM considered invalid for 5GS services over non-3GPP access" events in case of PLMN; or 2) set the counter for "the entry for the current SNPN considered invalid for 3GPP access" events and the counter for "the entry for the current SNPN considered invalid for non-3GPP access" events in case of SNPN; to UE implementation-specific maximum value.
3) delete the 5GMM parameters stored in non-volatile memory of the ME as specified in annex C.
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list and If the message has been successfully integrity checked by the NAS and the UE also supports the registration procedure over the other access, the UE shall in addition handle 5GMM parameters and 5GMM state for this access, as described for this 5GMM cause value.
#9 (UE identity cannot be derived by the network).
The UE shall set the 5GS update status to 5U2 NOT UPDATED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
The UE shall enter the state 5GMM-DEREGISTERED.
If the UE has initiated the registration procedure in order to enable performing the service request procedure for emergency services fallback, the UE shall attempt to select an E-UTRA cell connected to EPC or 5GCN If the rejected request was neither for initiating an emergency PDU session nor for emergency services fallback, the UE shall subsequently, automatically in itiate the initial registration procedure.
NOTE 3: User interaction is necessary in some cases when the UE cannot re-establish the PDU session(s) If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall rejected with the EMM cause with the same value.
The UE shall enter the state 5GMM-DEREGISTERED.
The UE shall delete any mapped 5G NAS security context or partial native 5G NAS security context.
registration procedure for initial registration.
NOTE 4: User interaction is necessary in some cases when the UE cannot re-establish the PDU session(s) If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM state as specified in 3GPP specification document [1 5] for the case when the normal tracking area updating procedure is rejected with the EMM cause with the same value.
#11 (PLMN not allowed).
of the UE is specified in subclause The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
The UE shall successfully integrity checked by the NAS, the UE shall set the PLMN-specific attempt counter and the PLMN- specific attempt counter for non-3GPP access for that PLMN to the UE implementation-specific maximum value.
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall in addition handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI and tracking area updating attempt counter as specified in 3GPP specification document for the case when the normal tracking area updating pro cedure is rejected with the EMM cause with the same value.
5GMM state for this access, as described for this 5GMM cause value.
#12 (Tracking area not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
Additionally, the UE shall reset the registration attempt counter.
1) the UE is not operating in SNPN access mode, the UE shall store the current TAI in the list of "5GS forbidden tracking areas for regional provision of service" and enter the state 5GMM- DEREGISTERED.
If the REGISTRATION REJECT message is not integrity protected, the UE shall memorize the current TAI was stor ed in the list of "5GS forbidden tracking areas for regional provision of service" for non-integrity protected NAS reject message; or 2) the UE is operating in SNPN access mode, the UE shall store the current TAI in the list of "5GS forbidden tracking areas for regional provision of service" for the current SNPN and enter the state 5GMM-DEREGISTERED.
If the REGISTRATION REJECT message is not integrity protected, the UE shall memorize the current TAI was stor ed in the list of "5GS forbidden tracking areas for regional provision of service" for the current SNPN for non-integrity protected NAS reject message.
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI and tracking area updating attempt counter as specified in 3GPP specification document for the case when the normal tracking area updating procedure is rejected with the EMM cause with the same value.
#13 (Roaming not allowed in this tracking area).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete the list of equivalent PLMNs (if available).
The UE shall reset the registration attempt counter and shall change to state 5GMM-REGISTERED.
If the UE is registered in S1 mode and operating in dual-registration mode, the PLMN that the UE chooses to register in is specified in subclause Otherwise if: 1) the UE is not operating in SNPN access mode, the UE shall store the current TAI in the list of "5GS forbidden tracking areas for roaming" and shall remove the current TAI from the stored TAI list if present.
If the REGISTRATION REJECT message is not integrity protected, the UE shall memorize the current TAI was stored in the list of "5GS forbidden tracking areas for roaming" for non-integrity protected NAS reject 2) the UE is operating in SNPN access mode, the UE shall store the current TAI in the list of "5GS forbidden tracking areas for roaming" for the current SNPN.
If the REGISTRATION REJECT message is not integrity protected, the UE shall memorize the current TAI was stor ed in the list of "5GS forbidden tracking areas for roaming" for the current SNPN for non-integrity protected NAS reject message.
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status and tracking area updating attempt counter as specified in 3GPP specification document for the case when the no rmal tracking area updating pr ocedure is rejected with the EMM cause with the same value.
#15 (No suitable cells in tracking area).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\).
The UE shall reset the registration attempt counter and shall enter the state 5GMM- If the UE has initiated the registration procedure in order to enable performing the service request procedure for emergency services fallback, the UE shall attempt to se lect an E-UTRA cell connected to EPC or 5GC according 1) the UE is not operating in SNPN access mode, the UE shall store the current TAI in the list of "5GS forbidden tracking areas for roaming" and shall remove the current TAI from the stored TAI list, if present.
If the REGISTRATION REJECT message is not integrity protected, the UE shall memorize the current TAI was stored in the list of "5GS forbidden tracking areas for roaming" for non-integrity protected NAS reject 2) the UE is operating in SNPN access mode, the UE shall store the current TAI in the list of "5GS forbidden tracking areas for roaming" for the current SNPN and shall remove the current TAI from the stored TAI list, if present.
If the REGISTRATION REJECT message is not integrity protected, the UE shall memorize the current TAI was stored in the list of "5GS forbidden tracking areas for roaming" for the current SNPN for non-integrity protected NAS reject message.
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status and tracking area updating attempt counter as specified in 3GPP specification document for the case when the no rmal tracking area updating pr ocedure is rejected with the EMM cause with the same value.
If the T3346 value IE is present in the REGISTRATION REJECT message and the value indicates that this timer is neither zero nor deactivated, the UE shall proceed as de scribed below, otherwise it shall be considered as an abnormal case and the behaviour of the UE for this case is specified in subclause The UE shall abort the registration procedure for mobility and periodic registration update.
If the rejected request was not for initiating an emergency PDU session, the UE shall set the 5GS update status to 5U2 NOT UPDATED, reset the registration attempt counter and change to state 5GMM-REGISTERED.
The UE shall stop timer T3346 if it is running.
If the REGISTRATION REJECT message is integrity protected, the UE shall start timer T3346 with the value provided in the T3346 value IE.
If the REGISTRATION REJECT message is not integrity protected, the UE shall start timer T3346 with a random value from the default range specified in 3GPP specification document .
The UE stays in the current serving cell and applies the normal cell reselection process.
The registration procedure for mobility and periodic registration update is started, if still necessary, when timer T3346 expires or If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status and tracking area updating attempt counter as specified in 3GPP specification document for the case when the no rmal tracking area updating pr ocedure is rejected with the EMM cause with the same value.
If the registration procedure for mobility and periodic registration update was initiated for an MO MMTEL voice call (i.
access category 4), or an MO IMS registration related signalling (i.
access category 9) or for NAS signalling connection recovery during an ongoing MO MMTEL voice call (i.
access category 4) or during an #27 (N1 mode not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\).
Additionally, the UE shall reset the registration attempt counter and shall enter the state 5GMM-REGISTERED.
If the message has been successfully integrity checked by the NAS, the UE shall set: 1) the PLMN-specific N1 mode attempt counter for 3GPP access and the PLMN-specific N1 mode attempt counter for non-3GPP access for that PLMN in case of PLMN; or The UE shall disable the N1 mode capability for the specific access type for which the message was received If the message has been successfully integrity checked by the NAS, the UE shall disable the N1 mode capability also for the other access type (see subclause\).
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall in addition set the EPS update status to EU3 ROAMING NOT ALLOWED.
Additionally, the UE shall reset the tracking area updating attempt counter and enter the state EMM-REGISTERED.
#31 (Redirection to EPC required).
over non-3GPP access is considered an abnormal case and the behaviour of the UE is specified in of the UE is specified in subclause The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\).
The UE shall reset the registration attempt counter and enter the state 5GMM- REGISTERED.
The UE shall enable the E-UTRA capability if it was disabled and disable the N1 mode capability for 3GPP If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status, and tracking area updating attempt counter as specified in 3GPP specification document for the case when the no rmal tracking area updating pr ocedure is rejected with the EMM cause with the same value.
#62 (No network slices available).
The UE shall abort the registration procedure for mobility and periodic registration update procedure, set the 5GS update status to 5U2 NOT UPDATED and enter state 5GMM-REGISTERED.
Additionally, the UE shall reset the registration attempt counter.
The UE receiving the rejected NSSAI in the REGISTRATION REJECT message takes the following actions based on the rejection cause in the rejected S-NSSAI(s): "S-NSSAI not available in the current PLMN or SNPN" The UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the current PLMN or SNPN as specified in subclause and shall not attempt to use this S-NSSAI(s) in the current PLMN or SNPN until switching off the UE, the UICC containing the USIM is removed, an entry of the "list of subscriber data" with the SNPN identity of the current SNPN is updated, or the rejected S-NSSAI(s) are removed as described in subclause "S-NSSAI not available in the current registration area" The UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the current registration area as specified in subclause and shall not attempt to use this S-NSSAI(s) in the current registration area until switching off the UE, the UE moving out of the current registration area, the UICC containing the USIM is removed, an entry of the "list of subscriber data" with the SNPN identity of the current SNPN is updated, or the rejected S-NSSAI(s) are removed as described in subclause "S-NSSAI not available due to the failed or revoked network slice-specific authentication and authorization" The UE shall store the rejected S-NSSAI(s) in the rejected NSSAI for the failed or revoked NSSAA as specified in subclause and shall not attempt to use this S-NSSAI in the current PLMN over any access until switching off the UE, the UICC containing the USIM is removed, the entry of the "list of If the UE has an allowed NSSAI or configured NSSAI th at contains S-NSSAIs which are not included in any of the rejected NSSAI for the PLMN or SNPN, the rejected NSSAI for the current registration area, and the rejected NSSAI for the failed or revoked NSSAA, the UE may stay in the current serving cell, apply the normal requested NSSAI that includes any S-NSSAI from the allo wed S-NSSAI or the configured NSSAI that is neither #72 (Non-3GPP access to 5GCN not allowed).
When received over non-3GPP access the UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause 2) and shall delete 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
Additionally, the UE shall reset the registration attempt counter and enter the state 5GMM-DEREGISTERED.
If the message has been successfully integrity checked by the NAS, the UE shall set the PLMN-specific N1 mode attempt counter for non-3GPP access for that PLMN to the UE implementation-specific maximum value.
NOTE 5: The 5GMM sublayer states, the 5GMM parameters and the registration status are managed per access type independently, i.
3GPP access or non-3GPP access (see subclauses and\).
The UE shall disable the N1 mode capability for non-3GPP access (see subclause\).
As an implementation option, the UE may enter the state 5GMM-DEREGISTERED.
PLMN-SEARCH in order If received over 3GPP access the cause shall be considered as an abnormal case and the behaviour of the UE for this case is specified in subclause of the UE is specified in subclause The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
The UE shall delete the list of equivalent PLMNs, reset the registration attempt counter, store the PLMN identity in the forbidden PLMN list as specified in subclause 3A, and enter state 5GMM-DEREGISTERED.
PLMN- specific attempt counter for non-3GPP access for that PLMN to the UE implementation-specific maximum If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall in addition set the EPS update status to EU3 ROAMING NOT ALLOWED and shall delete any 4G-GUTI, last visited registered TAI, TAI list and eKSI.
Additionally, the UE shall reset the tracking area updating attempt counter and enter the state EMM-DEREGISTERED.
#74 (Temporarily not authorized for this SNPN).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
The UE shall reset the registration attempt counter and store the SNPN identity in the "temporarily forbidden SNPNs" list for the specific access type for which the message was received.
The UE shall enter state 5GMM-DEREGISTERED.
PLMN-SEARCH and perform an SNPN selection according to 3GPP specification document .
If the message has been successfully integrity checked by the NAS, the UE shall set the SNPN-specific attempt counter for 3GPP access and the SNPN-specific attempt counter for non-3GPP access for the current SNPN to the UE implementation-specific maximum value.
5GMM state for this access, as described for this 5GMM cause value.
NOTE 6: When 5GMM cause #74 is received over 3GPP access, the term "other access" in "the UE also supports #75 (Permanently not authorized for this SNPN).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
The UE shall reset the registration attempt counter and store the SNPN identity in the "permanently forbidden SNPNs" list for the specific access type for which the message was received.
The UE shall enter state 5GMM-DEREGISTERED.
PLMN-SEARCH and perform an SNPN selection according to 3GPP specification document .
If the message has been successfully integrity checked by the NAS, the UE shall set the SNPN-specific attempt counter for 3GPP access and the SNPN-specific attempt counter for non-3GPP access for the current SNPN to the UE implementation-specific maximum value.
If the message has been successfully integrity checked by the NAS and the UE also supports the registration procedure over the other access to the same SNPN, the UE shall in addition handle 5GMM parameters and 5GMM state for this access, as described for this 5GMM cause value.
NOTE 7: When 5GMM cause #75 is received over 3GPP access, the term "other access" in "the UE also supports #76 (Not authorized for this CAG or authorized for CAG cells only).
of the UE is specified in subclause The UE shall set the 5GS update status to 5UROAMING NOT ALLOWED, store the 5GS update status according to clause , and reset the registration attempt counter.
If 5GMM cause #76 is received from: 1) a CAG cell, and if the UE receives a "CAG information list" in the CAG information list IE included in the the received "CAG information list".
Otherwise, the UE shall delete the CAG-ID(s) of the cell from the "allowed CAG list" for the current PLMN.
In addition: i) if the entry in the "CAG information list" for the current PLMN does not include an "indication that the UE is only allowed to access 5GS via CAG cells" or if the entry in the "CAG information list" for the current PLMN includes an "indication that the UE is only allowed to access 5GS via CAG cells" and the updated "allowed CAG list" for the current PLMN includes one or more CAG-IDs, then the UE shall to 3GPP specification document with the updated "CAG information list"; or ii) if the entry in the "CAG information list" for the current PLMN includes an "indication that the UE is only allowed to access 5GS via CAG cells" and the updated "allowed CAG list" for the current PLMN does not include any CAG-ID, then the UE shall enter the state 5GMM-DEREGISTERED.
PLMN-SEARCH and shall apply the PLMN selection proce ss defined in 3GPP specification document with the updated 2) a non-CAG cell, and if the UE receives a "CAG information list" in the CAG information list IE included in allowed to access 5GS via CAG cells" in the entry of the "CAG information list" for the current PLMN.
In addition: 3GPP specification document with the updated CAG information; or ii) if the "allowed CAG list" for the current PLMN does not includes any CAG-ID, then the UE shall enter the state 5GMM-DEREGISTERED.
PLMN-SEARCH and shall apply the PLMN selection process defined in 3GPP specification document with the updated "CAG information list".
#77 (Wireline access area not allowed).
acting on behalf of the FN-CRG (or on behalf of the N5GC device).
5GMM cause #77 received from a 5G behalf of the FN-BRG are considered as abnormal cases and the behaviour of the UE is specified in When received over wireline access network, the 5G-RG and the W-AGF acting on behalf of the FN-CRG (or on behalf of the N5GC device) shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\), shall delete 5G-G UTI, last visited registered TAI, TAI list and ngKSI, shall reset the registration attempt counter, shall enter the state 5GMM-DEREGISTERED and shall act as specified in subclause NOTE 8: The 5GMM sublayer states, the 5GMM parameters and the registration status are managed per access type independently, i.
3GPP access or non-3GPP access (see subclauses and\).
Other values are considered as abnormal cases.
The behaviour of the UE in those cases is specified in subclause Mobility and periodic registration update for initiating an emergency PDU session not accepted by the network If the mobility and periodic registration update request for initiating an emergency PDU session cannot be accepted by the network, the UE shall perform the procedures as described in subclause Then if the UE is in the same selected PLMN where the last mobility and periodic registration update request was attempted, the UE shall: a) inform the upper layers of the failure of the procedure; or NOTE 1: This can result in the upper layers requesting implementation specific mechanisms, e.
procedures specified in 3GPP specification document can result in the emergency call being attempted to another IP-CAN.
b) perform de-registration locally, if not de-registered already, and attempt initial registration for emergency If the mobility and periodic registration update request for initiating an emergency PDU session fails due to abnormal case b) in subclause , the UE shall perform the actio ns as described in subclause and inform the upper layers of the failure to access the network.
NOTE 2: This can result in the upper layers requesting implementation specific mechanisms, e.
procedures specified in 3GPP specification document can result in the emergency call being attempted to another IP-CAN.
If the mobility and periodic registration update request for initiating an emergency PDU session fails due to abnormal cases c) or d) in subclause , the UE shall perform the procedures as described in subclause Then if the UE is in the same selected PLMN where the last mobi lity and periodic registration update request was attempted, a) inform the upper layers of the failure of the procedure; or NOTE 3: This can result in the upper layers requesting implementation specific mechanisms, e.
procedures specified in 3GPP specification document can result in the emergency call being attempted to another IP-CAN.
b) perform de-registration locally, if not de-registered already, and attempt initial registration for emergency services.
The following abnormal cases can be identified: a) Timer T3346 is running.
The UE shall not start the registration procedure for mobility and periodic registration update unless: 1) the UE is in 5GMM-CONNECTED mode; CONNECTED mode over non-3GPP access and in 5GMM-IDLE mode over 3GPP access; 5) the UE has an emergency PDU session established or is establishing an emergency PDU session; 8) the UE in NB-N1 mode is requested by the upper layer to transmit user data related to an exceptional event the UE is allowed to use exception data reporting (see the ExceptionDataReportingAllowed leaf of the NAS configuration MO in 3GPP specification document or the USIM file EF NASCONFIG in 3GPP specification document\); timer T3346 was not started when N1 NAS signalling connection was established with RRC establishment cause set to "mo-ExceptionData".
periodic registration update while timer T3346 is running independent on whether timer T 3346 was If the registration procedure for mobility and periodic registration update was initiated for an MO MMTEL voice call (i.
access category 4), for an MO IMS registration related signalling (i.
access category 9), or for NAS signalling connection recovery during an ongoing MO MMTEL voice call (i.
access category 4) or during an was not initiated due to network congestion shall be provided to upper layers.
b) The lower layers indicate that the access attempt is barred.
The UE shall not start the registration procedure for mobility and periodic registration update.
The UE stays in the current serving cell and applies the normal cell rese lection process.
Receipt of the access barred indication The registration procedure for mobility and periodic registration update is started, if still needed, when the lower layers indicate that the barring is alleviated for the access category with which the access attempt was associated.
ba) The lower layers indicate that access barring is applicable for all access categories except categories 0 and 2 and the access category with which the access attempt was associated is other than 0 and If the REGISTRATION REQUEST message has not been sent , the UE shall proceed as specified for case b.
If additionally, the registration procedure for mobility and periodic registration update is started, if still needed, when the lower layers indicate that the barring is alleviated for the access category with which the access attempt was associated.
For additional UE requirements for both cases see subclause c) T3510 timeout.
If the UE has initiated the registration procedure in order to enable performing the service request procedure for emergency services fallback, the UE shall inform the upper layers of the failure of the emergency services d) REGISTRATION REJECT message, other 5GMM cause values than those treated in subclause , and cases of 5GMM cause values #11, #22, #31, #72, #73, #74, #75, #76 and #77, if considered as abnormal cases according to subclause Upon reception of the 5GMM causes #95, #96, #97, #99 and #111 the UE should set the registration attempt The UE shall proceed as described below.
e) Lower layer failure, release of the NAS signalling connection received from lower layers or the lower layers ACCEPT or REGISTRATION REJECT message is received.
The UE shall abort the registration procedure and proceed as described below.
registration update is completed, the registration procedure for mobility and periodic registration update shall be aborted and re-initiated immediately.
The UE shall set the 5GS update status to 5U2 NOT UPDATED.
g) Registration procedure for mobility and periodic registration update and de-registration procedure collision.
before the registration procedure for mobility and periodic registration update has been completed, the registration procedure for mobility and periodic registration update shall be aborted and the de-registration procedure shall be progressed.
before the registration procedure for mobility and periodic registration update has been completed, the registration procedure for mobility and periodic registration update shall be progressed and the de-registration procedure shall be aborted.
NOTE 2: The registration procedure for mobility and periodic registration update shall be aborted only if the DEREGISTRATION REQUEST message indicates in the access type that the access in which the registration procedure for mobility and periodic registration update was attempted shall be de-registered.
Otherwise both the procedures shall be progressed.
i) Transmission failure of REGISTRATION REQUEST message indication from the lower layers or the lower The registration procedure for mobility and periodic registration update shall be aborted and re-initiated immediately.
The UE shall set the 5GS update status to 5U2 NOT UPDATED.
j) Transmission failure of REGISTRATION COMPLETE message indication with TAI change from lower layers.
If the current TAI is not in the TAI list, the registration procedure for mobility and periodic registration update shall be aborted and re-initiated immediately.
The UE shall set the 5GS update status to 5U2 NOT UPDATED.
If the current TAI is still part of the TAI list, it is up to the UE implementation how to re-run the ongoing k) Transmission failure of REGISTRATION COMPLETE message indication without TAI change from lower It is up to the UE implementation how to re-run the ongoing procedure.
The registration procedure for mobility and periodic registration update shall be aborted, and the UE initiated de-registration procedure shall be performed.
De-registration not due to removal of USIM or entry update in the "list of subscriber data" and not due to switch the UE initiated de-registration procedure shall be initiated after successful completion of the registration procedure for mobility and periodic registration update.
m) Timer T3447 is running The UE shall not start any mobility and periodic registration update procedure with Uplink data status IE or Follow-on request indicator set to "Follow-on request pending" unless: The UE stays in the current serving cell and applies the normal cell reselection process.
The mobility and periodic registration update procedure is started, if still necessary, when timer T3447 expires.
n) Timer T3448 is running The UE in 5GMM-IDLE mode shall not start any mobility and periodic registration update procedure with Follow-on request indicator set to "Follow-on request pending" unless: 3) the UE in NB-N1 mode is requested by the upper layer to transmit user data related to an exceptional event and the UE is allowed to use exception data reporti ng (see the ExceptionDataReportingAllowed leaf of the NAS configuration MO in 3GPP specification document or the USIM file EF NASCONFIG in 3GPP specification document\).
The UE stays in the current serving cell and applies the normal cell reselection process.
The mobility and periodic registration update procedure is started, if still necessary, when timer T3448 expires.
Timer T3510 shall be stopped if still running.
The registration attempt counter shall be incremented, unless it was already set to If the registration attempt counter is less than 5: if the TAI of the current serving cell is not included in the TAI list or the 5GS update status is different to the UE shall start timer T3511, shall set the 5GS update status to 5U2 NOT UPDATED and change to state 5GMM-REGISTERED.
When timer T3511 expires, the registration update procedure is triggered again.
if the TAI of the current serving cell is included in the TAI list, the 5GS update status is equal to 5U1 mode to N1 mode, the UE shall keep the 5GS update status to 5U1 UPDATED and enter state 5GMM-REGISTERED.
The UE shall start timer T351 If in addition the REGISTRATION REQUEST message did not include the MICO indication IE or the Extended DRX IE, and: the REGISTRATION REQUEST message indicated "periodic registration updating"; - the registration procedure was initiated by the UE in 5GMM-CONNECTED mode with RRC inactive registered PLMN and not belonging to the registered PLMN, and none of the other reasons for initiating the regi stration updating procedure listed in subclause was applicable, the timer T3511 may be stopped when the UE enters 5GMM-CONNECTED mode.
if the TAI of the current serving cell is included in the TAI list, the 5GS update status is equal to 5U1 UPDATED and the UE is performing the registration procedure after an inter-system change from S1 mode to N1 mode, the UE shall change the 5GS update status to 5U2 NOT UPDATED and enter state 5GMM-REGISTERED.
The UE shall start timer T351 If the procedure is performed via 3GPP access and the UE is operating in single-registration mode, the UE than 5 and the EPS update status is different from EU1 UPDATED.
If the registration attempt counter is equal to 5 the UE shall start timer T3502, shall set the 5GS update status to 5U2 NOT UPDATED.
the UE shall delete the list of equivalent PLMNs (if any) and shall change to state 5GMM- REGISTERED.
ATTEMPTING-REGISTRATION-UPDATE or optionally to 5GMM- 3GPP specification document .
if the procedure is performed via 3GPP access and the UE is operating in single-registration mode: the UE shall in addition handle the EPS update status as specified in 3GPP specification document for the attempt counter is equal to 5; and if the UE does not change to state 5GMM-REGISTERED.
PLMN-SEARCH, the UE shall attempt to select E-UTRAN radio access technology.
The UE may disable the N1 mode capability as specified in Abnormal cases on the network side The following abnormal cases can be identified: UE and timer T3550 is running, the AMF shall abort the procedure, enter 5GMM-IDLE mode.
allocated by an AMF other than the current AMF, the current AMF does not need to retain the old 5G-GUTI.
3) if the UE needs to be paged: i) the AMF may first use the old 5G-S-TMSI from the old 5G-GUTI for paging within the area defined by REGISTRATION REJECT message with one of the following 5GMM cause values: #96 invalid mandatory information; #99 information element non-existent or not implemented; #100 conditional IE error; or #111 protocol error, unspecified.
On the first expiry of the timer, the AMF shall retransmit the REGISTRATION ACCEPT message and shall reset and restart timer T355 The retransmission is performed four times, i.
on the fifth expiry of timer T3550, the registration procedure for mobility and periodic update procedure is aborted.
TAI list was provided in the REGISTRATION ACCEPT message, both the old and new TAI lists shall also be considered valid until the old TAI list can be considered invalid by the AMF.
If the old 5G-GUTI was allocated by an AMF other than the current AMF, the current AMF does not need to retain the old 5G-GUTI.
During this period the AMF acts as described for case a) above.
d) REGISTRATION REQUEST with 5GS registration type IE set to "mobility registration updating" or "periodic registration updating" received after the REGISTRATION ACCEPT message has been sent and before the REGISTRATION COMPLETE message is received, if the REGISTRATION COMPLETE message is expected.
1) If one or more of the information elements in the REGISTRATION REQUEST message differ from the ones received within the previous REGISTRATION REQUEST message, the previously initiated registration procedure for mobility and periodic registration update shall be aborted if the REGISTRATION COMPLETE message has not been received and the new registration procedure for mobility and periodic registration update shall be progressed; or 2) if the information elements do not differ, then the REGISTRATION ACCEPT message shall be resent and timer T3550 shall be restarted.
In that case, the retransmission counter related to timer T3550 is not incremented.
e) More than one REGISTRATION REQUEST message with 5GS registration type IE set to "mobility registration updating" or "periodic registration updating" recei ved and neither REGISTRATION ACCEPT message nor REGISTRATION REJECT message has been sent.
1) If one or more of the information elements in the REGISTRATION REQUEST message differs from the ones received within the previous REGISTRATION REQUEST message, the previously initiated registration procedure for mobility and periodic registration update shall be aborted and the new registration procedure for mobility and periodic registration update shall be progressed; or 2) if the information elements do not differ, then the network shall continue with the previous registration procedure for mobility and periodic registration update and shall not treat any further this REGISTRATION REQUEST message.
g) DEREGISTRATION REQUEST message received before REGISTRATION COMPLETE message is received, if the REGISTRATION COMPLETE message is expected.
If the De-registration type IE is set to "switch off": The AMF shall abort the signalling for the registration procedure for mobility and periodic update towards the UE and shall progress the de-registration procedure as described in subclause NOTE 1: Internally in the AMF, before processing the de-registration request, the AMF can perform the necessary signalling procedures for the registration procedure for mobility and periodic update before progressing the de-registration procedure.
If the De-registration type IE is set to other type than "switch off": The AMF shall proceed with registration procedure for mobility and periodic update and shall progress the de-registration procedure after successful completion of the registration procedure for mobility and periodic h) If the REGISTRATION REQUEST message with 5GS registration type IE indicating "periodic registration updating" is received by the new AMF which does not have the 5GMM context data related to the subscription, the new AMF may send the REGISTRATION REJECT message with 5GMM cause #10 "implicitly de-registered".
i) Based on operator policy, if the mobility and periodic registration update request is rejected due to UE not for emergency services, the network shall reject the initial registration with a 5GMM cause value other than the 5GMM cause #76 (Not authorized for this CAG or authorized for CAG cells only).
NOTE 2: 5GMM cause #7 (5GS services not allowed), 5GMM cause #11 (PLMN not allowed), 5GMM cause #27 (N1 mode not allowed), 5GMM cause #73 (Serving network not authorized) can be used depending on the subscription of the UE and whether the UE roams or not.
The de-registration procedure is used: a) by the UE to de-register for 5GS services over 3GPP access when the UE is registered over 3GPP access; b) by the UE to de-register for 5GS services over non-3GPP access when the UE is registered over non-3GPP c) by the UE to de-register for 5GS services over 3GPP access, non-3GPP access or both when the UE is registered in the same PLMN over both accesses; d) by the network to inform the UE that it is deregistered for 5GS services over 3GPP access when the UE is registered over 3GPP access; e) by the network to inform the UE that it is deregistered for 5GS services over non-3GPP access when the UE is registered over non-3GPP access; f) by the network to inform the UE that it is deregistered for 5GS services over 3GPP access, non-3GPP access or both when the UE is registered in the same PLMN over both accesses; and g) by the network to inform the UE to re-register to the network.
b) as part of the eCall inactivity procedure defined in subclause ; and c) as part of USIM removal.
The de-registration procedure with appropriate de-registration type shall be invoked by the network: a) if the network informs whether the UE should re-register to the network.
The de-registration procedure with appropria te access type shall be invoked by the UE: a) if the UE needs to de-register for 5GS services over 3GPP access when the UE is registered over 3GPP access; b) if the UE needs to de-register for 5GS services over non-3GPP access when the UE is registered over non-3GPP c) the UE needs to de-register for 5GS services over 3GPP access, non-3GPP access or both when the UE is registered in the same PLMN over both accesses.
The de-registration procedure with appropriate access type shall be invoked by the network: a) if the network needs to inform the UE that it is dere gistered over 3GPP access when the UE is registered over b) if the network needs to inform the UE that it is deregistered over non-3GPP access when the UE is registered over non-3GPP access; or c) if the network needs to inform the UE that it is deregistered over 3GPP access, non-3GPP access or both when the UE is registered in the same PLMN over both accesses.
If the de-registration procedure is triggered due to USIM removal, the UE shall indicate "switch off" in the de- emergency PDU sessions as specified in 3GPP specification document .
particular UE is performed.
The UE is allowed to initiate the de-registration procedure even if the timer T3346 is running.
NOTE: When the UE has no PDU sessions over non-3GPP access, or the UE moves all the PDU sessions over a non-3GPP access to a 3GPP access, the UE and the AMF need not initiate de-registration over the non- When the AMF enters the state 5GMM-DEREGISTERED for 3GPP access, the AMF shall delete the stored UE radio capability information or the UE radio capability ID, if any.
UE-initiated de-registration procedure initiation example in figure\).
The De-registration type IE in cluded in the message indicates whether the de-registration procedure is due to a "switch off" or not.
The access type in cluded in the message indicates whether the de-registration a) for 5GS services over 3GPP access when the UE is registered over 3GPP access; DEREGISTRATION REQUEST message with the SUCI, start timer T3519 and store the value of the SUCI sent in the DEREGISTRATION REQUEST message; and If the de-registration request is not due to switch off and the UE is in the state 5GMM-REGISTERED or 5GMM- REGISTERED-INITIATED, timer T3521 shall be started in the UE after the DEREGISTRATION REQUEST message has been sent.
The UE shall enter the state 5GMM-DEREGISTERED-INITIATED.
During this period, the UE may be switched off as soon as the DEREGISTRATION REQUEST message has been sent.
or UE at switch off: DEREGISTRATION REQUESTStart T3521 UE-initiated de-registration procedure completion The UE, when receiving the DEREGISTRATION ACCEPT message, shall stop timer T3521, stop timer T3519 if running, and delete any stored SUCI.
UE-initiated de-registration procedure completion for 5GS services over 3GPP If the access type in the DEREGISTRATION REQUEST message indicates that the de-registration procedure is for a) if the de-registration procedure was performed due to disabling of 5GS services, then the UE shall enter the 5GMM-NULL state for 3GPP access; b) otherwise, the UE shall enter the 5GMM-DEREGISTERED state for 3GPP access.
NOTE: Case b) is applicable when the UE is also registered over non-3GPP access.
If the access type indicates that the de-registration procedure is for 3GPP access or for 3GPP access and non-3GPP access, and the UE is operating in single-registration mode, it shall additionally proceed as specified in 3GPP specification document , subclause , for the case when the UE receives an EMM message DETACH ACCEPT.
Furthermore, if the UE supports A/Gb or Iu mode, it shall disable the N1 mode capability for 3GPP access.
UE-initiated de-registration procedure completion for 5GS services non-3GPP If the access type in the DEREGISTRATION REQUEST indicates that the de-registration procedure is for non-3GPP the same PLMN or in different PLMNs, the AMF shall trigger SMF to perform release of user plane resources on non- If the de-registration request is not due to switch off, the UE shall: a) if the de-registration procedure was performed due to disabling of 5GS services, enter the 5GMM-NULL state b) otherwise, enter the 5GMM-DEREGISTERED state for non-3GPP access.
NOTE: Case b) is applicable when the UE is also registered over 3GPP access.
UE-initiated de-registration procedure completion for 5GS services over both 3GPP access and non-3GPP access If the access type in the DEREGISTRATION REQUEST indicates that the de-registration procedure is for both 3GPP access and non-3GPP access when the UE is registered in the same PLMN over both accesses, the descriptions for UE- initiated de-registration procedure completion for 5GS services over 3GPP access and over non-3GPP access, as specified in subclauses and , shall be followed.
Abnormal cases in the UE The following abnormal cases can be identified: a) Lower layer failure or release of the N1 NAS si gnalling connection before reception of DEREGISTRATION The de-registration procedure shall be aborted and the UE proceeds as follows: 1) if the de-registration procedure was performed due to disabling of 5GS services, the UE shall enter the 2) if the de-registration type "normal de-registration" was requested for reasons other than disabling of 5GS services, the UE shall enter the 5GMM-DEREGISTERED state.
is alleviated for the access category with which the access attempt was associated.
ba) The lower layers indicate that access barring is applicable for all access categories except categories 0 and 2 and the access category with which the access attempt was associated is other than 0 and If the DEREGISTRATION REQUEST message has not been sent, the UE shall proceed as specified for case b.
If the DEREGISTRATION REQUEST message has been sent , the UE shall proceed as specified for case a.
On the first four expiries of the timer, the UE shall retransmit the DEREGISTRATION REQUEST message and shall reset and restart timer T352 On the fifth expiry of timer T3521, the de-registration procedure shall be aborted and the UE proceeds as follows: 1) if the de-registration procedure was performed due to disabling of 5GS services, the UE shall enter the 2) if the de-registration type "normal de-registration" was requested for reasons other than disabling of 5GS services, the UE shall enter the 5GMM-DEREGISTERED state.
d) De-registration procedure collision.
De-registration containing de-registration type "switch off": procedure has been completed, this message shall be ignored and the UE-initiated de-registration procedure.
procedure has been completed, it shall treat the messa ge as specified in subclause with the following modification: - If the DEREGISTRATION REQUEST message received by the UE contains de-registration type "re- registration required", and the UE-initiated de-registration procedure is with de-registration type "normal de-registration", the UE need not initiate the registration procedure for initial registration.
e) De-registration and 5GMM co mmon procedure collision.
De-registration containing de-registration type "switch off": been completed, this message shall be ignored and the de-registration procedure shall continue.
registration procedure is completed, the de-registration procedure shall be aborted and re-initiated after was initiated due to removal of the USIM or the UE is to be switched off, the UE shall abort the de-registration procedure and enter the state 5GMM-DEREGISTERED.
If the current TAI is still part of the TAI list, the UE shall restart the de-registration procedure.
h) Transmission failure of DEREGISTRATION REQUEST message indication without TAI change from lower The UE shall restart the de-registration procedure.
i) The lower layers indicate that the RRC connection has been suspended.
De-registration containing de-registration type "switch off":.
The UE shall wait for an implementation-dependent time and shall restart the de-registration procedure, if still needed, upon expiration of the implementation-dependent time.
Timer T3521 shall be stopped if still running.
Abnormal cases in the network side The following abnormal cases can be identified: which the UE has no valid subscription identity for which the UE has no valid subscription, and the de-registration procedure is not due to "switch off", message including the 5GMM cause #74 "Temporarily not authorized for this SNPN".
the UE has no valid subscription message including the 5GMM cause #75 "Permanently not authorized for this SNPN".
in the UE's "allowed CAG list" for the current PLMN cell is included in the UE's "allowed CAG list" for the current PLMN and the de-registration procedure is not due to "switch off", the AMF shall initiate the de-registration procedure.
The AMF shall send a DEREGISTRATION REQUEST message including the 5GMM cause #76 "Not authorized for this CAG or authorized for CAG cells only".
associated with the current PLMN, where the entry contains an "indication that the UE is only allowed to access 5GS via CAG cells" includes an entry associated with the current PLMN, where the entry contains an "indication that the UE is only allowed to access 5GS via CAG cells" and the de-registrat ion procedure is not due to "switch off", the AMF Network-initiated de-registration procedure Network-initiated de-registration procedure initiation (see example in figure\).
SERVICE REJECT message or REGISTRATION REJECT message) with 5GMM cause #10 "implicitly de-registered" only when the UE initiates a 5GMM procedure.
The network shall also indicate via the access type whether the de-registration procedure is: a) for 3GPP access only; b) for non-3GPP access only; or c) for 3GPP access, non-3GPP access or both when the UE is registered in the same PLMN for both accesses.
If the network de-registration is triggered due to network slice-specific authentication and authorization failure or revocation as specified in subclause , then the network shall set the 5GMM cause value to #62 "No network slices available" in the DEREGISTRATION REQUEST message.
In addition, the AMF may include the rejected NSSAI IE in the DEREGISTRATION REQUEST message.
The AMF shall trigger the SMF to release locally the PDU se ssion(s) over the indicated access(es), if any, for the UE and enter state 5GMM-DEREGISTERED-INITIATED.
Network-initiated de-registration procedure completion by the UE Upon receiving the DEREGISTRATION REQUEST message, if the DEREGISTRATION REQUEST message DEREGISTERED for 3GPP access.
Furthermore, the UE shall, after the completion of the de-registration procedure, and the release of the existing NAS signalling connection, initiate an initial registration.
The UE should also re-establish any previously established PDU sessions over 3GPP access.
Upon receiving the DEREGISTRATION REQUEST message, if the DEREGISTRATION REQUEST message release of the PDU sessions over non-3GPP access, if any.
The UE shall stop the timer(s) T3346, T3396, T3584 and NOTE 1: When the de-registration type indicates "re-registration required", user interaction is necessary in some cases when the UE cannot re-establish the PDU session (s), if any, automatically.
Upon receiving the DEREGISTRATION REQUEST message, if the DEREGISTRATION REQUEST message indicates "re-registration not required" and the de-registration request is for non-3GPP access, the UE shall perform a Upon receiving the DEREGISTRATION REQUEST message, if the DEREGISTRATION REQUEST message message to the network and enter the state 5GMM-DEREGISTERED for both 3GPP access and non-3GPP access.
Upon receiving the DEREGISTRATION REQUEST message, if the DEREGISTRATION REQUEST message includes the rejected NSSAI IE, the UE takes the following actions based on the rejection cause in the rejected S-NSSAI(s): "S-NSSAI not available in the current PLMN or SNPN" The UE shall store the rejected S-NSSAI(s) in the rejected NSSAI for the current PLMN or SNPN as specified in subclause and shall not attempt to use this S-NSSAI in the current PLMN or SNPN until switching off the UE, the UICC containing the USIM is removed, or the rejected S-NSSAI(s) are removed as described in subclause "S-NSSAI not available in the current registration area" The UE shall store the rejected S-NSSAI(s) in the rej ected NSSAI for the current registration area as described in subclause and shall not attempt to use this S-NSSAI(s) in the current registration area until switching off the UE, the UE moving out of the current registration area, the UICC containing the USIM is removed, an entry of the "list of subscriber data" with the SNPN identity of the current SNPN is updated, or the rejected S-NSSAI(s) are removed as described in subclause "S-NSSAI is not available due to the failed or revoked network slice-specific authentication and authorization" The UE shall store the rejected S-NSSAI(s) in the rej ected NSSAI for the failed or revoked NSSAA as specified in subclause and shall not attempt to use this S-NSSAI in the current PLMN over any access until switching off the UE, the UICC containing the USIM is removed, the entry of the "list of subscriber data" with the SNPN identity of the current SNPN is updated, or the rejected S-NSSAI(s) are removed or deleted as described in subclause and If the de-registration type indicates "re-registration required", then the UE shall ignore the 5GMM cause IE if received.
If the de-registration type indicates "re-registration not required", the UE shall take the actions depending on the received 5GMM cause value: #3 (Illegal UE); NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
In case of PLMN, the UE shall consider the USIM as invalid for 5GS services until switching off or the UICC containing the USIM is removed; In case of SNPN, the UE shall consider the entry of the "list of subscriber data" with the SNPN identity of the current SNPN as invalid until the UE is switched off or the entry is updated.
Additionally, if EAP based primary authentication and key agreement procedure using EAP-AKA' or 5G AKA based primary authentication and key agreement procedure was performed in the current SNPN, the UE shall consider the USIM as invalid for the current SNPN until switching off or the UICC containing the USIM is removed.
The UE shall delete the list of equivalent PLMNs (if any) and shall enter the state 5GMM- The UE shall delete the 5GMM parameters stored in non-volatile memory of the ME as specified in annex C.
If the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS REQUEST is received with the EMM cause with the same value and with detach type set to "re-attach not required".
The USIM shall be considered as invalid also for non-EPS services until switching off or the UICC containing the USIM is removed.
If the UE also supports the registration procedure ov er the other access, the UE shall in addition handle 5GMM parameters and 5GMM state for this access, as described for this 5GMM cause value.
#7 (5GS services not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
In case of PLMN, the UE shall consider the USIM as invalid for 5GS services until switching off or the UICC containing the USIM is removed; In case of SNPN, the UE shall consider the entry of the "list of subscriber data" with the SNPN identity of the current SNPN as invalid for 5GS services until the UE is switched off or the entry is updated.
Additionally, if EAP based primary authentication and key agreement procedure using EAP-AKA' or 5G AKA based primary authentication and key agreement procedure was performed in the current SNPN, the UE shall consider the USIM as invalid for the current SNPN until switching off or the UICC containing the USIM is removed.
The UE shall enter the state 5GMM-DEREGISTERED.
The UE shall delete the 5GMM parameters stored in non-volatile memory of the ME as specified in annex C.
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list and If the UE also supports the registration procedure over the other access, the UE shall in addition handle 5GMM parameters and 5GMM state for this access, as described for this 5GMM cause value.
#11 (PLMN not allowed).
of the UE is specified in subclause The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
The UE shall delete the list of equivalent PLMNs, shall reset the registration attempt counter and enter the state 5GMM-DEREGISTERED.
The UE shall store the PLMN identity in the forbidden PLMN list as specified in subclause 3A.
handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI If the UE also supports the registration procedure over the other access to the same PLMN, the UE shall in addition handle 5GMM parameters and 5GMM state for th is access, as described for this 5GMM cause value.
#12 (Tracking area not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
The UE shall reset the registration attempt counter and shall enter the state 5GMM-DEREGISTERED.
If the UE is not operating in SNPN access mode, the UE shall store the current TAI in the list of "5GS forbidden tracking areas for regional provision of service".
Otherwise, the UE shall store the current TAI in the list of "5GS forbidden tracking areas for regional provision of service" for the current SNPN.
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters, EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list, is received with the EMM cause with the same value and with detach type set to "re-attach not required".
#13 (Roaming not allowed in this tracking area).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
The UE shall delete the list of equivalent PLMNs (if available), reset the registration attempt counter and shall change to state 5GMM-DEREGISTERED.
If the UE is not operating in SNPN access mode, the UE shall store the current TAI in the list of "5GS forbidden areas for roaming" for the current SNPN.
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall #15 (No suitable cells in tracking area).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
The UE shall reset the registration attempt counter and shall enter the state 5GMM-DEREGISTERED.
If the UE is not operating in SNPN access mode, the UE shall store the current TAI in the list of "5GS forbidden tracking areas for roaming".
Otherwise the UE shall store the current TAI in the list of "5GS forbidden tracking areas for roaming" for the current SNPN.
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall.
If the T3346 value IE is present in the DEREGISTRATION REQUEST message and the value indicates that this an abnormal case and the behaviour of the UE for this case is specified in subclause The UE shall start timer T3346 with the value provided in the T3346 value IE.
If the message was received via 3GPP access and the UE is operating in the single-registration mode, the UE shall set the EPS update status to EU2 NOT UPDATED, reset the attach attempt counter and shall enter the state #27 (N1 mode not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
Additionally, the UE shall reset the registration attempt counter and shall enter the state 5GMM-DEREGISTERED.
The UE shall disable the N1 mode capability for both 3GPP access and non-3GPP access (see subclause\).
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall in addition set the EPS update status to EU3 ROAMING NOT ALLOWED and shall delete any 4G-GUTI, last visited registered TAI, TAI list and eKSI.
Additionally, the UE shall reset the attach attempt counter and enter #62 (No network slices available).
The UE shall set the 5GS update status to 5U2 NOT UPDATED and enter state 5GMM- DEREGISTERED.
Additionally, the UE shall reset the registration attempt counter.
rejected for the current PLMN or SNPN or rejected for the current registration area, the UE may stay in the current serving cell, may apply the normal cell reselection process, and may start an initial registration procedure #72 (Non-3GPP access to 5GCN not allowed).
If received over non-3GPP access when the UE is re gistered over non-3GPP access, or received over 3GPP access and de-registration request is for non-3GPP access when the UE is registered in the same PLMN for both accesses, the UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete 5G-GUTI, last visited registered TAI, TAI list and ngKSI for non-3GPP access.
Additionally, the UE shall reset the registration attempt counter and enter the state 5GMM-DEREGISTERED for non-3GPP access.
NOTE 3: The 5GMM sublayer states, the 5GMM parameters and the registration status are managed per access type independently, i.
3GPP access or non-3GPP access (see subclauses and\).
The UE shall disable the N1 mode capability for non-3GPP access (see subclause\).
As an implementation option, if the UE is not currently registered over 3GPP access, the UE may enter the state 3GPP specification document .
If received over 3GPP access and de-registration request is for 3GPP access only, the cause shall be considered as an abnormal case and the behaviour of the UE for this case is specified in subclause of the UE is specified in subclause specified in subclause reset the registration attempt counter and shall store the SNPN identity in the "temporarily forbidden SNPNs" list.
for the specific access type for which the message was received.
The UE shall enter state 5GMM-DEREGISTERED.
PLMN-SEARCH and perform an SNPN selection according to 3GPP specification document #75 (Permanently not authorized for this SNPN).
of the UE is specified in subclause The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
The UE shall reset the registration attempt counter and store the SNPN identity in the "permanently forbidden SNPNs" list.
for the specific access type for which the message was received The UE shall enter state 5GMM-DEREGISTERED.
PLMN-SEARCH and perform an SNPN selection according to 3GPP specification document .
#76 (Not authorized for this CAG or authorized for CAG cells only).
of the UE is specified in subclause The UE shall set the 5GS update status to 5UROAMING NOT ALLOWED, store the 5GS update status according to clause , and reset the registration attempt counter.
If 5GMM cause #76 is received from: 1) a CAG cell, then the UE shall delete the CAG-ID(s) of the cell from the "allowed CAG list" for the current PLMN.
In addition: i) if the entry in the "CAG information list" for the current PLMN does not include an "indication that the UE is only allowed to access 5GS via CAG cells" or if the entry in the "CAG information list" for the current PLMN includes an "indication that the UE is only allowed to access 5GS via CAG cells" and the updated "allowed CAG list" for the current PLMN includes one or more CAG-IDs, then the UE shall ii) if the entry in the "CAG information list" for the current PLMN includes an "indication that the UE is only allowed to access 5GS via CAG cells" and the updated "allowed CAG list" for the current PLMN does not include any CAG-ID, then the UE shall enter the state 5GMM-DEREGISTERED.
PLMN- SEARCH and shall apply the PLMN selection proce ss defined in 3GPP specification document with the updated 2) a non-CAG cell, then the UE shall store an "indication that the UE is only allowed to access 5GS via CAG cells" in the entry of the "CAG information list" for the current PLMN.
In addition: i) if the "allowed CAG list" for the current PLMN includes one or more CAG-IDs, then the UE shall enter 3GPP specification document with the updated CAG information; or ii) if the "allowed CAG list" for the current PLMN does not includes any CAG-ID, then the UE shall enter the state 5GMM-DEREGISTERED.
PLMN-SEARCH and shall apply the PLMN selection process defined in 3GPP specification document with the updated "CAG information list".
#77 (Wireline access area not allowed).
acting on behalf of the FN-CRG (or on behalf of the N5GC device).
5GMM cause #77 received from a 5G behalf of the N5GC device) shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\), shall delete 5G-G UTI, last visited registered TAI, TAI list and ngKSI, shall reset the registration attempt counter, shall enter the state 5GMM-DEREGISTERED and shall act as specified in subclause NOTE 2: The 5GMM sublayer states, the 5GMM parameters and the registration status are managed per access type independently, i.
3GPP access or non-3GPP access (see subclauses and\).
Network-initiated de-registration procedure completion by the network The network shall stop timer T3522 upon receipt of the DEREGISTRATION ACCEPT message.
The network shall enter state 5GMM-DEREGISTERED for 3GPP access if the de-registration request is for 3GPP access.
The network shall enter state 5GMM-DEREGISTERED for non-3GPP access if the de-registration request is for non-3GPP access.
The network shall enter state 5GMM-DEREGISTERED for both 3GPP access and non-3GPP access if the de-registration request is for both 3GPP access and non-3GPP access.
Abnormal cases in the UE The following abnormal cases can be identified: a) Transmission failure of DEREGISTRATION ACCEPT message indication from lower layers.
The de-registration procedure shall be progressed and the UE shall send the DEREGISTRATION ACCEPT b) DEREGISTRATION REQUEST, other 5GMM cause values than those treated in subclause , cases of 5GMM cause value#11, #22, #72, #74, #75, #76 and#77 that are considered as abnormal cases according to subclause or no 5GMM cause IE is included, and the De-registration type IE indicates "re-registration not required".
The UE shall delete 5G-GUTI, TAI list, last visited registered TAI, list of equivalent PLMNs (if any), ngKSI, shall set the 5GS update status to 5U2 NOT UPDATED and shall start timer T350 A UE not supporting S1 mode may enter the state 5GMM-DEREGISTERED.
PLMN-SEARCH in order to If the message was received via 3GPP access and the UE is operating in the single-registration mode, the UE enter the state 5GMM-DEREGISTERED and attempt to select E-UTRAN radio access technology and proceed with the appropriate EMM specific procedures .
In this case, the UE may disable the N1 mode capability (see subclause\); or to 3GPP specification document .
If the message was received via 3GPP access and the UE is operating in the single-registration mode, the UE shall set the EPS update status to EU2 NOT UPDATED, enter the state EMM-DEREGISTERED and shall delete the EMM parameters 4G-GUTI, last visited registered TAI, TAI list and eKSI.
Abnormal cases in the network side The following abnormal cases can be identified: On the first expiry of the timer, the network shall retransmit the DEREGISTRATION REQUEST message and shall start timer T352 This retransmission is repeated four times, i.
on the fifth expiry of timer T3522, the de-b) Lower layer failure c) De-registration procedure collision network-initiated de-registration procedure has been completed, both procedures shall be considered completed.
ACCEPT message to the UE.
d) De-registration and registration procedure for initial registration collision "emergency registration" in the 5GS registration type IE before the network-initiated de-registration procedure has been completed, the network shall aborted the de-reg istration procedure and the registration procedure shall be progressed after the PDU sessions associated with the access type the REGISTRATION REQUEST message is sent over have been deleted.
NOTE 1: The above collision case is valid if the DEREGISTRATION REQUEST message indicates the access type over which the initial registration procedure is attempted otherwise both the procedures are progressed.
e) De-registration and registration procedure for mobility and periodic registration update collision updating" or "periodic registration updating" in the 5GS registration type IE before the network-initiated de-registration procedure has been completed, the de-reg istration procedure shall be progressed, i.
the REGISTRATION REQUEST message shall be ignored.
updating" or "periodic registration updating" in the 5GS registration type IE before the network-initiated de- registration procedure has been completed, the de-registration procedure shall be aborted and the registration procedure shall be progressed.
NOTE 2: The above collision case is valid if the DEREGISTRATION REQUEST message indicates the access type over which the mobility and periodic registration procedure is attempted otherwise both the procedures are progressed.
f) De-registration and service request procedure collision message before the network-initiated de-registration procedure has been completed (e.
the DEREGISTRATION REQUEST message is pending to be sent to the UE), the network shall progress the de-registration procedure.
NOTE 3: The above collision case is valid if the DEREGISTRATION REQUEST message indicates the access mode as specified in 3GPP specification document .
The procedure shall be started when: a) the UE is in any 5GMM-REGISTERED substate except substates 5GMM-REGISTERED.
NO-CELL-AVAILABLE; 1) timer T3444 expires or is found to have already expired and timer T3445 is not running; 2) timer T3445 expires or is found to have already expired and timer T3444 is not running; or 3) timers T3444 and T3445 expire or are found to have already expired.
The UE shall then perform the following actions: c) delete any 5G-GUTI, TAI list, last visited registered TAI, list of equivalent PLMNs, and ngKSI; and d) enter 5GMM-DEREGISTERED.
5GMM connection management procedures 
The purpose of the service request procedure is to change the 5GMM mode from 5GMM-IDLE to 5GMM- CONNECTED mode.
If the UE is not using 5GS services with control plane CIoT 5GS optimization, this procedure is used to request the establishment of user-plane resources for PDU sessions which are established without user-plane resources.
In latter case, the 5GMM mode can be the 5GMM-IDLE mode or the 5GMM-CONNECTED mode if the UE requires to establish user-plane resources for PDU sessions.
If the UE is using 5GS services with control plane CIoT 5GS optimization, this procedure can be used for UE initiated transfer of user data via the control plane from 5GMM-IDLE mode.
NOTE 1: The lower layer indicates when the user-plane resources for PDU sessions are successfully established or This procedure is used when: the network has downlink signalling pending over 3GPP access and the UE is in 5GMM-IDLE mode over 3GPP the network has downlink signalling pending over non-3GPP access, the UE is in 5GMM-IDLE mode over non- 3GPP access and in 5GMM-IDLE or 5GMM-CONNECTED mode over 3GPP access; the UE has uplink signalling pending over 3GPP access and the UE is in 5GMM-IDLE mode over 3GPP access; the network has downlink user data pending over 3GPP access and the UE is in 5GMM-IDLE mode over 3GPP the network has downlink user data pending over non-3GPP access, the UE is in 5GMM-IDLE mode over non- 3GPP access and in 5GMM-IDLE or 5GMM-CONNECTED mode over 3GPP access; the UE has user data pending over 3GPP access and the UE is in 5GMM-IDLE or 5GMM-CONNECTED mode the UE has user data pending over non-3GPP access and the UE is in 5GMM-CONNECTED mode over non- the UE in 5GMM-IDLE mode over non-3GPP access, receives an indication from the lower layers of non-3GPP access, that the access stratum connection is established between UE and network, if T3346 is not running; subclause of 3GPP specification document ; or the UE has to request resources for V2X communication over PC This procedure shall not be used for initiating user data transfer or PDU session management related signalling other located outside the LADN service area.
In NB-N1 mode, this procedure shall not be used to request the establishment of user-plane resources: if there is currently: 1) no user-plane resources established for the UE; 2) user-plane resources established for: i) one PDU session and the Multiple user-plane resources support bit was set to "Multiple user-plane resources not supported" in the 5GMM capability IE; or ii) two PDU sessions and the Multiple user-plane re sources support bit was set to "Multiple user-plane resources supported" in the 5GMM capability IE; or b) for additional PDU sessions, if the number of PDU sessions for which user-plane resources are currently established is equal to the UE's maximum number of supported user-plane resources.
The service request procedure is initiated by the UE, however, it can be triggered by the network by means of: the paging procedure (see subclause\) for the transfer of downlink signalling or user data pending over the paging procedure (see subclause\) for the transfer of downlink signalling or user data pending over non- the notification procedure (see subclause\) for the transfer of downlink signalling or user data pending over the notification procedure (see subclause\) for the transfer of downlink signalling or user data pending over NOTE 2: In case the UE is in 5GMM-IDLE mode over 3GPP access and in 5GMM-CONNECTED mode over non- 3GPP access and downlink signalling or user data pending over 3GPP access needs to be transferred, the AMF can trigger either the notification procedure or the paging procedure based on implementation.
The UE shall invoke the service request procedure when: type indicating non-3GPP access; c) the UE, in 5GMM-IDLE mode over 3GPP access, has uplink signalling pending (except in case i); d) the UE, in 5GMM-IDLE mode over 3GPP access, has uplink user data pending (except in case j); e) the UE, in 5GMM-CONNECTED mode or in 5GMM-CONNECTED mode with RRC inactive indication, has user data pending due to no user-plane resources established for PDU session(s) used for user data transport; connection is established between UE and network; indicating 3GPP access when the UE is in 5GMM-CONNECTED mode over non-3GPP access; h) the UE, in 5GMM-IDLE, 5GMM-CONNECTED mode over 3GPP access, or 5GMM-CONNECTED mode with i) the UE, in 5GMM-CONNECTED mode over 3GPP access or in 5GMM-CONNECTED mode with RRC j) the UE, in 5GMM-CONNECTED mode over 3GPP access or in 5GMM-CONNECTED mode with RRC control plane CIoT 5GS optimization and has pending user data to be sent via user-plane resources; or l) the UE in 5GMM-IDLE mode over 3GPP access has to request resources for V2X communication over PC5 (see 3GPP specification document [6C]).
If one of the above criteria to invoke the service request pr ocedure is fulfilled, then the service request procedure shall only be initiated by the UE when the following conditions are fulfilled: its 5GS update status is 5U1 UPDATED, and the TAI of the current serving cell is included in the TAI list; and no 5GMM specific procedure is ongoing.
The UE shall not invoke the service request procedure when the UE is in the state 5GMM-SERVICE-REQUEST- Service Request procedure (Part 1) CONTROL PLANE SERVICE REQUEST CONTROL PLANE SERVICE REQUEST release of RRC connectionStart T351.
CONTROL PLANE SERVICE REQUEST Service Request procedure (Part 2) The service request attempt counter shall be reset when: a registration procedure for mobility and periodic registration update is successfully completed; - a service request procedure is successfully completed; or - a service request procedure is rejected as specified in subclause or subclause Service request procedure initiation UE is not using 5GS services with control plane CIoT 5GS optimization.
If the UE is sending the SERVICE REQUEST message from 5GMM-IDLE mode and the UE needs to send non- cleartext IEs, the UE shall send the SERVICE REQUEST message including the NAS message container IE as described in subclause For cases a), b), and g) in subclause , the service type IE in the SERVICE REQUEST message shall be set to PLMN, the service type IE in the SERVICE REQUEST message shall be set to "high priority access".
For case a) in subclause : a) if the paging request includes an indication for non-3GPP access type, the Allowed PDU session status IE shall be included in the SERVICE REQUEST message.
If the UE has established the PDU session(s) associated with the S-NSSAI(s) which are included in the allowed NSSAI for 3GPP access, the UE shall indicate the PDU session(s) for which the UE allows the user-plane resources to be re-established over 3GPP access in the Allowed PDU session status IE.
Otherwise, the UE shall not indicate any PDU session(s) in the Allowed PDU session status IE; b) if the UE has uplink user data pending to be sent over 3GPP access, the Uplink data status IE shall be included in the SERVICE REQUEST message to indicate the PDU session(s) for which the UE has pending user data to be sent; or c) otherwise, the Uplink data status IE shall not be included in the SERVICE REQUEST message.
For case b) in subclause : a) the Allowed PDU session status IE shall be included in the SERVICE REQUEST message.
If the UE has the PDU session(s) associated with the S-NSSAI(s) which are included in the allowed NSSAI for 3GPP access, the UE shall indicate the PDU session(s) for which the UE allows the user-plane resources to be re-established over 3GPP access in the Allowed PDU session status IE.
Otherwise, the UE shall not indicate any PDU session(s) in the Allowed PDU session status IE; b) if the UE has uplink user data pending to be sent over 3GPP access, the Uplink data status IE shall be included in the SERVICE REQUEST message to indicate the PDU session(s) for which the UE has pending user data to be sent; c) otherwise, the Uplink data status IE shall not be included in the SERVICE REQUEST message.
For case c) in subclause , the Uplink data status IE shall not be included in the SERVICE REQUEST message except if the UE has one or more active always-on PDU sessions associated with the access type over which the shall set the service type IE in the SERVICE REQUEST message to "elevated signalling", and shall not include the Uplink data status IE in the SERVICE REQUEST message even if the UE has one or more active always-on PDU sessions associated with the access type over which the SERVICE REQUEST message is sent; or b) otherwise, the UE shall not initiate service request procedure except for emergency services, high priority access or responding to paging or notification.
high priority access in selected PLMN: a) if there exists an emergency PDU session which is indicat ed in the Uplink data status IE the service type IE in the SERVICE REQUEST message shall be set to "emergency services"; or b) otherwise, the service type IE in the SERVICE REQUEST message shall be set to "data".
exceeds the UE's maximum number of supported user-plane resources.
For case f) in subclause : a) if the UE has uplink user data pending to be sent, the Uplink data status IE shall be included in the SERVICE REQUEST message to indicate the PDU session(s) the UE has pending user data to be sent.
If the UE is not a UE configured for high priority access in selected PLMN, the service type IE in the SERVICE REQUEST message shall be set to "data"; SERVICE REQUEST message shall be set to "signalling".
For case g) in subclause , if the UE has uplink user data pending to be sent, the Uplink data status IE shall be included in the SERVICE REQUEST message to indicate the PDU session(s) the UE has pending user data to be sent.
services fallback" and without an Uplink data status IE.
For case i) in subclause , if the UE is not configur ed for high priority access in selected PLMN, the UE shall set the Service type IE in the SERVICE REQUEST message as follows: a) if the pending message is an UL NAS TRANSPORT message with the Request type IE set to "initial emergency request" or "existing emergency PDU session", the UE shall set the Service type IE in the SERVICE REQUEST message to "emergency services"; or b) otherwise, the UE shall set the Service type IE in the SERVICE REQUEST message to "signalling".
For case j) in subclause : a) the UE shall include the Uplink data status IE in the SERVICE REQUEST message indicating the PDU session(s) for which user-plane resources were active prior to receiving the fallback indication, if any; and in the SERVICE REQUEST message as follows: 1) if there is an emergency PDU session which is indicated in the Uplink data status IE, the UE shall set the Service type IE in the SERVICE REQUEST message to "emergency services"; or 2) if there is no emergency PDU session which is indicated in the Uplink data status IE, the UE shall set the Service type IE in the SERVICE REQUEST message to "data".
the SERVICE REQUEST message shall be set to "emergency services"; or b) otherwise, the service type IE in the SERVICE REQUEST message shall be set to "signalling".
If the UE has one or more active always-on PDU sessions associated with the access type over which the SERVICE REQUEST message is sent and the user-plane resources for these PDU sessions are not established, the UE shall include the Uplink data status IE in the SERVICE REQUEST message and indicate that the UE has pending user data to be sent for those PDU sessions.
If the UE has one or more active PDU sessions which are not accepted by the network as always-on PDU sessions and no uplink user data pending to be sent for those PDU sessions, the UE shall not include those PDU sessions in the Uplink data status IE in the SERVICE REQUEST message.
The Uplink data status IE may be included in the SERVICE REQUEST message to indicate which PDU session(s) associated with the access type the SERVICE REQUEST message is sent over have pending user data to be sent.
The PDU session status information element may be included in the SERVICE REQUEST message to indicate the PDU session(s) available in the UE associated with the access type the SERVICE REQUEST message is sent over.
REQUEST message that is obtained from the NAS message container IE as described in subclause If the UE has an emergency PDU session over the non-current access, it shall not initiate the SERVICE REQUEST message with the service type IE set to "emergency services" over the current access, unless the SERVICE REQUEST message has to be initiated to perform handover of an existing emergency PDU session from the non-current access to the current access.
NOTE 2: Transfer of an existing emergency PDU session between 3GPP access and non-3GPP access is needed e.
if the UE determines that the current access is no longer available.
UE is using 5GS services with control plane CIoT 5GS optimization message shall indicate "mobile terminating request".
If the UE only has uplink CIoT user data or SMS to be sent, the UE shall: a) if the data size is not more than 254 octets and there is no other optional IE to be included in the message: 1) for sending CIoT user data, set the Data type field to "control plane user data", include the PDU session ID, data, and Downlink data expected (DDX) (if available), in the CIoT small data container IE; and 2) for sending SMS, set the Data type field to "SMS", include SMS in the CIoT small data container IE; and b) otherwise if the data size is more than 254 octets or there are other optional IEs to be included in the message: 1) for sending CIoT user data, set the Payload container type IE to "CIoT user data container", include data in the Payload container IE as described in subclause ; and 2) for sending SMS, set the Payload container type IE to "SMS" and include data in the Payload container IE as NOTE 1: The term DDX used in the present document corresponds to the term NAS RAI used in 3GPP specification document .
the UE shall set the Control plane service type of the CONTROL PLANE SERVICE REQUEST message to "mobile originating request".
If the UE has only uplink CIoT user data, SMS or location services message to be sent, the UE shall: 1) CIoT user data, set the Data type field to "control plane user data", include the PDU session ID, data, and Downlink data expected (DDX) (if available), in the CIoT small data container IE; 2) location services message, set the Data type field to "Location services message container" and Downlink data expected (DDX), if available, in the CIoT small data container IE, and: i) if routing information is provided by upper layers: A) set the length of additional information field in the CIoT small data container IE to the length of routing information provided by upper layer location services application (see subclause 7), and set the additional information field in the CIoT small data container IE to the routing information provided by upper layer location services application (see subclause 7); or B) otherwise set the length of additional information field in the CIoT small data container IE to zero.
In this case the Additional information field of the CIoT small data container IE shall not be included; and ii) set the Data contents field of the CIoT small data container IE to the location services message payload; 3) SMS, set the Data type field to "SMS", include SMS in the CIoT small data container IE; or b) otherwise if the data size is more than 254 octets or there are other optional IEs to be included in the CONTROL PLANE SERVICE REQUEST message, and the data being sent is: 1) CIoT user data, set the Payload container type IE to "CIoT user data container", include data in the Payload container IE as described in subclause ; 2) location services message, set the Payload container type IE to "Location services message container", include data in the Payload container IE as described in subclause If the upper layer location services application provides the routing information set the Additional information IE to the routing information as described in subclause ; or 3) SMS, set the Payload container type IE to "SMS" and in clude data in the Payload container IE as described in Control plane service type of the CONTROL PLANE SERVICE REQUEST message to "mobile terminating request".
The UE shall include the Uplink data status IE in the CONTROL PLANE SERVICE REQUEST message to indicate which PDU session(s) have pending user data to be sent via user-plane resources.
set the Control plane service type of the CONTROL PLANE SERVICE REQUEST message to "mobile originating request".
The UE shall include the Uplink data status IE in the CONTROL PLANE SERVICE REQUEST message to indicate which PDU session(s) have pending user data to be sent via user-plane resources.
For case i) in subclause , the Control plane service type of the CONTROL PLANE SERVICE REQUEST message shall indicate "mobile originating request".
If the pending message is an UL NAS TRANSPORT message with the Payload container type IE set to: a) "SMS", "Location services message container", or "CIoT user data container", the UE shall send the CONTROL PLANE SERVICE REQUEST and include the SMS, location services message, or CIoT user data as described in this subclause; or b) otherwise, the UE shall send the CONTROL PLANE SERVICE REQUEST: 1) without including the the CIoT small data container IE and without including the NAS message container IE if the UE has no other optional IE to be sent; or message shall indicate "mobile originating request".
The UE shall include the Uplink data status IE in the CONTROL PLANE SERVICE REQUEST message indicating the PDU session(s) for which user-plane resources were active prior to receiving the fallback indication, if any.
The UE may include the PDU session status IE in the CONTROL PLANE SERVICE REQUEST message to indicate which PDU session(s) associated with the access type the CONTROL PLANE SERVICE REQUEST message is sent over are active in the UE.
Upon receipt of the SERVICE REQUEST or CONTROL PLANE SERVICE REQUEST message, the AMF may initiate the common procedures e.
the 5G AKA based primary authentication and key agreement procedure or the EAP based primary authentication and key agreement procedure.
Service request procedure accepted by the network UE is not using 5GS services with control plane CIoT 5GS optimization For cases other than h) in subclause , the UE sh all treat the reception of the SERVICE ACCEPT message as successful completion of the procedure.
The UE shall reset the service request attempt counter, stop timer T3517 and enter the state 5GMM-REGISTERED.
For case h) in subclause , a) the UE shall treat the indication from the lower layers when the UE has changed to S1 mode or E-UTRA connected to 5GCN (see 3GPP specification document\) as successful completion of the procedure and stop timer T3517; 3GPP access (see subclause\); and c) the AMF shall not check forCAG restrictions.
If the PDU session status information element is included in the SERVICE REQUEST message, then the AMF: access type the SERVICE REQUEST message is sent over, but are indicated by the UE as being inactive, and If the Uplink data status IE is included in the SERVICE REQUEST message and the UE is: PDU sessions that exceeds the UE's maximum number of supported user-plane resources; a) indicate the SMF to re-establish the user-plane resources for the corresponding PDU sessions; b) include the PDU session reactivation result IE in the SERVICE ACCEPT message to indicate the user-plane resources re-establishment result of the PDU sessions for which the UE requested to re-establish the user-plane resources; and If the Allowed PDU session status IE is included in the SERVICE REQUEST message, the AMF shall: a) for a 5GSM message from each SMF that has indicated pending downlink signalling only, forward the received 5GSM message via 3GPP access to the UE after the SERVICE ACCEPT message is sent; b) for each SMF that has indicated pending downlink data only: 1) notify the SMF that reactivation of the user-plane resources for the corresponding PDU session(s) associated with non-3GPP access cannot be performed if the corresponding PDU session ID(s) are not indicated in the Allowed PDU session status IE; and 2) notify the SMF that reactivation of the user-plane resources for the corresponding PDU session(s) associated with non-3GPP access can be performed if the corresponding PDU session ID(s) are indicated in the Allowed PDU session status IE.
c) for each SMF that have indicated pending downlink signalling and data: 1) notify the SMF that reactivation of the user-plane resources for the corresponding PDU session(s) associated with non-3GPP access cannot be performed if the corresponding PDU session ID(s) are not indicated in the Allowed PDU session status IE; 2) notify the SMF that reactivation of the user-plane resources for the corresponding PDU session(s) associated with non-3GPP access can be performed if the corresponding PDU session ID(s) are indicated in the Allowed PDU session status IE; and 3) discard the received 5GSM message for PDU session(s) associated with non-3GPP access; and d) include the PDU session reactivation result IE in the SERVICE ACCEPT message to indicate the successfully re-established user-plane resources for the corresponding PDU sessions, if any.
If due to regional subscription restric tions or access restrictions the UE is not allowed to access the TA or due to CAG If the PDU session reactivation result IE is included in the SERVICE ACCEPT message indicating that the user-plane result IE in the SERVICE ACCEPT message indicating that user-plane resources for the corresponding PDU session cannot be re-established, and: a) if the user-plane resources cannot be established becau se the SMF indicated to the AMF that the UE is located out of the LADN service area (see 3GPP specification document [20A]), the AMF shall include the PDU session reactivation result error cause IE with the 5GMM cause set to #43 "LADN not available"; b) if the user-plane resources cannot be established becau se the SMF indicated to the AMF that only prioritized services are allowed (see 3GPP specification document [20A]), the AMF shall include the PDU session reactivation result error cause IE with the 5GMM cause set to #28 "restricted service area"; c) if the user-plane resources cannot be established becau se the SMF indicated to the AMF that the resource is not available in the UPF (see 3GPP specification document [20A]), the AMF shall include the PDU session reactivation result error cause IE with the 5GMM cause set to #92 "insufficient user-plane resources for the PDU session"; or d) otherwise, the AMF may include the PDU session reactivation result error cause IE to indicate the cause of failure to re-establish the user-plane resources.
#92 "insufficient user-plane resources for the PDU session".
If the SERVICE REQUEST message is for emergency services fallback, the AMF triggers the emergency services fallback procedure as specified in subclause of 3GPP specification document .
If the UE having an emergency PDU session sent the SERVICE REQUEST message via: a) a CAG cell and none of the CAG-IDs of the CAG cell are included in the "Allowed CAG list" for the current PLMN in the UE's subscription; or to access 5GS via CAG cells"; the network shall accept the SERVICE REQUEST message and release all non-emergency PDU sessions locally.
The emergency PDU session shall not be released.
UE is using 5GS services with control plane CIoT 5GS optimization plane service type indicating "mobile terminating reques t", after completion of the 5GMM common procedures (if Control plane service type indicating "mobile originating request", after completion of the 5GMM common procedures the DDX field of the Release assistance indication IE or the DDX field of the CIoT small data container IE indicates "No further uplink and no further downlink data transmission subsequent to the uplink data transmission is expected".
a) if the CIoT small data container IE is included in the message, the AMF shall decipher the value part of the CIoT small data container IE and: 1) if the Data type field indicates "control plane user data", extract the PDU session ID and data content from and forward the content of the CIoT small data co ntainer IE to the SMF associated with the UE; 2) if the Data type field indicates "SMS", forward the content of the CIoT small data container IE to the SMSF associated with the UE; or 3) if the Data type field indicates "Location services message container", and if i) length of additional information field in the CIoT small data container IE is zero, forward the value of Data type field and the content of the CIoT small data container IE to the to the location services application; or ii) otherwise forward the value of Data type field and the content of the CIoT small data container IE to the LMF associated with the routing information that is included in the additional information field of the CIoT small data container IE; or b) otherwise, the AMF shall decipher the value part of NAS message container IE and: 1) if the Payload container IE is included in the CONTROL PLANE SERVICE REQUEST message and if the 2) if the Payload container IE is included in the CONTROL PLANE SERVICE REQUEST message and if the Payload container type IE is set to "SMS", the AMF sh all forward the content of the Payload container IE to the SMSF associated with the UE; 3) if the PDU session status IE is included in the CONTROL PLANE SERVICE REQUEST message or the i) not in NB-N1 mode; or number of PDU sessions that exceeds the UE's maximum number of supported user-plane resources; i) indicate the SMF to re-establish the user-plane resources for the corresponding PDU sessions; and ii) include the PDU session reactivation result IE in the SERVICE ACCEPT message to indicate the user- plane resources re-establishment result of the PDU sessions for which the UE requested to re-establish the 5) if the Uplink data status IE is included in the CONTROL PLANE SERVICE REQUEST, the UE is in NB-N1 6) otherwise, if the Payload container IE is included in the message and if the Payload container type IE is set to "Location services message container", the AMF shall forward the Payload container type and the content of the Payload container IE to the LMF associated with the routing information included in the Additional information IE of the CONTROL PLANE SERVICE REQUEST message.
If the DDX field in the CIoT small data container IE or the DDX field of the Release assistance indication IE indicates: 1) "No further uplink and no further downlink data transmission subsequent to the uplink data transmission is expected" and if there is no downlink signalling or downlink data for the UE; or transmission is expected" and upon subsequent delivery of the next received downlink data transmission to the UE and if there is no additional downlink signalling or downlink data for the UE, the AMF initiates the release of the N1 NAS signalling connection (see 3GPP specification document\).
Upon successful completion of the procedure, the UE sha ll reset the service request attempt counter, stop the timer T3517 and enter the state 5GMM-REGISTERED.
If the PDU session status information element is incl uded in the CONTROL PLANE SERVICE REQUEST message, access type the CONTROL PLANE SERVICE REQUEST message is sent over, but are indicated by the UE as result IE in the SERVICE ACCEPT message indicating that user-plane resources for the corresponding PDU session cannot be re-established, and: a) if the user-plane resources cannot be established becau se the SMF indicated to the AMF that the UE is located out of the LADN service area (see 3GPP specification document [20A]), the AMF shall include the PDU session reactivation result error cause IE with the 5GMM cause set to #43 "LADN not available"; error cause IE with the 5GMM cause set to #28 "restricted service area"; or c) if the user-plane resources cannot be established because: 1) the SMF indicated to the AMF that the resource is not available in the UPF (see 3GPP specification document [20A]); or 2) the UE is in NB-N1 mode and the result will lead to user-plane resources established for more than two PDU sessions (see 3GPP specification document\) the AMF shall include the PDU session reactivation result error cause IE with the 5GMM cause set to #92"insufficient user-plane resources for the PDU session": error cause IE with a 5GMM cause set to #92 "insufficient user-plane resources for the PDU session".
been released as successful completion of the procedure.
The UE shall reset the service request attempt counter, stop the timer T3517 and enter the state 5GMM-REGISTERED.
Editor's note: abnormal cases for the CONTROL PLANE SERVICE REQUEST on the UE and network side are Upon receipt of the CONTROL PLANE SERVICE REQUEST message with uplink data: if the DDX field of the Release assistance indication IE or the DDX field of the CIoT small data container IE is set to "No further uplink and no further downlink data transmission subsequent to the uplink data transmission is expected" in the message; if the AMF decides to forward the uplink data piggybacked in the CONTROL PLANE SERVICE REQUEST if the AMF decides to activate the congestion control for transport of user data via the control plane, then the AMF shall send SERVICE ACCEPT message with the T3448 value IE included.
If the AMF decides to deactivate the congestion control for tr ansport of user data via the control plane, then the AMF in the SERVICE ACCEPT message.
If the T3448 value IE is present in the received SERVICE ACCEPT message and the value indicates that this timer is neither zero nor deactivated, the UE shall: a) stop timer T3448 if it is running; b) consider the transport of user data via the control plane as successful; and c) start timer T3448 with the value provided in the T3448 value IE.
If the UE is using 5GS services with control plane CIoT 5GS optimization, the T3448 value IE is present in the SERVICE ACCEPT message and the value indicates that this timer is either zero or deactivated, the UE shall ignore the T3448 value IE and proceed as if the T3448 value IE was not present.
REQUEST message and the SERVICE ACCEPT message does not include the T3448 value IE and if timer T3448 is running, then the UE shall stop timer T344 Service request procedure not accepted by the network If the SERVICE REJECT message with 5GMM cause #31 or #76 was received without integrity protection, then the UE shall discard the message.
If the service request for mobile originated services is rejected due to general NAS level mobility management If the service request is rejected due to that the UE is not authorized in the current CAG cell or the UE is authorized to "Not authorized for this CAG or authorized for CAG cells only" and may include the "CAG information list" in the CAG information list IE in the SERVICE REJECT message.
Upon receipt of the CONTROL PLANE SERVICE REQUEST message with uplink data: if the AMF decides to not forward the uplink data piggybacked in the CONTROL PLANE SERVICE if the AMF decides to activate the congestion control for transport of user data via the control plane, a value for control plane data back-off timer T344 a) if the service type IE in the SERVICE REQUEST message is set to "signalling" or "data", the AMF shall send a SERVICE REJECT message with the 5GMM cause value set to #28 "Restricted service area"; b) otherwise, if the service type IE in the SERVICE REQUEST message is set to "mobile terminated services", "emergency services", "emergency services fallback", "high priority access" or "elevated signalling", the AMF shall continue the process as specified in subclause unless for other reasons the service request cannot be accepted.
If the service request for mobile originated services is re jected due to service gap control as specified in subclause 7, i.
the T3447 timer is running in AMF, the network shall set the 5GMM cause value to #22 "Congestion" and may include T3346 value IE in the SERVICE REJECT message set to the remaining time of the running T3447 timer.
Based on operator policy, if the service request procedure is rejected due to core network redirection for CIoT optimizations, the network shall set the 5GMM cause value to #31 "Redirection to EPC required".
NOTE 1: The network can take into account the UE's S1 mode capability, the EPS CIoT network behaviour supported by the UE or the EPS CIoT network behaviour supported by the EPC to determine the rejection with the 5GMM cause value #31 "Redirection to EPC required".
On receipt of the SERVICE REJECT message, if the UE is in state 5GMM-SERVICE-REQUEST-INITIATED, the UE shall reset the service request attempt counter and stop timer T3517 if running.
The UE shall take the following actions depending on the 5GMM cause value received in the SERVICE REJECT #6 (Illegal ME); The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
In case of PLMN, the UE shall consider the USIM as invalid for 5GS services until switching off or the UICC containing the USIM is removed; current SNPN until switching off or the UICC containing the USIM is removed.
The UE shall delete the list of equivalent PLMNs (if any) and shall enter the state 5GMM- DEREGISTERED.
If the message has been successfully integrity checked by the NAS, then the UE shall: 1) set the counter for "SIM/USIM considered invalid for GPRS services" events and the counter for "USIM considered invalid for 5GS services over non-3GPP access" events in case of PLMN; or 2) set the counter for "the entry for the current SNPN considered invalid for 3GPP access" events and the counter for "the entry for the current SNPN considered invalid for non-3GPP access" events in case of SNPN; to UE implementation-specific maximum value.
3) delete the 5GMM parameters stored in non-volatile memory of the ME as specified in annex C.
If the message was received via 3GPP access and the UE is operating in the single-registration mode, the UE If the message has been successfully integrity checked by the NAS and the UE also supports the registration procedure over the other access, the UE shall in addition handle 5GMM parameters and 5GMM state for this access, as described for this 5GMM cause value.
#7 (5GS services not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
In case of PLMN, the UE shall consider the USIM as invalid for 5GS services until switching off or the UICC containing the USIM is removed; In case of SNPN, the UE shall consider the entry of the "list of subscriber data" with the SNPN identity of the current SNPN as invalid for 5GS services until the UE is switched off or the entry is updated.
Additionally, if EAP based primary authentication and key agreement procedure using EAP-AKA' or 5G AKA based primary authentication and key agreement procedure was performed in the current SNPN, the UE shall consider the USIM as invalid for the current SNPN until switching off or the UICC containing the USIM is removed.
The UE shall enter the state 5GMM-DEREGISTERED.
If the message has been successfully integrity checked by the NAS, then the UE shall: 1) set the counter for "SIM/USIM considered invalid for GPRS services" events and the counter for "USIM considered invalid for 5GS services over non-3GPP access" events in case of PLMN; or 2) set the counter for "the entry for the current SNPN considered invalid for 3GPP access" events and the counter for "the entry for the current SNPN considered invalid for non-3GPP access" events in case of SNPN; to UE implementation-specific maximum value.
3) delete the 5GMM parameters stored in non-volatile memory of the ME as specified in annex C.
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list and eKSI as specified in 3GPP specification document for the case wh en the service request procedure is rejected with the EMM cause with the same value.
access, as described for this 5GMM cause value.
active, although it is implemented in the UE, is outside the scope of the present document.
#9 (UE identity cannot be derived by the network).
The UE shall set the 5GS update status to 5U2 NOT UPDATED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
The UE shall enter the state 5GMM-DEREGISTERED.
If the service request was initiated for emergency services fallback, the UE shall attempt to select an E-UTRA cell connected to EPC or 5GCN acco rding to the domain priority and selection rules specified in If the service request was initiated for any reason other than emergency services fallback or initiating an NOTE 3: User interaction is necessary in some cases when the UE cannot re-establish the PDU session(s) If the message was received via 3GPP access and the UE is operating in the single-registration mode, the UE the EMM cause with the same value.
The UE shall enter the state 5GMM-DEREGISTERED.
The UE shall delete any mapped 5G NAS security context or partial native 5G NAS security context.
If the service request was initiated for emergency services fallback, the UE shall attempt to select an E-UTRA cell connected to EPC or 5GCN acco rding to the domain priority and selection rules specified in If the rejected request was neither for initiating an emergency PDU session nor for emergency services fallback, NOTE 4: User interaction is necessary in some cases when the UE cannot re-establish the PDU session(s) If the message was received via 3GPP access and the UE is operating in the single-registration mode, the UE shall handle the EMM state as specified in 3GPP specification document for the case when the service request procedure is rejected with the EMM cause with the same value.
#11 (PLMN not allowed).
of the UE is specified in subclause The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
The UE shall shall set the PLMN-specific attempt counter and the PLMN-specific attempt counter for non-3GPP access for that PLMN to the UE implementation-specific maximum value.
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall in addition handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI If the message has been successfully integrity checked by the NAS and the UE also supports the registration procedure over the other access to the same PLMN, the UE shall in addition handle 5GMM parameters and 5GMM state for this access, as described for this 5GMM cause value.
#12 (Tracking area not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
1) the UE is not operating in SNPN access mode, the UE shall store the current TAI in the list of "5GS forbidden tracking areas for regional provision of service" and enter the state 5GMM- DEREGISTERED.
If the SERVICE REJECT message is not integrity protected, the UE shall memorize the current TAI was stored in the list of "5GS forbidden tracking areas for regional provision of service" for non-integrity protected NAS reject message; or 2) the UE is operating in SNPN access mode, the UE shall store the current TAI in the list of "5GS forbidden tracking areas for regional provision of service" for the current SNPN and enter the state 5GMM- DEREGISTERED.
If the SERVICE REJECT message is not integrity protected, the UE shall memorize the current TAI was stored in the list of "5GS forbidden tracking areas for regional provision of service" for the current SNPN for non-integrity protected NAS reject message.
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list and eKSI as specified in 3GPP specification document for the case wh en the service request procedure is rejected with the EMM cause with the same value.
#13 (Roaming not allowed in this tracking area).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\).
The UE shall enter the state 5GMM-REGISTERED.
1) the UE is not operating in SNPN access mode, the UE shall store the current TAI in the list of "5GS forbidden tracking areas for roaming" and remove the curre nt TAI from the stored TAI list if present.
If the SERVICE REJECT message is not integrity protected, the UE shall memorize the current TAI was stored in the list of "5GS forbidden tracking areas for roaming" for non-integrity protected NAS reject message; or 2) the UE is operating in SNPN access mode, the UE shall store the current TAI in the list of "5GS forbidden tracking areas for roaming" for the current SNPN and remove the current TAI from the stored TAI list if present.
If the SERVICE REJECT message is not integrity protected, the UE shall memorize the current TAI was stored in the list of "5GS forbidden tracking areas for roaming" for the current SNPN for non-integrity protected NAS reject message.
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state and EPS update status as specified in 3GPP specification document for the case when the service request procedure is rejected with the EMM cause with the same value.
#15 (No suitable cells in tracking area).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\).
The UE shall enter the state 5GMM-REGISTERED.
1) the UE is not operating in SNPN access mode, the UE shall store the current TAI in the list of "5GS forbidden tracking areas for roaming" and remove the curre nt TAI from the stored TAI list if present.
If the SERVICE REJECT message is not integrity protected, the UE shall memorize the current TAI was stored in the list of "5GS forbidden tracking areas for roaming" for non-integrity protected NAS reject message; or protected NAS reject message.
If the UE initiated service request for emergency services fallback, the UE shall attempt to select an E-UTRA another tracking area according to 3GPP specification document .
If the message was received via 3GPP access and the UE is operating in the single-registration mode, the UE shall handle the EMM parameters EMM state and EPS update status as specified in 3GPP specification document for the case when the service request procedure is rejected with the EMM cause with the same value.
If the T3346 value IE is present in the SERVICE REJECT message and the value indicates that this timer is neither zero nor deactivated, the UE shall proceed as desc ribed below, otherwise it shall be considered as an abnormal case and the behaviour of the UE for this case is specified in subclause If the rejected request was not for initiating an emergency PDU session, the UE shall abort the service request procedure and enter state 5GMM-REGISTERED, and stop timer T3517 if still running.
The UE shall stop timer T3346 if it is running.
If the SERVICE REJECT message is integrity protected, the UE shall start timer T3346 with the value provided in the T3346 value IE.
from the default range specified in 3GPP specification document .
service request procedure is started, if still necessary, when timer T3346 expires or is stopped.
If the message was received via 3GPP access and the UE is operating in the single-registration mode, the UE shall handle the EMM parameters EMM state and EPS update status as specified in 3GPP specification document for the case when the service request procedure is rejected with the EMM cause with the same value.
If the service request procedure was initiated for an MO MMTEL voice call (i.
access category 4) or for an MO IMS registration related signalling (i.
access category 9), a notification that the service request was not accepted due to congestion shall be provided to the upper layers.
If the UE is using 5GS services with control plane CIoT 5GS optimization and if the T3448 value IE is present in the SERVICE REJECT message and the value indicates that this timer is neither zero nor deactivated, the UE shall: a) stop timer T3448 if it is running; b) consider the transport of user data via the control plane as unsuccessful; and c) start timer T3448: 1) with the value provided in the T3448 value IE if the SERVICE REJECT message is integrity protected; or SERVICE REJECT message is not integrity protected.
If the UE is using 5GS services with control plane CIoT 5GS optimization, the T3448 value IE is present in the SERVICE REJECT message and the value indicates that this timer is either zero or deactivated, the UE shall ignore the T3448 value IE and: a) stop timer T3448 if it is running; and The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall enter the state 5GMM-REGISTERED.
If the message has been successfully integrity checked by the NAS, the UE shall set: 1) the PLMN-specific N1 mode attempt counter for 3GPP access and the PLMN-specific N1 mode attempt counter for non-3GPP access for that PLMN in case of PLMN; or 2) the SNPN-specific attempt counter for 3GPP access for the current SNPN in case of SNPN to the UE implementation-specific maximum value.
The UE shall disable the N1 mode capability for the specific access type for which the message was received If the message has been successfully integrity checked by the NAS, the UE shall disable the N1 mode capability also for the other access type (see subclause\).
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall in addition set the EPS update status to EU3 ROAMING NOT ALLOWED and enter the state EMM- #28 (Restricted service area).
The UE shall enter the state 5GMM-REGISTERED.
NON-ALLOWED-SERVICE, wait for the release of the N1 NAS signalling connection and perform the registration pr ocedure for mobility and periodic registration update if the service type IE in the SERVICE REQUEST message was not set to "elevated signalling" and the SERVICE REQUEST message is received over 3GPP access (see subclause and\).
If the service type IE in the SERVICE REQUEST message was set to "elevated signalling", the UE shall not re- #31 (Redirection to EPC required).
over non-3GPP access is considered an abnormal case and the behaviour of the UE is specified in of the UE is specified in subclause The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\).
The UE shall reset the service request attempt counter and enter the state 5GMM-REGISTERED.
The UE shall enable the E-UTRA capability if it was disabled and disable the N1 mode capability for 3GPP If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters, EMM state, and EPS update status as specified in 3GPP specification document for the case when the service request procedure is rejected with the EMM cause with the same value.
#72 (Non-3GPP access to 5GCN not allowed).
If the UE initiated the service request procedure over non-3GPP access, the UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it accordi ng to subclause\) and shall delete 5G- GUTI, last visited registered TAI, TAI list and ngKSI for non-3GPP access.
Additionally, the UE shall enter the state 5GMM-DEREGISTERED for non-3GPP access.
If the message has been successfully integrity checked by the NAS, the UE shall set the PLMN-specific N1 mode attempt counter for non-3GPP access for that PLMN to the UE implementation-specific maximum value.
The UE shall disable the N1 mode capability for non-3GPP access (see subclause\).
As an implementation option, if the UE is not currently registered over 3GPP access, the UE may enter the state 3GPP specification document .
If received over 3GPP access the cause shall be considered as an abnormal case and the behaviour of the UE for this case is specified in subclause of the UE is specified in subclause The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
The UE shall the UE shall set the PLMN-specific attempt counter and the PLMN-specific attempt counter for non-3GPP access for that PLMN to the UE implementation-specific maximum value.
If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall in addition set the EPS update status to EU3 ROAMING NOT ALLOWED, enter the state EMM-DEREGISTERED and shall delete any 4G-GUTI, last visited registered TAI, TAI list and eKSI.
#74 (Temporarily not authorized for this SNPN).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
The UE shall store the SNPN identity in the "temporarily forbidden SNPNs" list for the specific access type for which the message was received.
The UE shall enter state 5GMM-DEREGISTERED.
PLMN-SEARCH and perform an SNPN selection according to 3GPP specification document .
If the message has been successfully integrity checked by the NAS, the UE shall set the SNPN-specific attempt counter for 3GPP access and the SNPN-specific attempt counter for non-3GPP access for the current SNPN to the UE implementation-specific maximum value.
If the message has been successfully integrity checked by the NAS and the UE also supports the registration procedure over the other access to the same SNPN, the UE shall in addition handle 5GMM parameters and 5GMM state for this access, as described for this 5GMM cause value.
NOTE 6: When 5GMM cause #74 is received over 3GPP access, the term "other access" in "the UE also supports #75 (Permanently not authorized for this SNPN).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
The UE shall store the SNPN identity in the "permanently forbidden SNPNs" list for the specific access type for which the message was received.
The UE shall enter state 5GMM-DEREGISTERED.
PLMN-SEARCH and perform an SNPN selection according to 3GPP specification document .
If the message has been successfully integrity checked by the NAS, the UE shall set the SNPN-specific attempt counter for 3GPP access and the SNPN-specific attempt counter for non-3GPP access for the current SNPN to the UE implementation-specific maximum value.
5GMM state for this access, as described for this 5GMM cause value.
NOTE 7: When 5GMM cause #75 is received over 3GPP access, the term "other access" in "the UE also supports #76 (Not authorized for this CAG or authorized for CAG cells only).
of the UE is specified in subclause The UE shall set the 5GS update status to 5UROAMING NOT ALLOWED, store the 5GS update status If 5GMM cause #76 is received from: 1) a CAG cell, and if the UE receives a "CAG information list" in the CAG information list IE included in the SERVICE REJECT message, the UE shall delete any stored "CAG information list" and shall store the received "CAG information list".
Otherwise, the UE shall delete the CAG-ID from the "allowed CAG list" for the current PLMN.
In addition: i) if the entry in the "CAG information list" for the current PLMN does not include an "indication that the UE is only allowed to access 5GS via CAG cells" or if the entry in the "CAG information list" for the current PLMN includes an "indication that the UE is only allowed to access 5GS via CAG cells" and the to 3GPP specification document with the updated "CAG information list"; or ii) if the entry in the "CAG information list" for the current PLMN includes an "indication that the UE is only allowed to access 5GS via CAG cells" and the updated "allowed CAG list" for the current PLMN does not include any CAG-ID, then the UE shall enter the state 5GMM-DEREGISTERED.
PLMN-SEARCH and shall apply the PLMN selection proce ss defined in 3GPP specification document with the updated 2) a non-CAG cell, and if the UE receives a "CAG information list" in the CAG information list IE included in the SERVICE REJECT message, the UE shall delete any stored "CAG information list" and shall store the received "CAG information list".
Otherwise, the UE shall store an "indication that the UE is only allowed to access 5GS via CAG cells" in the entry of the "CAG information list" for the current PLMN.
In addition: i) if the "allowed CAG list" for the current PLMN includes one or more CAG-IDs, then the UE shall enter 3GPP specification document with the updated CAG information; or ii) if the "allowed CAG list" for the current PLMN does not includes any CAG-ID, then the UE shall enter the state 5GMM-DEREGISTERED.
PLMN-SEARCH and shall apply the PLMN selection process defined in 3GPP specification document with the updated "CAG information list".
#77 (Wireline access area not allowed).
acting on behalf of the FN-CRG (or on behalf of the N5GC device).
5GMM cause #77 received from a 5G When received over wireline access network, the 5G-RG and the W-AGF acting on behalf of the FN-CRG (or on behalf of the N5GC device) shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause\), shall delete 5G-G UTI, last visited registered TAI, TAI list and ngKSI, shall enter the state 5GMM-DEREGISTERED and shall act as specified in subclause NOTE 8: The 5GMM sublayer states, the 5GMM parameters and the registration status are managed per access type independently, i.
3GPP access or non-3GPP access (see subclauses and\).
If the service request for initiating an emergency PDU session cannot be accepted by the network, the UE shall perform request was attempted, the UE shall: a) inform the upper layers of the failure of the procedure; or NOTE 1: This can result in the upper layers requesting another emergency call attempt using domain selection as specified in 3GPP specification document .
b) de-register locally, if not de-registered already, attempt initial registration for emergency services.
If the service request for initiating an emergency PDU session fails due to abnormal cases a) in subclause , the UE shall perform the procedures as described in subclause Then if the UE is in the same selected PLMN where the last SERVICE REQUEST message was attempted, the UE shall: a) inform the upper layers of the failure of the procedure; or NOTE 2: This can result in the upper layers requesting another emergency call attempt using domain selection as specified in 3GPP specification document and 3GPP specification document .
b) de-register locally, if not de-registered already, attempt initial registration for emergency services.
Abnormal cases in the UE The following abnormal cases can be identified: The UE shall enter the state 5GMM-REGISTERED.
If the UE triggered the service request procedure in 5GMM-IDLE mode sending a: 1) SERVICE REQUEST message and the service type of the SERVICE REQUEST message was not set to "emergency services fallback"; or 2) CONTROL PLANE SERVICE REQUEST message; then the 5GMM sublayer shall increment the service request attempt counter, abort the procedure and release locally any resources allocated for the service request pro cedure.
The service request attempt counter shall not be 1) the service request procedure is initiated to establish an emergency PDU session; 5) the UE in NB-N1 mode is requested by the upper layer to transmit user data related to an exceptional event and the UE is allowed to use exception data reporti ng (see the ExceptionDataReportingAllowed leaf of the NAS configuration MO in 3GPP specification document or the USIM file EF NASCONFIG in 3GPP specification document\).
If the service request attempt counter is greater than or equal to 5, the UE shall start timer T352 Additionally, if the service request was initiated for an MO MMTEL voice call or for an MO IMS registration related signalling, a notification that the service request was not accepted due to the UE having started timer T3525 shall be provided to the upper layers.
NOTE 1: This can result in the upper layers requesting implementation specific mechanisms, e.
the MMTEL 7) the UE in NB-N1 mode is requested by the upper layer to transmit user data related to an exceptional event and the UE is allowed to use exception data reporti ng (see the ExceptionDataReportingAllowed leaf of the NAS configuration MO in 3GPP specification document or the USIM file EF NASCONFIG in 3GPP specification document\).
NOTE 2: The NAS signalling connection can also be released if the UE deems that the network has failed the authentication check as specified in subclause If the UE triggered the service request procedure in 5MM-CONNECTED mode sending a: 1) SERVICE REQUEST message and the service type of the SERVICE REQUEST message was not set to "emergency services fallback"; or 2) CONTROL PLANE SERVICE REQUEST message, the 5GMM sublayer shall abort the procedure, and stay in 5GMM-CONNECTED mode.
If the service type of the SERVICE REQUEST message was set to "emergency services fallback" and: 1) the service request procedure was triggered in 5GMM-IDLE mode, the 5GMM sublayer shall abort the procedure, release locally any resour ces allocated for the service request procedure, and inform the upper layers of the failure of the emergency services fallback (see 3GPP specification document\); or 2) the service request procedure was triggered in 5GMM-CONNECTED mode, the 5GMM sublayer shall abort the procedure, stay in 5GMM-CONNECTED mode, and inform the upper layers of the failure of the emergency services fallback (see 3GPP specification document\).
b) The lower layers indicate that the access attempt is barred.
The UE shall not start the service request procedure.
The UE stays in the current serving cell and applies the normal cell reselection process.
Receipt of the access barred indication shall not trigger the selection of a different core network type (EPC or 5GCN).
alleviated for the access category with which the access attempt was associated.
ba) The lower layers indicate that access barring is applicable for all access categories except categories 0 and 2 and the access category with which the access attempt was associated is other than 0 and If the SERVICE REQUEST message or CONTROL PLANE SERVICE REQUEST has not been sent, the UE shall proceed as specified for case b.
If the SERVICE REQUEST message or CONTROL PLANE SERVICE REQUEST has been sent: 1) the UE shall abort the service request procedure and stop timer T351 The UE stays in the current serving cell and applies the normal cell reselection process; and 2) the service request procedure is started, if still needed, when the lower layers indicate that the barring is alleviated for the access category with which the access attempt was associated.
For additional UE requirements for both cases see subclause c) Timer T3346 is running.
The UE shall not start the service request procedure unless: CONNECTED mode over non-3GPP access and in 5GMM-IDLE mode over 3GPP access; mode over 3GPP access and in 5GMM-IDLE mode over non-3GPP access; 5) the UE has an emergency PDU session established or is establishing an emergency PDU session; 6) the service request is initiated for emergency services fallback; 7) the service request procedure is initiated for elevated signalling; or 8) the UE in NB-N1 mode is requested by the upper layer to transmit user data related to an exceptional event the UE is allowed to use exception data reporting (see the ExceptionDataReportingAllowed leaf of the NAS configuration MO in 3GPP specification document or the USIM file EF NASCONFIG in 3GPP specification document\); timer T3346 was not started when N1 NAS signalling connection was established with RRC establishment cause set to "mo-ExceptionData".
If the UE is in 5GMM-IDLE mode, the UE stays in the current serving cell and applies normal cell reselection process.
The service request procedure is started, if still necessary, when timer T3346 expires or is stopped.
If the service request procedure was triggered for an MO MMTEL voice call (i.
access category 4) or for an MO IMS registration related signalling (i.
access category 9), a notification that the service request procedure was not initiated due to congestion shall be provided to the upper layers.
UE is in 5GMM-REGISTERED.
NORMAL SERVICE over non-3GPP access, the UE shall stop timer T3346 and send the SERVICE REQUEST message over non-3GPP access.
d) Registration procedure for mobility and periodic registration update is triggered.
The UE shall abort the service request procedure, stop timer T3517, if running and perform the registration procedure for mobility and periodic registration update.
The Follow-on request indicator shall be set to "Follow- on request pending" in the REGISTRATION REQUEST message.
If the UE is in state 5GMM-SERVICE-REQUEST-INITIATED at switch off, the de-registration procedure shall f) De-registration pr ocedure collision.
REQUEST-INITIATED, the UE shall progress the DEREGISTRATION REQUEST message and the service request procedure shall be aborted.
NOTE 3: The above collision case is valid if the DEREGISTRATION REQUEST message indicates the access g) Transmission failure of SERVICE REQUEST or CONTROL PLANE SERVICE REQUEST message indication with TAI change from lower layers.
If the current TAI is not in the TAI list, UE shall abort the service request procedure to perform the registration procedure for mobility and periodic registration update as specified in subclause If the current TAI is part of the TAI list, the UE shall restart the service request procedure.
h) Transmission failure of SERVICE REQUEST or CONTROL PLANE SERVICE REQUEST message indication without TAI change from lower layers.
and cases of 5GMM cause values #11, #22, #31, #72, #73, #74, #75, #76 and #77 that are considered as abnormal cases according to subclause The UE shall enter state 5GMM-REGISTERED.
The UE shall abort the service request procedure, stop timer T3517 and locally release any resources allocated for the service request procedure.
j) The UE in 5GMM-CONNECTED mode with RRC inactive indication over the 3GPP access, and in 5GMM- access with access type indicating 3GPP access.
The UE shall transition from 5GMM-CONNECTED mode with RRC inactive indication to 5GMM-IDLE mode over 3GPP access and initiate the service request procedure over the 3GPP access.
k) Timer T3447 is running The UE shall not start any service request procedure unless: 4) the service request is initiated for emergency services fallback; 5) the UE in 5GMM-CONNECTED mode receives mobile terminated signalling or downlink data over the 6) the service request procedure is initiated for elevated signalling.
The UE stays in the current serving cell and applies the normal cell reselection process.
The service request procedure is started, if still necessary, when timer T3447 expires.
l) Lower layer failure, release of the N1 signalling connection received from lower layers or the lower layers indicate that the RRC connection has been suspended before the service request procedure is completed or SERVICE REJECT message is received.
The UE shall abort the service request procedure, stop timer T3517, locally release any resources allocated for the service request procedure and enters state 5GMM-REGISTERED.
m) Timer T3448 is running The UE in 5GMM-IDLE mode shall not initiate the service request procedure for transport of user data via the 3) the UE in NB-N1 mode is requested by the upper layer to transmit user data related to an exceptional event and the UE is allowed to use exception data reporti ng (see the ExceptionDataReportingAllowed leaf of the NAS configuration MO in 3GPP specification document or the USIM file EF NASCONFIG in 3GPP specification document\).
The UE stays in the current serving cell and applies the normal cell reselection process.
The service request procedure is started, if still necessary, when timer T3448 expires.
Abnormal cases on the network side The following abnormal cases can be identified: request procedure has been completed by the AMF, the AMF enters/stays in 5GMM-IDLE.
If the SERVICE REQUEST message or the CONTROL PLANE SERVICE REQUEST message is received with #96 invalid mandatory information; #99 information element non-existent or not implemented; #100 conditional IE error; or #111 protocol error, unspecified.
The AMF stays in the current 5GMM mode.
c) More than one SERVICE REQUEST message or CONTROL PLANE SERVICE REQUEST message received before the procedure has been completed (i.
, before SERVICE REJECT message has been sent or service request procedure has been completed).
If one or more of the information elements in the SERVICE REQUEST message or CONTROL PLANE SERVICE REQUEST message differs from the ones received within the previous SERVICE REQUEST message or CONTROL PLANE SERVICE REQUEST message, the previously initiated service request procedure shall be aborted and the new service request procedure shall be progressed; If the information elements do not differ, then the AMF shall continue with the previous service request procedure and shall not treat any further this SERVICE REQUEST message or this CONTROL PLANE SERVICE REQUEST message.
d) REGISTRATION REQUEST message received with "initial registration" or "emergency registration" in the REJECT message has not been sent, the AMF may initiate the 5GMM common procedures, e.
the primary key agreement procedure execution, abort the service request procedure, delete the 5GMM context, indicate towards the SMF that the 5GMM context has been deleted and progress the new REGISTRATION REQUEST e) REGISTRATION REQUEST message received with "mobility registration updating" or "periodic registration updating" in the 5GS registration type IE received before the service request procedure has been completed or a SERVICE REJECT message has been sent.
g) CONTROL PLANE SERVICE REQUEST message received with the Data type field indicates "control plane user data" in the CIoT small data container IE or received with Payload container type IE set to "CIoT user data container" and: then the AMF may send back to the UE the CIoT user data container or control plane user data which was not forwarded as specified in subclause case l1).
signalling connection to the UE.
The paging procedure is also used by the network to request the UE to re-establish the user-plane resources of PDU sessions for downlink user data transport.
Another purpose of the paging procedure is to request the UE to re-establish the user-plane resources of PDU session(s) associated with non-3GPP access over 3GPP access.
Additionally, the network can use the paging procedure to initiate the mobile terminating SMS.
For the UE using eDRX, the network initiates the paging pro cedure when NAS signalling messages or user data is pending to be sent to the UE within the paging time window.
If NAS signalling messages or user data is pending to be sent to the UE outside the paging time window and the eDRX value that the network provides to the UE in the Extended DRX parameters IE during the last registration procedure is not all zeros (i.
the E-UTRA eDRX cycle length duration, or the eDRX cycle length duration of the E-UTRA cell connected to 5GCN, is higher than 2 seconds), the Paging for 5GS services.
The network shall initiate the paging procedure for 5GS services when NAS signalling messages or user data is pending to be sent to the UE in 5GMM-IDLE mode over 3GPP access (see example in figure\).
To initiate the procedure the 5GMM entity in the AMF requests the lower layer to start paging and shall start timer T351 If downlink signalling or user data is pending to be sent over non-3GPP access, the 5GMM entity in the AMF shall indicate to the lower layer that the paging is associated to non-3GPP access.
The 5GMM entity in the AMF may provide the lower layer with the "allowed CAG list" and an "indication that the UE is only allowed to access 5GS via CAG cells" for the current PLMN, if available.
If there is an active emergency PDU specified in subclauses if the UE is in 5GMM-REGISTERED.
NORMAL-SERVICE state and the UE is in the 5GMM-IDLE mode without suspend indication; the paging as specified in subclauses ; or 3) proceed as specified in subclause if the UE is in the 5GMM-IDLE mode with suspend indication; or b) if control plane CIoT 5GS optimization is used by the UE, the UE shall: 3) proceed as specified in subclause if the UE is in the 5GMM-IDLE mode with suspend indication.
NOTE: If the UE is in the 5GMM-IDLE mode without suspend indication and has an uplink user data to be sent to the network using control plane CIoT 5GS optimi zation when receiving the paging indication, the UE can piggyback the uplink user data during the service request procedure initiated to respond to the paging, as specified in subclause The network shall stop timer T3513 for the paging procedure when an integrity-protected response is received from the UE and successfully integrity checked by the network or when the 5GMM entity in the AMF receives an indication from the lower layer that it has received the NGAP UE context resume request message as specified in 3GPP specification document .
If the response received is not integrity protected, or the integrity check is unsuccessful, timer T3513 for the paging procedure shall be kept running unless: a) the UE is registered for emergency services; and the security mode control procedure or authentication procedure performed during mobility and periodic registration update has completed successfully.
Upon expiry of timer T3513, the network may reinitiate paging.
downlink data associated with priority user-plane resources for PDU sessions, the network shall stop timer T3513, and then initiate the paging procedure with paging priority.
Abnormal cases on the network side The following abnormal case can be identified: Abnormal cases in the UE The following abnormal cases can be identified: a) Paging message received with access type set to non-3GPP access while the UE is in 5GMM-CONNECTED mode over non-3GPP access.
The UE shall not respond to paging message.
b) Paging message received with access type set to 3GPP access when UE-initiated 5GMM specific procedure or service request procedure is ongoing.
The notification procedure is used by the network: a) to request the UE, by sending the NOTIFICATION messa ge over 3GPP access, to re-establish the user-plane resources of PDU session(s) associated with non-3GPP access over 3GPP access or to deliver 5GSM downlink signalling messages associated with non-3GPP access over 3GPP access when the UE is in 5GMM-IDLE mode over non-3GPP access and in 5GMM-CONNECTED mode over 3GPP access; or b) to request the UE, by sending the NOTIFICATION messa ge over non-3GPP access, to re-establish user-plane resources of the PDU session(s) or to deliver downlink signalling associated with 3GPP access over 3GPP access when the UE is in 5GMM-CONNECTED mode over non-3GPP access and: 1) in 5GMM-IDLE mode over 3GPP access when the UE is not in MICO mode; or 2) in 5GMM-IDLE mode with suspend indication over 3GPP access when the UE is not in MICO mode.
The network shall not use the NOTIFICATION message to re-establish user-plane resources of PDU session(s) associated with non-3GPP access over 3GPP access if all the PDU sessions of the UE that are established over the 3GPP access are associated with control plane only indication.
The network shall initiate the notification procedure by sending the NOTIFICATION message to the UE and start timer T3565 (see example in figure\).
For case a) in subclause , the NOTIFICATION message is sent from the network to the UE via 3GPP access with access type indicating non-3GPP access.
For case b) in subclause , the NOTIFICATION message is sent from the network to the UE via non-3GPP access with access type indicating 3GPP access when the UE is not in MICO mode.
SERVICE REQUEST or REGISTRATION REQUESTNOTIFICATIO.
NORMAL-SERVICE state over 3GPP access or 5GMM-REGISTERED.
NON- ALLOWED-SERVICE state (see subclause\), and the UE is in the 5GMM-IDLE mode without suspend indication; subclause , if the UE is in 5GMM-REGISTERED.
ATTEMPTING-REGISTRATION-UPDATE state over 3GPP access; or 3) proceed as specified in subclause if the UE is in the 5GMM-IDLE mode with suspend indication; b) if control plane CIoT 5GS optimization is used by the UE, the UE shall: 5GMM-REGISTERED.
NORMAL-SERVICE state and the UE is in the 5GMM-IDLE mode without suspend indication; subclause , if the UE is in 5GMM-REGISTERED.
ATTEMPTING-REGISTRATION-UPDATE state; or 3) proceed as specified in subclause if the UE is in the 5GMM-IDLE mode with suspend indication; or c) if the UE is in 5GMM-REGISTERED.
PLMN-SEARCH over 3GPP access, the UE shall respond with NOTIFICATION RESPONSE message indicating failure to re-establish the user-plane resources of PDU sessions and may include the PDU session status information element to indicate the PDU session(s) available in the UE associated with the 3GPP access type.
Upon reception of NOTIFICATION message: For case b) in subclause , if the UE is in 5GMM-REGISTERED.
NO-CELL-AVAILABLE state or then the UE shall respond with NOTIFICATION RESPONSE message indicating with the PDU session status information element that the local release of its PDU sessions was performed.
Upon reception of SERVICE REQUEST message or REGISTRATION REQUEST message, the AMF shall stop timer T3565 and proceed service request procedure as specified in subclauses or registration procedure for mobility and periodic registration update as specified in subclauses If no user-plane resources of PDU session(s) need to be re-established, the AMF should notify the SMF that the UE was reachable but did not accept to re-establish the user- plane resources of PDU session(s).
When the 5GMM entity in the AMF receives an indication from the lower layer that it has received the NGAP UE context resume request message as specified in 3GPP specification document , the AMF shall stop timer T356 Upon reception of NOTIFICATION RESPONSE message, the AMF shall stop timer T3565 and should notify the SMF that the UE is unreachable.
If the NOTIFICATION RESPONSE message includes the PDU session status information element, then the AMF shall Abnormal cases on the network side The following abnormal cases can be identified: reset and start timer T356 This retransmission is repeated four times, i.
on the fifth expiry of timer T3565, the procedure shall be aborted.
In addition, upon the fifth expiry of timer T3565: For case a) in subclause , the AMF should notify the SMF that the UE is unreachable.
The AMF may enter 5GMM-IDLE mode over 3GPP access.
For case b) in subclause , the AMF may either: 1) perform the paging procedure over the 3GPP access; or 2) notify the SMF that the UE is unreachable.
NOTE: Whether the AMF performs the paging procedure or notifies the SMF is up to operator's policies.
b) De-registration procedure collision message or REGISTRATION REQUEST message, the AMF shall stop timer T3565 and proceed de-registration procedure as specified in subclause Abnormal cases on the UE side The following abnormal cases can be identified: a) NOTIFICATION message received via non-3GPP access with access type indicating 3GPP access when UE- initiated 5GMM specific procedure or service request procedure over 3GPP access is ongoing.
The UE shall ignore the NOTIFICATION message.
6 Elementary procedures for 5GS session.
This clause describes the procedures used for 5GS session management (5GSM) performed over an N1 NAS signalling connection.
The main function of the 5GSM sublayer is to support the PDU session handling in the UE and in the SMF (transferred The 5GSM comprises procedures for: the authentication and authorization, establishment, modification and release of PDU sessions; and - request for performing handover of an existing PDU session between 3GPP access and non-3GPP access, or to transfer an existing PDN conn ection in the EPS to the 5GS.
established even if the radio and network resources constituting the corresponding PDU session between the UE and the SMF are temporarily released.
5GSM procedures can be performed only if a 5GMM context has been established between the UE and the AMF, and Types of 5GSM procedures Three types of 5GSM procedures can be distinguished: a) Procedures related to PDU sessions: These procedures are initiated by the network and are used for authentication and authorization or manipulation 1) PDU authentication and authorization; 2) network-requested PDU session modification; and 3) network-requested PDU session release.
This procedure is initiated by the UE and to request for establishment of PDU sessions or to perform handover of an existing PDU session between 3GPP access and non-3GPP access, or to transfer an existing PDN connection in the EPS to the 5GS: UE-requested PDU session establishment.
1) UE-requested PDU session modification; and 2) UE-requested PDU session release.
A successful transaction related procedure initiated by the UE triggers the network to execute one of the following procedures related to PDU session; network-requested PDU session modification procedure or network-requested PDU session release procedure.
The UE treats the start of the procedure related to the PDU session as completion of the.
5GSM sublayer states in the UE.
In the following subclauses, the possible 5GSM sublayer states of the UE are described and shown in figure INACTIVEPDU SESSION ACTIVEPDU SESSION RELEASE COMMAND including cause value = 43 REJECT including cause value /= 43PDU SESSION MODIFICATION COMMAND REJECT including cause REJECT including cause value = 43 NOTE: Not all possible transitions are shown in this figure.
The 5GSM sublayer states for PDU session handling in the UE (overview) No PDU session exists.
PDU SESSION ACTIVE PENDING The PDU session is active in the UE.
PDU SESSION INACTIVE PENDING PDU SESSION MODIFICATION PENDING No procedure transaction exists.
UE initiated 5GSM procedure reject by networ.
Network initiated 5GSM procedure The procedure transaction states in the UE (overview) 5GSM sublayer states in the network side.
In the following subclauses, the possible 5GSM sublayer states of the network are described and shown in.
INACTIVEPDU SESSION ACTIVEPDU SESSION ESTABLISHMENT ACCEPT PDU SESSION ESTABLISHMENT ACCEPT PDU SESSION ESTABLISHMENT REJECT PDU SESSION MODIFICATION REJECT including cause value /= 43 PDU SESSION RELEASE REJECTPDU SESSION ESTABLISHMENT REJECTPDU SESSION MODIFICATION REJECT including cause value = 43PDU SESSION NOTE: Not all possible transitions are shown in this figure.
The 5GSM sublayer states for PDU session handling in the network (overview) No PDU session exists.
The PDU session is active in the network.
PDU SESSION INACTIVE PENDING No procedure transaction exists.
5GSM procedure response by the UEPROCEDURE TRANSACTION PENDINGnetwork initiated 5GSM procedure command The procedure transaction states in the network (overview) Coordination between 5GSM and ESM Coordination between 5GSM and ESM with N26 interface or has association(s) between QoS flow and mapped EPS bearer after inter-system change from S1 mode to N1 mode.
dedicated EPS bearer context(s) based on the parameters of the mapped EPS bearer contexts or the associations between QoS flow and mapped EPS bearer in the PDU session, if ava ilable.
The EPS bearer identity assigned for the QoS flow of the default QoS rule becomes the EPS bearer identity of the default bearer in the corresponding PDN connection.
If a) the PDU session is not an MA PDU session established over both 3GPP access and non-3GPP access, the UE b) the PDU session is an MA PDU session established over both 3GPP access and non-3GPP access, the UE shall established over non-3GPP access only.
not associated with the default QoS rule, unless the UE is the 5G-RG and the PDU session is an MA PDU session established over 3GPP access and over wireline access, the UE shall locally delete the QoS rules and the QoS flow description(s).
The UE uses the parameters from each PDU session for which interworking with EPS is supported to create corresponding default EPS bearer context and optio nally dedicated EPS bearer context(s) as follows: 1) the PDN type shall be set to "non-IP" if the PDU session type is "Unstructured"; of them do not support Ethernet PDN type in S1 mode; and 6) the PDN type shall be set to "Ethernet" if the PDU session type is "Ethernet" and the UE and the network support Ethernet PDN type in S1 mode; b) the PDU address of the PDU session shall be mapped to the PDN address of the default EPS bearer context as 1) the PDN address of the default EPS bearer context is set to the PDU address of the PDU session, if the PDU session type is "IPv4", "IPv6" or "IPv4v6"; and 2) the PDN address of the default EPS bearer context is set to zero, if the PDU session type is "Ethernet" or.
c) the DNN of the PDU session shall be mapped to the APN of the default EPS bearer context; d) the APN-AMBR and extended APN-AMBR received in the parameters of the default EPS bearer context of the mapped EPS bearer contexts shall be mapped to the APN-AMBR and extended APN-AMBR of the default EPS e) for each PDU session in state PDU SESSION ACTIVE, PDU SESSION MODIFICATION PENDING or PDU 1) if the UE is performing an inter-system change from N1 mode to WB-S1 mode, the UE shall set the state of the mapped EPS bearer context(s) to BEARER CONTEXT ACTIVE; or 2) if the UE is performing an inter-system change from N1 mode to NB-S1 mode, for the mapped EPS bearer context corresponding to the default EPS bearer, the UE shall set the state of the mapped EPS bearer context any, the UE shall set the state of the mapped EPS bearer context to BEARER CONTEXT INACTIVE; and f) for any other PDU session the UE shall set the state of the mapped EPS bearer context(s) to BEARER Additionally, for each mapped EPS bearer context or the association between QoS flow and mapped EPS bearer in the PDU session: a) the EPS bearer identity shall be set to the EPS bearer identity received in the mapped EPS bearer context, or the EPS bearer identity associated with the QoS flow; b) the EPS QoS parameters shall be set to the mapped EPS QoS parameters of the EPS bearer received in the mapped EPS bearer context, or the EPS QoS parameters associated with the QoS flow; c) the extended EPS QoS parameters shall be set to the mapped extended EPS QoS parameters of the EPS bearer received in the mapped EPS bearer context, or the extend ed EPS QoS parameters associated with the QoS flow; d) the traffic flow template shall be set to the mapped traffic flow template of the EPS bearer received in the mapped EPS bearer context, or the stored traffic flow template associated with the QoS flow, if available.
After inter-system change from N1 mode to S1 mode, the UE shall associate the PDU session identity, the S-NSSAI, and the session-AMBR with the default EPS bearer context, and for each EPS bearer context mapped from one or more QoS flows, associate the QoS rule(s) for the QoS flow(s) and the QoS flow description(s) for the QoS flow(s) with the EPS bearer context.
If the PDU session is associated with the control plane only indication and supports interworking with EPS, after inter- system change from N1 mode to S1 mode, the UE shall associate the EPS bearer context(s) of the PDN connection corresponding to the PDU session with the control plane only indication.
After inter-system change from N1 mode to S1 mode, the UE and the SMF shall maintain the following 5GSM attributions and capabilities associated with the PDU session until the PDN connection corresponding to the PDU session is released: a) the always-on PDU session indication; b) the maximum number of supported packet filters; c) the support of reflective QoS; d) the maximum data rate per UE for user-plane integrity protection supported by the UE for uplink and the maximum data rate per UE for user-plane integrity protection supported by the UE for downlink; e) the support of multi-homed IPv6 PDU session; and f) if the UE is the 5G-RG and the PDU session is an MA PDU session established over 3GPP access, the PDN resource of the MA PDU session.
After inter-system change from N1 mode to S1 mode, the UE shall deem that the following features are supported by the network on the PDN connection corresponding to the PDU session: a) PS data off; and b) Local address in TFT.
configuration options IE in the MODIFY EPS BEARER CONTEXT REQUEST message, the UE shall discard the corresponding association(s) and associate the new value(s) with the EPS bearer context.
The network may provide the UE with one or more QoS rules by including either one QoS rules parameter, or one QoS rules with the length of two octets parameter, but not both, in the Protocol configuration options IE or Extended protocol configuration options IE in the MODIFY EPS BEARER CONTEXT REQUEST message.
The network may provide the UE with one or more QoS flow descriptions corresponding to the EPS bearer context being modified, by including either one QoS flow descriptions parameter, or one QoS flow descriptions with the length of two octets parameter, but not both, in the Protocol configuration options IE or Extended protocol configuration options IE in the MODIFY EPS BEARER CONTEXT REQUEST message.
description is modified in the Protocol configuration options IE or Extended protocol configuration options IE in the MODIFY EPS BEARER CONTEXT REQUEST message, the UE sh all check the EPS bearer identity included in the QoS flow description; and: a) if the EPS bearer identity correspon ds to the EPS bearer context being modi fied or the EPS bear er identity is not included, the UE shall store the QoS flow description and all the associated QoS rules, if any, for the EPS bearer context being modified for use during inter-system change from S1 mode to N1 mode; and b) otherwise the UE shall locally delete the QoS flow de scription and all the associated QoS rules, if any, and parameter set to 5GSM cause #84 "syntactical error in the QoS operation" in the MODIFY EPS BEARER CONTEXT ACCEPT message.
When the UE is provided with one or more QoS rules, or one or more QoS flow descriptions in the Protocol configuration options IE or Extended protocol configuration options IE in the MODIFY EPS BEARER CONTEXT REQUEST message, the UE shall process the QoS rules sequen tially starting with the first QoS rule and shall process the QoS flow descriptions sequentially starting with the fi rst QoS flow description.
The UE shall check the QoS rules and QoS flow descriptions for different types of errors as follows: the QoS rules parameter, the QoS rules with the length of two octets parameter, the QoS flow descriptions parameter and the QoS flow descriptions with the length of two octets parameter included in the Protocol configuration options IE or Extended protocol configuration options IE in the MODIFY EPS BEARER CONTEXT REQUEST message are discarded, if any.
NOTE 2: If the EPS bearer context modi fication procedure is rejected, then the QoS rules parameter, the QoS rules with the length of two octets parameter, the QoS flow descriptions parameter and the QoS flow descriptions with the length of two octets parameter included in the Protocol configuration options IE or Extended protocol configuration options IE in the MODIFY EPS BEARER CONTEXT REQUEST message are discarded, if any.
a) Semantic errors in QoS operations: 1) When the rule operation is "Modify existing QoS rule and add packet filters", "Modify existing QoS rule and replace all packet filters", "Modify existing QoS rule and delete packet filters" or "Modify existing QoS rule without modifying packet filters" on the default QoS rule and the DQR bit is set to "the QoS rule is not the default QoS rule".
2) When the rule operation is "Modify existing QoS rule and add packet filters", "Modify existing QoS rule and 3) When the rule operation is "Create new QoS rule" and the DQR bit is set to "the QoS rule is the default QoS 4) When the rule operation is "Delete existing QoS rule" on the default QoS rule.
5) When the rule operation is "Create new QoS rule", "Modify existing QoS rule and add packet filters", "Modify existing QoS rule and replace all packet filters", "Modify existing QoS rule and delete packet filters", or "Modify existing QoS rule without modifying packet filters" and two or more QoS rules associated with this PDU session would have identical precedence values.
a PDU session of IPv4, IPv6, IPv4v6 or Ethernet PDU session type, and the packet filter list in the resultant QoS rule is empty.
7) When the rule operation is "Create new QoS rule", and there is already an existing QoS rule with the same 8) When the rule operation is "Modify existing QoS rule and add packet filters", "Modify existing QoS rule and without modifying packet filters" and there is no existing QoS rule with the same QoS rule identifier.
9) When the rule operation is "Delete existing QoS rule" and there is no existing QoS rule with the same QoS QoS flow description with the same QoS flow identifi er stored for the EPS bearer context being modified.
11) When the flow description operation is "Modify exis ting QoS flow description" and there is no existing QoS flow description with the same QoS flow identifier.
12) When the flow description operation is "Delete existi ng QoS flow description" and there is no existing QoS flow description with the same QoS flow identifier.
13) When the UE determines that: flows and the default EPS bearer context is not associated with the default QoS rule.
same PDN connection as the EPS bearer context being modified.
15) When the flow description operation is "Create new QoS flow description", "Modify existing QoS flow description" or "Delete existing QoS flow description" and there is already an existing QoS flow description with the same QoS flow identifier stored for an EPS bearer context different from the EPS bearer context being modified and belonging to the same PDN conn ection as the EPS bearer context being modified.
with a 5GSM cause parameter set to 5GSM cause #83 "semantic error in the QoS operation" in the MODIFY EPS BEARER CONTEXT ACCEPT message.
In case 5, if the old QoS rule (i.
the QoS rule that existed before the MODIFY EPS BEARER CONTEXT REQUEST message was received) is not the default QoS rule , the UE shall not diagnose an error, shall further process the new request and, if it was processed successful ly, shall delete the old QoS rule which has identical IE or Extended protocol configuration options IE with a 5GSM cause parameter set to 5GSM cause #83 "semantic error in the QoS operation" in the MODIFY EPS BEARER CONTEXT ACCEPT message.
In case 6, if the QoS rule is not the default QoS rule, the UE shall delete the QoS rule.
If the QoS rule is the In case 7, if the existing QoS rule is not the default QoS rule and the DQR bit of the new QoS rule is set to "the QoS rule is not the default QoS rule", the UE shall not diagnose an error, further process the create request and, if it was processed successfully, delete the old QoS rule (i.
the QoS rule that existed before the MODIFY EPS BEARER CONTEXT REQUEST message was received).
If the existing QoS rule is the default QoS rule or the configuration options IE or Extended protocol configuration options IE with a 5GSM cause parameter set to 5GSM cause #83 "semantic error in the QoS operation" in the MODIFY EPS BEARER CONTEXT ACCEPT message.
In case 9, the UE shall not diagnose an error, further process the delete request and, if it was processed successfully, consider the respective QoS rule as successfully deleted.
In case 10, the UE shall not diagnose an error, further process the create request and, if it was processed successfully, delete the old QoS flow description (i.
the QoS flow description that existed before the MODIFY EPS BEARER CONTEXT REQUEST message was received).
In case 12, the UE shall not diagnose an error, further process the delete request and, if it was processed successfully, consider the respective QoS flow description as successfully deleted.
IE with a 5GSM cause parameter set to 5GSM cause #83 "semantic error in the QoS operation" in the MODIFY EPS BEARER CONTEXT ACCEPT message.
b) Syntactical errors in QoS operations: 1) When the rule operation is "Create new QoS rule", "Modify existing QoS rule and add packet filters", "Modify existing QoS rule and replace all packet filters" or "Modify existing QoS rule and delete packet filters" and the packet filter list in the QoS rule is empty.
2) When the rule operation is "Delete existing QoS rule" or "Modify existing QoS rule without modifying deleted does not exist in the original QoS rule.
A) rule operation is "Create new QoS rule", "Modify existing QoS rule and add packet filters", "Modify B) flow description operation is "Delete existing QoS fl ow description", and the UE determines that there is 7) When the flow description operation is "Create new QoS flow description" or "Modify existing QoS flow 3GPP specification document table\) which lacks at least one of the mandatory parameters (i.
, GFBR uplink, GFBR downlink, MFBR uplink and MFBR downlink).
In case 3 the UE shall not diagnose an error, further process the deletion request and, if no error according to In case 6, if the Protocol configuration options IE or Extended protocol configuration options IE in the MODIFY EPS BEARER CONTEXT REQUEST message contains at least one other valid QoS rule, the UE shall not successful completion of the EPS bearer context modifica tion procedure, the UE shall delete the QoS rule for which no corresponding QoS flow description is av ailable and initiate UE requested bearer resource modification procedure to delete the QoS rule for which it has deleted.
In case 7, if the default QoS rule is associated with the QoS flow description which lacks at least one of the configuration options IE with a 5GSM cause parameter set to 5GSM Cause #84 "syntactical error in the QoS operation" in the MODIFY EPS BEARER CONTEXT ACCEPT message.
Otherwise, if the Protocol configuration options IE or Extended protocol configuration options IE in the MODIFY EPS BEARER CONTEXT REQUEST message contains at least one other valid QoS rule or the QoS flow description IE contains at least one other valid QoS flow description, the UE shall not diagnose an error and shall further bearer context modification procedure, the UE shall delete the QoS flow description which lacks at least one of the mandatory parameters and the associated QoS rule(s) and initiate UE requested bearer resource modification procedure to delete the QoS rule for which it has deleted.
IE with a 5GSM cause parameter set to 5GSM cause #84 "syntactical error in the QoS operation" in the MODIFY EPS BEARER CONTEXT ACCEPT message.
c) Semantic errors in packet filters: 5GSM cause parameter set to 5GSM cause #44 "semantic errors in packet filter(s)" in the MODIFY EPS BEARER CONTEXT ACCEPT message.
d) Syntactical errors in packet filters: 1) When the rule operation is "Create new QoS rule", "Modify existing QoS rule and add packet filters" or "Modify existing QoS rule and replace all packet filters", and two or more packet filters in the resultant QoS rule would have identical packet filter identifiers.
In case 1, if two or more packet filters with identical packet filter identifiers are contained in the MODIFY EPS protocol configuration options IE with a 5GSM cause parameter set to 5GSM cause #45 "syntactical error in packet filter(s)" in the MODIFY EPS BEARER CONTEXT ACCEPT message.
Otherwise, the UE shall not diagnose an error, further process the MODIFY EPS BEARER CONTEXT REQUEST message and, if it was processed successfully, delete the old packet filters which have the identical packet filter identifiers.
IE with a 5GSM cause parameter set to 5GSM cause #45 "syntactical error in packet filter(s)" in the MODIFY EPS BEARER CONTEXT ACCEPT message.
NOTE 3: The 5GSM cause to use cannot be different from #44 "semantic error in packet filter(s)", #45 "syntactical errors in packet filter(s)", #83 "semantic error in the QoS operation" or #84 "syntactical error in the QoS operation".
The selection of a 5GSM cause is up to UE implementation.
Upon successful completion of an EPS attach procedure or tracking area updating procedure after inter-system change from N1 mode to S1 mode (see 3GPP specification document\), the UE shall delete any UE derived QoS rules of each PDU For PDU session(s) associated with non-3GPP access in 5GS, if present, the UE may: a) keep some or all of these PDU sessions still associated with non-3GPP access in 5GS, if supported; b) release some or all of these PDU sessions explicitly by initiating the UE requested PDU session release c) attempt to transfer some or all of these PDU sessions from N1 mode to S1 mode by initiating the UE requested PDN connectivity procedure(s) with the PDN CONNECTIVITY REQUEST message created as follows: 1) if the PDU session is an emergency PDU session, the request type shall be set to "handover of emergency bearer services".
Otherwise the request type shall be set to "handover"; 2) the PDU session type of the PDU session shall be mapped to the PDN type of the default EPS bearer context i) the PDN type shall be set to "non-IP" if the PDU session type is "Unstructured"; ii) the PDN type shall be set to "IPv4" if the PDU session type is "IPv4"; iii) the PDN type shall be set to "IPv6" if the PDU session type is "IPv6"; iv) the PDN type shall be set to "IPv4v6" if the PDU session type is "IPv4v6"; v) the PDN type shall be set to "non-IP" if the PDU session type is "Ethernet" and the UE, the network or both of them do not support Ethernet PDN type in S1 mode; and vi) the PDN type shall be set to "Ethernet" if the PDU session type is "Ethernet" and the UE and the network support Ethernet PDN type in S1 mode; 3) the DNN of the PDU session shall be mapped to the APN of the default EPS bearer context; and one or more QoS flow descriptions received in the Protocol configuration options IE or Ex tended protocol configuration descriptions after inter-system change from N1 mode to S1 mode.
The network may provide the UE with one or more QoS rules by including either one QoS rules parameter, or one QoS rules with the length of two octets parameter, but not both, in the Protocol configuration options IE or Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER CONTEXT REQUEST or ACTIVATE DEDICATED EPS BEARER CONTEXT REQUEST message.
The network may provide the UE with one or more QoS flow descriptions corresponding to the EPS bearer co ntext being activated, by including either one QoS flow descriptions parameter, or one QoS flow descriptions with the length of two octets parameter, but not both, in the Protocol configuration options IE or Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER CONTEXT REQUEST or ACTIVATE DEDICATED EPS BEARER CONTEXT REQUEST message.
description is modified in the Protocol configuration options IE or Extended protocol configuration options IE of the ACTIVATE DEFAULT EPS BEARER CONTEXT REQUEST or ACTIVATE DEDICATED EPS BEARER CONTEXT REQUEST message, the UE shall check the EPS bearer identity included in the QoS flow description; and: included, the UE shall store the QoS flow description and all the associated QoS rules, if any, for the EPS bearer context being activated for use during inter-system change from S1 mode to N1 mode; and b) otherwise the UE shall locally delete the QoS flow de scription and all the associated QoS rules, if any, and When the UE is provided with one or more QoS rules, or one or more QoS flow descriptions in the Protocol configuration options IE or Extended protocol configuration options IE of the ACTIVATE DEFAULT EPS BEARER CONTEXT REQUEST or ACTIVATE DEDICATED EPS BEARER CONTEXT REQUEST message, the UE shall process the QoS rules sequentially starting with the first QoS rule and shall process the QoS flow descriptions sequentially starting with the first QoS flow description.
The UE shall check QoS rules and QoS flow descriptions for different types of errors as follows: configuration options IE or Extended protocol configuration options IE with a 5GSM cause value, then the QoS rules parameter, the QoS rules with the length of two octets parameter, the QoS flow descriptions parameter and the QoS flow descriptions with the length of two octets parameter included in the Protocol configuration options IE or Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER CONTEXT REQUEST or ACTIVATE DEDICATED EPS BEARER CONTEXT REQUEST message are discarded, if any.
parameter, the QoS flow descriptions parameter and the QoS flow descriptions with the length of two octets parameter included in the Protocol configuration options IE or Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER CONTEXT REQUEST or ACTIVATE DEDICATED EPS BEARER CONTEXT REQUEST message are discarded, if any.
a) Semantic errors in QoS operations: 1) When the rule operation is "Create new QoS rule" and the DQR bit is set to "the QoS rule is the default QoS 2) When the rule operation is received in an ACTIVATE DEFAULT EPS BEARER CONTEXT REQUEST message, the rule operation is "Create new QoS rule", and there is no rule with the DQR bit set to "the QoS rule is the default QoS rule".
3) When the rule operation is "Create new QoS rule" and two or more QoS rules associated with this PDU session would have identical precedence values.
5) When the flow description operation is an opera tion other than "Create new QoS flow description".
6) When the UE determines that: flows and the default EPS bearer context is not associated with the default QoS rules.
ii) a dedicated EPS bearer context is associated with the default QoS rule.
7) When the flow description operation is received in an ACTIVATE DEDICATED EPS BEARER CONTEXT REQUEST message, the flow description operation is "Create new QoS flow description" and there is already an existing QoS flow description with the same QoS flow identifier stored for an EPS bearer context different from the EPS bearer context being activated and belonging to the same PDN connection as the EPS bearer context being activated.
8) When the rule operation is "Create new QoS rule" and there is already an existing QoS rule with the same QoS flow description with the same QoS flow identifier.
configuration options IE with a 5GSM cause parameter set to 5GSM cause #83 "semantic error in the QoS operation" in the ACTIVATE DEFAULT EPS BEARER CONTEXT ACCEPT or ACTIVATE DEDICATED EPS BEARER CONTEXT ACCEPT message.
configuration options IE with a 5GSM cause parameter set to 5GSM cause #83 "semantic error in the QoS operation" in the ACTIVATE DEFAULT EPS BEARER CONTEXT ACCEPT or ACTIVATE DEDICATED EPS BEARER CONTEXT ACCEPT message.
b) Syntactical errors in QoS operations: 1) When the rule operation is "Create new QoS rule" and the packet filter list in the QoS rule is empty.
3) When there are other types of syntactical errors in the coding of the QoS rules parameter, the QoS rules with the length of two octets parameter, the QoS flow descriptions parameter or the QoS flow descriptions with 4) When, the QFI corresponding to the QFI of the resulting QoS rule.
B) flow description operation is "Delete existing QoS fl ow description", and the UE determines that there is corresponding to the QFI of the QoS flow description that is deleted (i.
there is no associated QoS flow description with the same QFI).
In case 1, case 3 or case 4, if the QoS rule is not the default QoS rule, the UE shall delete the QoS rule.
If the operation" in the ACTIVATE DEFAULT EPS BEARER CONTEXT ACCEPT or ACTIVATE DEDICATED EPS BEARER CONTEXT ACCEPT message.
c) Semantic errors in packet filters: 5GSM cause parameter set to 5GSM cause #44 "semantic errors in packet filter(s)" in the ACTIVATE DEFAULT EPS BEARER CONTEXT ACCEPT or ACTIVATE DEDICATED EPS BEARER CONTEXT ACCEPT message.
d) Syntactical errors in packet filters: 1) When the rule operation is "Create new QoS rule" and two or more packet filters in the resultant QoS rule would have identical packet filter identifiers.
If the QoS rule is not the default QoS rule, the UE shall delete the QoS rule.
If the QoS rule is the default QoS DEFAULT EPS BEARER CONTEXT ACCEPT or ACTIVATE DEDICATED EPS BEARER CONTEXT parameter in the ACTIVATE DEFAULT EPS BEARER CONTEXT ACCEPT or ACTIVATE DEDICATED EPS BEARER CONTEXT ACCEPT message.
NOTE 6: The 5GSM cause to use cannot be different from #44 "semantic error in packet filter(s)", #45 "syntactical errors in packet filter(s)", #83 "semantic error in the QoS operation" or #84 "syntactical error in the QoS operation".
The selection of a 5GSM cause is up to UE implementation.
Upon inter-system change from S1 mode to N1 mode, the UE uses the parameters from the default EPS bearer context a) the PDN type of the default EPS bearer context shall be mapped to the PDU session type of the PDU session as 1) if the PDN type is "non-IP": the PDU session type is set to the locally availa ble information associated with the PDN connection (either "Ethernet" or "Unstructured"), if available; or otherwise, the PDU session type is set to "Unstructured"; 3) if the PDN type is "IPv6", the PDU session type is set to "IPv6"; 4) if the PDN type is set to "IPv4v6", the PDU session type is set to "IPv4v6"; and 5) if the PDN type is "Ethernet", the PDU session type is "Ethernet"; b) the PDN address of the default EPS bearer context sh all be mapped to PDU address of the PDU session, if the PDN type is "IPv4", "IPv6" or "IPv4v6"; c) the APN of the default EPS bearer context shall be mapped to the DNN of the PDU session; d) for each default EPS bearer context in state BEARER CONTEXT ACTIVE the UE shall set the state of the mapped PDU session to PDU SESSION ACTIVE; and e) for any other default EPS bearer context the UE sha ll set the state of the mapped PDU session to PDU SESSION Additionally, the UE shall set: a) the PDU session identity of the PDU session to the PDU session identity included by the UE in the Protocol configuration options IE or Extended protocol configuration options IE in the PDN CONNECTIVITY b) the S-NSSAI of the PDU session to the S-NSSAI included by the network in the Protocol configuration options c) the session-AMBR of the PDU session to the session-AMBR included by the network in the Protocol configuration options IE or Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER REQUEST message or the MODIFY EPS BEARER CONTEXT REQUEST message, or the session-AMBR associated with the de fault EPS bearer context; d) the SSC mode of the PDU session to "SSC mode 1"; and e) the always-on PDU session indication to the always-on PDU session indication maintained in the UE, if any.
PDU session and for which interworking to 5GS is supported, the 5G-RG shall consider that the MA PDU session is established over 3GPP access and, unless the MA PDU session is established over wireline access too, the 5G-RG shall set the session-AMBR of the PDU session to the session-AMBR included by the network in the Protocol configuration options IE or Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER REQUEST message or the MODIFY EPS BEARER CONTEXT REQUEST message, or the session-AMBR associated with the default EPS bearer context of the PDN connection.
Additionally, for each EPS bearer context of the PDN connection, the UE shall create QoS flow(s) each of which is associated with the QoS flow description received in the Protocol configuration options IE or Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER REQUEST message, ACTIVATE DEDICATED EPS BEARER REQUEST message, and/or MODIFY EPS BEARER REQUEST message (see 3GPP specification document\), or the QoS flow description associated with EPS bearer context, unless the UE is the 5G-RG, the PDU session is an MA PDU session which: a) is established over wireline access; and and the QoS flow already exists over the wireline access.
Additionally, for each EPS bearer context of the PDN connection, the UE shall create QoS rules(s), if any, each of which is associated with the QoS rule received in the Pr otocol configuration options IE or Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER REQUEST message, ACTIVATE DEDICATED EPS BEARER REQUEST message, or MODIFY EPS BEARER CONTEXT REQUEST message (see 3GPP specification document\), or the QoS rules associated with EPS bearer context.
is supported by the network and the SMF shall consider that Ethernet PDN type in S1 mode is supported by the UE.
The UE and the network shall locally release the PDN conne ction(s) and EPS bearer(s) associated with the 3GPP access which have not been transferred to 5GS.
shall associate the EPS bearer identity, the EPS QoS paramete rs, the extended EPS QoS parameters, and the traffic flow template, if available, of the EPS bearer context with the QoS flow.
After inter-system change from S1 mode to N1 mode, for each QoS flow of an MA PDU session which: such that the QoS flow was received in the Protocol configuration options IE or Extended protocol configuration RG shall associate the EPS bearer iden tity, the EPS QoS parameters, the extended EPS QoS parameters, and the traffic flow template, if available, of the EPS bearer context with the QoS flow.
connection supports interworking to 5GS, after inter-system change from S1 mode to N1 mode, the UE shall associate the PDU session corresponding to the PDN connec tion with the control plane only indication.
If there is an EPS bearer used for IMS signalling, after inter-system change from S1 mode to N1 mode, the QoS flow of the default QoS rule in the corresponding PDU session is used for IMS signalling.
SMF shall determine the PDU session indication as specified in subclause When the UE is provided with one or more mapped EPS bear er contexts in the Mapped EPS bearer contexts IE of the PDU SESSION MODIFICATION COMMAND message, the UE shall process the mapped EPS bearer contexts sequentially starting with the first mapped EPS bearer context.
shall be deleted from the UE and the network if there is no other existing QoS flow associ ated with this EPS bearer mapped from the deleted EPS bearer identity shall be deleted from the UE and the network if there is no other existing QoS flow associated with this EPS bear er context.
When an EPS bearer is released, all the associated QoS flow descriptions and QoS rules that are mapped from the released EPS bearer shall be deleted from the UE and the network.
NOTE 7: If T3584 is running or deactivated for the S-NSSAI and optionally the DNN combination, the UE is allowed to initate ESM procedures in EPS with or without APN corresponding to that DNN, and if the NOTE 2: It is up to UE implementation to decide which PDU session(s) to be attempted to transfer from N1 mode to S1 mode, e.
based on UE policy or UE local configuration.
IPv6 PDU session to EPS.
Upon inter-system change from N1 mode to S1 mode in EMM-IDLE mode, the UE shall use the parameters from each a) if the PDU session is an emergency PDU session, the request type shall be set to "handover of emergency bearer services".
Otherwise the request type shall be set to "handover"; b) the PDU session type of the PDU session shall be mapped to the PDN type of the default EPS bearer context as 1) the PDN type shall be set to "non-IP" if the PDU session type is "Unstructured"; 2) the PDN type shall be set to "IPv4" if the PDU session type is "IPv4"; 3) the PDN type shall be set to "IPv6" if the PDU session type is "IPv6"; 4) the PDN type shall be set to "IPv4v6" if the PDU session type is "IPv4v6"; 5) the PDN type shall be set to "non-IP" if the PDU session type is "Ethernet" and the UE, the network or both of them do not support Ethernet PDN type in S1 mode; and 6) the PDN type shall be set to "Ethernet" if the PDU session type is "Ethernet" and the UE and the network support Ethernet PDN type in S1 mode; c) the DNN of the PDU session shall be mapped to the APN of the default EPS bearer context; d) the PDU session ID parameter in the PCO IE shall be set to the PDU session identity of the PDU session; and e) if the UE is the 5G-RG and the PDU session is an MA PDU session established over 3GPP access, the ATSSS request PCO parameter shall be included in the PCO IE.
After inter-system change from N1 mode to S1 mode, the UE shall associate the PDU session identity with the default 3GPP specification document\), the UE shall delete any UE derived QoS rules except when the UE is the 5G-RG and the PDU session is an MA PDU session established over 3GPP access and wireline access.
have not been transferred to EPS.
For PDU session(s) associated with non-3GPP access in 5GS, if present, the UE may: a) keep some or all of these PDU sessions still associated with non-3GPP access in 5GS, if supported; b) release some or all of these PDU sessions explicitly by initiating the UE requested PDU session release procedure(s); or When the network does not support N26 interface, the MME does not provide the UE with the mapped PDU session for a PDN connection but provides the UE with an S-NSSAI if the PDN connection is not for emergency bearer services.
with an S-NSSAI in the Protocol configuration options IE or Extended protocol configuration options IE of the ACTIVATE DEFAULT EPS BEARER REQUEST message.
NOTE 4: It is up to UE implementation to decide which PDN connection(s) to be attempted to transfer from S1 mode to N1 mode, e.
based on UE policy or UE local configuration.
EPC, it is possible that the network provided the S-NSSAI already during the establishment via non-3GPP access (see 3GPP specification document\).
Upon inter-system change from S1 mode to N1 mode in 5GMM-IDLE mode, the UE uses the parameters from the default EPS bearer context of each PDN connection which the UE intends to transfer to 5GS and for which the UE has a) if the PDN connection is for emergency bearer services , the request type shall be set to "existing emergency PDU session".
Otherwise the request type shall be set to: resource of an MA PDU session; or 2) "existing PDU session"; b) the PDN type of the default EPS bearer context shall be mapped to the PDU session type of the PDU session as 1) if the PDN type is "non-IP": the PDU session type is set to the locally availa ble information associated with the PDN connection (either "Ethernet" or "Unstructured"), if available; or otherwise, the PDU session type is set to "Unstructured"; 2) if the PDN type is "IPv4" the PDU session type is set to "IPv4"; 3) if the PDN type is "IPv6", the PDU session type is set to "IPv6"; 4) the PDN type shall be set to "IPv4v6" if the PDU session type is "IPv4v6"; and 5) if the PDN type is "Ethernet", the PDU session type is set to "Ethernet"; and c) the APN of the default EPS bearer context shall be mapped to the DNN of the PDU session; d) the PDU session ID shall be set to the PDU session identity included by the UE in the Protocol configuration options IE or Extended protocol configuration options IE in the PDN CONNECTIVITY REQUEST message, or to the PDU session ID associated with the default EPS bearer context; and e) if the PDU session is not an emergency PDU session, the S-NSSAI of the PDU session shall be set to the S- NSSAI included by the network in the Protocol configuration options IE or Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER REQUEST message, if provided by the network, or the The UE shall locally release the PDN connection(s) and EPS bearer(s) associated with the 3GPP access which have not been transferred to 5GS.
a Coordination between 5GSM and SM Coordination between 5GSM and SM states is not required.
After the 5G-SRVCC handover from NG-RAN to UTRAN (see 3GPP specification document [6A]), all the PDU sessions of the UE are locally released at the UE and the network.
Coordination for interworking with ePDG connected to EPC in the PDU session ID field in the N1_MODE_CAPABILITY Notify payload of the IKE_AUTH request message (see 3GPP specification document\).
The network provides the UE with an S-NSSAI in the N1_MODE_INFORMATION Notify payload of the IKE_AUTH response message (see 3GPP specification document\).
Upon inter-system change to N1 mode, for PDN connection(s) established via an ePDG connected to EPC, if present, a) keep some or all of these PDN connections still via ePDG connected to EPC, if supported; b) release some or all of these PDN connections explicitly by initiating the UE initiated tunnel disconnection procedure(s) as specified in 3GPP specification document ; or c) attempt to transfer some or all of these PDN connections to N1 mode by initiating the PDU session establishment procedure(s) with the PDU SESS ION ESTABLISHMENT REQUEST message created as specified in subclause for the case of inter-system change from S1 mode to N1 mode in 5GMM-IDLE General on elementary 5GSM procedures Principles of PTI handling for 5GSM procedures shall include in the response message the PTI value received within the request message or within the command message (see examples in figure , figure , and figure\).
message the PTI value received with the request message (see examples in figure\).
command message the PTI value set to "no procedure transac tion identity assigned" (see examples in figure\).
transaction related request (PTI = a) transaction related accept (PTI = a) UE-requested transaction related procedure accepted by the network transaction related request (PTI = a) transaction related reject (PTI = a) UE-requested transaction related procedure rejected by the network transaction related request (PTI = a) transaction related command (PTI = a) transaction related response (PTI = a) transaction related command (PTI = unassigned) transaction related response (PTI = unassigned) The following PDU Session types are supported: b) IPv6; c) IPv4v6; d) Ethernet (EtherType as defined in IEEE Std 80 [31A]); and e) Unstructured.
IP address allocation for IPv4, IPv6 and IPv4v6 P DU session types is described in subclause The SMF is responsible for the session management functions to provide the PDU connectivity service to the UE via the SM signalling between UE and SMF.
The session management procedures includes: a) the UE-requested PDU sess ion establishment procedure; c) the UE-requested PDU sess ion modification procedure; d) the network-requested PDU session modification procedure; e) the UE-requested PDU session release procedure; and f) the network-requested PDU session release procedure.
A UE may establish multiple PDU sessions, to the same data network or to different data networks, via 3GPP and via and Non-3GPP access networks at the same time.
The session management messages between UE and SMF are transferred via AMF as specified in subclause.
This clause specifies IP address allocation for the PDU session.
IP address allocation to the UE shall be performed by SMF based on one or both the selected IP versions and operator policies.
If IPv4 PDU session type is selected, an IPv4 a ddress is allocated to the UE.
If IPv6 PDU session type is selected, an IPv6 prefix and an interface identifier for the IPv6 link local address are allocated to the UE.
If IPv4v6 PDU session type is selected, an IPv4 address, an IPv6 prefix and an interface identifier for the IPv6 link local address are allocated to the UE.
For IPv4 PDU session type and for IPv4v6 PDU session type, the UE: a) shall obtain an IPv4 address via: 1) NAS signalling as specified in subclause ; or 2) DHCPv4; and b) may obtain IPv4 configuration parameters (e.
DNS server address) via DHCPv For IPv6 PDU session type and for IPv4v6 PDU session type, the UE: a) shall build an IPv6 link local address based on the allo cated interface identifier for the IPv6 link local address; b) shall obtain /64 IPv6 prefix via IPv6 stateless addre ss autoconfiguration as specified in 3GPP specification document and c) may obtain IPv6 configuration parameters via stateless DHCPv6 as specified in IETF RFC 3736 .
IP address allocation via NAS signalling IP stack capabilities if the UE requests IP connectivity as follows: 1) which is IPv6 and IPv4 capable, shall set the PDU sess ion type IE to IPv4, IPv6 or IPv4v6 according to UE configuration or received policy.
2) which is only IPv6 capable, shall set the PDU session type IE to IPv 3) which is only IPv4 capable, shall set the PDN type IE to IPv b) When the IP version capability of the UE is unknown in the UE (as in the case when the MT and TE are separated and the capability of the TE is not known in the MT), the UE shall set the PDU session type IE to If the UE wants to use DHCPv4 for IPv4 address assignment, it shall indicate that to the network within the Extended protocol configuration options IE in the PDU SESSION ESTABLISHMENT REQUEST.
On receipt of the PDU SESSION ESTABLISHMENT REQUEST message sent by the UE, the network when allocating an IP address shall take into account the PDU session type IE, the operator's policies of the network, and the user's a) if the network sets the selected PDU session type IE to IPv4, the network shall include an IPv4 address in the b) if the network sets the selected PDU session type IE to IPv6, the network shall include an interface identifier for the IPv6 link local address in the PDU address IE; and c) if the network sets the selected PDU session type IE to IPv4v6, the network shall include an IPv4 address and an interface identifier for the IPv6 link local address in the PDU address IE.
Advertisement Message as specified in IETF RFC 4861 [38B] with the "Managed address configuration" flag set to zero, the 5G-RG and the W-AGF acting on behalf of the FN-RG (or on behalf of the N5GC device): a) shall obtain /64 IPv6 prefix via IPv6 stateless addre ss autoconfiguration as specified in 3GPP specification document and b) may obtain IPv6 configuration parameters via stateless DHCPv6 as specified in IETF RFC 3736 or as specified in IETF RFC 3315 [33B]; and c) may request additional IPv6 prefixes using DHCPv If the 5G-RG and the W-AGF acting on behalf of the FN- RG (or on behalf of the N5GC device) request IPv6 prefixes using DHCPv6, the 5G-RG and the W-AGF acting on behalf of the FN-RG (or on behalf of the N5GC device) shall act as a "Requesting Router" as described in IETF RFC 3633 [33C], shall obtain IPv6 prefixes using the DHCPv6 Identity association for prefix delegation NOTE 1: The 5G-RG and the W-AGF acting on behalf of the FN-RG (or on behalf of the N5GC device) can a) shall obtain an IPv6 address via DHCPv6 and the DHCPv6 Identity association for non-temporary addresses option as specified in IETF RFC 3315 [33B]; b) may obtain IPv6 configuration parameters via DHCPv6 as specified in IETF RFC 3315 [33B]; and c) may request IPv6 prefixes using DHCPv If the 5G-RG and the W-AGF acting on behalf of the FN-RG requests IPv6 prefixes using DHCPv6, the 5G-RG and the W-AGF acting on behalf of the FN-RG shall act as a "Requesting Router" as described in IETF RFC 3633 [33C], shall obtain IPv6 prefixes using the DHCPv6 Identity association for prefix delegation option as specified in IETF RFC 3633 [33C] and IETF RFC 3315 [33B], may include DHCPv6 Rapid commit option as specified in IETF RFC 3315 [33B] in a DHCP message, and may include DHCPv6 OPTION_ORO option with the OPTION_PD_EXCLUDE option code as specified in IETF RFC 6603 [40A] in the DHCP message.
NOTE 2: The 5G-RG and the W-AGF acting on behalf of the FN-RG (or on behalf of the N5GC device) can The 5G-RG may obtain ACS information via DHCP as specified in clause of BBF TR-069 or in BBF TR-369 R-DIS.
treatments of UL user data packets in one or more QoS flows based on signalled QoS rules, derived QoS rules or any session establishment or at the PDU session modification.
Each signalled QoS rule contains: a) an indication of whether the QoS rule is the default QoS rule; b) a QoS rule identifier (QRI); For case d) above: set of packet filters contains zero or more packet filters for DL direction, and may additionaly contain one of A) a match-all packet filter for UL direction; B) a match-all packet filter for UL and DL directions; C) zero or more packet filters for UL direction (other than the match-all packet filter for UL direction); D) zero or more packet filters for UL and DL directions (other than the match-all packet filter for UL and DL E) one or more packet filters for UL direction (other than the match-all packet filter for UL direction) and one or more packet filters for UL and DL directions (other than the match-all packet filter for UL and DL packet filter, then the highest precedence value shall be used for the default QoS rule.
the default QoS rule, the set of packet filters contains zero or more packet filters for the DL direction, and may additionally contain one of the following: A) zero or more packet filters for UL direction (other than the match-all packet filter for UL direction); and B) zero or more packet filters for both UL and DL directions (other than the match-all packet filter for UL 3) For PDU session of unstructured PDU session type, there is only one QoS rule associated with it and the set of packet filters of that QoS rule is empty.
from 70 to 99 (decimal).
NOTE 3: In order to support QoS differentiation in case of access to PLMN services via an SNPN, the UE, within the SNPN, can construct packet filters based on the destination IP address to reach the N3IWF in the PLMN and the security parameters index (SPI) for the IPsec SA.
SNPN and the security parameters index (SPI) for the IPsec SA.
Derived QoS rules are applicable only for PDU session of IPv4, IPv6, IPv4v6 or Ethernet PDU session type.
received via the PDU session.
Each derived QoS rule contains: the range from 70 to 99 (decimal).
PDU session establishment or at the PDU session modification.
Each QoS flow description contains: a) a QoS flow identifier (QFI); 2) Guaranteed flow bit rate (GFBR) for DL; 3) Maximum flow bit rate (MFBR) for UL; 4) Maximum flow bit rate (MFBR) for DL; and 5) optionally averaging window, applicable for both UL and DL; c) 5QI, if the QFI is not the same as the 5QI of the QoS flow identified by the QFI; and d) optionally, an EPS bearer identity (EBI) if the QoS flow can be mapped to an EPS bearer as specified in subclause of 3GPP specification document .
3GPP specification document table , the averaging window associated with the 5QI in 3GPP specification document table applies for the averaging window.
3GPP specification document table , the standardized value of two seconds is used as the averaging window.
The standardized value of two seconds is used as the av eraging window for the UE's enforcement of the UL rate limitation indicated by the session-AMBR.
UL user data packet matching For PDU session of IPv4, IPv6, IPv4v6 or Ethernet PDU session type, upon receiving an UL user data packet from the directions matching the UL user data packet; or matching the UL user data packet; by evaluating the QoS rules in increasing order of their preced ence values until the UL user data packet is associated For PDU session of unstructured PDU session type, upon receiving an UL user data packet from the upper layers for lower layers for transmission.
NOTE: Marking of the UL user data packet with the QFI is performed by the lower layers.
The UE may support reflective QoS.
If the UE supports the reflective QoS, the UE shall support the procedures in the following subclauses.
The UE may request to revoke the usage of reflective QoS for an existing PDU session for which the UE had previously indicated support for reflective QoS.
Derivation of packet filter for UL direction from DL user data packet ), the UE shall proceed as follows: 2) the protocol field of the received DL user data pack et indicates UDP as specified in IETF RFC 768 ; or 3) the protocol field of the received DL user data pack et indicates ESP as specified in IETF RFC 4303 and then the packet filter for UL direction contains the following packet filter components: 1) an IPv4 remote address component set to the value of the source address field of the received DL user data 3) a protocol identifier/next header type component set to the value of the protocol field of the received DL user UDP as specified in IETF RFC 768 : i) a single local port type component set to the value of the destination port field of the received DL user ii) a single remote port type component set to the value of the source port field of the received DL user data 5) if the protocol field of the received DL user data packet indicates ESP as specified in IETF RFC 4303 : i) a security parameter index type component set to the security parameters index of the uplink IPSec SA DL user data packet; 1) the last next header field of the received DL user data packet indicates TCP as specified in 2) the last next header field of the received DL user data packet indicates UDP as specified in IETF RFC 768 ; or parameters index field of the received DL user data packet exists; then the packet filter for UL direction contains the following packet filter components: 1) an IPv6 remote address/prefix length component set to the value of the source address field of the received DL user data packet; 2) an IPv6 local address/prefix length component set to the value of the destination address field of the received DL user data packet; 3) a protocol identifier/next header type component set to the value of the last next header field of the received DL user data packet; 4) if the last next header field of the received DL user data packet indicates TCP as specified in IETF RFC 793 or UDP as specified in IETF RFC 768 : i) a single local port type component set to the value of the destination port field of the received DL user ii) a single remote port type component set to the value of the source port field of the received DL user data 5) if the last next header field of the received DL user data packet indicates ESP as specified in IETF RFC 4303 : i) a security parameter index type component set to the security parameters index of the uplink IPSec SA DL user data packet; UL direction contains the following packet filter components: 1) a destination MAC address component set to the source MAC address of the received DL user data packet; 2) a source MAC address component set to the destination MAC address of the received DL user data packet; 3) if an 80Q C-TAG is included in the received DL user data packet, an 80Q C-TAG VID component set to the 80Q C-TAG VID of the received DL user data packet and an 80Q C-TAG PCP/DEI component set to the 80Q C-TAG PCP/DEI of the received DL user data packet; 4) if an 80Q S-TAG is included in the received DL user data packet, an 80Q S-TAG VID component set to the 80Q S-TAG VID of the received DL user data packet and an 80Q S-TAG PCP/DEI component set to the 80Q S-TAG PCP/DEI of the received DL user data packet; component set to the Ethertype of the received DL user data packet; 6) if the Ethertype field of the Ethernet frame header indi cates that the data carried in the Ethernet frame is IPv4 data, the UE shall also add to the packet filter for UL direction the IP-specific components based on the contents of the IP header of the received DL user data packet as described in bullet a) above; and 7) if the Ethertype field of the Ethernet frame header indi cates that the data carried in the Ethernet frame is IPv6 data, the UE shall also add to the packet filter for UL direction the IP-specific components based on the contents of the IP header of the received DL user data packet as described in bullet b) above; and b) the precedence value of the derived QoS rule is set to 80 (decimal); and c) the packet filter for UL direction of the derived QoS rule is set to the derived packet filter for UL direction; and the UE shall start the timer T3583 associated with the derived QoS rule with the RQ timer value last received during the UE-requested PDU session establishment procedure of the PDU session (see subclause\) or the network-requested PDU session modification procedure of the PDU session (see subclause\).
If the RQ timer value was received neither in the UE-requested PDU session establis hment procedure of the PDU session nor in any network- requested PDU session modification procedure of the PDU se ssion, the default standardized RQ timer value is used.
filter for UL direction as the packet filter for UL direction derived from the DL user data packet as specified in subclause : a) the UE shall re-start the timer T3583 associated with the derived QoS rule with the RQ timer value last received during the UE-requested PDU session establishment procedure of the PDU session (see subclause\) or the network-requested PDU session modification procedure of the PDU session (see subclause\).
If the RQ nor in any network-requested PDU session modification procedure of the PDU session, the default standardized RQ timer value is used; and b) if the QFI value associated with the DL user data pack et is different from the QFI value stored for the derived QoS rule, the UE shall replace the QFI value stored for the derived QoS rule with the new QFI value for the derived QoS rule.
Upon release of the PDU session, the UE shall remove the derived QoS rule(s) associated with the PDU session.
If the network accepts the request from the UE to revoke the usage of reflective QoS and sets the value of the RQ timer to "deactivated" or zero, the UE shall remove the de rived QoS rule(s) associated with the PDU session.
Upon inter-system mobility from WB-N1 mode to NB-N1 mode or from NR connected to 5GCN to NB-N1 mode, the UE shall remove the derived QoS rule(s) associated with the PDU session that is kept active.
Ignoring RQI in the UE for UL direction from the DL user data packet as specified in subclause , the UE shall ignore the RQI and shall handle the received DL user data packet.
QoS in MA PDU session In an MA PDU session, unless the UE is the 5G-RG and the MA PDU session: a) is established over wireline access; and the UE shall have one set of QoS rules, one set of QoS flow descriptions and one session-AMBR.
The network can provide the set of QoS rules, the set of QoS flow descriptions and the session-AMBR of the MA PDU session via either access of the MA PDU session.
In an MA PDU session, the UE shall support:- of the MA PDU session created via the same or the other access.
In an MA PDU session: the RG-RG shall have two sets of QoS rules, two sets of QoS flow descriptions and two session-AMBR values - one is maintained via wireline access and the other is associated with EPS bearer contexts of the PDN connection and maintained via PCO parameters received via the PDN connection.
Local area data network (LADN) The UE can receive the local area data network (LADN) information consisting of LADN DNNs and LADN service area information (a set of tracking areas that belong to the current registration area) during the registration procedure or the generic UE configuration update procedure (see subclause and subclause\).
The UE considers the received LADN information to be valid only in the TAIs of the registered PLMN that are in the LADN service area information, and in the TAIs of the equivalent PLMNs if the LADN service area information includes TAIs for the equivalent PLMNs.
When the AMF provides the UE with LADN service area information containing TAIs for the equivalent PLMNs, the AMF shall include these TAIs of the equivalent PLMNs in the UE’s registration area.
The LADN DNN(s) received by the UE is also consider ed as LADN DNN(s) in the equivalent PLMNs.
The UE shall consider itself to be located inside the LADN service area based on the LADN service area information.
If When the UE is located in the LADN service area, the UE may initiate: the UE-requested PDU session modification pro cedure to modify the PDU session for LADN; and the service request procedure to re-establish the user-plane resources for the PDU session for LADN.
When the UE is located outside the LADN service area, the UE is allowed: If the UE has moved out of the LADN service area, the SMF shall: a) release the PDU session for LADN; or b) release the user-plane resources for the PDU session for LADN and maintain the PDU session for LADN; according to operator's policy.
In case b): if the UE has returned to the LADN service area, and the network has downlink user data pending, the network re-establishes the user-plane resources for the PDU session for LADN; and.
Handling of DNN based congestion control case of SNPN.
Upon receipt of a 5GMM message or 5GSM message from the network for which the UE needs to stop the running timers T3396 associated with an LADN DNN as specified in subclause , , , and , only the running timer T3396 associated with the LADN DNN for the current PLMN and equivalent PLMNs is stopped.
The DNN associated with T3396 is the DNN provided by the UE during the PDU session establishment.
If no DNN is provided by the UE along the PDU SESSION ESTABLISHMENT REQUEST, then T3396 is associated with no DNN.
For this purpose, the UE shall memorize the DNN provided to the network during the PDU session establishment.
The timer T3396 associated with no DNN will never be started due to any 5GSM procedure related to an emergency PDU session.
If the timer T3396 associated with no DNN is running, it does not affect the ability of the UE to request an emergency PDU session.
Handling of S-NSSAI based congestion control In the UE, 5GS session management timers T3584 for the S-NSSAI based congestion control are started and stopped on a per S-NSSAI, DNN and PLMN basis.
If the 5GSM congestion re-attempt indicator IE set to "The back-off timer is In the UE, 5GS session management timers T3585 for the S-NSSAI based congestion control are started and stopped on establishment, the timer T3585 is associated with the mapped S-NSSAI of the PDU session.
The 5GSM congestion re-attempt indicator IE shall not be applicable in an SNPN.
If the timer T3584 or timer T3585 was provided during the PDU session establishment procedure, the S-NSSAI associated with T3584 or T3585, respectively is the S-NSSAI, including no S-NSSAI, provided by the UE during the PDU session establishment.
If the timer T3584 is provided during the PDU session modification or PDU session release procedure, the UE behaves as follows: The DNN associated with T3584 is the DNN provided by the UE during the PDU session establishment.
For this purpose, the UE shall memorize the DNN and the S-NSSAI provided to the network during the PDU session establishment.
The timer T3584 associated with no DNN and an S-NSSAI will never be started due to any 5GSM procedure related to an emergency PDU session.
If the timer T3584 associated with no DNN and an S-NSSAI is running, it does not affect the ability of the UE to request an emergency PDU session.
If the timer T3585 was provided during the PDU session modification or PDU session release procedure, the UE behaves as follows: if an S-NSSAI was provided by the UE during the PDU session establishment, then T3585 is associated with the S-NSSAI of the PDU session.
If no S-NSSAI is provided by the UE along the PDU SESSION ESTABLISHMENT REQUEST message, then T3585 is associated with no S-NSSAI.
If the PDN connection was established when in the S1 mode, then T3585 is associated with no S-NSSAI.
Editor’s note [CR#2326, WID 5GProtocc16]: Changes to the association of the timer T3584 and timer T3585 when the UE provided no S-NSSAI during PDU session establishment are FFS.
If the timer T3584 is running or is deactivated for all the PLMNs and is associated with an S-NSSAI other than no S- a) the UE registered in the HPLMN is neither allowed to initiate the PDU session establishment procedure nor the PDU session modification procedure when the [S-NSSAI, no DNN] or [S-NSSAI, DNN] combination provided If the timer T3584 is running or is deactivated for all the PLMNs and is associated with [no S-NSSAI, no DNN] or [no If the timer T3585 is running or is deactivated for all the PLMNs and is associated with an S-NSSAI other than no S- a) the UE registered in the HPLMN is neither allowed to initiate the PDU session establishment procedure nor the PDU session modification procedure when the S-NSSAI provided by the UE during the PDU session Interaction with upper layers.
A 5GSM entity may interact with upper layers.
Subclause describes how the 5GSM entity interacts with upper layers with respect to the URSP.
b) to release an existing PDU session; or 0 Handling of 3GPP PS data off lists of 3GPP PS data off exempt services as specified in 3GPP specification document or in the EF 3GPPPSDATAOFF USIM file as specified in 3GPP specification document : a) a list of 3GPP PS data off exempt services to be used in the HPLMN or EHPLMN; and b) a list of 3GPP PS data off exempt services to be used in the VPLMN.
If only the list of 3GPP PS data off exempt services to be used in the HPLMN or EHPLMN is configured at the UE, this list shall be also used in the VPLMN.
3GPP PS data off exempt services as specified in 3GPP specification document for each SNPN whose entry exists in the "list of subscriber data": a) a list of 3GPP PS data off exempt services to be used in the SNPN.
session from non-3GPP access to 3GPP access and except for the establishment of user plane resources on the other access for the MA PDU session(see subclause\), and during UE-requested PDU session modification procedure establish user plane resources on the other access for the MA PDU session over 3GPP access or non-3GPP access, and: 3GPP PS data off UE status in the Extended protocol configuration options IE; or b) if the 3GPP PS data off UE status has not changed since the last providing to the network, the UE need not provide the 3GPP PS data off UE status.
The network shall support of 3GPP PS data off.
When the 3GPP PS data off UE status is "activated": a) the UE does not send uplink IP packets via 3GPP access except: 1) for those services indicated in the list of 3GPP PS data off exempt services to be used in the HPLMN or EHPLMN as specified in 3GPP specification document when the UE is in its HPLMN or EHPLMN or for those services indicated in the list of 3GPP PS data off exem pt services to be used in the SNPN as specified in 3GPP specification document when the UE is in an SNPN; 2) for those services indicated in the list of 3GPP PS data off exempt services to be used in the HPLMN or EHPLMN when the UE is in the VPLMN, if only the list of 3GPP PS data off exempt services to be used in the HPLMN or EHPLMN is configured to the UE as specified in 3GPP specification document ; 3) for those services indicated in the list of 3GPP PS data off exempt services to be used in the VPLMN when the UE is in the VPLMN, if the list of 3GPP PS data off exempt services to be used in the VPLMN is configured to the UE as specified in 3GPP specification document ; 4) for those services indicated in the EF 3GPPPSDATAOFF USIM file as specified in 3GPP specification document ; 5) any uplink traffic due to procedures specified in 3GPP specification document ; and 6) any uplink traffic due to procedures specified in 3GPP specification document ; b) the UE does not send uplink Ethernet user data packets via 3GPP access; and c) the UE does not send uplink Unstructured user data packets via 3GPP access.
Otherwise the UE sends uplink user data packets without restriction.
NOTE: If the UE supports 3GPP PS data off, uplink IP packets are filtered as specified in 3GPP specification document session or an MA PDU session.
1 Multi-homed IPv6 PDU session The UE supporting IPv6 may support multi-homed IPv6 PDU session.
If the UE supports the multi-homed IPv6 PDU session: 2) during the UE-requested PDU session modification performed after the first inter-system change from S1 is of "IPv6" or "IPv4v6" PDU session type.
2 Handling of network rejection not due to congestion control interval at which the UE may retry the same procedure for 5GSM cause values other than #26 "insufficient resources", #69 "insufficient resources for specific slice".
For 5GSM cause values other than #26 "insufficient resources", #28 UE is allowed to re-attempt the corresponding session management procedure for the same DNN in S1 mode after inter-system change.
NOTE 1: If the network includes this back-off timer value, then the UE is blocked from sending another 5GSM request for the same procedure for the same [PLMN, DNN, S-NSSAI], [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, S-NSSAI], or [PLMN, no DNN, no S-NSSAI] combination for the specified duration.
Therefore, the operator needs to exercise caution in determining the use of this timer value.
or in the USIM NAS CONFIG file to derive the re-attempt indicator as specified in subclauses and If re-attempt in S1 mode is allowed, the UE shall consider the back-off timer to be applicable only to the 5GS session management in N1 mode for the rejected 5GS session management procedure and the given [PLMN, DNN, S-NSSAI], [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, S-NSSAI], or [PLMN, no DNN, no S-NSSAI] combination.
If re- attempt in S1 mode is not allowed, the UE shall consider the back-off timer to be applicable to both NAS protocols, i.
applicable to the 5GS session management in N1 mode for the rejected 5GS session management procedure and to the EPS session management in S1 mode for the corresponding session management procedure and the given [PLMN, DNN] or [PLMN, no DNN] combination.
NOTE 3: In the present subclause the terms DNN and APN are referring to the same parameter.
The DNN and the S-NSSAI of the [PLMN, DNN, S-NSSAI] combination associated with the back-off timer is the DNN and the S-NSSAI provided by the UE when the PDU session is established.
If no DNN or no S-NSSAI was provided to the network during the PDU session establishment, then the back-off timer is associated with the [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, S-NSSAI], or [PLMN, no DNN, no S-NSSAI] combination, dependent on which parameters were provided.
For this purpose, the UE shall memorize the DNN and the S-NSSAI provided to the network during the PDU session establishment.
The back-off timer associated with the [PLMN, no DNN, no S-NSSAI] combination will never be started due to any 5GSM procedure related to an emergency PDU session.
If the back-off timer associated with the [PLMN, no DNN, no S-NSSAI] combination is running, it does not affect the ability of the UE to request an emergency PDU session.
the PLMN in which the UE received the 5GS session management reject message, but for each PLMN included in the equivalent PLMN list at the time when the 5GS session management reject message was received.
priority access in selected PLMN, then the UE is allo wed to initiate 5GSM procedures for the [PLMN, DNN, S- NSSAI], [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, S-NSSAI], or [PLMN, no DNN, no S-NSSAI] combination.
Neither the re-attempt indicator IE nor re-attempt indicator derivation shall be applicable in an SNPN.
3 Handling of Small data rate control Small data rate control is applicable only to NB-N1 mode and WB-N1 mode.
Small data rate control controls the maximum number of uplink user data messages including uplink exception data the PDU session is released.
If the UE indicates support for CIoT 5GS optimizations, the network may provide the small data rate control parameters to the UE and may provide the small data rate control parameters for exception data to the UE if and only if the small data rate control parameters is provided to the UE.
Small data rate control parameters and small data rate control parameters for exception data can also be provided to the UE in S1 mode as specified in 3GPP specification document .
for exception data reporting is not reached; or the additional small data rate control parameters for exception data is not provided, the UE is allowed to send uplink exception reports even if the limit for the small data rate control has been reached.
3GPP specification document .
a) the UE indicates support for CIoT 5GS optimizations; and b) the small data rate control status was stored for the PDU session and is still valid, the network may provide the remaining small data rate control status as initial small data rate control parameters to the and the initial small data rate control parameters for exception data for the duration of the validity period.
When the validity period expires the small data rate control parameters and the small data rate control parameters for exception data shall be applied (see 3GPP specification document\).
NOTE 1: The HPLMN can discard or delay user data that exceeds the limit provided for small data rate control.
Upon inter-system change from N1 mode to S1 mode, the UE shall store the current small data rate control status for PDU sessions to be transferred from N1 mode to S1 mode as specified in 3GPP specification document .
NOTE 2: How long the UE stores the current small data rate control status is implementation specific.
Upon inter-system change from S1 mode to N1 mode, the UE shall use the stored small data rate control status, if any, to comply with the small data rate control policy for PDU sessions transferred from S1 mode to N1 mode as specified in 3GPP specification document , if the validity period of the stored small data rate control status has not expired.
4 Handling of Serving PLMN rate control Serving PLMN rate control is applicable only for PDU sessions established for control plane CIoT 5GS optimization.
Serving PLMN rate control protect its AMF and the signalling radio bearers in the E-UTRA from the load generated by user data over control plane.
The SMF can inform the UE of any local serving PLMN ra te control during the PDU sess ion establishment procedure (see subclause\) or the PDU session modification procedure (see subclause\).
If serving PLMN rate control is enabled, the SMF shall start the serving PLMN rate control for the PDU session when the first control plane user data is received over the PDU session.
The UE shall limit the rate at which it generates uplink control plane user data to comply session the NAS procedure corresponds to, and the indicat ed rate is valid until the PDU session is released.
Any Serving PLMN rate control information provided by the network to the UE is only applicable for the PLMN which provided this information.
This serving PLMN rate control information shall be discarded when the UE successfully registers to another PLMN.
The Reliable Data Service may only be used with PDU sessions for which the "Control Plane CIoT 5GS Optimisation" indicator is set or with PDU sessions using the control plane CIoT 5GS optimization when the AMF does not move such PDU sessions to the user plane.
The network shall inform the UE about the acceptance of UE's request for Reliable Data Service usage during the PDU session establishment procedure (see subclause\) in the extended protocol configuration options IE.
If the network accepts the use of Reliable Data Service to tr ansfer data for the specified PDU session, the UE shall use this PDU session exclusively for data transfer using Reliable Data Service; otherwise the UE shall not use this PDU session for data transfer using Reliable Data Service.
6 Handling of header compression for control plane CIoT The UE and the SMF may use: IP header compression for PDU sessions of "IPv4", "IPv6" or "IPv4v6" PDU session type; and Ethernet header compression for PDU sessions of "Ethernet" PDU session type.
Both the UE and the AMF indicate whether header compression for control plane CIoT 5GS optimization is supported during registration procedures (see subclauses\).
If both the UE and the network support header compression, the header compression configuration for each PDU session is negotiated during the PDU session establishment procedure and PDU session modification procedure as specified in subclause , and For IP header compression, ROHC protocol specified in IETF RFC 5795 [39B] is used.
The IP header compression configuration used for IP header compression is (re-)ne gotiated between the UE and the SMF using the IP header compression configuration IE as specified in subclauses , , and , respectively.
For Ethernet header compression, Ethernet Header Compressi on (EHC) protocol specified in 3GPP specification document is used.
The Ethernet header compression configuration used for Ethernet header compression is (re-)negotiated between the UE and the SMF using the Ethernet header compression conf iguration IE as specified in subclauses , , PDU session authentication and authorization procedure.
The purpose of the PDU session authentication and authorization procedure is to enable the DN: a) to authenticate the upper layers of the UE, when establishing the PDU session; b) to authorize the upper layers of the UE, when establishing the PDU session; c) both of the above; or d) to re-authenticate the upper layers of the UE after establishment of the PDU session.
The PDU session authentication and authorization procedure can be performed only during or after the UE-requested procedure shall not be performed during or after the UE-req uested PDU session establishment procedure establishing an emergency PDU session.
EAP has defined four types of EAP messages: a) an EAP-request message; b) an EAP-response message; c) an EAP-success message; and d) an EAP-failure message.
The EAP-request message is transported from the network to the UE using the PDU SESSION AUTHENTICATION COMMAND message of the PDU EAP message reliable transport procedure.
The EAP-response message to the EAP-request message is transported from the UE to the network using the PDU SESSION AUTHENTICATION COMPLETE message of the PDU EAP message reliable transport procedure.
If the PDU session authentication and authorization pro cedure is performed during the UE-requested PDU session a) and the DN authentication of the UE completes successfully, the EAP-success message is transported from the network to the UE as part of the UE-requested PDU session establishment procedure in the PDU SESSION b) and the DN authentication of the UE completes unsuccessfully, the EAP-failure message is transported from the network to the UE as part of the UE-requested PDU session establishment procedure in the PDU SESSION ESTABLISHMENT REJECT message.
If the PDU session authentication and authorization pro cedure is performed after the UE-requested PDU session a) and the DN authentication of the UE completes successfully, the EAP-success message is transported from the network to the UE using the PDU SESSION AUTHENTICATION RESULT message of the PDU EAP result message transport procedure.
b) and the DN authentication of the UE completes unsuccessfully, the EAP-failure message is transported from the network to the UE using the PDU SESSION RELEASE COMMAND message of the network-requested PDU session release procedure.
The SMF shall set the authenticator retransmission timer specified in IETF RFC 3748 subclause to infinite messages and therefore retransmissions at the EAP layer of the SMF do not occur.
PDU SESSION AUTHENTICATION COMMAND 
T3590PDU SESSION AUTHENTICATION COMPLETE <EAP-response message to EAP-request message A> PDU SESSION AUTHENTICATION COMMAND PDU SESSION AUTHENTICATION COMPLETE <EAP-response message to EAP-request message B> PDU SESSION ESTABLISHMENT ACCEPT PDU SESSION ESTABLISHMENT REJECT PDU SESSION AUTHENTICATION RESULT PDU SESSION RELEASE COMMAND PDU session authentication and authorization procedure PDU EAP message reliable transport procedure PDU EAP message reliable transport procedure initiation The SMF shall set the PTI IE of the PDU SESSION AUTHENTICATION COMMAND message to "No procedure The SMF shall set the EAP message IE of the PDU SESSION AUTHENTICATION COMMAND message to the EAP- request message provided by the DN or generated locally.
The SMF shall send the PDU SESSION AUTHENTICATION COMMAND message, and the SMF shall start timer Upon receipt of the PDU SESSION AUTHENTICATION COMMAND message, if the UE provided an S-NSSAI and a DNN during the PDU session establishment, the UE shall stop timer T3584, if it is running for the same [S-NSSAI, Upon receipt of the PDU SESSION AUTHENTICATION COMMAND message, if the UE provided an S-NSSAI during the PDU session establishment, the UE shall stop timer T3585, if it is running for the S-NSSAI provided by the UE.
If the UE did not provide an S-NSSAI during the PDU session establishment, the UE shall stop the timer T3585 associated with no S-NSSAI if it is running.
established, timer T3396 associated with the DNN (or no DNN, if no DNN was provided by the UE) is running, and timer T3584 associated with the DNN (or no DNN, if no DNN was provided by the UE) and the S-NSSAI (or no S-NSSAI, if no S-NSSAI was provided by the UE) is running, then the UE stops both the timer T3396 and the timer T358 established, timer T3585 associated with the S-NSSAI (or no S-NSSAI, if no S-NSSAI was provided by the UE) is running, and timer T3584 associated with the DNN (or no DNN, if no DNN was provided by the UE) and the S-NSSAI (or no S-NSSAI, if no S-NSSAI was provided by the UE) is running, then the UE stops both the timer T3585 and the timer T358 DN is transparent to the 5GSM layer of the UE.
PDU EAP message reliable transport procedure accepted by the UE The UE shall set the EAP message IE of the PDU SESSION AUTHENTICATION COMPLETE message to the EAP- The UE shall transport the PDU SESSION AUTHENTICATION COMPLETE message and the PDU session ID, using the NAS transport procedure as specified in subclause Apart from this action, the authentication and authorization procedure initiated by the DN is transparent to the 5GSM layer of the UE.
provides the EAP message received in the EAP message IE of the PDU SESSION AUTHENTICATION COMPLETE message to the DN or handles it locally.
Abnormal cases on the network side The following abnormal cases can be identified: The SMF shall, on the first expiry of the timer T3590, retransmit the PDU SESSION AUTHENTICATION COMMAND message and shall reset and start timer T359 This retransmission is repeated four times, i.
on the fifth expiry of timer T3590, the SMF shall abort the procedure.
The following abnormal cases can be identified: a) PDU session inactive for the received PDU session ID.
If the PDU session ID in the PDU SESSION AUTHENTICATION COMMAND message belongs to any PDU 5GSM cause IE set to #43 "Invalid PDU session identity".
PDU session release procedure, and the PDU session indicated in PDU SESSION AUTHENTICATION COMMAND message is the PDU session that the UE had requested to release, the UE shall ignore the PDU SESSION AUTHENTICATION COMMAND message and proceed with the UE-requested PDU session release procedure.
PDU EAP result message transport procedure PDU EAP result message transport procedure initiation PDU EAP result message transport procedure is initiated by the SMF if the PDU session authentication and authorization procedure is performed after the PDU sess ion is established and the DN authentication of the UE The SMF shall set the PTI IE of the PDU SESSION AUTHENTICATION RESULT message to "No procedure The SMF shall set the EAP message IE of the PDU SESSION AUTHENTICATION RESULT message to the EAP- success message provided by the DN.
The SMF shall send the PDU SESSION AUTHENTICATION RESULT message.
transport procedure as specified in subclause , the UE passes to the upper layers the EAP message received in the EAP message IE of the PDU SESSION AUTHENTICATION RESULT message.
Apart from this action, the authentication and authorization procedure initiated by the DN is transparent to the 5GSM layer of the UE.
Network-requested PDU session modification procedure.
Network-requested PDU session modification procedure initiation If the authorized QoS rules of the PDU session is modified or is marked as to be synchronised with the UE, the SMF shall set the authorized QoS rules IE of the PDU SESSION MODIFICATION COMMAND message to the authorized QoS rules of the PDU session.
The SMF shall ensure that the number of the packet filters used in the authorized QoS rules of the PDU Session does not exceed the maximum number of packet filters supported by the UE for the PDU If the authorized QoS flow descriptions of the PDU session is modified or is marked as to be synchronised with the UE, the SMF shall set the authorized QoS flow descriptions IE of the PDU SESSION MODIFICATION COMMAND message to the authorized QoS flow descriptions of the PDU session.
description for that QoS flow in the authorized QoS flow descriptions IE of the PDU SESSION MODIFICATION b) the QFI of the new QoS flow is not the same as the 5QI of the QoS flow identified by the QFI; or c) the new QoS flow can be mapped to an EPS bearer as specified in subclause of 3GPP specification document .
If the session-AMBR of the PDU session is modified, the SMF shall set the selected Session-AMBR IE of the PDU SESSION MODIFICATION COMMAND message to the session-AMBR of the PDU session.
If interworking with EPS is supported for the PDU session and if the mapped EPS bearer contexts of the PDU session is modified, the SMF shall set the mapped EPS bearer co ntexts IE of the PDU SESSION MODIFICATION COMMAND IE of the PDU SESSION MODIFICATION COMMAND message to the new EPS bearer identity associated with the procedure and the PDU SESSION MODIFICATION REQUEST message includes a 5GSM capability IE, the SMF shall: a) if the RQoS bit is set to: 1) "Reflective QoS supported", consider that the UE supports reflective QoS for this PDU session; or 2) "Reflective QoS not supported", consider that the UE does not support reflective QoS for this PDU session; b) if the MHPDU bit is set to: 1) "Multi-homed IPv6 PDU session supported", consider that this PDU session is supported to use multiple 2) "Multi-homed IPv6 PDU session not supported", consider that this PDU session is not supported to use If the SMF considers that reflective QoS is supported for QoS flows belonging to this PDU session, the SMF may include the RQ timer IE set to an RQ timer value in the PDU SESSION MODIFICATION COMMAND message.
session requested IE in the PDU SESSION MODIFICATION REQUEST message (if available), that either: a) the requested PDU session needs to be an always-on PDU session, the SMF shall include the Always-on PDU session indication IE in the PDU SESSION MODIFICA TION COMMAND message and shall set the value to "Always-on PDU session required"; or b) the requested PDU session shall not be an always-on PDU session and: i) if the UE included the Always-on PDU session requested IE, the SMF shall include the Always-on PDU session indication IE in the PDU SESSION MODIFI CATION COMMAND message and shall set the value to "Always-on PDU session not allowed"; or ii) if the UE did not include the Always-on PDU session requested IE, the SMF shall not include the Always-on PDU session indication IE in the PDU SESSION MODIFICATION COMMAND message.
indication IE with the value set to "Always-on PDU session required" in the UE-requested PDU session establishment Always-on PDU session indication IE in the PDU SESSION MODIFICATION COMMAND message and shall set the value to "Always-on PDU session required".
this PDU session and remove the derived QoS rule(s) associated with the PDU session, if any.
the PDU SESSION MODIFICATION REQUEST message received as part of the UE-requested PDU session modification procedure.
modification procedure, the SMF shall set the PTI IE of the PDU SESSION MODIFICATION COMMAND message to "No procedure transaction identity assigned".
If the selected SSC mode of the PDU session is "SSC mode 3" and the SMF requests the relocation of SSC mode 3 PDU session anchor with multiple PDU sessions as specified in 3GPP specification document , the SMF shall include 5GSM cause #39 "reactivation requested" , in the PDU SESSION MODIFICATION COMMAND message, and may include configuration options IE of the PDU SESSION MODIFICATION COMMAND message.
The SMF shall send the PDU SESSION MODIFICATION COMMAND message, and the SMF shall start timer T3591 (see example in figure\).
NOTE: If the SMF requests the relocation of SSC mode 3 PDU session anchor with multiple PDU sessions as specified in 3GPP specification document , the reallocation re quested indication indicating whether the SMF is to be reallocated or the SMF is to be reused is provided to the AMF.
IE was included in the PDU SESSION ESTABLISHMENT REQUEST message, and the SMF supports control plane CIoT 5GS optimization and IP header compression for control plane CIoT 5GS optimization, the SMF may include the IP header compression configuration IE in the PDU SESSION MODIFICATION COMMAND message to re-negotiate IP header compression configuration associated to the PDU session.
configuration IE was included in the PDU SESSION ESTABLISHMENT REQUEST message, and the SMF supports control plane CIoT 5GS optimization and Ethernet header compression for control plane CIoT 5GS optimization, the SMF may include the Ethernet header compression configuration IE in the PDU SESSION MODIFICATION COMMAND message to re-configure Ethernet header compression configuration associated with the PDU session.
PDU SESSION MODIFICATION COMPLETEPDU SESSION MODIFICATION COMMAN.
PDU SESSION MODIFICATION COMMAND REJECTStop T3591OR Network-requested PDU session modification procedure Network-requested PDU session modification procedure accepted by the UE PDU session establishment, the UE shall stop timer T3396, if it is running for the DNN provided by the UE.
If the UE emergency request" and different from "existing emergency PDU session", the UE shall stop the timer T3396 associated with no DNN if it is running.
If the PDU SESSION MODIFICATION COMMAND message was received for an emergency PDU session, the UE shall not stop the timer T3396 associated with no DNN if it is running.
Upon receipt of the PDU SESSION MODIFICATION COMM AND message, if the UE provided an S-NSSAI and a DNN during the PDU session establishment, the UE shall stop timer T3584, if it is running for the [S-NSSAI of the PDU session, DNN] combination provided by the UE.
If the UE did not provide an S-NSSAI during the PDU session Upon receipt of the PDU SESSION MODIFICATION COMMAND message, if the UE provided an S-NSSAI during the PDU session establishment, the UE shall stop timer T3585, if it is running for the S-NSSAI of the PDU session.
If the UE did not provide an S-NSSAI during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop the timer T3585 associated with no S-NSSAI if it is running.
If the PDU SESSION MODIFICATION COMMAND message was received for an emergency PDU session, the UE shall not stop the timer T3585 associated with no S-NSSAI if it is running.
Editor’s note [CR#2326, WID 5GProtoc]: For all the cases in this subclause, changes to the handling of the timer T3584 and T3585 for the scenario when the UE provided no S-NSSAI during PDU session establishment are FFS.
If the PDU SESSION MODIFICATION COMMAND message incl udes the Mapped EPS bearer contexts IE, the UE shall process the mapped EPS bearer contexts sequentia lly starting with the first mapped EPS bearer context.
If the PDU SESSION MODIFICATION COMMAND message includes the Authorized QoS flow descriptions IE, the UE shall process the QoS flow descriptions sequentially starting with the first QoS flow description.
The UE shall replace the stored authorized QoS rules, authorized QoS flow descriptions and session-AMBR of the PDU session with the received value(s), if any, in the PDU SESSION MODIFICATION COMMAND message.
shall check each mapped EPS bearer context for different types of errors as follows: rules IE and Authorized QoS flow descriptions IE included in the PDU SESSION MODICATION COMMAND message, if any.
a) Semantic error in the mapped EPS bearer operation: 1) operation code = "Create new EPS bearer" and there is already an existing mapped EPS bearer context with the same EPS bearer identity associated with any PDU session.
same EPS bearer identity associated with the PDU session that is being modified.
3) operation code = "Modify existing EPS bearer" and there is no existing mapped EPS bearer context with the same EPS bearer identity associated with the PDU session that is being modified.
4) operation code = "Create new EPS bearer" or "Modify existing EPS bearer" and the resulting mapped EPS In case 1, if the existing mapped EPS bearer context is associated with the PDU session that is being modified, the UE shall not diagnose an error, further process the create request and, if it was process successfully, delete the old EPS bearer context.
In case 2, the UE shall not diagnose an error, further process the delete request and, if it was processed successfully, consider the mapped EPS bearer context as successfully deleted.
Otherwise, after sending the PDU SESSSION MODIFICATION COMPLETE for the ongoing PDU session #85 "Invalid mapped EPS bearer identity".
different types of TFT IE errors as follows: 2) Semantic errors in TFT operations: In case iv, after sending the PDU SESSSION MODIFICATION COMPLETE for the ongoing PDU session successfully, delete the old TFT.
In case ii, the UE shall: process the new request and if the TFT operation is "Delete existing TFT" or "Delete packet filters from process the new request as an activation request, if the TFT operation is "Add packet filters in existing TFT" or "Replace packet filters in existing TFT".
REQUEST message to delete the mapped EPS bearer context with 5GSM cause #41 "semantic error in the TFT operation".
In case iii, if the packet filters belong to the default EPS bearer context, the UE shall process the new deletion 2) Syntactical errors in TFT operations: filters in existing TFT" or "Delete packet filters from existing TFT" and the packet filter list in the TFT IE is empty.
iii) TFT operation = "Replace packet filters in existing TFT" when the packet filter to be replaced does not exist in the original TFT.
iv) TFT operation = "Delete packet filters from existing TFT" when the packet filter to be deleted does not exist in the original TFT.
the number of packet filters subfield, and the number of packet filters in the packet filter list.
In case iii, the UE shall not diagnose an error, further process the replace request and, if no error according to In case iv, the UE shall not diagnose an error, further process the deletion request and, if no error according Otherwise, after sending the PDU SESSSION MODIFICATION COMPLETE for the ongoing PDU session #42 "syntactical error in the TFT operation".
3) Semantic errors in packet filters: packet filter is outside the scope of the present document.
filter applicable for the uplink direction among the packet filters created on request from the network.
#44 "semantic errors in packet filter(s)".
4) Syntactical errors in packet filters: filters in existing TFT" and two or more packet filters in the resultant TFT would have identical packet filters in existing TFT", and two or more packet filters among all TFTs associated with this PDN connection would have identical packet filter precedence values.
iii) When there are other types of syntactical errors in the coding of packet filters, such as the use of a #45 "syntactical error in packet filter(s)".
Otherwise, the UE shall not diagnose an error, further process the new request and, if it was processed successfully, delete the old packet filters which have the identical packet filter identifiers.
an error, shall further process the new request and, if it was processed successfully, shall delete the old packet filters which have identical filter precedence values.
In case ii, if one or more old packet filters belong to the default EPS bearer context, after sending the PDU REQUEST message to delete the mapped EPS bearer context with 5GSM cause #45 "syntactical errors in packet filter(s)".
Otherwise, after sending the PDU SESSSION MODIFICATION COMPLETE for the ongoing PDU session #45 "syntactical error in packet filter(s)".
can be transferred to EPS, the UE shall update the as sociation between the QoS flow and the mapped EPS bearer context, based on the new EPS bearer identity and the mapped EPS bearer contexts.
If the "Delete existing EPS bearer" operation code in the Mapped EPS bearer contexts IE was re ceived, the UE shall discard the association between the QoS flow and the corresponding mapped EPS bearer context.
a) the UE detects different errors in the mapped EPS bear er contexts as described above which requires sending a PDU SESSION MODIFICATION REQUEST message to delete the erroneous mapped EPS bearer contexts; and b) optionally, if the UE detects errors in QoS rules that require to delete at least one QoS rule as described in the UE, after sending the PDU SESSSION MODIFICATION COMPLETE message for the ongoing PDU session erroneous mapped EPS bearer contexts, and optionally to dele te the erroneous QoS rules.
The UE shall include a 5GSM cause IE in the PDU SESSION MODIFICATION REQUEST message.
NOTE 4: The 5GSM cause to use cannot be different from #41 "semantic error in the TFT operation", #42 "syntactical error in the TFT operation", #44 "semantic error in packet filter(s)", #45 "syntactical errors in packet filter(s)", #83 "semantic error in the QoS operation", #84 "syntactical error in the QoS operation", or #85 "Invalid mapped EPS bearer identity".
The selection of a 5GSM cause is up to UE implementation.
If the PDU SESSION MODIFICATION COMMAND message cont ains the PTI value allocated in the UE-requested PDU session modification procedure, the UE shall stop the timer T358 The UE should ensure that the PTI value assigned to this procedure is not released immediately.
NOTE 5: The way to achieve this is implementation dependen t.
For example, the UE can ensure that the PTI value assigned to this procedure is not released during the time equal to or greater than the default value of While the PTI value is not released, the UE regards any received PDU SESSION MODIFICATION COMMAND If the selected SSC mode of the PDU session is "SSC mode 3" and the PDU SESSION MODIFICATION COMMAND address lifetime if received in the PDU session address lifeti me PCO parameter of the Extended protocol configuration options IE of the PDU SESSION MODIFICATION COMMAND message.
After the completion of the network- requested PDU session modification procedure, the UE should re-initiate the UE-requested PDU session establishment a) the PDU session type associated with the present PDU session; b) the SSC mode associated with the present PDU session; c) the DNN associated with the present PDU session; and d) the S-NSSAI associated with (if available in roaming scenarios) a mapped S-NSSAI if provided in the UE- requested PDU session establishment procedure of the present PDU session.
small data rate control parameters value for the PDU session with the received small data rate control parameters value in the Extended protocol configuration options IE in the PDU SESSION MODIFICATION COMMAND message.
If the UE has indicated support for CIoT 5GS optimizatio ns and receives an additional small data rate control parameters for exception data container in the Extended protocol configuration options IE in the PDU SESSION MODIFICATION COMMAND message, the UE shall store the additional small data rate control parameters for exception data value and use the stored additional small data rate control parameters for exception data value as the The UE shall include the PDU session ID of the old PDU session which is about to get released in the old PDU session ID IE of the UL NAS TRANSPORT message that transports the PDU SESSION ESTABLISHMENT REQUEST message.
NOTE 6: The UE is expected to maintain the PDU session for which the PDU SESSION MODIFICATION COMMAND message including 5GSM cause #39 "reactivation requested" is received during the time indicated by the PDU session address lifetime value or until receiving an indication from upper layers (e.
that the old PDU session is no more needed).
flow descriptions IE of the PDU SESSION MODIFICATI ON COMMAND message contains an EPS bearer identity (EBI), then the UE shall locally remove the EPS bearer identity (EBI) from the parameters list field of such one or more If the selected PDU session type of the PDU session is "Ethernet", the UE supports inter-system change from N1 mode MODIFICATION COMMAND message contains an EPS bearer id entity (EBI), the UE shall locally remove the EPS bearer identity (EBI) from the parameters list field of such one or more authorized QoS flow descriptions.
After sending the PDU SESSION MODIFICATION COMPLETE message for the ongoing PDU session modification procedure, the If the Always-on PDU session indication IE is included in the PDU SESSION MODIFICATION COMMAND message a) the value of the IE is set to "Always-on PDU session required", the UE shall consider the established PDU session as an always-on PDU session; or b) the value of the IE is set to "Always-on PDU session not allowed", the UE shall not consider the established PDU session as an always-on PDU session.
If the UE does not receive the Always-on PDU sess ion indication IE in the PDU SESSION MODIFICATION 1) if the UE has received the Always-on PDU session indication IE with the value set to "Always-on PDU session required" for this PDU session, the UE shall consider the PDU session as an always-on PDU session; or 2) otherwise the UE shall not consider the PDU session as an always-on PDU session.
UE shall store the Serving PLMN rate control IE value, re placing any existing value, and use the stored serving PLMN rate control value as the maximum allowed limit of uplink control plane user data for the corresponding PDU session in accordance with 3GPP specification document .
The UE shall transport the PDU SE SSION MODIFICATION COMPLETE message and the PDU session ID, using the NAS transport procedure as specified in subclause After sending the PDU SESSION MODIFICATION COMPLETE message, if the "Create new EPS bearer" operation MODIFICATION COMMAND message nor an existing QoS flow description corresponding to the EPS bearer identity consider the PDU session as modified.
If the selected SSC mode of the PDU session is "SSC mode 3" and the PDU Network-requested PDU session modification procedure not accepted by the If the PDU SESSION MODIFICATION COMMAND message cont ains the PTI value allocated in the UE-requested PDU session modification procedure, the UE shall stop the timer T358 The UE should ensure that the PTI value assigned to this procedure is not released immediately.
NOTE 1: The way to achieve this is implementation dependent.
For example, the UE can ensure that the PTI value assigned to this procedure is not released during the time equal to or greater than the default value of indicate the reason for rejecting the PDU session modification.
The 5GSM cause IE typically indicates one of the following 5GSM cause values: #26 insufficient resources; #43 invalid PDU session identity; #44 semantic error in packet filter(s); #45 syntactical error in packet filter(s); #83 semantic error in the QoS operation; or #84 syntactical error in the QoS operation.
If the selected SSC mode of the PDU session is "SSC mode 3" and the PDU SESSION MODIFICATION COMMAND messages includes 5GSM cause #39 "reactivation requested", while the UE does not have sufficient resources for initiating the PDU session establishment procedure as specified in subclause then the UE shall set cause IE to #26 a request to modify the authorized QoS rules, or both, and the UE decides to reject the request due to e.
the supported maximum number, then the UE shall set the 5GSM cause IE to #26 "insufficient resources".
SESSION MODIFICATION COMMAND message, then the Authorized QoS rules IE, the Authorized QoS flow descriptions IE and the Mapped EPS bearer contexts IE included in the PDU SESSION MODIFICATION COMMAND message are discarded, if any.
a) Semantic errors in QoS operations: 1) When the rule operation is "Modify existing QoS rule and add packet filters", "Modify existing QoS rule and replace all packet filters", "Modify existing QoS rule and delete packet filters" or "Modify existing QoS rule without modifying packet filters" on the default QoS rule and the DQR bit is set to "the QoS rule is not the default QoS rule".
2) When the rule operation is "Modify existing QoS rule and add packet filters", "Modify existing QoS rule and 3) When the rule operation is "Create new QoS rule" and the DQR bit is set to "the QoS rule is the default QoS 4) When the rule operation is "Delete existing QoS rule" on the default QoS rule.
5) When the rule operation is "Create new QoS rule", "Modify existing QoS rule and add packet filters", "Modify existing QoS rule and replace all packet filters", "Modify existing QoS rule and delete packet filters ", or "Modify existing QoS rule without modifying packet filters" and two or more QoS rules associated with this PDU session would have identical precedence values, and the UE is not in NB-N1 mode.
a PDU session of IPv4, IPv6, IPv4v6 or Ethernet PDU session type, and the packet filter list in the resultant QoS rule is empty.
7) When the rule operation is "Create new QoS rule", th ere is already an existing QoS rule with the same QoS rule identifier and the UE is not in NB-N1 mode.
8) When the rule operation is "Modify existing QoS rule and add packet filters", "Modify existing QoS rule and replace all packet filters", "Modify existing QoS rule and delete packet filters" or "Modify existing QoS rule without modifying packet filters", the associated QoS rule does not exist and the UE is not in NB-N1 mode.
9) When the rule operation is different than "Delete existing QoS rule", the DQR bit of the QoS rule is set to "the QoS rule is not the default QoS rule" and the UE is in NB-N1 mode.
10) When the rule operation is "Delete existing QoS rule" and there is no existing QoS rule with the same QoS flow description with the same QoS flow identifier and the UE is not in NB-N1 mode.
12) When the flow description operation is "Modify ex isting QoS flow description", the associated QoS flow description does not exist and the UE is not in NB-N1 mode.
13) When the flow description operation is "Delete existi ng QoS flow description" and there is no existing QoS flow description with the same QoS flow identifier.
14) When the flow description operation is different than "Delete existing QoS flow description", the QFI is not the same as the QFI of the default QoS rule and the UE is in NB-N1 mode.
REQUEST message with 5GSM cause #83 "semantic error in the QoS operation".
In case 5, if the old QoS rule (i.
the QoS rule that existed before the PDU SESSION MODIFICATION COMMAND message was received) is not the default QoS rule, the UE shall not diagnose an error, shall further process the new request and, if it was processed successful ly, shall delete the old QoS rule which has identical precedence value.
Furthermore, after sending the PDU SESSSION MODIFICATION COMPLETE for the In case 5, if the old QoS rule (i.
the QoS rule that existed before the PDU SESSION MODIFICATION In case 6, if the QoS rule is not the default QoS rule, after sending the PDU SESSSION MODIFICATION In case 7, if the existing QoS rule is not the default QoS rule and the DQR bit of the new QoS rule is set to "the QoS rule is not the default QoS rule", the UE shall not diagnose an error, further process the create request and, if it was processed successfully, delete the old QoS rule.
If the existing QoS rule is the default QoS rule or the DQR bit of the new QoS rule is set to "the QoS rule is the default QoS rule", the UE shall reject the PDU SESSION MODIFICATION COMMAND message with 5GSM cause #83 "semantic error in the QoS operation".
In case 9, after sending the PDU SESSSION MODIFICATION COMPLETE for the ongoing PDU session cause #83 "semantic error in the QoS operation" to delete the QoS rule.
In case 10, the UE shall not diagnose an error, further process the delete request and, if it was processed successfully, consider the respective QoS rule as successfully deleted.
In case 11, the UE shall not diagnose an error, further process the create request and, if it was processed successfully, delete the old QoS flow description.
In case 13, the UE shall not diagnose an error, further process the delete request and, if it was processed successfully, consider the respective QoS flow description as successfully deleted.
In case 14, after sending the PDU SESSSION MODIFICATION COMPLETE for the ongoing PDU session cause #83 "semantic error in the QoS operation" to delete the QoS flow description.
Otherwise, the UE shall reject the PDU SESSION MODIFICATION COMMAND message with 5GSM cause #83 "semantic error in the QoS operation".
b) Syntactical errors in QoS operations: 1) When the rule operation is "Create new QoS rule", "Modify existing QoS rule and add packet filters", "Modify existing QoS rule and replace all packet filters" or "Modify existing QoS rule and delete packet filters" and the packet filter list in the QoS rule is empty.
2) When the rule operation is "Delete existing QoS rule" or "Modify existing QoS rule without modifying deleted does not exist in the original QoS rule.
between the number of packet filters subfield, and the number of packet filters in the packet filter list.
A) rule operation is "Create new QoS rule", "Modify existing QoS rule and add packet filters", "Modify existing QoS rule and replace all packet filters", "Modify existing QoS rule and delete packet filters" or 7) When the flow description operation is "Create new QoS flow description" or "Modify existing QoS flow In case 3 the UE shall not diagnose an error, further process the deletion request and, if no error according to In case 6, if the QoS rules IE contains at least one other valid QoS rule, the UE shall not diagnose an error and PDU session modification procedure, the UE shall delete the QoS rule for which no corresponding QoS flow description is available and initiate UE requested PDU session modification procedure with 5GSM cause #84 "syntactical error in the QoS operation" to delete the QoS rule for which it has deleted.
In case 7, if the default QoS rule is associated with the QoS flow description which lacks at least one of the or the QoS flow description IE contains at least one other valid QoS flow description, the UE shall not diagnose completion of the PDU session modification procedure, the UE shall delete the QoS flow description which lacks at least one of the mandatory parameters and the associated QoS rule(s), if any, and initiate UE requested PDU session modification procedure with 5GSM cause #84 "syntactical error in the QoS operation" to delete the QoS flow description and the associated QoS rule(s), if any, which it has deleted.
Otherwise the UE shall reject the PDU SESSION MODIFICATION COMMAND message with 5GSM cause #84 "syntactical error in the QoS operation".
c) Semantic errors in packet filters: The UE shall reject the PDU SESSION MODIFICATION COMMAND message with 5GSM cause #44 "semantic error in packet filter(s)".
d) Syntactical errors in packet filters: 1) When the rule operation is "Create new QoS rule", "Modify existing QoS rule and add packet filters" or "Modify existing QoS rule and replace all packet filters", and two or more packet filters in the resultant QoS rule would have identical packet filter identifiers.
In case 1, if two or more packet filters with identical packet filter identifiers are contained in the PDU SESSION MODIFICATION COMMAND message, the UE sh all reject the PDU SESSION MODIFICATION COMMAND with 5GSM cause #45 "syntactical errors in packet filter(s)".
Otherwise, the UE shall not diagnose an error, further process the PDU SESSION MODIFI CATION COMMAND message and, if it was processed successfully, replace the old packet filter with the new packet filter which have the identical packet filter identifiers.
Otherwise the UE shall reject the PDU SESSION MODIFICATION COMMAND message with 5GSM cause #45 "syntactical errors in packet filter(s)".
b) optionally, if the UE detects different errors in the mapped EPS bearer contexts as described in subclause erroneous QoS rules, and optionally to delete the erroneous mapped EPS bearer contexts.
The UE shall include a 5GSM cause IE in the PDU SESSION MODIFICATION REQUEST message.
NOTE 5: The 5GSM cause to use cannot be different from #41 "semantic error in the TFT operation", #42 "syntactical error in the TFT operation", #44 "semantic error in packet filter(s)", #45 "syntactical errors in packet filter(s)", #83 "semantic error in the QoS operation", #84 "syntactical error in the QoS operation", or #85 "Invalid mapped EPS bearer identity".
The selection of a 5GSM cause is up to UE implementation.
The UE shall transport the PDU SESSION MODIFICATION COMMAND REJECT message and the PDU session ID, using the NAS transport procedure as specified in subclause than #43 "invalid PDU session identity" in state PDU SESSION MODIFICATION PENDING, the SMF shall stop timer T3591, enter the state PDU SESSION ACTIVE and abort the PDU session modification procedure.
Abnormal cases on the network side The following abnormal cases can be identified: a) Expiry of timer T359 On the first expiry of the timer T3591, the SMF shall resend the PDU SESSION MODIFICATION COMMAND message and shall reset and restart timer T359 This retransmission is repeated four times, i.
on the fifth expiry of timer T3591, the SMF shall abort the procedure and enter the state PDU SESSION ACTIVE.
The SMF may continue to use the previous configuration of the PDU session or initiate the network-requested PDU session release procedure.
If the SMF decides to co ntinue to use the previous configuration of the PDU i) the authorized QoS rules IE is included in the PDU SESSION MODIFICATION COMMAND message, the SMF may mark the corresponding authorized QoS rule(s) of the PDU session as to be synchronised with the ii) the authorized QoS flow descriptions IE is included in the PDU SESSION MODIFICATION COMMAND message, the SMF may mark the corresponding authorized QoS flow description(s) of the PDU session as to be synchronised with the UE.
b) Invalid PDU session identity.
Upon receipt of the PDU SESSION MODIFICATION COMMAND REJECT message including 5GSM cause #43 "invalid PDU session identity", the SMF shall release locally the existing PDU session.
c) Collision of UE-requested PDU session release procedure and network-requested PDU session modification session modification procedure, and the PDU sessi on indicated in the PDU SESSION RELEASE REQUEST message is the PDU session that the SMF had requested to modify, the SMF shall abort the PDU session modification procedure and proceed with the UE -requested PDU session release procedure.
d) Collision of UE-requested PDU session modification procedure and network-requested PDU session PDU session modification procedure, and the PDU se ssion indicated in the PDU SESSION MODIFICATION PDU SESSION MODIFICATION REQUEST message was received from the UE.
e) 5G access network cannot forward the message.
If the SMF determines based on content of the n2SmInfo attribute specified in 3GPP specification document [20A] that the DL NAS TRANSPORT message carrying the PDU SE SSION MODIFICATION COMMAND message was not forwarded to the UE by the 5G access network, then the SMF shall abort the procedure and enter the state PDU f) 5G access network cannot forward the message due to handover.
If the SMF determines based on content of the n2SmInfo attribute specified in 3GPP specification document [20A] that the DL NAS TRANSPORT message carrying the PDU SE SSION MODIFICATION COMMAND message was not forwarded to the UE by the 5G access network due to handover, then the SMF shall abort the procedure and enter the state PDU SESSION ACTIVE.
modification procedure when the SMF detects that the handover is completed successfully or has failed or at the expiry of the configured guard timer as specified in 3GPP specification document .
Abnormal cases in the UE The following abnormal cases can be identified: a) PDU session inactive for the received PDU session ID.
If the PDU session ID in the PDU SESSION MODIFICATION COMMAND message belongs to any PDU session in state PDU SESSION INACTIVE in the UE, the UE shall set the 5GSM cause IE to #43 "Invalid PDU session identity" in the 5GSM STATUS message, and set the PDU session ID to the received PDU session ID in the UL NAS TRANSPORT message as specified in subclause b) Collision of network-requested PDU session modification procedure and UE-requested PDU session session modification procedure, the PTI IE of the PDU SESSION MODIFICATION COMMAND message is set to "No procedure transaction identity assigned", and the PDU session indicated in the PDU SESSION and proceed with the network-requested PDU session modification procedure.
Network-requested PDU session release procedure.
Network-requested PDU session release procedure initiation The SMF shall set the 5GSM cause IE of the PDU SESSION RELEASE COMMAND message to indicate the reason for releasing the PDU session.
The 5GSM cause IE typically indicates one of the following 5GSM cause values: #8 operator determined barring; #29 user authentication or authorization failed; #36 regular deactivation; #38 network failure; #39 reactivation requested; #46 out of LADN service area; #67 insufficient resources for specific slice and DNN; #69 insufficient resources for specific slice.
If the selected SSC mode of the PDU session is "SSC mode 2" and the SMF requests the relocation of SSC mode 2 PDU session anchor with different PDU sessions as specified in 3GPP specification document , the SMF shall include 5GSM cause #39 "reactivation requested".
the SMF shall set the PTI IE of the PDU SESSION RELEASE COMMAND message to the PTI of the PDU SESSION RELEASE REQUEST message received as part of the UE-requested PDU session release procedure.
procedure, the SMF shall set the PTI IE of the PDU SESSION RELEASE COMMAND message to "No procedure Based on the local policy and user's subscription data, if the SMF decides to release the PDU session after determining: a) include the 5GSM cause value #39 "reactivation requested" in the 5GSM cause IE of the PDU SESSION RELEASE COMMAND message; or b) include a 5GSM cause value other than #39 "reactivation requested" in the 5GSM cause IE of the PDU SESSION RELEASE COMMAND message.
NOTE: The included 5GSM cause value is up to the network implementation.
If the SMF receives UE presence in LADN service area from the AMF indicating that the UE is out of the LADN service area and the SMF decides to release the PDU session, the SMF shall include the 5GSM cause value #46 "out of LADN service area" in the 5GSM cause IE of the PDU SESSION RELEASE COMMAND message.
Upon receipt of the 5GSM cause value #46 "out of LADN service area" in the 5GSM cause IE of the PDU SESSION RELEASE COMMAND message, the UE shall release the PDU session.
5GSM cause #69 "insufficient resources for specific slice" is included in the PDU SESSION RELEASE COMMAND message.
If the 5GSM cause value is #69 "insufficient resources for specific slice" and the PDU SESSION RELEASE to "initial emergency request" or "existing emergency PDU session" for the establishment of the PDU session, the The SMF shall send: a) the PDU SESSION RELEASE COMMAND message; and b) the N1 SM delivery skip allowed indication: 1) if the SMF allows the AMF to skip sending the N1 SM container to the UE and the 5GSM cause IE is not set to #39 "reactivation requested"; or 2) if the SMF allows the AMF to skip sending the N1 SM container to the UE and the Access type IE is not set to "3GPP access" or "non-3GPP access" towards the AMF, and the SMF shall start timer T3592 (see example in figure\).
PDU SESSION RELEASE COMPLETEPDU SESSION RELEASE COMMAN.
Network-requested PDU session release procedure Network-requested PDU session release procedure accepted by the UE SESSION RELEASE COMPLETE message.
If the PDU SESSION RELEASE COMMAND message contains the PTI value allocated in the UE-requested PDU session release procedure, the UE shall stop the timer T358 The UE should ensure that the PTI value assigned to this procedure is not released immediately.
NOTE 1: The way to achieve this is implementation dependent.
For example, the UE can ensure that the PTI value assigned to this procedure is not released during the time equal to or greater than the default value of While the PTI value is not released, the UE rega rds any received PDU SESSION RELEASE COMMAND message a) the PDU session type associated with the released PDU session; b) the SSC mode associated with the released PDU session; c) the DNN associated with the released PDU session; and d) the S-NSSAI associated with (if available in roaming scenarios) a mapped S-NSSAI if provided in the UE- requested PDU session establishment procedure of the released PDU session.
NOTE 2: User interaction is necessary in some cases when the UE cannot re-initiate the UE-requested PDU session If the PDU SESSION RELEASE COMMAND message is received without the Back-off timer value IE or includes 5GSM cause #39 "reactivation requested", and the UE provided an S-NSSAI during the PDU session establishment, the UE shall stop timer T3585 if it is running for the S-NSSAI provided by the UE.
If the UE did not provide an S-NSSAI during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop the timer T3585 associated with no S-NSSAI if it is running.
If the PDU SESSION RELEASE COMMAND message was received for an emergency PDU session, the UE shall not stop the timer T3585 associated with no S-NSSAI if it is running.
If the PDU SESSION RELEASE COMMAND message is received without the Back-off timer value IE or includes PDU SESSION RELEASE COMMAND message was received for an emergency PDU session, the UE shall not stop the timer T3396 associated with no DNN if it is running.
If the PDU SESSION RELEASE COMMAND message is received without the Back-off timer value IE or includes session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop the timer T3584 associated with [S-NSSAI of the PDU session, no DNN] combination, if it is running.
If the PDU SESSION RELEASE COMMAND message was received for an emergency PDU session, the UE shall not stop the timer T3584 associated with [S-NSSAI of the PDU session, no DNN] if it is was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop the timer T3584 associated with [no S-NSSAI, no DNN] if it is running.
If the PDU SESSION RELEASE COMMAND message was received for an emergency PDU session, the UE shall not stop the timer T3584 associated with [no S-NSSAI, no DNN] if it is running.
NOTE 3: If the PDU SESSION RELEASE COMMAND message is received without the Back-off timer value IE NOTE 4: If the PDU SESSION RELEASE COMMAND message is received without the Back-off timer value IE establishment, the UE shall stop timer T3396 associated with the corresponding DNN, if it is running.
If the timer value indicates neither zero nor deactivated and no DNN was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop timer T3396 associated with no DNN if it is running.
The UE shall then start timer T3396 with the value provided in the Back-off timer value IE and: MODIFICATION REQUEST message with exception of those identified in subclause , for the same DNN that was sent by the UE, until timer T3396 expires or timer T3396 is stopped; and DNN was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", until timer T3396 expires or timer T3396 is stopped.
establishment, the UE shall stop timer T3396 associated with the corresponding DNN, if it is running.
If the timer value indicates that this timer is deactivat ed and no DNN was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop timer T3396 associated with no DNN if it is running.
The UE: MODIFICATION REQUEST message with exception of those identified in subclause , for the same c) if the timer value indicates zero, the UE: ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message for the same DNN; and 2) if no DNN was provided during the PDU session establishment and the request type was different from procedure for emergency services.
If the timer T3396 is running when the UE enters state 5GMM-DEREGISTERED, the UE remains switched on, and the USIM in the UE remains the same, then timer T3396 is kept running until it expires or it is stopped.
switched on, the UE shall behave as follows: If the 5GSM cause value is #39 "reactivation requested", the UE shall ignore the Back-off timer value IE and Re-attempt indicator IE provided by the network, if any.
If the 5GSM cause value is #67 "insufficient resources for specific slice and DNN" and the Back-off timer value IE is included, the UE shall take different actions depending on the timer value received for timer T3584 in the Back-off UE during the PDU session establishment the UE shall stop timer T3584 associated with the [S-NSSAI of the PDU session, DNN] combination, if it is running.
If the timer value indicates neither zero nor deactivated, an S-NSSAI and no DNN was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop timer T3584 "existing emergency PDU session", the UE shall stop timer T3584 associated with the [no S-NSSAI, no DNN] combination, if it is running.
The UE shall then start timer T3584 with the value provided in the Back-off timer value IE.
1) The UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message with request type different from "initial emergency request" and different from "existing emergency PDU session", or PDU for the [S-NSSAI of the PDU session, DNN] combination, until timer T3584 expires or timer T3584 is 2) shall not send another PDU SESSION ESTABLISHMENT REQUEST message with request type different for the [S-NSSAI of the PDU session, no DNN] combination, if no DNN was provided during the PDU session establishment, until timer T3584 expires or timer T3584 is stopped; 3) shall not send another PDU SESSION ESTABLISHMENT REQUEST message, or another PDU SESSION MODIFICATION REQUEST message with the exception of those identified in subclause , for the same [no S-NSSAI, DNN] combination, if no S-NSSAI was provided during the PDU session establishment, until timer T3584 expires or timer T3584 is stopped; and 4) shall not send another PDU SESSION ESTABLISHMENT REQUEST message with request type different for the same [no S-NSSAI, no DNN] combination, if neither S-NSSAI nor DNN was provided during the PDU session establishment, until timer T3584 expires or timer T3584 is stopped.
shall not send another PDU SESSION ESTABLISHMENT REQUEST message with request type different from "initial emergency request" and different from "existing emergency PDU session", or PDU SESSION MODIFICATION REQUEST message with exception of those identified in subclause , for the [S- subclause , for the [S-NSSAI of the PDU session, no DNN] combination, if no DNN was provided removed, or the UE receives an PDU SESSION MODIFICATION COMMAND message for the [no S- 4) if neither S-NSSAI nor DNN were provided by the UE during the PDU session establishment, the UE shall emergency PDU session established for the [no S-NSSAI, no DNN] combination from the network.
c) if the timer value indicates zero: 1) if both S-NSSAI and DNN were provided by the UE during the PDU session establishment, the UE shall stop timer T3584 associated with the [S-NSSAI of the PDU session, DNN] combination, if running, and may send another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message for the [S-NSSAI of the PDU session, DNN] combination; the UE shall stop timer T3584 associated with the [S-NSSAI of the PDU session, no DNN] combination, if it is running.
The UE may send another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message for the [S-NSSAI of the PDU session, no DNN] combination if the request type was different from "initial emergency request" and different from "existing emergency PDU session"; may send another PDU SESSION ESTABLISHMENT REQUEST message, or PDU SESSION MODIFICATION REQUEST message for the [no S-NSSAI, DNN] combination; and 4) if neither S-NSSAI nor DNN were provided by the UE during the PDU session establishment, the UE shall stop timer T3584 associated with the [no S-NSSAI, no DNN] combination, if it is running.
The UE may send another PDU SESSION ESTABLISHMENT REQUEST message, or PDU SESSION MODIFICATION REQUEST message for the [no S-NSSAI, no DNN] combination if the request type was different from "initial emergency request" and different from "existing emergency PDU session".
If the 5GSM congestion re-attempt indicator IE set to "The back-off timer is applied in all PLMNs" is included in the PDU SESSION RELEASE COMMAND message with the 5GSM cause value #67 "insufficient resources for specific slice and DNN", then the UE shall apply the timer T3584 for all the PLMNs.
Otherwise, the UE shall apply the timer T3584 for the registered PLMN.
If the 5GSM cause value is #67 "insufficient resources for specific slice and DNN" and the Back-off timer value IE is not included, then the UE may send another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message for the same [S-NSSAI, DNN] combination.
procedure for emergency services.
If the timer T3584 is running when the UE enters state 5GMM-DEREGISTERED, the UE remains switched on, and the USIM in the UE remains the same, then timer T3584 is kept running until it expires or it is stopped.
switched on, the UE shall behave as follows: If the 5GSM cause value is #69 "insufficient resources for specific slice" and the Back-off timer value IE is included, the UE shall take different actions depending on the timer value received for timer T3585 in the Back-off timer value: a) If the timer value indicates neither zero nor deactivat ed and an S-NSSAI was provided during the PDU session establishment, the UE shall stop timer T3585 associated with the S-NSSAI of the PDU session, if it is running.
If the timer value indicates neither zero nor deactivated and no S-NSSAI was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop timer T3585 associated with no S-NSSAI if it is running.
The UE shall then start timer T3585 with the value provided in the Back-off timer value IE and: 1) if an S-NSSAI was provided by the UE during the PDU session establishment, the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message , or PDU SESSION MODIFICATION REQUEST message with exception of those identified in subclause , for the S-NSSAI of the PDU session, until timer T3585 expires or timer T3585 is stopped; and 2) if the request type was different from "initial emergency request" and from "existing emergency PDU b) if the timer value indicates that this timer is deac tivated and an S-NSSAI was provided during the PDU session establishment, the UE shall stop timer T3585 associated with the S-NSSAI of the PDU session, if it is running.
If the timer value indicates that this timer is deactivated and no S-NSSAI was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing 1) if an S-NSSAI was provided by the UE during the PDU session establishment, the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST, or PDU SESSION MODIFICATION REQUEST with exception of those identified in subclause , for the S-NSSAI of the PDU session until the UE is Back-off timer value IE or including 5GSM cause #39 "reactivation requested" for the S-NSSAI of the PDU session from the network; and 2) if the request type was different from "initial emergency request" and from "existing emergency PDU session", and an S-NSSAI was not provided by the UE during the PDU session establishment, the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message without an S-NSSAI and with c) if the timer value indicates zero: 1) if an S-NSSAI was provided by the UE during the PDU session establishment, the UE shall stop timer T3585 associated with the S-NSSAI of the PDU session, if running, and may send another PDU SESSION ESTABLISHMENT REQUEST, or PDU SESSION MODIFICATION REQUEST message for the S-NSSAI of the PDU session; and 2) if no S-NSSAI was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop timer T3585 associated with no S-NSSAI, if running, and may send another PDU SESSION ESTABLISHMENT REQUEST message without an S-NSSAI, or an other PDU SESSION MODIFICATION REQUEST message without an S-NSSAI provided by the UE.
Editor’s note [CR#2326, WID 5GProtoc]: For all the cases in this subclause, changes to the handling of the timers T3584 and T3585 for the scenario when the UE provided no S-NSSAI during PDU session establishment are FFS.
If the 5GSM congestion re-attempt indicator IE set to "The back-off timer is applied in all PLMNs" is included in the PDU SESSION RELEASE COMMAND message with the 5GSM cause value #69 "insufficient resources for specific slice", then the UE shall apply the timer T3585 for all the PLMNs.
Otherwise, the UE shall apply the timer T3585 for If the 5GSM cause value is #69 "insufficient resources for specific slice" and the Back-off timer value IE is not included, then the UE may send another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message for the same S-NSSAI or without an S-NSSAI.
procedure for emergency services.
If the timer T3585 is running when the UE enters state 5GMM-DEREGISTERED, the UE remains switched on, and the USIM in the UE remains the same, then timer T3585 is kept running until it expires or it is stopped.
switched on, the UE shall behave as follows: SESSION MODIFICATION REQUEST message in the PLMN for the same S-NSSAI and optionally the ESTABLISHMENT REQUEST message for the same S-NSSAI in the new PLMN.
Upon receipt of the PDU SESSION RELEASE COMMAND with the Access type IE, the UE shall behave as follows: a) if the PDU session is an MA PDU session established and has user-plane resources established on both 3GPP access and non-3GPP access, the UE shall consider the user-plane resources on the access indicated in the b) if the PDU session is an MA PDU session and has user-plane resources established on only the access indicated The UE shall transport the PDU SESSION RELEASE COMPLETE message and the PDU session ID, using the NAS transport procedure as specified in subclause the PDU session as released.
N1 SM delivery skipped If the PDU SESSION RELEASE COMMAND message was sent along the N1 SM delivery skip allowed indication towards AMF, then upon receipt of an indication that N1 SM delivery was skipped, the SMF shall stop timer T3592 and shall consider the PDU session as released.
Abnormal cases on the network side The following abnormal cases can be identified: a) Expiry of timer T359 The SMF shall, on the first expiry of the timer T3592, retransmit the PDU SESSION RELEASE COMMAND message and shall reset and start timer T359 This retransmission is repeated four times, i.
on the fifth expiry of timer T3592, the SMF shall abort the procedure.
b) Collision of network-requested PDU session release procedure and UE-requested PDU session modification MODIFICATION REQUEST message and proceed with the PDU session release procedure.
c) Collision of network-requested PDU session release procedure and UE-requested PDU session release RELEASE COMMAND message to the UE, and the PDU session ID in the PDU SESSION RELEASE REQUEST message is the same as the PDU session ID in the PDU SESSION RELEASE COMMAND message, the SMF shall ignore the PDU SESSION RELEASE REQUEST message and proceed with the network-requested PDU session release procedure.
The following abnormal cases can be identified: a) PDU session inactive for the received PDU session ID.
If the PDU session ID in the PDU SESSION RELEASE COMMAND message belongs to any PDU session in state PDU SESSION INACTIVE in the UE, the UE shall include the 5GSM cause #43 "Invalid PDU session identity" in the 5GSM STATUS message, and set the PDU session ID to the received PDU session ID in the UL NAS TRANSPORT message as specified in subclause b) User-plane resources of the MA PDU session on the access indicated in the Access type IE not established.
from the access indicated in the Access type IE, the UE sh all not diagnose an error, further process the release type IE as successfully released.
perform handover of an existing PDU session between 3GPP access and non-3GPP access, to transfer an existing PDN connection in the EPS to the 5GS, to transfer an existing PDN connection in an untrusted non-3GPP access connected to the EPC to the 5GS, or to establish an MA PDU se ssion to support ATSSS (see 3GPP specification document [13B]).
If accepted by the network, the PDU session enables exchange of PDUs between the UE and the DN.
"activated" and the UE is not using the PDU session to se nd uplink IP packets for any of the 3GPP PS data off exempt services (see subclause 0); c) when the UE is in NB-N1 mode, the UE has indicated preference for user plane CIoT 5GS optimization, the network has accepted the use of user plane CIoT 5GS optimization for the UE, and the UE currently has user- plane resources established for two other PDU sessions; control plane CIoT 5GS optimization, the network has accepted the use of control plane CIoT 5GS optimization for the UE, and the Control plane only indication IE was received in the PDU SESSION ESTABLISHMENT ACCEPT message; or has indicated preference for user plane CIoT 5GS optimi zation, the network has accepted the use of user plane CIoT 5GS optimization for the UE, and the number of PDU sessions that currently has user-plane resources established equals to the UE's maximum number of supported user-plane resources.
UE-requested PDU session establishment procedure initiation NOTE 0: When IMS voice is available over either 3GPP access or non-3G PP access, the "voice centric" UE in IMS signalling, if the conditions for performing an initial registration with IMS indicated in REQUEST message to the allocated PTI value.
emergency PDU session over the current access.
If the UE is registered for emergency services over the current access it shall not request establishing an emergency PDU session over the non-current access except if the request is for transferring the emergency PDU session to the non-current access.
Before transferring an emergency PDU session from supported in the NG-RAN cell (either an NR cell or an E-UTRA cell) on which the UE is camping.
NOTE 1: Transfer of an existing emergency PDU sessi on or PDN connection for emergency bearer services between 3GPP access and non-3GPP access is needed e.
if the UE determines that the current access is no longer available.
type IE in the PDU SESSION ESTABLISHMENT REQUEST message and shall set the IE to one of the following values: the IP version capability as specified in subclause , "Ethernet" or "Unstructured" based on the URSP rules or based on UE local configuration (see 3GPP specification document\).
NOTE 2: When the UE initiates the UE-requested PDU session establishment procedure to transfer an existing non- IP PDN connection in the EPS to the 5GS, the UE can use locally available information associated with the PDN connection to select the PDU session type between "Ethernet" and "Unstructured".
shall set the SSC mode IE of the PDU SESSION ESTABLISHMENT REQUEST message to the SSC mode.
If the UE to the 5GS or the UE requests transfer of an existing PDN connection in an untrusted non-3GPP access connected to the EPC to the 5GS, the UE shall set the SSC mode IE to "SSC mode 1".
ESTABLISHMENT REQUEST message to "SSC mode 1".
The UE should set the RQoS bit to "Reflective QoS supported" in the 5GSM capability IE of the PDU SESSION ESTABLISHMENT REQUEST message if the UE supports reflective QoS and: PDN type or of "Non-IP" PDN type mapping to "Ethernet" PDU session type, to the 5GS; or c) the UE requests to transfer an existing PDN conn ection in an untrusted non-3GPP access connected to the EPC of "IPv4", "IPv6" or "IPv4v6" PDN type to the 5GS.
and the UE can support more than 16 packet filters for this PDU session; PDN type or of "Non-IP" PDN type mapping to "Ethernet" PDU session type, to the 5GS and the UE can support more than 16 packet filters for this PDU session; or c) the UE requests to transfer an existing PDN conn ection in an untrusted non-3GPP access connected to the EPC of "IPv4", "IPv6" or "IPv4v6" PDN type to the 5GS and the UE can support more than 16 packet filters for this PDU session.
The UE shall include the Integrity protection maximum data rate IE in the PDU SESSION ESTABLISHMENT REQUEST message to indicate the maximum data rate per UE for user-plane integrity protection supported by the UE for uplink and the maximum data rate per UE for user-plane integrity protection supported by the UE for downlink.
The UE shall set the MHPDU bit to "Multi-homed IPv6 PDU session supported" in the 5GSM capability IE of the PDU SESSION ESTABLISHMENT REQUEST message if the UE supports multi-homed IPv6 PDU session and: untrusted non-3GPP access connected to the EPC to the 5GS.
The UE shall set the EPT-S1 bit to "Ethernet PDN type in S1 mode supported" in the 5GSM capability IE of the PDU SESSION ESTABLISHMENT REQUEST message if the UE supports Ethernet PDN type in S1 mode and requests "Ethernet" PDU session type.
TSC), the UE shall include the Always-on PDU session requested IE and set the value of the IE to "Always-on PDU session requested" in the PDU SESSION ESTABLISHMENT REQUEST message.
If the UE has an emergency PDU session, the UE shall not perform the UE-requested PDU session establishment procedure to establish another emergency PDU session .
The UE may perform the UE-requested PDU session.
a) the UE requests to perform handover of an existing PDU session between 3GPP access and non-3GPP access; b) the UE requests to perform transfer an exis ting PDN connection in the EPS to the 5GS; or c) the UE requests to perform transfer an existing PDN connection in an untrusted non-3GPP access connected to the EPC to the 5GS; a) set the PDU session ID in the PDU SESSION ESTABLISHMENT REQUEST message and in the UL NAS TRANSPORT message to the stored PDU session ID corresponding to the PDN connection; and b) set the S-NSSAI in the UL NAS TRANSPORT message to the stored S-NSSAI associated with the PDU session ID only if the S-NSSAI is included in the allowed NSSAI.
If the N5CW device supports 3GPP access and requests to perform handover of an existing PDU session from non- 3GPP access to 3GPP access, the N5CW device shall set the PDU session ID in the PDU SESSION ESTABLISHMENT REQUEST message and in the UL NAS TRANSPORT message to "PDU session identity value 15".
may allow the network to upgrade the requested PDU session to an MA PDU session.
In order to allow the network to establish an MA PDU session.
When the UE is registered over both 3GPP access and non-3GPP access in the same PLMN and the UE requests to over one access, the UE may perform the UE-requested PDU session establishment procedure to establish user-plane resources over the other access for the MA PDU session as specified in subclause 2 of 3GPP specification document and the S-NSSAI associated with the MA PDU session is included in the allowed NSSAI of the other access.
If the UE establishes user-plane resources over the other access for the MA PDU session, the UE shall: a) set the request type to "MA PDU request" in the UL NAS TRANSPORT message; b) set the PDU session ID to the stored PDU session ID corresponding to the established MA PDU session in the PDU SESSION ESTABLISHMENT REQUEST message and in the UL NAS TRANSPORT message; and c) set the S-NSSAI in the UL NAS TRANSPORT message to the stored S-NSSAI associated with the PDU session allows the network to upgrade the requested PDU session to an MA PDU session: a) if the UE supports ATSSS Low-Layer functionality with any steering mode as specified in subclause of 3GPP specification document , the UE shall set the ATSSS-ST bits to "ATSSS Low-Layer functionality with any steering mode supported" in the 5GSM capability IE of the PDU SESSION ESTABLISHMENT REQUEST message; b) if the UE supports MPTCP functionality with any steering mode and ATSSS-LL functionality with only active- standby steering mode as specified in subclause of 3GPP specification document , the UE shall set the ATSSS-ST bits to "MPTCP functionality with any steering mode and ATSSS-LL functionality with only active-standby steering mode supported" in the 5GSM capability IE of the PDU SESSION ESTABLISHMENT REQUEST message; and c) if the UE supports MPTCP functionality with any steering mode and ATSSS-LL functionality with any steering mode as specified in subclause of 3GPP specification document , the UE shall set the ATSSS-ST bits to "MPTCP functionality with any steering mode and ATSSS-LL functionality with any steering mode supported" in the 5GSM capability IE of the PDU SESSION ESTABLISHMENT REQUEST message.
established over one access, the UE shall not attempt to establish user-plane resources for the MA PDU session over the network which does not support ATSSS as specified in subclause 2 of 3GPP specification document .
and except for the establishment of user plane resources on the other access for the MA PDU session, the UE shall include the Extended protocol configuration options IE in the PDU SESSION ESTABLISHMENT REQUEST message and include the 3GPP PS data off UE status.
The UE behaves as described in subclause If the UE supports Reliable Data Service, the UE shall include the Extended protocol configuration options IE in the PDU SESSION ESTABLISHMENT REQUEST message and include the Reliable Data Service request indicator.
The UE behaves as described in subclause If the UE supports DNS over (D)TLS (see 3GPP specification document\), the UE shall include the extended protocol configuration options IE in the PDU SESSION ESTABLISHMENT REQUEST message and include DNS server.
a) the PDU session type value of the PDU session type IE is set to "IPv4", "IPv6" or "IPv4v6"; message; and c) the network indicates "Control plane CIoT 5GS optimization supported" and "IP header compression for control plane CIoT 5GS optimization supported" in the 5GS network support feature IE of the REGISTRATION ACCEPT message; the UE shall include the IP header compression config uration IE in the PDU SESSION ESTABLISHMENT REQUEST.
a) the PDU session type value of the PDU session type IE is set to "Ethernet"; b) the UE indicates "Control plane CIoT 5GS optimiza tion supported" and "Ethernet header compression for control plane CIoT 5GS optimization supported" in the 5GMM capability IE of the REGISTRATION c) the network indicates "Control plane CIoT 5GS optimization supported" and "Ethernet header compression for control plane CIoT 5GS optimization supported" in the 5GS network support feature IE of the REGISTRATION the UE shall include the Ethernet header compression configuration IE in the PDU SESSION ESTABLISHMENT REQUEST message.
management information containers, the UE shall: a) set the TPMIC bit to "Transfer of port management information containers supported" in the 5GSM capability IE of the PDU SESSION ESTABLISHMENT REQUEST message; b) include the DS-TT Ethernet port MAC address IE in the PDU SESSION ESTABLISHMENT REQUEST message and set its contents to the MAC address of the DS-TT Ethernet port used for the PDU session; c) if the UE-DS-TT residence time is available at the UE, include the UE-DS-TT residence time IE and set its contents to the UE-DS-TT residence time; and d) include the Port management information container IE in the PDU SESSION ESTABLISHMENT REQUEST If the UE supporting S1 mode supports receiving QoS rules with the length of two octets or QoS flow descriptions with the length of two octets via the extended protocol configur ation options IE, the UE shall include the QoS rules with the length of two octets support indicator or the QoS flow descriptions with the length of two octets support indicator, respectively, in the extended protocol configuration options IE in the PDU SESSION ESTABLISHMENT REQUEST The UE shall transport: a) the PDU SESSION ESTABLISHMENT REQUEST message; b) the PDU session ID of the PDU session being established, being handed over, being transferred, or been established as an MA PDU session; c) if the request type is set to: subclause\) or UE local configuration, according to subclause of 3GPP specification document : NSSAI(s) in the matching URSP rule, if any to the S-NSSAI(s) in the UE local configuration or in the default URSP rule, according to the conditions given in subclause of 3GPP specification document ; or rule, if any, or else to the S-NSSAI(s) in the UE local configuration or in the default URSP rule, according to the conditions given in subclause of 3GPP specification document ; and B) the S-NSSAI in the allowed NSSAI associated with the S-NSSAI in A); or 2) "existing PDU session", an S-NSSAI, which is an S-NSSAI associated with the PDU session and (if available in roaming scenarios) a mapped S-NSSAI; d) the requested DNN, if the request type is set to "initial request" or "existing PDU session", and the UE requests a e) the request type which is set to: 2) "existing PDU session", if the UE is not registered for emergency services and the UE requests: i) handover of an existing non-emergency PDU session between 3GPP access and non-3GPP access; ii) transfer of an existing PDN connection for non-em ergency bearer services in the EPS to the 5GS; or iii) transfer of an existing PDN connection for non-emergency bearer services in an untrusted non-3GPP access connected to the EPC to the 5GS; i) handover of an existing emergency PDU session between 3GPP access and non-3GPP access; ii) transfer of an existing PDN connection for emer gency bearer services in the EPS to the 5GS; or iii) transfer of an existing PDN connection for emer gency bearer services in an untrusted non-3GPP access connected to the EPC to the 5GS; or 5) "MA PDU request", if the UE requests: i) to establish an MA PDU session; or ii) to establish user plane resources over other access of an MA PDU session established over one access f) the old PDU session ID which is the PDU session ID of the existing PDU session, if the UE initiates the UE- requested PDU session establishment procedure upon receiving the PDU SESSION MODIFICATION COMMAND messages with the 5GSM cause IE set to #39 "reactivation requested"; using the NAS transport procedure as specified in subclause , and the UE shall start timer T3580 (see example in figure\).
For bullet c), if the matching URSP rule does not have an associated S-NSSAI, or if the UE does not have any matching URSP rule and there is no S-NSSAI in the UE local configuration or in the default URSP rule, the UE shall not provide If the request type is set to "initial emergency request" or "existing emergency PDU session", neither DNN nor S- NSSAI is transported by the UE using the NAS transport procedure as specified in subclause PDU SESSION ESTABLISHMENT ACCEPTStop T3580 ORPDU SESSION ESTABLISHMENT REQUESTStart T3580 PDU SESSION ESTABLISHMENT REJECTStop T3580 UE-requested PDU session establishment procedure session" and the PDU session authentication and authorization by the external DN is required due to local policy, the SMF shall check whether the PDU SESSION ESTABLISHMENT REQUEST message includes the SM PDU DN request container IE.
session", the SM PDU DN request container IE is included in the PDU SESSION ESTABLISHMENT REQUEST message, the PDU session authentication and authorization by the external DN is required due to local policy and user's request container IE is compliant with the local policy and user's subscription data, the SMF shall proceed with the EAP Authentication procedure specified in 3GPP specification document and refrain from accepting or rejecting the PDU SESSION ESTABLISHMENT REQUEST message until the EAP Authentication procedure finalizes; or b) the information for the PDU session authentication and authorization by the external DN in the SM PDU DN request container IE is not compliant with the local policy and user's subscription data, the SMF shall consider it as an abnormal case and proceed as specified in subclause user's subscription data, the SMF shall proceed wi th the EAP Authentication procedure specified in 3GPP specification document and refrain from accepting or rejecting the PDU SESSION ESTABLISHMENT REQUEST message until the EAP Authentication procedure finalizes.
SMF shall consider that the request for the relocation of SSC mode 3 PDU session anchor with multiple PDU sessions as specified in 3GPP specification document is accepted by the UE.
If the UE has set the TPMIC bit to "Transfer of port management information containers supported" in the 5GSM If the UE requests establishing an emergency PDU session, the network shall not check for service area restrictions or subscription restrictions when processing the PDU SESSION ESTABLISHMENT REQUEST message.
The SMF shall set the authorized QoS rules IE of the PDU SESSION ESTABLISHMENT ACCEPT message to the authorized QoS rules of the PDU session and may include the authorized QoS flow descriptions IE of the PDU SESSION ESTABLISHMENT ACCEPT message set to the authori zed QoS flow descriptions of the PDU session.
The SMF shall ensure that the number of the packet filters used in the authorized QoS rules of the PDU Session does not exceed the maximum number of packet filters supported by the UE for the PDU session.
If the received request type is "initial emergency request", the SMF shall set the authorized QoS flow descriptions IE according to the initial QoS parameters used for establishing emergency services configured in the SMF emergency configuration data.
SMF shall set the authorized QoS flow descriptions IE to the authorized QoS flow descriptions of the PDU session, if: a) the authorized QoS rules IE contains at least one GBR QoS flow; b) the QFI is not the same as the 5QI of the QoS flow identified by the QFI; or c) the QoS flow can be mapped to an EPS bearer as specified in subclause of 3GPP specification document .
If interworking with EPS is supported for the PDU session, the SMF shall set in the PDU SESSION a) the Mapped EPS bearer contexts IE to the EPS bearer contexts mapped from one or more QoS flows of the PDU b) the EPS bearer identity parameter in the authorized QoS flow descriptions IE to the EPS bearer identity corresponding to the QoS flow, for each QoS flow which can be transferred to EPS.
If the "Create new EPS bearer" operation code in the mapped EPS bearer contexts IE was received, and there is no corresponding authorized QoS flow descriptions IE in the PDU SESSION ESTABLISHMENT ACCEPT message, the delete the mapped EPS bearer context.
Furthermore, the SMF shall store the association between the QoS flow and the mapped EPS bearer context, for each QoS flow which can be transferred to EPS.
The SMF shall set the selected SSC mode IE of the PDU SESSION ESTABLISHMENT ACCEPT message to: a) the received SSC mode in the SSC mode IE included in the PDU SESSION ESTABLISHMENT REQUEST message based on one or more of the PDU session type, the subscription and the SMF configuration; b) either the default SSC mode for the data network listed in the subscription or the SSC mode associated with the SMF configuration, if the SSC mode IE is not included in the PDU SESSION ESTABLISHMENT REQUEST SMF shall set the selected SSC mode IE to "SSC mode 1", "SSC mode 2", or "SSC mode 3".
ESTABLISHMENT ACCEPT message to: a) the S-NSSAI of the PDU session; and b) the mapped S-NSSAI (if available in roaming scenarios).
The SMF shall set the selected PDU session type IE of the PDU SESSION ESTABLISHMENT ACCEPT message to ESTABLISHMENT ACCEPT message and shall set the PDU addre ss IE to an IPv4 address is allocated to the UE in ESTABLISHMENT ACCEPT message and shall set the PDU address IE to an interface identifier for the IPv6 link local address allocated to the UE in the PDU session.
If the selected PDU session type is "IPv4v6", the SMF shall include the PDU address IE in the PDU SESSION ESTABLISHMENT ACCEPT message and shall set the PDU address IE to an IPv4 address and an interface identifier for the IPv6 link local address, allocated to the UE in the PDU session.
ESTABLISHMENT ACCEPT message to the DNN determined by the AMF of the PDU session.
The SMF shall set the Session-AMBR IE of the PDU SESSION ESTABLISHMENT ACCEPT message to the Session- AMBR of the PDU session.
If the selected PDU session type is "IPv4", "IPv6", "IPv4v6" or "Ethernet" and if the PDU SESSION ESTABLISHMENT REQUEST message includes a 5GSM capability IE with the RQoS bit set to "Reflective QoS supported", the SMF shall consider that reflective QoS is supported for QoS flows belonging to this PDU session and may include the RQ timer IE set to an RQ timer value in the PDU SESSION ESTABLISHMENT ACCEPT message.
If the selected PDU session type is "IPv4", "IPv6", "IPv4v6" or "Ethernet" and if the PDU SESSION The SMF shall consider that the maximum data rate per UE for user-plane integrity protection supported by the UE for uplink and the maximum data rate per UE for user-plane integrity protection supported by the UE for downlink are valid for the lifetime of the PDU session.
reflective QoS indication (RQI) to UPF to activate refl ective QoS.
If the QoS flow is established over 3GPP access, the SMF also includes reflective QoS Attribute (RQA) in QoS profile of the QoS flow during QoS flow establishment.
If the selected PDU session type is "IPv6" or "IPv4v6" and if the PDU SESSION ESTABLISHMENT REQUEST message includes a 5GSM capability IE with the MHPDU bit set to "Multi-homed IPv6 PDU session supported", the SMF shall consider that this PDU session is supported to use multiple IPv6 prefixes.
If the selected PDU session type is "Ethernet", the PDU SESSION ESTABLISHMENT REQUEST message includes a 5GSM capability IE with the EPT-S1 bit set to "Ethernet PDN type in S1 mode supported" and the network supports Ethernet PDN type in S1 mode, the SMF shall set the EPT-S1 bit of the 5GSM network feature support IE of the PDU SESSION ESTABLISHMENT ACCEPT message to "Ethernet PDN type in S1 mode supported".
If the DN authentication of the UE was performed and completed successfully, the SMF shall set the EAP message IE of the PDU SESSION ESTABLISHMENT ACCEPT message to an EAP-success message as specified in IETF RFC 3748 , provided by the DN.
Based on local policies or configurations in the SMF and the Always-on PDU session requested IE in the PDU SESSION ESTABLISHMENT REQUEST message (if available), if the SMF determines that either: a) the requested PDU session needs to be established as an always-on PDU session (e.
because the PDU session is for TSC, for URLLC, or for both), the SMF shall include the Always-on PDU session indication IE in the b) the requested PDU session shall not be established as an always-on PDU session and: i) if the UE included the Always-on PDU session requested IE, the SMF shall include the Always-on PDU session indication IE in the PDU SESSION ESTABLISHMENT ACCEPT message and shall set the value to "Always-on PDU session not allowed"; or ii) if the UE did not include the Always-on PDU session requested IE, the SMF shall not include the Always-on PDU session indication IE in the PDU SESSION ESTABLISHMENT ACCEPT message.
If the PDU session is an MA PDU session, the SMF sh all include the ATSSS container IE in the PDU SESSION ESTABLISHMENT ACCEPT message.
The SMF shall set the content of the ATSSS container IE as specified in 3GPP specification document [13B].
"MA PDU session network upgrade is allowed" and: in the PDU SESSION ESTABLISHMENT ACCEPT message; or b) if the SMF decides to establish an MA PDU session, the SMF shall include the AT SSS container IE in the PDU SESSION ESTABLISHMENT ACCEPT message, which indicates to the UE that the requested single access PDU session was established as an MA PDU Session.
If the network decides that the PDU session is only for control plane CIoT 5GS optimization, the SMF shall include the control plane only indication in the PDU SESSION ESTABLISHMENT ACCEPT message.
b) the SMF supports IP header compression for control plane CIoT 5GS optimization; the SMF shall include the IP header compression config uration IE in the PDU SESSION ESTABLISHMENT ACCEPT b) the SMF supports Ethernet header compression for control plane CIoT 5GS optimization; the SMF shall include the Ethernet header compression configuration IE in the PDU SESSION ESTABLISHMENT ACCEPT message.
The SMF shall send the PDU SESSION ESTABLISHMENT ACCEPT message.
transport procedure as specified in subclause , the UE shall stop timer T3580, shall release the allocated PTI value and shall consider that the PDU session was established.
The UE shall store the authorized QoS rules, and the session-AMBR received in the PDU SESSION ESTABLISHMENT ACCEPT message for the PDU session.
The UE shall also store the authorized QoS flow ACCEPT message for the PDU session.
If the number of the authorized QoS rules, the number of the packet filters, or the number of the authorized QoS flow a) Semantic errors in QoS operations: 1) When the rule operation is "Create new QoS rule", and the DQR bit is set to "the QoS rule is the default QoS 2) When the rule operation is "Create new QoS rule", and there is no rule with the DQR bit set to "the QoS rule is the default QoS rule".
3) When the rule operation is "Create new QoS rule" and two or more QoS rules associated with this PDU session would have identical precedence values.
4) When the rule operation is an operation other than "Create new QoS rule", and the request type is "initial request" or "initial emergency request".
5) When the rule operation is "Create new QoS rule", the DQR bit is set to "the QoS rule is not the default QoS rule", the request type is "initial request" and the UE is in NB-N1 mode.
6) When the rule operation is "Create new QoS rule" and two or more QoS rules associated with this PDU session would have identical QoS rule identifier values.
7) When the flow description operation is an operation other than "Create new QoS flow description", and the request type is "initial request" or "initial emergency request".
8) When the flow description operation is "Create new QoS flow description", the request type is "initial and the UE is NB-N1 mode.
MODIFICATION REQUEST message to delete the QoS rule with 5GSM cause #83 "semantic error in the QoS operation".
QoS flow description with 5GSM cause #83 "semantic error in the QoS operation".
SESSION RELEASE REQUEST message with 5GSM cause #83 "semantic error in the QoS operation".
b) Syntactical errors in QoS operations: 1) When the rule operation is "Create new QoS rule" and the packet filter list in the QoS rule is empty.
between the number of packet filters subfield, and the number of packet filters in the packet filter list.
QoS flow (as described in 3GPP specification document table\), and there is no QoS flow description with a QFI corresponding to the QFI of the resulting QoS rule.
B) request type is "existing PDU session" or "existing emergency PDU session", the flow description 5GSM cause #84 "syntactical error in the QoS operation".
In case 4, if the default QoS rule is associated with the QoS flow description which lacks at least one of the which lacks at least one of the mandatory parameters and the associated QoS rule(s), if any, with 5GSM cause #84 "syntactical error in the QoS operation".
c) Semantic errors in packet filters: cause #44 "semantic error in packet filter(s)".
d) Syntactical errors in packet filters: 1) When the rule operation is "Create new QoS rule" and two or more packet filters in the resultant QoS rule would have identical packet filter identifiers.
SESSION RELEASE REQUEST message with 5GSM cause #45 "syntactical errors in packet filter(s)".
with 5GSM cause #45 "syntactical errors in packet filter(s)".
If the Always-on PDU session indication IE is included in the PDU SESSION ESTABLISHMENT ACCEPT message a) the value of the IE is set to "Always-on PDU session required", the UE shall consider the established PDU session as an always-on PDU session; or b) the value of the IE is set to "Always-on PDU session not allowed", the UE shall not consider the established PDU session as an always-on PDU session.
The UE shall not consider the established PDU session as an always-on PDU session if the UE does not receive the Always-on PDU session indication IE in the PDU SESSION ESTABLISHMENT ACCEPT message.
The UE shall store the mapped EPS bearer contexts, if received in the PDU SESSION ESTABLISHMENT ACCEPT message.
Furthermore, the UE shall also store the asso ciation between the QoS flow and the mapped EPS bearer context, for each QoS flow which can be transferred to EPS, based on the received EPS bearer identity parameter in context for different types of errors as follows: rules IE and Authorized QoS flow descriptions IE included in the PDU SESSION ESTABLISHMENT ACCEPT, if any.
a) Semantic error in the mapped EPS bearer operation: 2) When the operation code is "Create new EPS bearer " and there is already an existing mapped EPS bearer context with the same EPS bearer iden tity associated with any PDU session.
3) When the operation code is "Create new EPS bearer " or "Modify existing EPS bearer" and the resulting mapped EPS bearer context has invalid or missing mandatory parameters (e.
, mapped EPS QoS parameters the UE shall not diagnose an error, further process the create request and, if it was process successfully, delete the old EPS bearer context.
MODIFICATION REQUEST message to delete the mapped EPS bearer context with 5GSM cause #85 "Invalid mapped EPS bearer identity".
for different types of TFT IE errors as follows: 1) Semantic errors in TFT operations: REQUEST message to delete the mapped EPS bearer context with 5GSM cause #41 "semantic error in the TFT operation".
2) Syntactical errors in TFT operations: the number of packet filters subfield, and the number of packet filters in the packet filter list.
REQUEST message with to delete the mapped EPS bearer context 5GSM cause #42 "syntactical error in the 3) Semantic errors in packet filters: ii) When the resulting TFT does not contain any packet filter which applicable for the uplink direction.
REQUEST message to delete the mapped EPS bearer context with 5GSM cause #44 "semantic errors in packet filter(s)".
4) Syntactical errors in packet filters: have identical packet filter identifiers.
this PDN connection would have identical packet filter precedence values.
iii) When there are other types of syntactical errors in the coding of packet filters, such as the use of a an error and shall delete the old packet filters which have identical filter precedence values.
delete the mapped EPS bearer context with 5GSM cause #45 "syntactical errors in packet filter(s)".
MODIFICATION REQUEST message to delete the mapped EPS bearer context with 5GSM cause #45 "syntactical error in packet filter(s)".
SESSION MODIFICATION REQUEST message.
NOTE 3: The 5GSM cause to use cannot be different from: #41 "semantic error in the TFT operation", #42 "syntactical error in the TFT operation", #44 "semantic error in packet filter(s)", #45 "syntactical errors in packet filter(s)", #83 "semantic error in the QoS operation", #84 "syntactical error in the QoS operation", and #85 "Invalid mapped EPS bearer identity".
The selection of a 5GSM cause is up to the UE implementation.
The UE shall only use the Control plane CIoT 5GS optimization for this PDU session if the Control plane only indication is included in the PDU SESSION ESTABLISHMENT ACCEPT message.
If the UE requests the PDU session type "IPv4v6" and: a) the UE receives the selected PDU session type set to "IPv4" and does not receive the 5GSM cause value #50 "PDU session type IPv4 only allowed"; or b) the UE receives the selected PDU session type set to "IPv6" and does not receive the 5GSM cause value #51 "PDU session type IPv6 only allowed"; the UE may subsequently request another PDU session for the other IP version using the UE-requested PDU session establishment procedure to the same DNN (or no DNN, if no DNN was indicated by the UE) and the same S-NSSAI associated with (if available in roaming scenarios) a ma pped S-NSSAI (or no S-NSSAI, if no S-NSSAI was indicated If the UE requests the PDU session type "IPv4v6", receives the selected PDU session type set to "IPv4" and the 5GSM cause value #50 "PDU session type IPv4 only allowed", the UE shall not subsequently request another PDU session for "IPv6" using the UE-requested PDU session establishment procedure to the same DNN (or no DNN, if no DNN was indicated by the UE) and the same S-NSSAI associated with (if available in roaming scenarios) a mapped S-NSSAI (or no S-NSSAI, if no S-NSSAI was indicated by the UE) and the PDU session type "IPv6" until: the PDU session type which is used to access the DNN (or no DNN, if no DNN was indicated by the UE) and the S-NSSAI (or no S-NSSAI, if no S-NSSAI was indicated by the UE) is changed; the UE is switched off, or - the USIM is removed.
If the UE requests the PDU session type "IPv4v6", receives the selected PDU session type set to "IPv6" and the 5GSM cause value #51 "PDU session type IPv6 only allowed", the UE shall not subsequently request another PDU session for "IPv4" using the UE-requested PDU session establishment procedure to the same DNN (or no DNN, if no DNN was indicated by the UE) and the same S-NSSAI associated with (if available in roaming scenarios) a mapped S-NSSAI (or no S-NSSAI, if no S-NSSAI was indicated by the UE) and the PDU session type "IPv4" until: the PDU session type which is used to access the DNN (or no DNN, if no DNN was indicated by the UE) and the S-NSSAI (or no S-NSSAI, if no S-NSSAI was indicated by the UE) is changed; If the selected PDU session type of the PDU session is "Ethernet", the UE supports inter-system change from N1 mode the UE, the network or both of them do not support Ethernet PDN type in S1 mode, and the parameters list field of one ESTABLISHMENT ACCEPT message contains an EPS bearer identity (EBI), then the UE shall locally remove the EPS bearer identity (EBI) from the parameters list field of such one or more authorized QoS flow descriptions.
If the UE receives an IPv4 Link MTU parameter, an Ethernet Frame Payload MTU parameter, or an Unstructured Link MTU parameter in the Extended protocol configuration options IE of the PDU SESSION ESTABLISHMENT ACCEPT message, the UE shall pass to the upper layer the received IPv4 link MTU size, the received Ethernet frame payload MTU size, or the unstructured link MTU size.
NOTE 4: The IPv4 link MTU size corresponds to the maximum length of user data packet that can be sent via N3 NOTE 6: The unstructured link MTU size correspond to the maximum length of user data packet that can be sent If the 5G-RG receives an ACS information parameter in the Extended protocol configuration options IE of the PDU SESSION ESTABLISHMENT ACCEPT message, the 5G-RG shall pass the ACS URL in the received ACS information parameter to the upper layer.
in the Extended protocol configuration options IE in the PDU SESSION ESTABLISHMENT ACCEPT message, the UE shall store the small data rate control parameters value and use the stored small data rate control parameters value as the maximum allowed limit of uplink user data for the PDU session in accordance with 3GPP specification document .
If the UE has indicated support for CIoT 5GS optimizatio ns and receives an additional small data rate control parameters for exception data container in the Extended protocol configuration options IE in the PDU SESSION ESTABLISHMENT ACCEPT message, the UE shall store the additional small data rate control parameters for exception data value and use the stored additional small data rate control parameters for exception data value as the maximum allowed limit of uplink exception data for the PDU session in accordance with 3GPP specification document .
container or an initial additional small data rate control parameters for exception data container in the Extended protocol maximum allowed limit of uplink control plane user data for the corresponding PDU session in accordance with 3GPP specification document .
If the UE receives an APN rate control parameters container or an additional APN rate control for exception data parameters container in the extended protocol configuration options IE in the PDU SESSION ESTABLISHMENT ACCEPT message, the UE shall store these parameters and use them to limit the rate at which it generates uplink user data messages for the PDN connection corresponding to the PDU session if the PDU session is transferred to EPS upon APN rate control parameters and additional APN rate control for exception data parameters, respectively, for this PDN connection.
If the UE receives an initial APN rate control parameters container or an initial additional APN rate control for exception data parameters container in the extended protocol configuration options IE in the PDU SESSION ESTABLISHMENT ACCEPT message, the UE shall store these parameters in the APN rate control status and use them them to limit the rate at which it generates exception data messages for the PDN connection corresponding to the PDU session if the PDU session is transferred to EPS upon inte r-system change from N1 mode to S1 mode in accordance with 3GPP specification document .
The received APN rate control stat us shall replace any previously stored APN rate control status for this PDN connection.
NOTE 7: In the PDU SESSION ESTABLISHMENT ACCEPT message, the SMF provides either APN rate control parameters container, or initial APN rate control parameters container, in the extended protocol configuration options IE, but not both.
NOTE 8: In the PDU SESSION ESTABLISHMENT ACCEPT message, the SMF provides either additional APN rate control for exception data parameters container, or initial additional APN rate control for exception data parameters container, in the extended protocol configuration options IE, but not both.
If the network accepts the use of Reliable Data Service to transfer data for the PDU session, the network shall include the extended protocol configuration options IE in the PDU SESSION ESTABLISHMENT ACCEPT message and include the Reliable Data Service accepted indicator.
The UE behaves as described in subclause If the UE indicates support of DNS over (D)TLS by providing DNS server security information indicator to the network and the network wants to enforce the use of DNS over (D)TLS, the network may include the extended protocol configuration options IE in the PDU SESSION ESTABLISHMENT ACCEPT message and include the DNS server security information with length of two octets.
Upon receivi ng the DNS server security information, the UE shall pass it to the upper layer.
The UE shall use this information to send the DNS over (D)TLS (See 3GPP specification document\).
NOTE 9: Support of DNS over (D)TLS is based on the informative requirements as specified in 3GPP specification document and it is implemented based on the operator requirement.
UE requested PDU session establishment procedure not accepted by the.
The SMF shall set the 5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT message to indicate the reason for rejecting the PDU session establishment.
The 5GSM cause IE typically indicates one of the following SM cause values: #8 operator determined barring; #26 insufficient resources; #27 missing or unknown DNN; #28 unknown PDU session type; #29 user authentication or authorization failed; #31 request rejected, unspecified; #32 service option not supported; #33 requested service option not subscribed; #35 PTI already in use; #39 reactivation requested; #46 out of LADN service area; #50 PDU session type IPv4 only allowed; #51 PDU session type IPv6 only allowed; #54 PDU session does not exist; #57: PDU session type IPv4v6 only allowed; #58: PDU session type Unstructured only allowed; #61: PDU session type Ethernet only allowed; #67 insufficient resources for specific slice and DNN; #68 not supported SSC mode; #69 insufficient resources for specific slice; subscription, the SMF configuration, or both, are limited to IPv4 only for the requested DNN, the SMF shall include the 5GSM cause value #50 "PDU session type IPv4 only allowed" in the 5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT message.
subscription, the SMF configuration, or both, support none of "IPv4" and "IPv6" PDU session types for the requested DNN, the SMF shall include the 5GSM cause value #28 " unknown PDU session type" in the 5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT message.
subscription, the SMF configuration, or both, are limited to IPv6 only for the requested DNN, the SMF shall include the 5GSM cause value #51 "PDU session type IPv6 only allowed" in the 5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT message.
subscription, the SMF configuration, or both, support none of "IPv4" and "IPv6" PDU session types for the requested DNN, the SMF shall include the 5GSM cause value #28 " unknown PDU session type" in the 5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT message.
subscription, the SMF configuration, or both, support none of "IPv4v6", "IPv4" and "IPv6" PDU session types for the requested DNN, the SMF shall include the 5GSM cause value #28 "unknown PDU session type" in the 5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT message.
"Ethernet", and the subscription, the SMF configuration, or both, do not support the PDU session type for the requested DNN, the SMF shall include the 5GSM cause value #28 " unknown PDU session type" in the 5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT message.
session type IE set to "Unstructured", and the SMF configuration does not support the PDU session type, the SMF shall include the 5GSM cause value #28 " unknown PDU session type" in the 5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT message.
If the PDU SESSION ESTABLISHMENT REQUEST message is to establish an MA PDU session and MA PDU session is not allowed due to operator policy and subscription, and the SMF decides to reject the PDU session establishment, the SMF shall include the 5GSM cause value #33 "requested service option not subscribed" in the 5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT message.
In 3GPP access, if the operator's configuration requires user-plane integrity protection for the PDU session and, the maximum data rate per UE for user-plane integrity protection supported by the UE for uplink or the maximum data rate per UE for user-plane integrity protection supported by the UE for downlink, or both, are lower than required by the operator's configuration, the SMF shall include the 5GSM cause value #82 "maximum data rate per UE for user-plane integrity protection is too low" in the 5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT message.
area, the SMF shall include the 5GSM cause value #46 "out of LADN service area" in the 5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT message.
If the DN authentication of the UE was performed and completed unsuccessfully, the SMF shall include the 5GSM cause value #29 "user authentication or authorization failed" in the 5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT message and shall set the EAP message IE of the PDU SESSION ESTABLISHMENT REJECT message to an EAP-failure message as specified in IETF RFC 3748 , provided by the DN.
"existing PDU session" and the SMF determines the UE has: the SMF may reject the PDU SESSION ESTABLISHMENT REQUEST message and: a) include the 5GSM cause value #39 "reactivation requested" in the 5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT message; or b) include a 5GSM cause value other than #39 "reactivation requested" in the 5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT message.
NOTE 1: The included 5GSM cause value is up to the network implementation.
If the PDU session cannot be established due to resource unavailability in the UPF, the SMF shall include the 5GSM cause value #26 "insufficient resources" in the 5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT If the Back-off timer value IE is included and the 5GSM cause value is different from #26 "insufficient resources", #28 "unknown PDU session type", #46 "out of LADN service area", "#50 "PDU session type IPv4 only allowed", #51 "PDU session type IPv6 only allowed", #54 "PDU session does not exist", #57 "PDU session type IPv4v6 only allowed", #58 "PDU session type Unstructured only allowed", #61 "PDU session type Ethernet only allowed", #67 "insufficient resources for specific slice and DNN", #68 "not supported SSC mode", and #69 "insufficient resources for specific mode is allowed in an equivalent PLMN.
mode using the same PDU session type for the same DNN (or no DNN, if no DNN was indicated by the UE) and the same S-NSSAI (or no S-NSSAI, if no S-NSSAI was indicated by the UE).
The SMF shall send the SM PDU SESSION ESTABLISHMENT REJECT message.
transport procedure as specified in subclause , the UE shall stop timer T3580 shall release the allocated PTI value and shall consider that the PDU session was not established.
If the PDU SESSION ESTABLISHMENT REQUEST message was sent with request type set to "initial emergency a) inform the upper layers of the failure of the procedure; or NOTE 2: This can result in the upper layers requesting another emergency call attempt using domain selection as specified in 3GPP specification document .
b) de-register locally, if not de-registered already, attempt initial registration for emergency services.
If the PDU SESSION ESTABLISHMENT REJECT message includes 5GSM cause #39 "reactivation requested" and the PDU session is being transferred from EPS to 5GS and established with the request type set to "existing PDU session", the UE should re-initiate the UE-requested PDU session establishment procedure as specified in a) the PDU session type associated with the transferred PDU session; b) the SSC mode associated with the transferred PDU session; c) the DNN associated with the transferred PDU session; and d) the S-NSSAI associated with (if available in roaming scenarios) a mapped S-NSSAI if provided in the UE- requested PDU session establishment procedure of the transferred PDU session.
Handling of network rejection due to congestion control.
the 5GSM cause value #26 "insufficient resources" and the Back-off timer value IE are included in the PDU SESSION ESTABLISHMENT REJECT message; or IE set to the PDU session ID of the PDU session; establishment, the UE shall stop timer T3396 associated with the corresponding DNN, if it is running.
If the timer value indicates neither zero nor deactivated and no DNN was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop timer T3396 associated with no DNN if it is running.
The UE shall received from the 5GMM sublayer and: 1) shall not send another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message with exception of those identified in subclause , for the same DNN that was sent by the UE, until timer T3396 expires or timer T3396 is stopped; and "initial emergency request" and different from "existing emergency PDU session", until timer T3396 expires or timer T3396 is stopped.
establishment, the UE shall stop timer T3396 associated with the corresponding DNN, if it is running.
If the timer value indicates that this timer is deactivat ed and no DNN was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop timer T3396 associated with no DNN if it is running.
The UE: 1) shall not send another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message with exception of those identified in subclause , for the same DNN until the UE is switched off, the USIM is removed, the entry in the "list of subscriber data" for the request type different from "initial emergency request" and different from "existing emergency PDU session", or another PDU SESSION MODIFICATION REQUEST message with exception of those c) if the timer value indicates zero, the UE: 1) shall stop timer T3396 associated with the corresponding DNN, if running, and may send another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message for the same DNN; and 2) if no DNN was provided during the PDU session establishment and the request type was different from procedure for emergency services.
If the timer T3396 is running when the UE enters state 5GMM-DEREGISTERED, the UE remains switched on, and the USIM in the UE remains the same or the entry in the "list of subscriber data" for the SNPN to which timer T3396 is associated is not updated, then timer T3396 is kept running until it expires or it is stopped.
the "list of subscriber data" for the SNPN to which timer T3396 is associated is not updated when the UE is switched.
the 5GSM cause value #67 "insufficient resources for specific slice and DNN" and the Back-off timer value IE are included in the PDU SESSION ESTABLISHMENT REJECT message; or an indication that the 5GSM message was not forwarded due to S-NSSAI and DNN based congestion control is are specified in subclause\): a) If the timer value indicates neither zero nor deactivated, the UE shall stop timer T3584 associated with the same [S-NSSAI, DNN] combination as that the UE provided during the PDU session establishment, if it is running.
If the timer value indicates neither zero nor deactivated and no DNN was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop timer T3584 associated with [S-NSSAI, no DNN] combination as that the UE provided during the PDU session establishment, if it is running.
If the timer value indicates neither zero nor deactivated and no S-NSSAI was provided during the PDU session establishment, the UE shall stop timer T3584 associated with [no S-NSSAI, DNN] combination as that the UE provided during the PDU session establishment, if it is running.
If the timer value indicates neither zero nor deactivated and neither S-NSSAI nor DNN was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop timer T3584 associated with [no S-NSSAI, no DNN] combination as that the UE provided during the PDU session establishment, if it is running.
The UE shall then start timer T3584 with the value provided in the Back-off timer value IE or with the Back-off timer value received from the 5GMM sublayer and: 1) shall not send another PDU SESSION ESTABLISHMENT REQUEST message, or PDU SESSION MODIFICATION REQUEST message with exception of those identified in subclause , for the same [S-NSSAI, DNN] combination that was sent by the UE, until timer T3584 expires or timer T3584 is stopped; 2) shall not send another PDU SESSION ESTABLISHMENT REQUEST message with request type different from "initial emergency request" and different from "existing emergency PDU session", or another PDU SESSION MODIFICATION REQUEST with exception of those identified in subclause , message for the same [S-NSSAI, no DNN] combination that was sent by the UE, if no DNN was provided during the PDU session establishment, until timer T3584 expires or timer T3584 is stopped; 3) shall not send another PDU SESSION ESTABLISHMENT REQUEST message, or another PDU SESSION MODIFICATION REQUEST message with exception of those identified in subclause , for the same [no S-NSSAI, DNN] combination that was sent by the UE, if no S-NSSAI was provided during the PDU session establishment, until timer T3584 expires or timer T3584 is stopped; and 4) shall not send another PDU SESSION ESTABLISHMENT REQUEST message with request type different from "initial emergency request" and different from "existing emergency PDU session", or another PDU SESSION MODIFICATION REQUEST message with exception of those identified in subclause , for the same [no S-NSSAI, no DNN] combination that was sent by the UE, if neither S-NSSAI nor DNN was provided during the PDU session establishment, until timer T3584 expires or timer T3584 is stopped.
b) if the timer value indicates that this timer is deactivated, the UE: 1) shall stop timer T3584 associated with the same [S-NSSAI, DNN] combination as that the UE provided by the UE, until the UE is switched off, the USIM is removed, the entry in the "list of subscriber data" for the 2) shall stop timer T3584 associated with the same [S-NSSAI, no DNN] combination as that the UE provided ESTABLISHMENT REQUEST message with request type different from "initial emergency request" and 3) shall stop timer T3584 associated with the same [no S-NSSAI, DNN] combination as that the UE provided 4) shall stop timer T3584 associated with the same [no S-NSSAI, no DNN] combination as that the UE combination that was sent by the UE, if neither S-NSSAI nor DNN was provided during the PDU session non-emergency PDU session established for the same [no S-NSSAI, no DNN] combination from the c) if the timer value indicates zero, the UE: 1) shall stop timer T3584 associated with the same [S-NSSAI, DNN] combination as that the UE provided during the PDU session establishment, if it is running.
The UE may send another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message for the same [S-NSSAI, DNN] combination; 2) shall stop timer T3584 associated with the same [S-NSSAI, no DNN] combination as that the UE provided during the PDU session establishment, if it is running.
The UE may send another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message for the same [S-NSSAI, no DNN] combination if no DNN was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU 3) shall stop timer T3584 associated with the same [no S-NSSAI, DNN] combination as that the UE provided during the PDU session establishment, if it is running.
The UE may send another PDU SESSION ESTABLISHMENT REQUEST message, or PDU SESSION MODIFICATION REQUEST message for the same [no S-NSSAI, DNN] combination if no NSSAI was provided during the PDU session establishment; and 4) shall stop timer T3584 associated with the same [no S-NSSAI, no DNN] combination as that the UE provided during the PDU session establishment, if it is running.
The UE may send another PDU SESSION ESTABLISHMENT REQUEST message, or PDU SESSION MODIFICATION REQUEST message for the If the 5GSM congestion re-attempt indicator IE set to "The back-off timer is applied in all PLMNs" is included in the PDU SESSION ESTABLISHMENT REJECT message with the 5GSM cause value #67 "insufficient resources for specific slice and DNN", then the UE shall apply the timer T3584 for all the PLMNs.
Otherwise, the UE shall apply the timer T3584 for the registered PLMN.
If the Back-off timer value IE is not included or no Back-off timer value is received from the 5GMM sublayer, then the REQUEST message for the same [S-NSSAI, DNN] combination, or for the same [S-NSSAI, no DNN] combination, or for the same [no S-NSSAI, DNN] combination, or for the same [no S-NSSAI, no DNN] combination.
procedure for emergency services.
If the timer T3584 is running when the UE enters state 5GMM-DEREGISTERED, the UE remains switched on, and the USIM in the UE remains the same or the entry in the "list of subscriber data" for the SNPN to which timer T3396 is associated is not updated, then timer T3584 is kept running until it expires or it is stopped.
switched on or the entry in the "list of subscriber data" for the SNPN to which timer T3396 is associated is not updated, the UE shall behave as follows:.
the 5GSM cause value #69 "insufficient resources for specific slice" and the Back-off timer value IE are included in the PDU SESSION ESTABLISHMENT REJECT message; or an indication that the 5GSM message was not forwarded due to S-NSSAI only based congestion control is are specified in subclause\): a) If the timer value indicates neither zero nor deactivat ed and an S-NSSAI was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop timer T3585 associated with the corresponding S-NSSAI, if it is running.
If the timer value indicates neither zero nor deactivated and no S-NSSAI was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop timer T3585 associated with no S-NSSAI if it is running.
The UE shall then start timer T3585 with the value provided in the Back-off timer value IE or with the Back-off timer value received from the 5GMM sublayer and: 1) shall not send another PDU SESSION ESTABLISHMENT REQUEST message with request type different from "initial emergency request" and different from "existing emergency PDU session", or another PDU 2) shall not send another PDU SESSION ESTABLISHMENT REQUEST message without an S-NSSAI and b) if the timer value indicates that this timer is deac tivated and an S-NSSAI was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop timer T3585 associated with the corresponding S-NSSAI, if it is running.
If the timer value indicates that this timer is deactivated and no S-NSSAI was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop timer T3585 associated with no S-NSSAI if it is running.
The UE: 1) shall not send another PDU SESSION ESTABLISHMENT REQUEST message with request type different same S-NSSAI from the network; and 2) shall not send another PDU SESSION ESTABLISHMENT REQUEST message without an S-NSSAI and by the UE, if no S-NSSAI was provided during the PDU session establishment and the request type was c) if the timer value indicates zero, the UE: 1) shall stop timer T3585 associated with the corresponding S-NSSAI, if running, and may send another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message for the same S-NSSAI; and 2) if no S-NSSAI was provided during the PDU session establishment and the request type was different from "initial emergency request " and different from "existing emergency PDU session", the UE shall stop timer T3585 associated with no S-NSSAI, if running, and may send another PDU SESSION ESTABLISHMENT REQUEST message without an S-NSSAI, or an other PDU SESSION MODIFICATION REQUEST message without an S-NSSAI provided by the UE.
If the 5GSM congestion re-attempt indicator IE set to "The back-off timer is applied in all PLMNs" is included in the PDU SESSION ESTABLISHMENT REJECT message with the 5GSM cause value #69 "insufficient resources for specific slice", then the UE shall apply the timer T3585 for all the PLMNs.
Otherwise, the UE shall apply the timer T3585 for the registered PLMN.
If the Back-off timer value IE is not included or no Back-off timer value is received from the 5GMM sublayer, then the REQUEST message for the same S-NSSAI or without an S-NSSAI.
procedure for emergency services.
If the timer T3585 is running when the UE enters state 5GMM-DEREGISTERED, the UE remains switched on, and the USIM in the UE remains the same or the entry in the "list of subscriber data" for the SNPN to which timer T3396 is associated is not updated, then timer T3585 is kept running until it expires or it is stopped.
on, the UE shall behave as follows: timer with the value t NOTE: As described in this subclause, upon PLMN change or inter-system change, the UE does not stop the timer T3584 or T358 This means the timer T3584 or T3585 can still be running or be deactivated for the given 5GSM procedure, the PLMN, the S-NSSAI and optionally the DNN combination when the UE returns to the PLMN or when it performs inter-system change back from S1 mode to N1 mode.
Thus the UE can still be prevented from sending another PDU SESSION ESTABLISHMENT REQUEST or PDU SESSION MODIFICATION REQUEST message in the PLMN for the same S-NSSAI and optionally the same DNN.
ESTABLISHMENT REQUEST message for the same S-NSSAI in the new PLMN.
Handling of network rejection not due to congestion control If the 5GSM cause value is different from #26 "insufficient resources", #28 "unknown PDU session type", #39 "reactivation requested", #46 "out of LADN service area", #50 "PDU session type IPv4 only allowed", #51 "PDU session type IPv6 only allowed", #54 "PDU session does not exist", #57 "PDU session type IPv4v6 only allowed", #58 "PDU session type Unstructured only allowed", #61 "PDU session type Ethernet only allowed", #67 "insufficient resources for specific slice and DNN", #68 "not supported SSC mode", and #69 "insufficient resources for specific a) if the timer value indicates neither zero nor deactivated and: 1) if the UE provided DNN and S-NSSAI to the network during the PDU session establishment, the UE shall start the back-off timer with the value provided in the Back-off timer value IE for the PDU session establishment procedure and [PLMN, DNN, S-NSSAI] combination.
The UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for the same DNN and S-NSSAI in the current PLMN, until the back-off timer expires, the UE is switched off, the USIM is removed, or the entry in the "list of subscriber data" for the current SNPN is updated; or session establishment, it shall start the back-off timer accordingly for the PDU session establishment procedure and the [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, S-NSSAI] or [PLMN, no DNN, no S-NSSAI] combination.
Dependent on the combination, the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for the same [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, S-NSSAI] or [PLMN, no DNN, no S-NSSAI] combination in the current PLMN, until the back-off timer expires, the UE is switched off, the USIM is removed, or the entry in the "list of subscriber data" for the current SNPN is updated; b) if the timer value indicates that this timer is deactivated and: 1) if the UE provided DNN and S-NSSAI to the network during the PDU session establishment, the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for the same DNN and S-NSSAI in the current PLMN, until the UE is switched off, the USIM is removed, or the entry in the "list of subscriber data" for the current SNPN is updated; or session establishment, the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for the same [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, S-NSSAI] or [PLMN, no DNN, no S-c) if the timer value indicates zero, the UE may send another PDU SESSION ESTABLISHMENT REQUEST message for the same combination of [PLMN, DNN, S-NSSAI], [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, S-NSSAI], or [PLMN, no DNN, no S-NSSAI] in the current PLMN.
If the Back-off timer value IE is not included, then the UE shall ignore the Re-attempt indicator IE provided by the network in the PDU SESSION ESTABLISHMENT REJECT message, if any.
1) the UE not operating in SNPN access mode shall proceed as follows: as described above in the present subclause using the configured SM Retry Timer value as specified in 3GPP specification document or in USIM file NAS CONFIG as specified in 3GPP specification document , if available, as back-off timer value; and the SM Retry Timer value is not configured, the UE shall behave as described above in the present subclause, using the default value of 12 minutes for the back-off timer; or 2) the UE operating in SNPN access mode shall proceed as follows: A) the SM Retry Timer value for the current SNPN as specified in 3GPP specification document is available; or B) the SM Retry Timer value in USIM file NAS CONFIG as specified in 3GPP specification document is available and the UE used the USIM for registration to the current SNPN; then the UE shall behave as described above in the present subclause using the configured SM Retry Timer value as back-off timer value; or NOTE 0: The way to choose one of the configured SM Retry Timer values for back-off timer value is up to UE implementation if both conditions in bullets A) and B) above are satisfied.
ii) otherwise, the UE shall behave as described above in the present subclause, using the default value of 12 minutes for the back-off timer.
b) For 5GSM cause value #27 "missing or unknown DNN", the UE shall proceed as follows: back-off timer with the configured SM Retry Timer value as specified in 3GPP specification document or in USIM file NAS CONFIG as specified in 3GPP specification document , if available, as back-off timer value for the PDU session establishment procedure and the [PLMN, DNN] or [PLMN, no DNN] combination.
The UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for the same DNN in the current PLMN, until the back-off timer expires, the UE is switched off or the USIM is removed; and SM Retry Timer value is not configured, the UE shall start the back-off timer with the default value of 12 minutes as back-off timer value for the PDU session establishment procedure and the [PLMN, DNN] or [PLMN, no DNN] combination.
The UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for the same DNN in the current PLMN, until the back-off timer expires, the UE is switched off or the USIM is removed.
c) For 5GSM cause values different from #8 "operator determined barring", #27 "missing or unknown DNN", #32 The UE shall not stop any back-off timer: c) upon registration over another access type.
NOTE 1: This means the back-off timer can still be running or be deactivated for the given 5GSM procedure when the UE returns to the PLMN or when it performs inter-system change back from S1 mode to N1 mode.
Thus, the UE can still be prevented from sending another PDU SESSION ESTABLISHMENT REQUEST message for the combination of [PLMN, DNN, S-NSSAI], [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, S-NSSAI], or [PLMN, no DNN, no S-NSSAI] in the PLMN.
timer is deactivated, the UE behaves as follows: combination of [new PLMN, DNN, S-NSSAI], [new PLMN, DNN, no S-NSSAI], [new PLMN, no DNN, S-NSSAI], or [new PLMN, no DNN, no S-NSSAI] in the new PLMN, if the back-off timer is not running and is not deactivated for the PDU session establishment procedure and the combination of [new PLMN, DNN, S-NSSAI], [new PLMN, DNN, no S-NSSAI], [new PLMN, no DNN, S-NSSAI], or [new PLMN, no DNN, no S-NSSAI]; Furthermore, as an implementation option, for the 5GSM cause value #8 "operator determined barring", #32 a Re-attempt indicator IE, the UE may decide not to automatically send another PDU SESSION b) if the network does not include the Re-attempt indicator IE to indicate whether re-attempt in S1 mode is allowed, or the UE ignores the Re-attempt indicator IE, e.
becau se the Back-off timer value IE is not included, then: running for the combination of [PLMN, DNN, S-NSSAI] or [PLMN, DNN, no S-NSSAI], the UE shall apply the configured value SM_RetryAtRATChange value as specified in 3GPP specification document or in USIM file NAS CONFIG as specified in 3GPP specification document , if available, to determine whether the UE may attempt a PDN connectivity procedure for the same [PLMN, DNN] combination in S1 mode.
If the back-off timer is running for the combination of [PLMN, no DNN, S-NSSAI] or [PLMN, no DNN, no S-NSSAI], the same applies for the PDN connectivity procedure for the [P LMN, no DNN] combination in S1 mode accordingly; configuration MO as specified in 3GPP specification document is not available and the value for inter-system change is not configured in the USIM file NAS procedure for the same [PLMN, DNN] or [PLMN, no DNN] combination in S1 mode is unspecified; and c) if the network includes the Re-attempt indicator IE indicating that re-attempt in an equivalent PLMN is not or deactivate the back-off timer for N1 mode only; and 2) otherwise, the UE shall start or deactiv ate the back-off timer for S1 and N1 mode.
If the back-off timer for a [PLMN, DNN] or [PLMN, no DN N] combination, was started or deactivated in S1 mode upon receipt of PDN CONNECTIVITY REJECT message (see 3GPP specification document\) and the network indicated that ESTABLISHMENT REQUEST message in this PLMN for the same DNN, or without DNN, after inter-system change to N1 mode.
If the network indicated that re-attempt in N1 mode is not allowed, the UE shall not send any PDU SESSION ESTABLISHMENT REQUEST message in this PLMN for the same DNN in combination with any S- NSSAI or without S-NSSAI, or in this PLMN without DNN in combination with any S-NSSAI or without S-NSSAI, after inter-system change to N1 mode until the timer expires, the UE is switched off or the USIM is removed.
If the 5GSM cause value is #28 " unknown PDU session type" and the PDU SESSION ESTABLISHMENT REQUEST IE and Re-attempt indicator IE provided by the network, if any.
The UE may send another PDU SESSION If the 5GSM cause value is #39 "reactivation requested", the UE shall ignore the Back-off timer value IE and Re- attempt indicator IE provided by the network, if any.
NOTE 4: Further UE behaviour upon receipt of 5GSM cause value #39 is up to the UE implementation.
If the 5GSM cause value is #46 "out of LADN service area", the UE shall ignore the Back-off timer value IE and Re-attempt indicator IE provided by the network, if any.
The UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message or another PDU SESSION MODIFICATION REQUEST message for the LADN DNN provided by the UE during the PDU session establishment procedure until the LADN information for the specific LADN DNN is updated as described in subclause and subclause The UE shall not indicate the PDU session(s) for the LADN DNN provided by the UE during the PDU session establishment procedure in the Uplink data status IE included in the SERVICE REQUEST message until the LADN information for the specific LADN DNN is updated as described in subclause and subclause If the 5GSM cause value is #50 "PDU session type IPv4 only allowed", #51 "PDU session type IPv6 only allowed", #57 "PDU session type IPv4v6 only allowed", #58 "PDU session type Unstructured only allowed", or #61 "PDU session type Ethernet only allowed", the UE shall ignore the Back-off timer value IE provided by the network, if any.
The UE shall evaluate other URSP rules if available as specified in 3GPP specification document .
The UE shall not subsequently send another PDU SESSION ESTABLISHMENT REQUEST message for the same DNN (or no DNN, if no DNN was indicated by the UE) and the same S-NSSAI associated with (if available in roaming scenarios) a mapped S-NSSAI (or no S-NSSAI, if no S-NSSAI was indicated by the UE) using the same PDU session type until any of the following conditions is fulfilled: SESSION ESTABLISHMENT REJECT message was received; d) the UE is switched off; or e) the USIM is removed or the entry in the "list of subscriber data" for the current SNPN is updated.
For the 5GSM cause values #50 "PDU session type IPv4 only allowed", #51 "PDU session type IPv6 only allowed", #57 "PDU session type IPv4v6 only allowed", #58 "PDU se ssion type Unstructured only allowed", and #61 "PDU session type Ethernet only allowed", the UE shall ignore the value of the RATC bit in the Re-attempt indicator IE provided by the network, if any.
NOTE 5: For the 5GSM cause values #50 "PDU session type IPv4 only allowed", #51 "PDU session type IPv6 only allowed", #57 "PDU session type IPv4v6 only allowed", #58 "PDU session type Unstructured only allowed", and #61 "PDU session type Ethernet only allowed", re-attempt in S1 mode for the same DNN (or no DNN, if no DNN was indicated by the UE) using the same PDU session type is not allowed.
If the 5GSM cause value is #54 "PDU session does not exist", the UE shall ignore the Back-off timer value IE and Re- attempt indicator IE provided by the network, if any.
If the PDU session establishment procedure is to perform NOTE 6: User interaction is necessary in some cases when the UE cannot re-establish the PDU session(s) If the 5GSM cause value is #68 "not supported SSC mode", the UE shall ignore the Back-off timer value IE and Re-attempt indicator IE provided by the network, if any.
The UE shall evaluate other URSP rules if available as specified in 3GPP specification document .
The UE shall not subsequently send another PDU SESSION ESTABLISHMENT REQUEST message for the same DNN (or no DNN, if no DNN was indicated by the UE) and the same S-NSSAI associated with (if available in roaming scenarios) a mapped S-NSSAI (or no S-NSSAI, if no S-NSSAI was indicated by the UE) using the same SSC mode or an SSC mode which was not included in the Allowed SSC mode IE until any of the following conditions is fulfilled: SESSION ESTABLISHMENT REJECT message was received; b) the SSC mode which is used to access to the DNN (or no DNN, if no DNN was indicated by the UE) and the S- c) the UE is switched off; or d) the USIM is removed or the entry in the "list of subscriber data" for the current SNPN is updated.
If the UE receives the 5GSM cause value is #33 "reque sted service option not subscribed" upon sending PDU SESSION ESTABLISHMENT REQUEST to establish an MA PDU session, the UE shall ignore the Back-off timer value IE and Re-attempt indicator IE provided by the network, if any.
The UE shall evaluate URSP rules, if available, as specified in 3GPP specification document and the UE may send PDU SESSION ESTABLISHMENT REQUEST after evaluating those URSP rules.
Upon receipt of an indication from 5G MM sublayer that the 5GSM message was not forwarded because the DNN is not PDU session ID IE set to the PDU session ID of the PDU session, the UE: a) shall stop timer T3580; b) shall abort the procedure; and sent by the UE, until: 1) the UE is switched off; 2) the USIM is removed or the entry in the "list of subscriber data" for the current SNPN is updated; or 3) the DNN is included in the LADN information and the network updates the LADN information during the registration procedure or the generic UE configuration update procedure.
Handling the maximum number of established PDU sessions the maximum number of PDU session IDs allowed by the protocol (as specified in 3GPP specification document subclause 1b), the PLMN's maximum number of PDU sessions and the UE's implementation-specific maximum number of PDU sessions.
the 5GSM message was not forwarded because the PLMN's maximum number of PDU sessions has been reached, then the UE determines the PLMN's maximum number of PDU sessions as the number of active PDU sessions it has.
NOTE 1: In some situations, when attempting to establish multiple PDU sessions, the number of active PDU sessions that the UE has when 5GMM cause #65 is received is not equal to the maximum number of PDU sessions reached in the network.
NOTE 2: When the network supports emergency services, it is not expected that 5GMM cause #65 is returned by the network when the UE requests an emergency PDU session.
The PLMN's maximum number of PDU sessions applies to the PLMN in which the 5GMM cause #65 "maximum number of PDU sessions reached" is received.
When the UE is switched off, when the USIM is removed, or the entry in If the maximum number of established PDU sessions is reached at the UE and the upper layers of the UE request session is released.
If the UE needs to release an established PDU session, choosing which PDU session to release is implementation specific, however the UE shall not release the emergency PDU session.
A Handling the maximum number of allowed active user-plane resources for PDU sessions of UEs in NB-N1 mode resources supported" during the registration procedure for in itial registration or for mobility and periodic registration update, and one otherwise.
a) the UE's maximum number of supported user-plane resources is one, then only one PDU session can have active user-plane resources even though that UE might have established more than one PDU session; or b) the UE's maximum number of supported user-plane resources is two, then only two PDU sessions can have If the UE decides to release one or more active user-plane resources to cater for upper layer request, the UE shall release the PDU session via explicit 5GSM signalling.
Abnormal cases in the UE The following abnormal cases can be identified: a) Expiry of timer T3580 The UE shall, on the first expiry of the timer T3580: if the PDU SESSION ESTABLISHMENT REQUEST message was sent with request type set to "initial emergency request" or "existing emergency PDU session", then the UE may: a) inform the upper layers of the failure of the procedure; or NOTE: This can result in the upper layers requesting another emergency call attempt using domain selection as specified in 3GPP specification document .
b) de-register locally, if not de-registered already, attempt initial registration for emergency services.
otherwise, retransmit the PDU SESSION ESTABLISHMENT REQUEST message and the PDU session information which was transported together with the initial transmission of the PDU SESSION ESTABLISHMENT REQUEST message and shall reset and start timer T3580, if still needed.
This SESSION ESTABLISHMENT REQUEST message with the PDU session ID IE set to the same value as the PDU session ID that was sent by the UE, the UE shall stop timer T3580 and shall abort the procedure.
If the UE sent the PDU SESSION ESTABLISHMENT REQUEST message in order for the handover of an existing non- emergency PDU session between 3GPP access and non-3GPP access, the UE shall consider that the PDU session is associated with the source access type.
b1) Upon receiving an indication that the 5GSM message was not forwarded due to service area restrictions along value as the PDU session ID that was sent by the UE, the UE shall stop timer T3580 and shall abort the c) Collision of UE-requested PDU session establishment procedure and network-requested PDU session release ESTABLISHMENT REQUEST message to the network, and the PDU session ID in the PDU SESSION RELEASE COMMAND message is the same as the PDU session ID in the PDU SESSION ESTABLISHMENT REQUEST message, the UE shall ignore the PDU SESSION RELEASE COMMAND message and proceed with the UE-requested PDU session establishment procedure.
Abnormal cases on the network side The following abnormal cases can be identified: PDU SESSION ESTABLISHMENT REQUEST message b) The information for the PDU session authentication and authorization by the external DN in PDU DN request container is not compliant with local policy and user's subscription data PDU session", the PDU session authentication and authorization by the external DN is required due to local policy and user's subscription data and the information for the PDU session authentication and authorization by the external DN in the SM PDU DN request container IE is not compliant with the local policy and user's subscription data, the SMF shall reject the PDU session establishment request including the 5GSM cause #29 "user authentication or authorization failed", in the PDU SESSION ESTABLISHMENT REJECT message.
c) UE-requested PDU session establishment with request type set to "initial request" or "initial emergency request" for an existing PDU session: to the PDU session ID of an existing PDU session and with request type set to "initial request" or "initial emergency request", the SMF shall release locally the ex isting PDU session and proceed with the PDU session d) UE-requested PDU session establishment with request type "existing PDU session" or "existing emergency PDU "existing PDU session" or "existing emergency PDU session", and the SMF does not have any information about that PDU session, then the SMF shall reject the PDU se ssion establishment procedure with the 5GSM cause set to #54 "PDU session does not exist" in the PDU SESSION ESTABLISHMENT REJECT message.
e) 5G access network cannot forward the message: If the SMF determines based on content of the n2SmInfo attribute specified in 3GPP specification document [20A] that the DL NAS TRANSPORT message carrying the PDU SESSION ESTABLISHMENT ACCEPT was not forwarded to the UE by the 5G access network, then the SMF shall reject the PDU session establishment procedure with the 5GSM cause set to #26 "insufficient resources" in the PDU SESSION ESTABLISHMENT REJECT message.
UE-requested PDU session modification procedure.
The purpose of the UE-requested PDU session modification procedure is: e) to indicate to the network the relevant 5GSM parameters and capabilities (e.
the UE's 5GSM capabilities, whether the UE supports more than 16 packet filters, the maximum data rate per UE for user-plane integrity f) to delete one or more mapped EPS bearer contexts; procedure even if the UE is outside the LADN service area or the timer T3396, T3584, T3585 or the back-off timer is running or is deactivated.
T3584, T3585 or the back-off timer is running or is deactivat ed, the UE shall not initiate the UE-requested PDU session modification procedure and shall instead initiate the UE-requested PDU session release procedure.
If the UE needs to initiate the UE-requested PDU session modification procedure to indicate to the network the relevant 5GSM parameters and capabilities (e.
the UE's 5GSM capabilities, whether the UE supports more than 16 packet the UE-requested PDU session modification procedure after expiry of timer T3396, T3584 or T3585 or after expiry of the back-off timer.
UE-requested PDU session modification procedure initiation REQUEST message to the allocated PTI value.
for the error cases described in subclause and subclause rules or the requested QoS flow descriptions IE indicating requested QoS flow descriptions or both for the specific QoS handling.
The QoS rules IE includes the packet filters which describe the service data flows requested by the UE.
The rule operation code to "Create new QoS rule" and shall set the segregation bit to "Segregation requested" for the corresponding QoS rule in the QoS rules IE.
The UE shall set the QRI values to "no QoS rule identifier assigned" in the requested QoS rules IE, if the QoS rules are newly created; ot herwise, the UE shall set the QRI values to those of the existing QoS rules for which the specific QoS handling applies.
The UE shall set the QFI values to "no QoS flow identifier assigned" in the requested QoS flow descriptio ns IE, if the QoS flow descriptions are newly created; QoS rules IE containing more than one QoS rule with the rule operation code set to "Create new QoS rule", the SMF shall assign the same QFI to all the QoS rules which are created.
a) the UE is performing the PDU session modification procedure to indicate the support of reflective QoS, the UE shall set the RQoS bit to "Reflective QoS supporte d" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST message; or b) the UE is performing the PDU session modification procedure to indicate that reflective QoS is not supported, the UE shall set the RQoS bit to "Reflective QoS not supported" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST message.
The UE shall not indicate support for reflective QoS for this PDU Session for the remaining lifetime of the PDU Session.
a) the UE is performing the PDU session modification pr ocedure to indicate the support of Multi-homed IPv6 PDU session, the UE shall set the MHPDU bit to "Multi-homed IPv6 PDU session supported" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST message; or b) the UE is performing the PDU session modification pro cedure to indicate that Multi-homed IPv6 PDU session is not supported, the UE shall set the MHPDU bit to "Multi-homed IPv6 PDU session not supported" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST message.
"IPv4", "IPv6", "IPv4v6", or "Ethernet" PDU session type, and the UE supports more than 16 packet filters for this PDU session, the UE shall indicate the maximum number of packet filters supported for the PDU session in the Maximum number of supported packet filters IE of the PDU SESSION MODIFICATION REQUEST message.
If the UE is performing the PDU session modification procedure operation or packet filters, the UE shall include the 5GSM cause IE in the PDU SESSION MODIFICATION REQUEST message as described in MODIFICATION REQUEST message and setting the 3GPP PS data off UE status.
To request re-negotiation of IP header compression confi guration, the UE shall include the IP header compression configuration IE in the PDU SESSION MODIFICATION REQUEST message if the network indicated "Control plane CIoT 5GS optimization supported" and "IP header compression for control plane CIoT 5GS optimization supported" in the 5GS network support feature support IE.
To request re-negotiation of Ethernet header compression configuration, the UE shall include the Ethernet header compression configuration IE in the PDU SESSION MODIFICATION REQUEST message if the network indicated "Control plane CIoT 5GS optimization supported" and "Ethernet header compression for control plane CIoT 5GS optimization supported" in the 5GS network support feature support IE.
b) the PDU session type value of the PDU session type IE is set to "IPv4", "IPv6" or "IPv4v6"; c) the UE indicates "Control plane CIoT 5GS optimiza tion supported" and "IP header compression for control plane CIoT 5GS optimization supported" in the 5GMM capability IE of the REGISTRATION REQUEST d) the network indicates "Control plane CIoT 5GS optimization supported" and "IP header compression for control plane CIoT 5GS optimization supported" in the 5GS network support feature IE of the REGISTRATION ACCEPT message; the UE shall initiate the PDU session modification procedure to negotiate the IP header compression configuration and include the IP header compression configuration IE in the PDU SESSION MODIFICATION REQUEST message.
After an inter-system change from S1 mode to N1 mode, if: b) the PDU session type value of the PDU session type IE is set to "Ethernet"; c) the UE indicates "Control plane CIoT 5GS optimiza tion supported" and "Ethernet header compression for control plane CIoT 5GS optimization supported" in the 5GMM capability IE of the REGISTRATION d) the network indicates "Control plane CIoT 5GS optimization supported" and "Ethernet header compression for control plane CIoT 5GS optimization supported" in the 5GS network support feature IE of the REGISTRATION the UE shall initiate the PDU session modification procedure to negotiate the Ethernet header compression configuration and include the Ethernet header compre ssion configuration IE in the PDU SESSION MODIFICATION The UE shall transport: a) the PDU SESSION MODIFICATION REQUEST message; b) the PDU session ID; and c) if the UE-requested PDU session modification: request type set to "modification request"; and transporting the request type; using the NAS transport procedure as specified in subclause , and the UE shall start timer T3581 (see example in b) the may UE allow the network to upgrade the PDU session to an MA PDU session.
In order for the UE to allow the network to upgrade the PDU session to an MA PDU session, the UE shall set "MA PDU session network upgrade allowed" in the MA PDU session information IE and set the request type to "modification request" in the UL NAS TRANSPORT message.
In case UE executes case a) or b): 1) if the UE supports ATSSS Low-Layer functionality with any steering mode as specified in subclause of 3GPP specification document , the UE shall set the ATSSS-ST bits to "ATSSS Low-Layer functionality with any steering mode supported" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST message; steering mode supported" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST message; and 3) if the UE supports MPTCP functionality with any steering mode and ATSSS-LL functionality with any steering mode as specified in subclause of 3GPP specification document , the UE shall set the ATSSS-ST bits to "MPTCP functionality with any steering mode and ATSSS-LL functionality with any steering mode supported" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST message.
UE-requested PDU session modification procedure UE-requested PDU session modification procedure accepted by the network SMF shall handle the contents of the Port management information container IE as specified in 3GPP specification document and 3GPP specification document .
UE-requested PDU session modification procedure not accepted by the.
The SMF shall set the 5GSM cause IE of the PDU SESSION MODIFICATION REJECT message to indicate the reason for rejecting the PDU session modification.
The 5GSM cause IE typically indicates one of the following SM cause values: #29 user authentication or authorization failed; #31 request rejected, unspecified; #32 service option not supported; #35 PTI already in use; #43 Invalid PDU session identity; #46 out of LADN service area; #59 unsupported 5QI value; #67 insufficient resources for specific slice and DNN; #69 insufficient resources for specific slice; or #95 – 111 protocol errors.
the SMF shall include the 5GSM cause value #46 "out of LADN service area" in the 5GSM cause IE of the PDU SESSION MODIFICATION REJECT message.
If the Extended protocol configuration options IE of the PDU SESSION MODIFICATION REQUEST message indicates 3GPP PS data off UE status and the SMF detects the change of the 3GPP PS data off UE status, the SMF shall not include the 5GSM cause value #26 "insufficient resources", the 5GSM cause value #67 "insufficient resources for specific slice and DNN", the 5GSM cause value #69 "insufficient resources for specific slice" and the 5GSM cause value #46 "out of LADN service area" in the 5GSM cause IE of the PDU SESSION MODIFICATION REJECT message.
If the 5GSM cause value is #26"insufficient resources", #67 "insufficient resources for specific slice and DNN", or #69 The SMF shall send the PDU SESSION MODIFICATION REJECT message.
procedure as specified in subclause , the UE shall stop timer T3581, release the allocated PTI value, and enter the state PROCEDURE TRANSACTION INACTIVE.
Handling of network rejection due to congestion control.
the 5GSM cause value #26 "insufficient resources" and the Back-off timer value IE are included in the PDU SESSION MODIFICATION REJECT message; or establishment, the UE shall stop timer T3396 associated with the corresponding DNN, if it is running.
If the timer value indicates neither zero nor deactivated and no DNN was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop timer T3396 associated with no DNN if it is running.
The UE shall received from the 5GMM sublayer and: DNN that was sent by the UE, until timer T3396 expires or timer T3396 is stopped; and request type different from "initial emergency request" and different from "existing emergency PDU session", or another PDU SESSION MODIFICATION REQUEST message with exception of those establishment, the UE shall stop timer T3396 associated with the corresponding DNN, if it is running.
If the timer value indicates that this timer is deactivat ed and no DNN was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop timer T3396 associated with no DNN if it is running.
The UE: 1) shall not send another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION off, the USIM is removed, the entry in the "list of subscriber data" for the current SNPN is updated, or the c) if the timer value indicates zero, the UE: 1) shall stop timer T3396 associated with the corresponding DNN, if running, and may send another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message for the same DNN; and 2) if no DNN was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop timer If the timer T3396 is running when the UE enters state 5GMM-DEREGISTERED, the UE remains switched on, and the USIM in the UE remains the same or the entry in the "list of subscriber data" for the SNPN to which timer T3396 is associated is not updated, then timer T3396 is kept running until it expires or it is stopped procedure for emergency services.
the UE shall behave as follows: timer with the value t system change from S1 mode to N1 mode and timer T3396 associated with the corresponding DNN (or no DNN) is running, then the UE shall re-initiate the UE-requested PDU session modification procedure after expiry of timer.
the 5GSM cause value #67 "insufficient resources for specific slice and DNN" and the Back-off timer value IE are included in the PDU SESSION MODIFICATION REJECT message; or an indication that the 5GSM message was not forwarded due to S-NSSAI and DNN based congestion control is PDU session ID IE set to the PDU session ID of the PDU session; the UE shall ignore the Re-attempt indicator IE provided by the network, if any, and take different actions depending on are specified in subclause\): UE during the PDU session establishmen, the UE shall stop timer T3584 associated with the [S-NSSAI of the PDU session, DNN] combination, if it is running.
If the timer value indicates neither zero nor deactivated, an S-NSSAI and no DNN was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop timer T3584 associated with [S-NSSAI of the PDU session, no DNN] combination, if it is running.
If the timer value indicates UE shall stop timer T3584 associated with the [no S-NSSAI, DNN] combination, if it is running.
If the timer value indicates neither zero nor deactivated and neither S-NSSAI nor DNN was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop timer T3584 associated with the [no S-NSSAI, no DNN] combination, if it is running.
The UE shall then start timer T3584 with the value provided in the Back-off timer value IE or with the Back-off timer value received from the 5GMM sublayer and: 1) shall not send another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message with the exception of th ose identified in subclause , for the [S- NSSAI, DNN] combination, until timer T3584 expires or timer T3584 is stopped; 2) shall not send another PDU SESSION ESTABLISHMENT REQUEST message with request type different for the [S-NSSAI of the PDU session, no DNN] combination, if no DNN was provided during the PDU session establishment, until timer T3584 expires or timer T3584 is stopped; 3) shall not send another PDU SESSION ESTABLISHMENT REQUEST message, or another PDU SESSION MODIFICATION REQUEST message with the exception of those identified in subclause , for the [no S-NSSAI, DNN] combination, if no S-NSSAI was provided during the PDU session establishment, until timer T3584 expires or timer T3584 is stopped; and 4) shall not send another PDU SESSION ESTABLISHMENT REQUEST message with request type different for the [no S-NSSAI, no DNN] combination, if neither S-NSSAI nor DNN was provided during the PDU session establishment, until timer T3584 expires or timer T3584 is stopped.
1) if both S-NSSAI and DNN were provided by the UE during the PDU session establishment, the UE shall stop timer T3584 associated with the [S-NSSAI of the PDU session, DNN] combination, if it is running.
The UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message with exception of those identified in subclause , for the [S- subclause , for the [S-NSSAI of the PDU session, no DNN] combination, if no DNN was provided UE is switched off, the USIM is removed, the entry in the "list of subscriber data" for the current SNPN is 4) if neither S-NSSAI nor DNN were provided by the UE during the PDU session establishment, the UE shall the current SNPN is updated, or the UE receives an PDU SESSION MODIFICATION COMMAND message c) if the timer value indicates zero: 1) if both S-NSSAI and DNN were provided by the UE during the PDU session establishment, the UE shall stop timer T3584 associated with the [S-NSSAI of the PDU session, DNN] combination, if it is running.
The UE may send another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message for the [S-NSSAI of the PDU session, DNN] combination; the UE shall stop timer T3584 associated with the [S-NSSAI of the PDU session, no DNN] combination, if it is running.
The UE may send another PDU SESSION ESTABLISHMENT REQUEST message, or PDU SESSION MODIFICATION REQUEST message for the [S-NSSAI of the PDU session, no DNN] combination if the request type was different from "initial emergency request" and different from "existing emergency PDU session"; may send another PDU SESSION ESTABLISHMENT REQUEST message, or PDU SESSION MODIFICATION REQUEST message for the [no S-NSSAI, DNN] combination; and 4) if neither S-NSSAI nor DNN were provided by the UE during the PDU session establishment, the UE shall stop timer T3584 associated with the [no S-NSSAI, no DNN] combination, if it is running.
The UE may send another PDU SESSION ESTABLISHMENT REQUEST message, or PDU SESSION MODIFICATION REQUEST message for the [no S-NSSAI, no DNN] combination and the request type was different from "initial emergency request" and different from "existing emergency PDU session".
If the 5GSM congestion re-attempt indicator IE set to "The back-off timer is applied in all PLMNs" is included in the PDU SESSION MODIFICATION REJECT message with the 5GSM cause value #67 "insufficient resources for specific slice and DNN", then the UE shall apply the timer T3584 for all the PLMNs.
Otherwise, the UE shall apply the timer T3584 for the registered PLMN.
If the Back-off timer value IE is not included or no Back-off timer value is received from the 5GMM sublayer, then the REQUEST message for the same [S-NSSAI, DNN] combination, or for the same [S-NSSAI, no DNN] combination, or for the same [no S-NSSAI, DNN] combination, or for the same [no S-NSSAI, no DNN] combination.
procedure for emergency services.
If the timer T3584 is running when the UE enters state 5GMM-DEREGISTERED, the UE remains switched on, and the USIM in the UE remains the same or the entry in the "list of subscriber data" for the SNPN to which timer T3396 is associated is not updated, then timer T3584 is kept running until it expires or it is stopped.
the "list of subscriber data" for the SNPN to which timer T3396 is associated is not updated when the UE is switched on, the UE shall behave as follows: system change from S1 mode to N1 mode and timer T3584 associated with the corresponding [no S-NSSAI, DNN] combination or [no S-NSSAI, no DNN] combination is running, then the UE shall re-initiate the UE-requested PDU session modification procedure after expiry of timer T358.
the 5GSM cause value #69 "insufficient resources for specific slice" and the Back-off timer value IE are included in the PDU SESSION MODIFICATION REJECT message; or an indication that the 5GSM message was not forwarded due to S-NSSAI only based congestion control is PDU session ID IE set to the PDU session ID of the PDU session; the UE shall ignore the bit "RATC" and the bit "EPLMNC" in the Re-attempt indicator IE provided by the network, if any, and take different actions depending on the timer value received for timer T3585 in the Back-off timer value IE or a) If the timer value indicates neither zero nor deactivat ed and an S-NSSAI was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop timer T3585 associated with the S-NSSAI of the PDU session, if it is running.
If the timer value indicates neither zero nor deactivated and no S-NSSAI was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop timer T3585 associated with no S-NSSAI if it is 1) if an S-NSSAI was provided by the UE during the PDU session establishment, the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message with request type different from "initial emergency request" and different from "existing emergency PDU session", or another PDU SESSION MODIFICATION 2) if the request type was different from "initial emergency request" and from "existing emergency PDU session", and an S-NSSAI was not provided by the UE during the PDU session establishment, the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message without an S-NSSAI and with request type different from "initial emergency request" and different from "existing emergency PDU b) if the timer value indicates that this timer is deac tivated and an S-NSSAI was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop timer T3585 associated with the S-NSSAI of the PDU session, if it is running.
If the timer value indicates that this timer is deactivated and no S-NSSAI was provided during the PDU session establishment and the request type was different from "initial emergency request" and different from "existing emergency PDU session", the UE shall stop timer T3585 associated with no S-NSSAI if it is running.
In addition: 1) if an S-NSSAI was provided by the UE during the PDU session establishment, the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message with request type different from "initial emergency request" and different from "existing emergency PDU session", or another PDU SESSION MODIFICATION 2) if the request type was different from "initial emergency request" and from "existing emergency PDU session", and an S-NSSAI was not provided by the UE during the PDU session establishment, the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message without an S-NSSAI and with c) if the timer value indicates zero: 1) if an S-NSSAI was provided by the UE during the PDU session establishment, the UE shall stop timer T3585 associated with the S-NSSAI of the PDU session, if running, and may send another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message for the S-NSSAI of the PDU session; and 2) if no S-NSSAI was provided during the PDU session establishment and the request type was different from "initial emergency request " and different from "existing emergency PDU session", the UE shall stop timer T3585 associated with no S-NSSAI, if running, and may send another PDU SESSION ESTABLISHMENT REQUEST message without an S-NSSAI, or an other PDU SESSION MODIFICATION REQUEST message without an S-NSSAI provided by the UE.
If the 5GSM congestion re-attempt indicator IE set to "The back-off timer is applied in all PLMNs" is included in the PDU SESSION MODIFICATION REJECT message with the 5GSM cause value #69 "insufficient resources for specific slice", then the UE shall apply the timer T3585 for all the PLMNs.
Otherwise, the UE shall apply the timer T3585 for the registered PLMN.
If the Back-off timer value IE is not included or no Back-off timer value is received from the 5GMM sublayer, then the REQUEST message for the same S-NSSAI or without an S-NSSAI.
procedure for emergency services.
If the timer T3585 is running when the UE enters state 5GMM-DEREGISTERED, the UE remains switched on, and the USIM in the UE remains the same or the entry in the "list of subscriber data" for the SNPN to which timer T3396 is associated is not updated, then timer T3585 is kept running until it expires or it is stopped.
the "list of subscriber data" for the SNPN to which timer T3396 is associated is not updated when the UE is switched on, the UE shall behave as follows: system change from S1 mode to N1 mode and timer T3585 associated with no S-NSSAI is running, then the UE shall re-initiate the UE-requested PDU session modification procedure after expiry of timer T358 NOTE 3: As described in this subclause, upon PLMN change or inter-system change, the UE does not stop the timer T3584 or T358 This means the timer T3584 or T3585 can still be running or be deactivated for the given 5GSM procedure, the PLMN, the S-NSSAI and optionally the DNN combination when the UE returns to the PLMN or when it performs inter-system change back from S1 mode to N1 mode.
Thus the UE can still be prevented from sending another PDU SESSION ESTABLISHMENT REQUEST or PDU SESSION MODIFICATION REQUEST message in the PLMN for the same S-NSSAI and optionally the same DNN.
ESTABLISHMENT REQUEST message for the same S-NSSAI in the new PLMN.
Handling of network rejection not due to congestion control If the 5GSM cause value is different from #26 "insufficient resources", #46 "out of LADN service area", #59 "unsupported 5QI value", #67 "insufficient resources for specific slice and DNN", and #69 "insufficient resources for configured for high priority access in selected PL MN, exceptions are specified in subclause 2): a) if the timer value indicates neither zero nor deactivated and: 1) if the UE provided DNN and S-NSSAI to the network during the PDU session establishment, the UE shall start the back-off timer with the value provided in the Back-off timer value IE for the PDU session modification procedure and [PLMN, DNN, S-NSSAI] combination.
The UE shall not send another PDU session establishment, it shall start the back-off timer accordingly for the PDU session modification procedure and the [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, S-NSSAI] or [PLMN, no DNN, no S- NSSAI] combination.
Dependent on the combination, the UE shall not send another PDU SESSION MODIFICATION REQUEST message with exception of those identified in subclause , for the same [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, S-NSSAI] or [PLMN, no DNN, no S-NSSAI] combination in the current PLMN, until the back-off timer expires, the UE is switched off, the USIM is removed, or the entry in the "list of subscriber data" for the current SNPN is updated; b) if the timer value indicates that this timer is deactivated and: 1) if the UE provided DNN and S-NSSAI to the network during the PDU session establishment, the UE shall not send another PDU SESSION MODIFICATION REQUEST message with exception of those identified in subclause , for the same DNN and S-NSSAI in the current PLMN, until the UE is switched off, the USIM is removed, or the entry in the "list of subscriber data" for the current SNPN is updated; or session establishment, the UE shall not send another PDU SESSION MODIFICATION REQUEST message with exception of those identified in subclause , for the same [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, S-NSSAI] or [PLMN, no DNN, no S-NSSAI] combination in the current PLMN, until the UE is switched off, the USIM is removed, or the entry in the "list of subscriber data" for the current SNPN is updated; and c) if the timer value indicates zero, the UE may send another PDU SESSION MODIFICATION REQUEST message for the same combination of [PLMN, DNN, S-NSSAI], [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, S-NSSAI], or [PLMN, no DNN, no S-NSSAI] in the current PLMN.
If the Back-off timer value IE is not included, then the UE shall ignore the Re-attempt indicator IE provided by the network in the PDU SESSION MODIFICATION REJECT message, if any.
a) Additionally, if the 5GSM cause value is #32 "servi ce option not supported", or #33 "requested service option 1) the UE not operating in SNPN access mode shall proceed as follows: as described above in the present subclause using the configured SM Retry Timer value as specified in 3GPP specification document or in USIM file NAS CONFIG as specified in 3GPP specification document , if available, as back-off timer value; and the SM Retry Timer value is not configured, the UE shall behave as described above in the present subclause, using the default value of 12 minutes for the back-off timer; or 2) the UE operating in SNPN access mode shall proceed as follows: A) the SM Retry Timer value for the current SNPN as specified in 3GPP specification document is available; or B) the SM Retry Timer value in USIM file NAS CONFIG as specified in 3GPP specification document is available and the UE used the USIM for registration to the current SNPN; then the UE shall behave as described above in the present subclause using the configured SM Retry Timer value as back-off timer value; or NOTE 0: The way to choose one of the configured SM Retry Timer values for back-off timer value is up to UE implementation if both conditions in bullets A) and B) above are satisfied.
ii) otherwise, the UE shall behave as described above in the present subclause, using the default value of 12 minutes for the back-off timer.
The UE shall not stop any back-off timer: b) upon an inter-system change; or c) upon registration over another access type.
NOTE 1: This means the back-off timer can still be running or be deactivated for the given 5GSM procedure when the UE returns to the PLMN or when it performs inter-system change back from S1 mode to N1 mode.
Thus the UE can still be prevented from sending another PDU SESSION MODIFICATION REQUEST message for the combination of [PLMN, DNN, S-NSSAI], [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, S-NSSAI], or [PLMN, no DNN, no S-NSSAI] in the PLMN.
timer is deactivated, the UE behaves as follows: combination of [new PLMN, DNN, S-NSSAI], [new PLMN, DNN, no S-NSSAI], [new PLMN, no DNN, S-NSSAI], or [new PLMN, no DNN, no S-NSSAI] in the new PLMN, if the back-off timer is not running and is not deactivated for the PDU session modification procedure and the combination of [new PLMN, DNN, S- NSSAI], [new PLMN, DNN, no S-NSSAI], [new PLMN, no DNN, S-NSSAI], or [new PLMN, no DNN, no S-NSSAI]; Furthermore, as an implementation option, for the 5GSM cause value #32 "service option not supported" or #33 combination of [PLMN, DNN, S-NSSAI], [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, S-NSSAI], or b) if the network does not include the Re-attempt indicator IE to indicate whether re-attempt in S1 mode is allowed, or the UE ignores the Re-attempt indicator IE, e.
becau se the Back-off timer value IE is not included, then: running for the combination of [PLMN, DNN, S-NSSAI] or [PLMN DNN, no S-NSSAI], the UE shall apply the configured value SM_RetryAtRATChange value as specified in 3GPP specification document or in USIM file NAS CONFIG as specified in 3GPP specification document , if available, to determine whether the UE may attempt an [PLMN, DNN] combination in S1 mode; and configuration MO as specified in 3GPP specification document is not available and the value for inter-system change is not configured in the USIM file NAS CONFIG , then the UE behaviour regarding an EPS bearer resource allocation procedure or an EPS bearer resource modification procedure for the same [PLMN, DNN] combination in S1 mode is unspecified; and c) if the network includes the Re-attempt indicator IE indicating that re-attempt in an equivalent PLMN is not or deactivate the back-off timer for N1 mode only; and 2) otherwise, the UE shall start or deactiv ate the back-off timer for S1 and N1 mode.
If the back-off timer for a [PLMN, DNN] or [PLMN, no DN N] combination was started or deactivated in S1 mode upon receipt of BEARER RESOURCE ALLOCATION REJECT message or BEARER RESOURCE MODIFICATION this PLMN for the same DNN after inter-system change to N1 mode.
If the network indicated that re-attempt in N1 mode is not allowed, the UE shall not send any PDU SESSION MODIFICATION REQUEST message with exception of those identified in subclause , in this PLMN for the same DNN in combination with any S-NSSAI or without S-NSSAI, after inter-system change to N1 mode until the timer expires, the UE is switched off or the USIM is removed.
If the 5GSM cause value is #46 "out of LADN service area", the UE shall ignore the Back-off timer value IE and Re-attempt indicator IE provided by the network, if any.
The UE shall not send another PDU SESSION MODIFICATION REQUEST message or another PDU SESSION ESTABLISHMENT REQUEST message for the LADN DNN provided by the UE during the PDU session establishment procedure until the LADN information for the specific LADN DNN is updated as described in subclause and subclause The UE shall not indicate the PDU session(s) for the LADN DNN provided by the UE during the PDU session establishment procedure in the Uplink data status IE included in the SERVICE REQUEST message until the LADN information for the specific LADN DNN is updated as described in subclause and subclause If the 5GSM cause value is #59 "unsupported 5QI value", the UE shall ignore the Back-off timer value IE and Re- attempt indicator IE provided by the network, if any.
The UE should pass the corresponding error cause to the upper layers.
NOTE 4: How to solve the issue of unsupported 5QI value in the upper layers is UE implementation specific.
Abnormal cases in the UE The following abnormal cases can be identified: a) Expiry of timer T358 The UE shall, on the first expiry of the timer T3581, retransmit the PDU SESSION MODIFICATION REQUEST message and the PDU session information which was transported together with the initial transmission of the PDU SESSION MODIFICATION REQUEST message and shall reset and start timer T358 This retransmission is repeated four times, i.
on the fifth expiry of timer T3581, the UE shall abort the procedure and shall rel ease the allocated PTI.
b) Invalid PDU session identity.
Upon receipt of the PDU SESSION MODIFICATION REJECT message including 5GSM cause #43 "invalid.
c) Collision of network-requested PDU session release procedure and UE-requested PDU session modification modification procedure, and the PDU session indi cated in the PDU SESSION RELEASE COMMAND message is the PDU session that the UE had requested to modify, the UE shall abort the PDU session modification procedure and proceed with the network-requested PDU session release procedure.
session of IPv4, IPv6, IPv4v6 or Ethernet PDU session type for which the UE has already revoked the usage of e) Collision of network-requested PDU session modification procedure and UE-requested PDU session The handling of the same abnormal case as described in subclause applies.
f) Upon receiving an indication that the 5GSM message was not forwarded due to service area restrictions along as the PDU session ID that was sent by the UE, the UE shall abort the procedure and shall stop the timer T358 SESSION MODIFICATION REQUEST message with the PDU session ID IE set to the same value as the PDU session ID that was sent by the UE, the UE shall stop timer T3581 and shall abort the procedure.
Abnormal cases on the network side The following abnormal cases can be identified: a) If the PDU session is an emergency PDU session and the 5GSM cause IE is not included in the PDU SESSION MODIFICATION REQUEST message or is set to a 5GSM cause other than the 5GSM causes #41, #42, #44, #45, #83, #84, and #85, the SMF shall reject the PDU SESSION MODIFICATION REQUEST message with 5GSM cause #31 "request rejected, unspecified".
b) PDU session inactive for the received PDU session identity.
If the PDU session ID in the PDU SESSION MODIFICATION REQUEST message belongs to any PDU session in state PDU SESSION INACTIVE in the SMF, the SMF shall set the 5GSM cause IE to #43 "Invalid PDU session identity" in the PDU SESSION MODIFICATION REJECT message.
c) Collision of network-requested PDU session modification procedure and UE-requested PDU session The handling of the same abnormal case as described in subclause applies.
d) AMF provides a "message was exempted from the DNN based congestion activated in the AMF" but the UE- requested PDU session modification procedure is not exempt from DNN based congestion control.
If the SMF receives an exemptionInd attribute in dicating "message was exempted from the DNN based congestion activated in the AMF" as specified in 3GPP specification document [20A], and the Extended protocol PS data off UE status, then the SMF shall set the 5GSM cause #26 "insufficient resources" in the PDU SESSION MODIFICATION REJECT message.
e) AMF provides a "message was exempted from the S-NSSAI and DNN based congestion activated in the AMF" but the UE-requested PDU session modification procedure is not exempt from S-NSSAI only based congestion control.
If the SMF receives an exemptionInd attribute indi cating "message was exempted from the S-NSSAI and DNN PS data off UE status, then the SMF shall set the 5GSM cause #67 "insufficient resources for specific slice and DNN" in the PDU SESSION MODIFICATION REJECT message.
f) AMF provides a "message was exempted from the S- NSSAI only based congestion activated in the AMF" but the UE-requested PDU session modification procedure is not exempt from S-NSSAI only based congestion If the SMF receives an exemptionInd attribute indicating "message was exempted from the S-NSSAI only based congestion activated in the AMF" as specified in 3GPP specification document [20A], and the Extended protocol If the SMF determines based on content of the n2SmInfo attribute specified in 3GPP specification document [20A] that the DL NAS TRANSPORT message carrying the PDU SE SSION MODIFICATION COMMAND message was not value in the PDU SESSION MODIFICATION REJECT message.
NOTE: The use of an appropriate 5GSM cause value is implementation specific.
UE-requested PDU session release procedure.
The UE is allowed to initiate the PDU session release procedure even if the timer T3396 is running.
The UE is allowed to initiate the PDU session release procedure even if the timer T3584 is running.
The UE is allowed to initiate the PDU session release procedure even if the timer T3585 is running.
The UE is allowed to initiate the PDU session release procedure even if the UE is outside the LADN service area.
UE-requested PDU session release procedure initiation The UE may set the 5GSM cause IE of the PDU SESSION RELEASE REQUEST message to indicate the reason for releasing the PDU session.
The 5GSM cause IE typically indicates one of the following 5GSM cause values: #36 regular deactivation; #41 Semantic error in the TFT operation; #42 Syntactical error in the TFT operation; #44 Semantic errors in packet filter(s); #45 Syntactical error in packet filter(s).
REQUEST message to the allocated PTI value.
The UE shall transport the PDU SESSION RELEASE REQUEST message and the PDU session ID, using the NAS transport procedure as specified in subclause , and the UE shall start timer T3582 (see example in figure\).
If the UE is releasing the PDU session due to: a) errors in QoS operations or packet filters; or b) the number of the authorized QoS rules, the number of the packet filters, or the number of the authorized QoS flow descriptions associated with the PDU session have reached the maximum number supported by the UE, the UE shall include the 5GSM cause IE in the PDU SESSION RELEASE REQUEST message as described in Network-requested PDU session release procedurePDU SESSION RELEASE REQUES.
PDU SESSION RELEASE REJECTStop T3582OR UE-requested PDU session release procedure UE-requested PDU session release procedure accepted by the network request to release the PDU session, and shall perform the ne twork-requested PDU session release procedure as specified UE-requested PDU session release procedure not accepted by the network The SMF shall set the 5GSM cause IE of the PDU SESSION RELEASE REJECT message to indicate the reason for rejecting the PDU session release.
The 5GSM cause IE typically indicates one of the following SM cause values: #35 PTI already in use; or #43 Invalid PDU session identity; or #95 – 111: protocol errors.
procedure as specified in subclause , the UE shall st op timer T3582, release the allocated PTI value and locally release the PDU session.
Abnormal cases in the UE The following abnormal cases can be identified: a) Expiry of timer T358 The UE shall, on the first expiry of the timer T3582, retransmit the PDU SESSION RELEASE REQUEST message and the PDU session information which was transported together with the initial transmission of the PDU SESSION RELEASE REQUEST message and shall reset and start timer T358 This retransmission is repeated four times, i.
on the fifth expiry of timer T 3582, the UE shall abort the pr ocedure, release the allocated session release procedure, and the PDU session indicated in PDU SESSION MODIFICATION COMMAND message is the PDU session that the UE had requested to release, the UE shall ignore the PDU SESSION MODIFICATION COMMAND message and proceed wi th the PDU session release procedure.
c) Collision of UE-requested PDU session release procedure and network-requested PDU session release transaction identity assigned" during the UE-requested PDU session release procedure, and the PDU session indicated in the PDU SESSION RELEASE COMMAND message is the same as the PDU session that the UE requests to release, the UE shall abort the UE-request ed PDU session release procedure and shall stop the timer T3582 and proceed with the network-requested PDU session release procedure.
Abnormal cases on the network side The following abnormal cases can be identified: a) PDU session inactive for the received PDU session identity.
If the PDU session ID in the PDU SESSION RELEASE REQUEST message belongs to any PDU session in state PDU SESSION INACTIVE in the SMF, the SMF shall send the PDU SESSION RELEASE REJECT message to the UE with the 5GSM cause #43 "Invalid PDU session identity".
The purpose of the sending of the 5GSM STATUS message is to report at any time certain error conditions detected upon receipt of 5GSM protocol data.
The 5GSM STATUS message can be sent by both the network and the UE (see 5GSM status received in the UE If the 5GSM entity of the UE receives a 5GSM STATUS message the UE shall take different actions depending on the received 5GSM cause value: The UE shall abort any ongoing 5GSM procedure related to the received PTI value and stop any related timer.
#97 Message type non-existent or not implemented.
The UE shall abort any ongoing 5GSM procedure related to the PTI or PDU session ID and stop any related On receipt of a 5GSM STATUS message with any other 5GSM cause value no state transition and no specific action shall be taken as seen from the radio interface, i.
local actions are possible.
5GSM status received in the SMF If the SMF receives a 5GSM STATUS message the SMF shall take different actions depending on the received 5GSM cause value: #43 invalid PDU session identity.
The SMF shall abort any ongoing 5GSM procedure related to the PTI or PDU session ID, stop any related timer and locally release the PDU session indicated in the 5GSM STATUS message.
#81 invalid PTI value.
The SMF shall abort any ongoing 5GSM procedure related to the received PTI value and stop any related timer.
#96 invalid mandatory information.
The SMF shall abort any ongoing 5GSM procedure related to the PTI or PDU session ID and stop any related #97 message type non-existent or not implemented.
The SMF shall abort any ongoing 5GSM procedure related to the PTI or PDU session ID and stop any related The local actions to be taken by the SMF on receipt of a 5GSM STATUS message with any other 5GSM cause value Exchange of extended protoc ol configuration options The UE and the SMF can exchange protocol configuration options via 5GSM procedures.
The protocol configuration options shall be exchanged via the Extended protocol configuration options IE.
The procedures specified in the present document apply to those messages which pass the checks described in this This subclause also specifies procedures for the handling of unknown, unforeseen, and erroneous protocol data by the Subclauses to shall be applied in order of precedence.
Detailed error handling procedures in the network are implementation dependent and may vary from PLMN to PLMN.
However, when extensions of this protocol are developed, networks are assumed to have the error handling which is indicated in this subclause as mandatory ("shall") and that is indicated as strongly recommended ("should").
For definition of semantical and syntactical errors see 3GPP specification document , subclause 1 Message too short or too long Unknown or unforeseen proc edure transaction identity or The following network procedures shall apply for handling an unknown, erroneous, or unforeseen PTI received in a value is an assigned or unassigned value that does not match any PTI in use, the network shall respond with a 5GSM STATUS message including 5GSM cause #47 "PTI mismatch".
value is an assigned value, the network shall respond with a 5GSM STATUS message including 5GSM cause #81 "invalid PTI value".
value is an unassigned value, the network shall respond with a 5GSM STATUS message including 5GSM cause #81 "invalid PTI value".
The following UE procedures shall apply for handling an unknown, erroneous, or unforeseen PTI received in a 5GSM message: MODIFICATION REJECT message in which the PTI value is an assigned value that does not match any PTI in use: 3) otherwise, the UE shall respond with a 5GSM STATUS message including 5GSM cause #47 "PTI REJECT message in which the PTI value is an assigned value that does not match any PTI in use: 2) otherwise, the UE shall respond with a 5GSM STATUS message including 5GSM cause #47 "PTI ESTABLISHMENT REJECT message in which the PTI value is an assigned value that does not match any PTI in use: 1) the UE shall respond with a 5GSM STATUS message including 5GSM cause #47 "PTI mismatch".
AUTHENTICATION RESULT message in which the PTI value is an assigned value, the UE shall respond with a 5GSM STATUS message including 5GSM cause #81 "invalid PTI value".
The following network procedures shall apply for handling an unknown, erroneous, or unforeseen PDU session identity REJECT message including 5GSM cause #43 "invalid PDU session identity".
message including 5GSM cause #43 "invalid PDU session identity".
c) Upon receipt of an UL NAS TRANSPORT message, the network takes the following actions: 1) If the Request type IE is set to "initial request" or "initial emergency request" and the message includes a 2) otherwise, if the message includes an unassigned or reserved PDU session identity value, the network shall d) If the network receives a 5GSM message other than those listed in items a) through c) above in which the The following UE procedures shall apply for handling an unknown, erroneous, or unforeseen PDU session identity received in the header of a 5GSM message: a) If the UE receives a 5GSM message which includes an unassigned or reserved PDU session identity value, the UE shall ignore the message.
state PDU SESSION INACTIVE in the UE, the UE shall respond with a 5GSM STATUS message including 5GSM cause #43 "invalid PDU session identity".
Unknown or unforeseen message type If UE receives a 5GMM message or 5GSM message with message type not defined for the extended protocol If the network receives a 5GMM or 5GSM message with message type not defined for the EPD or not implemented by foreseen in the protocol, the network actions are implementation dependent.
Otherwise, if the network receives a type not defined for the EPD, see 3GPP specification document .
Non-semantical mandatory information element errors a) an "imperative message part" error; or b) a "missing mandatory IE" error the UE shall proceed as follows: If the message is not one of the messages listed in the UE procedures in subclause , item a), b) or c), the UE the network shall proceed as follows: If the message is not one of the messages listed in the network procedures in subclause , item a), b) or c), the network shall either: 1) try to treat the message (the exact further actions are implementation dependent); or depending on the EPD) with cause #96 "invalid mandatory information".
No exceptional cases are described for 5GS mobility management messages.
No semantical or syntactical diagnosis other than presence and length shall be performed on the EPS NAS message container information element in the REGISTRATION REQUEST message.
COMMAND REJECT message with 5GSM cause #96 "invalid mandatory information" shall be returned.
message with 5GSM cause #96 "invalid mandatory information" shall be returned.
in a 5GSM message: REJECT message with 5GSM cause #96 "invalid mandatory information" shall be returned.
message with 5GSM cause #96 "invalid mandatory information" shall be returned.
5GSM cause #96 "invalid mandatory information" shall be returned.
message part IEIs unknown in the message The network shall take the same approach.
Out of sequence IEs The network should take the same approach.
information element is not specified in clause 8 and clause 9 of the present document, the UE shall handle only the contents of the information element appearing first and sh all ignore all subsequent repetitions of the information element.
When repetition of information elements is specified, the UE shall handle only the contents of specified repeated information elements.
If the limit on repetition of information elements is exceeded, the UE shall handle the of the information element.
The network should follow the same procedures.
Non-imperative message part errors a) syntactically incorrect optional IEs; and b) conditional IE errors.
Syntactically incorrect optional IEs When upon receipt of a 5GMM or 5GSM message the UE dia gnoses a "missing conditional IE" error or an "unexpected conditional IE" error, or when it receives a 5GMM or 5GSM message containing at least one syntactically incorrect a) try to treat the message (the exact further actions are implementation dependent); or depending on the EPD) with cause #100 "conditional IE error".
procedural part of the present document (i.
of clauses 5, 6).
If, however no such reactions are specified, the UE shall EPD) with cause #95 "semantically incorrect message".
8 Message functional definitions and contents.
5GS mobility management messages The AUTHENTICATION REQUEST message is sent by the AMF to the UE to initiate authentication of the UE Message type: AUTHENTICATION REQUEST Significance: dual Direction: network to UE Table : AUTHENTICATION REQUEST message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
ngKSI NAS key set identifier.
Spare half octet Spare half octet.
0 M LV n 21 Authentication parameter RAND (5G authentication challenge) Authentication parameter RAND 20 Authentication parameter AUTN (5G authentication challenge) Authentication parameter AUTN 78 EAP message EAP message Authentication parameter RAND IE is included if the AUTHENTICATION REQUEST message is used in a 5G AKA.
EAP message IE is included if the AUTHENTICATION REQUEST message is used in an EAP based primary authentication and key agreement procedure.
Message type: AUTHENTICATION RESPONSE Significance: dual Direction: UE to network Table : AUTHENTICATION RESPONSE message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
parameter Authentication response parameter 78 EAP message EAP message The AUTHENTICATION RESULT message is sent by the AMF to the UE to provide result of EAP authentication of the UE identity.
See table Message type: AUTHENTICATION RESULT Table : AUTHENTICATION RESULT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
ngKSI NAS key set identifier.
Spare half octet Spare half octet.
EAP message EAP message 0 O TLV n This IE shall be included if the message contains an EAP message IE with an EAP-success message.
The AUTHENTICATION FAILURE message is sent by the UE to the AMF to indicate that authentication of the network has failed.
See table Message type: AUTHENTICATION FAILURE Significance: dual Direction: UE to network Table : AUTHENTICATION FAILURE message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
5GMM cause 5GMM cause 
30 Authentication failure parameter Authentication failure parameter The AUTHENTICATION REJECT message is sent by the AMF to the UE to indicate that the authentication procedure has failed and that the UE shall abort all activities.
See table Message type: AUTHENTICATION REJECT Direction: network to UE Table : AUTHENTICATION REJECT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
78 EAP message EAP message EAP message IE is included if the AUTHENTICATION REJECT message is used to convey EAP-failure message.
The REGISTRATION REQUEST message is sent by the UE to the AMF.
See table Message type: REGISTRATION REQUEST Significance: dual Direction: UE to network Security header type Security header type Spare half octet Spare half octet.
5GS registration type 5GS registration type.
ngKSI NAS key set identifier.
5GS mobile identity 5GS mobile identity C- Non-current native NAS key set identifier NAS key set identifier 2 O TV 1 10 5GMM capability 5GMM capability 2E UE security capability UE security capability 2F Requested NSSAI NSSAI 52 Last visited registered TAI 5GS tracking area identity 17 S1 UE network capability S1 UE network capability 40 Uplink data status Uplink data status 50 PDU session status PDU session status B- MICO indication MICO indication 2B UE status UE status 77 Additional GUTI 5GS mobile identity 25 Allowed PDU session status Allowed PDU session status 18 UE's usage setting UE's usage setting 51 Requested DRX parameters 5GS DRX parameters 70 EPS NAS message container EPS NAS message container 4 O TLV-E n 74 LADN indication LADN indication Payload container type Payload container type 7B Payload container Payload container Network slicing indication Network slicing indication 53 5GS update type 5GS update type 41 Mobile station classmark 2 Mobile station classmark 2 42 Supported codecs Supported codec list 71 NAS message container NAS message container 3 O TLV-E n 60 EPS bearer context status EPS bearer context status 6E Requested extended DRX parameters Extended DRX parameters 35 Requested mapped NSSAI Mapped NSSAI 48 Additional information requested Additional information requested 1A Requested WUS assistance information WUS assistance information 1 O TLV n XX N5GC indication N5GC indication.
30 Requested NB-N1 mode DRX parameters NB-N1 mode DRX parameters 3 O TLV 3 Non-current native NAS key set identifier This IE shall be included by the UE when performing the registration procedure if the 5GS registration type IE indicates: a) "initial registration", according to the conditions specified in subclause ; or b) "mobility registration updating", according to the conditions specified in subclause Last visited registered TAI S1 UE network capability This IE shall be included if the UE has uplink user data pending to be sent.
the message is sent over, that are active within the UE.
The UE may include this IE to request the use of MICO mode.
change from S1 mode to N1 mode or if the UE in dual-registration mode and EMM state EMM-REGISTERED 3 Allowed PDU session status with non-3GPP access allowed to be re-established over 3GPP access.
4 UE's usage setting This IE shall be included if the UE supports IMS voice.
5 Requested DRX parameters If the UE wants to use or change the UE specific DRX parameters, the UE shall include the Requested DRX parameters IE in the REGISTRATION REQUEST message.
6 EPS NAS message container AREA UPATE REQUEST message, using EPS security context.
The UE performing initial registration shall include this information element if 1) was previously registered in S1 mode before entering state EMM-DEREGISTERED; and 2) has received an "interworking without N26 interface not supported" indication from the network; and The content of this message container is the complete integrity protected ATTACH REQUEST message, using EPS 7A Payload container type This IE shall be included if the UE includes the Payload container IE.
NOTE: In this version of the protocol, the Payload container type IE in the REGISTRATION REQUEST message is set to "UE policy container" as described in subclauses and with the PLMN ID part indicating the HPLMN or the select ed PLMN for the registration procedure for mobility and Within an SNPN, this IE shall be included if the UE has one or more stored UE policy sections for the selected SNPN for the registration procedure for initial registration.
9 Network slicing indication 0 5GS update type b) a change in the UE's radio capability for NG-RAN; or c) the UE requests CIoT 5GS optimizations.
1 NAS message container 2 Requested extended DRX parameters The UE shall include this IE if the UE needs to use extended DRX or change the extended DRX parameters.
3 EPS bearer context status The UE shall include this IE if the UE operating in the single-registration mode performs inter-system change from S1 mode to N1 mode and the UE has locally deactivated EPS bearer context(s) for which interworking to 5GS is supported while the UE was in S1 mode without notifying the network.
The UE may include this IE during the registration update procedure if it requests to use MICO mode and use the active time timer.
5 Mobile station classmark 2 This IE shall be included if the UE supports 5G-SRVCC from NG-RAN to UTRAN (see 3GPP specification document [6A]).
This IE shall be included if the UE supports 5G-SRVCC from NG-RAN to UTRAN.
7 UE radio capability ID 8 Requested mapped NSSAI associated only with an S-NSSAI that is applicable in the HPLMN as specified in clause 0 Requested WUS assistance information The UE may include this IE if the UE supports WUS assistance information and the UE is not performing the initial registration for emergency services.
This IE shall be included in the REGISTRATION REQUEST message when the W-AGF is acting on behalf of an 3 Requested NB-N1 mode DRX parameters The UE shall include this IE if the UE wants to use or change the UE specific DRX parameters for NB-N1 mode.
The REGISTRATION ACCEPT message is sent by the AMF to the UE.
See table Message type: REGISTRATION ACCEPT Significance: dual Direction: network to UE Security header type Security header type Spare half octet Spare half octet.
5GS registration result 5GS registration result 77 5G-GUTI 5GS mobile identity 4A Equivalent PLMNs PLMN list 54 TAI list 5GS tracking area identity list 15 Allowed NSSAI NSSAI 11 Rejected NSSAI Rejected NSSAI 31 Configured NSSAI NSSAI 21 5GS network feature support 5GS network feature support 50 PDU session status PDU session status 26 PDU session reactivation result PDU session reactivation result 72 PDU session reactivation result error cause PDU session reactivation result error cause 79 LADN information LADN information B- MICO indication MICO indication Network slicing indication Network slicing indication 27 Service area list Service area list 5D Non-3GPP de-registration timer value GPRS timer 2 O TLV 3 34 Emergency number list Emergency number list 7A Extended emergency number list Extended emergency number list 73 SOR transparent container SOR transparent container 1 O TLV-E 2n 78 EAP message EAP message A- NSSAI inclusion mode NSSAI inclusion mode 76 Operator-defined access category definitions Operator-defined access category 8 O TLV-E n 51 Negotiated DRX parameters 5GS DRX parameters D- Non-3GPP NW policies Non-3GPP NW provided policies 60 EPS bearer context status EPS bearer context status 67 UE radio capability ID UE radio capability ID 8 O TLV n 68 UE radio capability ID deletion indication UE radio capability ID deletion 39 Pending NSSAI NSSAI 74 Ciphering key data Ciphering key data 75 CAG information list CAG information list configuration Truncated 5G-S-TMSI configuration 0 O TLV 3 1C Negotiated WUS assistance information WUS assistance information 1 O TLV n 29 Negotiated NB-N1 mode DRX parameters NB-N1 mode DRX parameters 3 O TLV 3 This IE shall be included: a) if the network allows one or more S-NSSAIs received in the requested NSSAI of the REGISTRATION 1) the requested NSSAI was not included in the REGISTRATION REQUEST message or none of the requested NSSAI are allowed; and 2) the network has one or more subscribed S-NSSAIs marked as default which are not subject to network slice- specific authentication and authorization that are available.
The network may include this IE to inform the UE of one or more S-NSSAIs that were included in the requested NSSAI in the REGISTRATION REQUEST message but were rejected by the network.
5GS network feature support This IE shall be included when the network needs to indi cate the PDU sessions that are associated with the access type the message is sent over, that are active in the network.
0 PDU session reactivation result This IE shall be included: if the Uplink data status IE is included in the REGISTRATION REQUEST message; if the Allowed PDU session status IE is included in the REGISTRATION REQUEST message and there is at least one PDU session indicated in the Allowed PDU session status IE for which the user-plane resources can be re-established over 3GPP access.
1 PDU session reactivation result error cause This IE may be included, if the PDU session reactivation result IE is included and there exist one or more PDU sessions for which the user-plane resources cannot be re-established, to indicate the cause of failure to re-establish the user-plane The network shall include this IE if there are valid LADN se rvice area(s) for the subscribed DNN(s) of the UE in the The network shall include the MICO indication IE if: a)- the UE included the MICO indication IE in the REGISTRATION REQUEST message; and b) the network supports and accepts the use of MICO mode.
4 Network slicing indication 5 Service area list This IE may be included to assign new service area restrictions to the UE.
not indicate "periodic registration updating".
The AMF may include this IE during the mobility and periodic registration update procedure over 3GPP access when the 5GS registration type IE indicates "periodic registration updating".
9 Emergency number list within the same country as in the PLMN from which this IE is received.
0 Extended emergency number list PLMN from which this IE is received.
1 SOR transparent container This IE may be sent by the network.
If this IE is sent, the contents of this IE includes the list of preferred PLMN/access technology combinations (or HPLMN indication that 'no change of the "Operator Controlled PLMN Selector with Access Technology" list stored in the UE is needed and thus no list of preferred PLMN/access technology combinations is provided') (see 3GPP specification document annex C) and optional acknowledgement request.
EAP message IE is included if the REGISTRATION ACCEPT message is sent as part of registration for emergency services and is used to convey EAP-failure message.
3 NSSAI inclusion mode This IE shall be included if required by operatory policy.
4 Operator-defined access category definitions This IE may be included to assign new operator-defined access category definitions to the UE or delete the operator-defined access category definitions at the UE side.
5 Negotiated DRX parameters The network shall include this IE if the Requested DRX parameters IE was included in the REGISTRATION REQUEST message.
6 Non-3GPP NW provided policies This IE is included if the network needs to indicate wh ether emergency numbers provided via non-3GPP access can be used to initiate UE detected emergency calls (see 3GPP TS 2 302\).
If this IE is not included then the UE shall ePDG as specified in 3GPP specification document .
The network shall include the Negotiated extended DRX parameters IE if: the UE included the Requested extended DRX parameters IE in the REGISTRATION REQUEST message; and the network supports eDRX and accepts the use of eDRX.
The network may include T3447 value IE if: the UE supports the control plane CIoT 5GS optimizations.
The AMF shall include this IE if the UE has requested active time value in the REGISTRATION REQEUST message and the AMF decides to accept the use of MICO mode and the use of the active time.
1 EPS bearer context status inter-system change from S1 mode to N1 mode and the network supports N26 interface.
2 UE radio capability ID 3 UE radio capability ID deletion indication This IE may be included if the UE is not in NB-N1 mode, both the UE and the network support RACS and the network needs to trigger the UE to delete all network-assigned UE radio capability IDs stored at the UE for the serving PLMN or SNPN.
The network may include this IE to inform the UE of one or more S-NSSAIs that are pending as the network slice-specific authentication and authorization procedure is not completed.
5 Ciphering key data This IE is included if the network needs to send cipheri ng key data to the UE for ciphered broadcast assistance data.
6 CAG information list 7 Truncated 5G-S-TMSI configuration The network shall include this IE if: REQUEST message; the AMF decides to accept the requested CIoT 5GS optimization; and - the network is configured to provide the truncated 5G-S-TMSI configuration for control plane CIoT 5GS 8 Negotiated NB-N1 mode DRX parameters The network shall include the Negotiated NB-N1 mode DRX parameters IE if the requested NB-N1 mode DRX parameters IE was included in the REGISTRATION REQUEST message.
9 Negotiated WUS assistance information The network shall include the Negotiated WUS assistance information IE if: the UE supports WUS assistance information; the AMF supports and accepts the use of WUS assistance information; and the UE is not performing the initial registration for emergency services.
The REGISTRATION COMPLETE message is sent by the UE to the AMF.
See table Message type: REGISTRATION COMPLETE Significance: dual Direction: UE to network Table : REGISTRATION COMPLETE message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
73 SOR transparent container SOR transparent container This IE may be sent by the UE.
If this IE is sent, the contents of this IE indicates the UE acknowledgement of successful reception of the SOR tr ansparent container IE in the REGISTRATION ACCEPT message.
The REGISTRATION REJECT message is sent by the AMF to the UE.
See table Table : REGISTRATION REJECT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
5GMM cause 5GMM cause 
78 EAP message EAP message 69 Rejected NSSAI Rejected NSSAI 75 CAG information list CAG information list The AMF may include this IE when the general NAS level mobility management congestion control is active EAP message IE is included if the REGISTRATION REJECT message is used to convey EAP-failure message.
The network may include this IE to inform the UE of one or more S-NSSAIs that were included in the requested NSSAI in the REGISTRATION REQUEST message but were rejected by the network.
0 UL NAS transport The UL NAS TRANSPORT message transports message pa yload and associated information to the AMF.
See Message type: UL NAS TRANSPORT Table : UL NAS TRANSPORT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
UL NAS TRANSPORT message Payload container type Payload container type.
Spare half octet Spare half octet.
Payload container Payload container 12 PDU session ID PDU session identity 2 59 Old PDU session ID PDU session identity 2 Request type Request type 24 Additional information Additional information A- MA PDU session information MA PDU session information F- Release assistance indication Release assistance indication The UE shall include this IE when the Payload container type IE is set to "N1 SM information".
Old PDU session ID REQUEST message upon receiving the PDU SESSION MODIFICATION COMMAND message with the 5GSM cause IE set to #39 "reactivation requested" and the Payload container type IE is set to "N1 SM information".
The UE shall include this IE when the PDU session ID IE is included and the Payload container IE contains the PDU SESSION ESTABLISHMENT REQUEST message or the PDU SESSION MODIFICATION REQUEST which is not The UE may include this IE when the Request type IE is set to "initial request", "existing PDU session" or "MA PDU request" and the Payload container type IE is set to "N1 SM information".
The UE may include this IE when the Payload container type IE is set to "LTE Positioning Protocol (LPP) message container" or "Location services (LCS) message container".
MA PDU session information The UE may include this IE if the Request type IE is included and is not set to "initial emergency request " or "existing emergency PDU session" in the UL NAS TRANSPORT message.
The UE may include this IE to inform the network whether: no further uplink and no further downlink data transmission is expected; or uplink data transmission subsequent to the uplink data transmission is expected.
1 DL NAS transport The DL NAS TRANSPORT message transports message pa yload and associated information to the UE.
See Message type: DL NAS TRANSPORT Significance: dual Direction: network to UE Table : DL NAS TRANSPORT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
DL NAS TRANSPORT message 
Payload container type Payload container type.
Spare half octet Spare half octet.
Payload container Payload container 9 M LV-E 5537 12 PDU session ID PDU session identity 2 24 Additional information Additional information 58 5GMM cause 5GMM cause 37 Back-off timer value GPRS timer 3 The AMF may include this IE when the Payload container type IE is set to "LTE Positioning Protocol (LPP) message container" or "Location services (LCS) message container".
The AMF shall include this IE when the Payload container IE contains an uplink payload which was not forwarded and the Payload container type IE is not set to "Multiple payloads".
The AMF shall include this IE when the Payload container IE contains an uplink 5GSM message which was not forwarded due to DNN based congestion control, S-NSSAI and DNN based congestion control or S-NSSAI only based congestion control and the Payload container type IE is not set to "Multiple payloads".
2 De-registration request (UE originating de-registration) The DEREGISTRATION REQUEST message is sent by the UE to the AMF.
See table Message type: DEREGISTRATION REQUEST Significance: dual Direction: UE to network Table : DEREGISTRATION REQUEST message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
De-registration type De-registration type 
ngKSI NAS key set identifier.
3 De-registration accept (UE originating de-registration) The DEREGISTRATION ACCEPT message is sent by the AMF to the UE.
See table Message type: DEREGISTRATION ACCEPT IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
4 De-registration request (UE terminated de-registration) The DEREGISTRATION REQUEST message is sent by the AMF to the UE.
See table Message type: DEREGISTRATION REQUEST Direction: network to UE Table : DEREGISTRATION REQUEST message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
De-registration type De-registration type 
Spare half octet Spare half octet.
58 5GMM cause 5GMM cause 6D Rejected NSSAI Rejected NSSAI This information element is included if a 5GMM cause is provided.
The AMF may include this IE when the general NAS level mobility management congestion control is active.
The AMF may include this IE to inform the UE of one or more S-NSSAIs that were rejected by the network due to network slice-specific authentication and authorization fail ure or revocation as specified in subclause The DEREGISTRATION ACCEPT message is sent by the UE to the AMF.
See table Message type: DEREGISTRATION ACCEPT Significance: dual Direction: UE to network Table : DEREGISTRATION ACCEPT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
The SERVICE REQUEST message is sent by the UE to the AMF in order to request the establishment of an N1 NAS signalling connection and/or to request the establishment of user-plane resources for PDU sessions which are established without user-plane resources.
See table Message type: SERVICE REQUEST Direction: UE to network Security header type Security header type.
Spare half octet Spare half octet.
Service request message identity Message type.
ngKSI NAS key set identifier.
Service type Service type 
5G-S-TMSI 5GS mobile identity 40 Uplink data status Uplink data status 50 PDU session status PDU session status 25 Allowed PDU session status Allowed PDU session status 71 NAS message container NAS message container 3 O TLV-E n This IE shall be included if the UE has uplink user data pending to be sent.
the message is sent over, that are active within the UE.
Allowed PDU session status access for PDU session(s) associated with non-3GPP access and the UE needs to indicate the user-plane resources of PDU session(s) associated with non-3GPP access allowed to be re-established over 3GPP access or if there is no PDU session(s) for which the UE allows the user-plane resources to be re-established over 3GPP access.
The SERVICE ACCEPT message is sent by the AMF to the UE in order to accept the service request procedure.
See Message type: SERVICE ACCEPT Significance: dual Direction: network to UE Security header type Security header type.
Spare half octet Spare half octet.
Service accept message identity Message type.
50 PDU session status PDU session status 26 PDU session reactivation result PDU session reactivation result 72 PDU session reactivation result error cause PDU session reactivation result error 78 EAP message EAP message This IE shall be included when the network needsto indicate the PDU sessions that are associated with the access type that the message is sent over that are active within the network.
PDU session reactivation result This IE shall be included: if the Uplink data status IE is included in the SERVICE REQUEST message; if the Allowed PDU session status IE is included in the SERVICE REQUEST message and there is at least one PDU session indicated in the Allowed PDU session status IE for which user-plane resources can be re- established over 3GPP access.
PDU session reactivation result error cause This IE may be included if the PDU session reactivation resu lt IE is included and there exist one or more PDU sessions for which the user-plane resources cannot be re-established, to indicate the cause of failure to re-establish the user-plane is used to convey EAP-failure message.
the UE supports the control plane CIoT 5GS optimizations.
The SERVICE REJECT message is sent by the AMF to the UE in order to reject the service request procedure.
See Table : SERVICE REJECT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
Service reject message identity Message type.
5GMM cause 5GMM cause 
50 PDU session status PDU session status 78 EAP message EAP message 75 CAG information list CAG information list This IE shall be included when the network needs to indi cate the PDU sessions that are associated with the access type that the message is sent over, that are active within the network.
The AMF may include this IE when the general NAS level mobility management congestion control is active.
EAP message IE is included if the SERVICE REJECT message is used to convey EAP-failure message.
the UE supports the control plane CIoT 5GS optimizations.
9 Configuration update command The CONFIGURATION UPDATE COMMAND message is sent by the AMF to the UE.
See table Message type: CONFIGURATION UPDATE COMMAND Security header type Security header type.
Spare half octet Spare half octet.
D- Configuration update indication Configuration update indication 77 5G-GUTI 5GS mobile identity 54 TAI list 5GS tracking area identity list 15 Allowed NSSAI NSSAI 27 Service area list Service area list 43 Full name for network Network name 5 O TLV n 45 Short name for network Network name 5 O TLV n 46 Local time zone Time zone 47 Universal time and local time zone Time zone and time 3 O TV 8 49 Network daylight saving time Daylight saving time 79 LADN information LADN information B- MICO indication MICO indication Network slicing indication Network slicing indication 31 Configured NSSAI NSSAI 11 Rejected NSSAI Rejected NSSAI 76 Operator-defined access category definitions Operator-defined access category definitions 8 O TLV-E n F- SMS indication SMS indication 75 CAG information list CAG information list 67 UE radio capability ID UE radio capability ID 8 O TLV n A- UE radio capability ID deletion indication UE radio capability ID deletion indication 44 5GS registration result 5GS registration result configuration Truncated 5G-S-TMSI configuration 0 O TLV 3 C- Additional configuration indication Additional configuration indication Full name for network Short name for network 0 Universal time and local time zone This IE may be included to assign new universal time and local time zone to the UE.
1 Network daylight saving time This IE may be included to assign new network daylight saving time to the UE.
This IE may be included to assign new LADN information to the UE or delete the LADN information at the UE side.
This IE may be included to request the UE to re-negotiate MICO mode.
4 Network slicing indication 7 Operator-defined access category definitions This IE may be included to assign new operator-defined access category definitions to the UE or delete the operator-defined access category definitions at the UE side.
This IE may be included to indicate that the abil ity for the UE to use SMS over NAS has changed.
0 CAG information list This IE may be included to assign new "CAG information list" to the UE or delete the "CAG information list" at the UE side.
1 UE radio capability ID 2 UE radio capability ID deletion indication This IE may be included if the UE is not in NB-N1 mode, both the UE and the network support RACS and the network needs to trigger the UE to delete all network-assigned UE radio capability IDs stored at the UE for the serving PLMN or serving SNPN.
3 5GS registration result This IE shall be included if the network wants to indicate to the UE that the UE is registered for emergency services.
4 Truncated 5G-S-TMSI configuration is configured to provide the truncated 5G-S-TMSI configuration for control plane CIoT 5GS optimizations.
5 Additional configuration indication The network may include this IE when requesting the UE to register without the release of the N1 NAS signalling connection.
0 Configuration update complete The CONFIGURATION UPDATE COMPLETE message is sent by the UE to the AMF.
See table Message type: CONFIGURATION UPDATE COMPLETE Significance: dual Direction: UE to network Security header type Security header type.
Spare half octet Spare half octet.
The IDENTITY REQUEST message is sent by the AMF to the UE to request the UE to pr ovide specified identity.
See Message type: IDENTITY REQUEST Direction: AMF to UE Table : IDENTITY REQUEST message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
Identity request message identity Message type.
Identity type 5GS identity type.
Spare half octet Spare half octet.
The IDENTITY RESPONSE message is sent by the UE to the AMF to provide the requested identity.
See Message type: IDENTITY RESPONSE Direction: UE to AMF Security header type Security header type.
Spare half octet Spare half octet.
Mobile identity 5GS mobile identity.
Significance: dual Direction: network to UE Table : NOTIFICATION message content Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
Notification message identity Message type.
Access type Access type 
Spare half octet Spare half octet.
The NOTIFICATION RESPONSE message is sent by the UE to the AMF to notify the failure to initiate the service Message type: NOTIFICATION RESPONSE Significance: dual Direction: UE to network Security header type Security header type.
Spare half octet Spare half octet.
50 PDU session status PDU session status This information element shall be included when the UE needs to indicate over non-3GPP access the type of the PDU sessions that are associated with the 3GPP access type that are active within the UE.
5 Security mode command The SECURITY MODE COMMAND message is sent by the AMF to the UE to establish NAS signalling security.
See table Message type: SECURITY MODE COMMAND Significance: dual Direction: network to UE Security header type Security header type.
Spare half octet Spare half octet.
Selected NAS security algorithms NAS security algorithms.
ngKSI NAS key set identifier.
Spare half octet Spare half octet.
Replayed UE security capabilities UE security capability E- IMEISV request IMEISV request 57 Selected EPS NAS security algorithms EPS NAS security algorithms 5 O TV 2 36 Additional 5G security information Additional 5G security information 78 EAP message EAP message 0 O TLV n 19 Replayed S1 UE security The AMF may include this information element to request the UE to send its IMEISV with the corresponding SECURITY MODE COMPLETE message.
Selected EPS NAS security algorithms This IE shall be included if the AMF supports N26 interface and the UE set the S1 mode bit to "S1 mode supported" in the 5GMM capability IE of the REGISTRATION REQUEST message.
Additional 5G security information The network shall include this IE if: a) the network needs to provide the UE with horizontal derivation parameter; or b) the initial NAS message (i.
REGISTRATION REQUE ST or SERVICE REQUEST) does not successfully pass the integrity check at the AMF (see subclause\).
This IE is included when the EAP Success message is sent as part of the EAP based primary authentication and key agreement procedure, as specified in subclause This IE shall be included if the message contains an EAP message IE with an EAP-success message.
6 Security mode complete COMMAND message.
See table Message type: SECURITY MODE COMPLETE Significance: dual Direction: UE to network Table : SECURITY MODE COMPLETE message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
Security mode complete message 
77 IMEISV 5GS mobile identity 71 NAS message container NAS message container 3 O TLV-E n 78 non-IMEISV PEI 5GS mobile identity The UE shall include this information element, if the IMEISV was requested within the corresponding SECURITY The UE shall include this information element: a) if during an ongoing registration procedure or service request procedure, the AMF included the Additional 5G security information with the RINMR bit set to "Retransmission of the initial NAS message requested" in the SECURITY MODE COMMAND message as described in 3GPP specification document ; and The 5G-RG or the W-AGF acting on behalf of the FN-RG (or on behalf of the N5GC device) shall include this information element, if the IMEISV was requested within the corresponding SECURITY MODE COMMAND message, the IMEISV is not available but MAC address is available.
The UE shall include this information element, if the IMEISV was requested within the corresponding SECURITY MODE COMMAND message, the IMEISV is not available but EUI-64 is available.
The SECURITY MODE REJECT message is sent by the UE to the AMF to indicate that the corresponding security mode command has been rejected.
See table Message type: SECURITY MODE REJECT Significance: dual Direction: UE to network Table : SECURITY MO DE REJECT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
Security mode reject message 
5GMM cause 5GMM cause 
8 Security protected 5GS NAS message and the message authentication code protecting the message.
See table Message type: SECURITY PROTECTED 5GS NAS MESSAGE Table : SECURITY PROTECTED 5GS NAS MESSAGE message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
Message authentication code Message authentication code.
Sequence number Sequence number 
Plain 5GS NAS message Plain 5GS NAS message The 5GMM STATUS message is sent by the UE or by the AMF at any time to report certain error conditions.
See Message type: 5GMM STATUS Significance: local Direction: both Table : 5GMM STATUS message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
5GMM STATUS message identity Message type.
5GMM cause 5GMM cause 
0 Control Plane Service request The CONTROL PLANE SERVICE REQUEST message is sent by the UE to the AMF when the UE is using 5GS services with control plane CIoT 5GS optimization.
See table Message type: CONTROL PLANE SERVICE REQUEST Direction: UE to network Security header type Security header type.
Spare half octet Spare half octet.
Control plane service request Control plane service type Control plane service type.
ngKSI NAS key set identifier.
6F CIoT small data container CIoT small data container Payload container type Payload container type 7B Payload container Payload container 12 PDU session ID PDU session identity 2 50 PDU session status PDU session status F- Release assistance indication Release assistance indication 40 Uplink data status Uplink data status 71 NAS message container NAS message container 3 O TLV-E n 24 Additional information Additional information CIoT small data container This IE shall be included if the UE needs to send uplink small user data, SMS or location services message or uplink SMS that is not more than 254 bytes, and there is no other optional IE to be sent.
NOTE: When the UE determines to use the CIoT small data container IE to send uplink data in this message, there is no other optional IEs in this message.
This IE shall be included if the UE includes the Payload container IE.
This IE shall be included if the UE needs to send uplink CIoT user data, SMS or location services message.
The UE shall include this IE when the Payload container type IE is set to "CIoT user data container".
the message is sent over, that are active within the UE.
The UE may include this IE to inform the network whether: no further uplink and no further downlink data transmission is expected; or uplink data transmission subsequent to the uplink data transmission is expected.
This IE shall be included if the UE has uplink user data pending to be sent over the user plane.
message and the UE needs to send non-cleartext IEs.
The UE may include this IE when the Payload container ty pe IE is set to "Location services message container".
1 Network slice-specific authentication command The NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message is sent by the AMF to the UE for authentication of the upper layers of the UE.
See table Message type: NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND Direction: network to UE Table : NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
message identity Message type 
EAP message EAP message 2 Network slice-specific authentication complete The NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message is sent by the UE to the AMF in response to the NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message and indicates acceptance of the NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message.
See table Table : NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
EAP message EAP message 3 Network slice-specific authentication result The NETWORK SLICE-SPECIFIC AUTHENTICATION RESULT message is sent by the AMF to the UE for indicating the result of the network slice-specific authenti cation and authorization procedure.
See table Message type: NETWORK SLICE-SPECIFIC AUTHENTICATION RESULT Direction: network to UE Table : NETWORK SLICE-SPECIFIC AUTHENTICATION RESULT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
Security header type Security header type.
Spare half octet Spare half octet.
EAP message EAP message PDU session establishment request The PDU SESSION ESTABLISHMENT REQUEST message is sent by the UE to the SMF to initiate establishment of a PDU session.
See table Message type: PDU SESSION ESTABLISHMENT REQUEST Direction: UE to network Table : PDU SESSION ESTABLISHMENT REQUEST message content IEI Information Element Type/R eference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
PDU session ID PDU session identity.
PTI Procedure transaction identity 
Integrity protection maximum data PDU session type PDU session type A- SSC mode SSC mode 28 5GSM capability 5GSM capability 55 Maximum number of supported B- Always-on PDU session 39 SM PDU DN request container SM PDU DN request container 7B Extended protocol configuration options Extended protocol configuration 66 IP header compression configuration IP header compression configuration 6E DS-TT Ethernet port MAC address DS-TT Ethernet port MAC address 6F UE-DS-TT residence time UE-DS-TT residence time 7C Port management information container Port management information container 1F Ethernet header compression configuration Ethernet header compression Maximum number of supported packet filters This IE shall be included in the message when the selected PDU session type is "IPv4", "IPv6", "IPv4v6" or "Ethernet" and the UE can support more than 16 packet filters for this PDU session.
connection and any of the 5GSM capabilities supported by the UE is relevant for the PDU session.
Always-on PDU session requested SM PDU DN request container provide information for the PDU session authentication and authorization by the external DN.
Extended protocol configuration options This IE is included in the message when the UE needs to transmit (protocol) data (e.
configuration parameters, error codes or messages/events) to the network.
0 IP header compression configuration The UE shall include the IP header compression configuration IE if: the PDU session type value of the PDU session type IE is set to "IPv4", "IPv6" or "IPv4v6"; plane CIoT 5GS optimization supported" in the 5GMM capability IE of the REGISTRATION REQUEST the network indicates "Control plane CIoT 5GS optimization supported" and "IP header compression for control plane CIoT 5GS optimization supported" in the 5GS network support feature IE of the REGISTRATION ACCEPT message.
1 DS-TT Ethernet port MAC address 2 UE-DS-TT residence time This IE shall be included in the message if: a) the UE supports transfer of port management information containers; 4 Ethernet header compression configuration The UE shall include the Ethernet header compression configuration IE if: the PDU session type value of the PDU session type IE is set to "Ethernet"; the UE indicated "Control Plane CIoT 5GS optimiza tion supported" and "Ethernet header compression for control plane CIoT 5GS optimization supported" in the 5GMM capability IE of the REGISTRATION the network indicated "Control plane CIoT 5GS optimization supported" and "Ethernet header compression for control plane CIoT 5GS optimization supported" in the 5GS network support feature IE of the REGISTRATION PDU session establishment accept The PDU SESSION ESTABLISHMENT ACCEPT message is sent by the SMF to the UE in response to PDU Message type: PDU SESSION ESTABLISHMENT ACCEPT Significance: dual Direction: network to UE PDU session ID PDU session identity.
PTI Procedure transaction identity 
message identity Message type 
Selected PDU session type PDU session type.
Selected SSC mode SSC mode.
Authorized QoS rules QoS rules 59 5GSM cause 5GSM cause 29 PDU address PDU address 56 RQ timer value GPRS timer 75 Mapped EPS bearer contexts Mapped EPS bearer contexts 78 EAP message EAP message 79 Authorized QoS flow descriptions QoS flow descriptions 7B Extended protocol configuration 17 5GSM network feature support 5GSM network feature support 18 Serving PLMN rate control Serving PLMN rate control 77 ATSSS container ATSSS container C- Control plane only indication Control plane only indication 66 IP header compression configuration IP header compression configuration 4 O TLV 57 1F Ethernet header compression configuration Ethernet header compression This IE is included when the selected PDU session type is different from the PDU session type requested by the UE.
This IE is included when the selected PDU session type is "IPv4", "IPv6" or "IPv4v6".
This IE shall be included in the message when the SMF received from the AMF an S-NSSAI together with the PDU Always-on PDU session indication The network shall include this IE if the network decides to inform the UE whether the PDU session is established as an always-on PDU session.
Mapped EPS bearer contexts This IE is included when interworking with EPS is supported for the PDU session.
This IE is included when the external DN successfully performed authentication and authorization of the UE using EAP.
Authorized QoS flow descriptions This IE is included when the network needs to provide authorized QoS flow descriptions.
0 Extended protocol configuration options This IE is included in the message when the network needs to transmit (protocol) data (e.
configuration parameters, error codes or messages/events) to the UE.
2 5GSM network feature support This IE is included when the network needs to indicate support of 5GSM network features.
4 Serving PLMN rate control This IE shall be included when the network needs to indi cate the maximum uplink control plane user data the UE is allowed to send per 6 minute interval.
The IE shall be included in the message when the PDU session is an MA PDU session.
6 Control plane only indication The network shall include the control plane only indication IE if the network determines that the associated PDU session is only for control plane CIoT 5GS optimization.
The SMF may include the IP header compression configuration IE if: the network accepts an IP PDU session type; and control plane CIoT 5GS optimization is selected.
8 Ethernet header compression configuration The SMF may include the Ethernet header compression configuration IE if: the network accepts an Ethernet PDU session type; and - control plane CIoT 5GS optimization is selected.
PDU session establishment reject The PDU SESSION ESTABLISHMENT REJECT message is sent by the SMF to the UE in response to PDU Message type: PDU SESSION ESTABLISHMENT REJECT Significance: dual Direction: network to UE Table : PDU SESSION ESTABLISHMENT REJECT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
PDU session ID PDU session identity.
PTI Procedure transaction identity 
message identity Message type 
5GSM cause 5GSM cause 
37 Back-off timer value GPRS timer 3 F- Allowed SSC mode Allowed SSC mode 78 EAP message EAP message 7B Extended protocol configuration options Extended protocol configuration options 1D Re-attempt indicator Re-attempt indicator 61 5GSM congestion re-attempt indicator 5GSM congestion re-attempt indicator The network may include this IE if the 5GSM cause is not #28 "unknown PDU session type", #39 "reactivation requested", #46 "out of LADN service area", #50 "PDU sess ion type IPv4 only allowed", #51 "PDU session type IPv6 This IE is included when the network rejects the PDU SESSION ESTABLISHMENT REQUEST with cause #68 "not supported SSC mode.
This IE is included when the external DN unsuccessfully performed authentication and authorization of the UE using EAP.
Extended protocol configuration options This IE is included in the message when the network needs to transmit (protocol) data (e.
configuration parameters, error codes or messages/events) to the UE.
The network may include this IE if the network includes the Back-off timer value IE and the 5GSM cause value is not #26 "insufficient resources", #28 "unknown PDU session type", #39 "reactivation requested", #46 "out of LADN service area", #54 "PDU session does not exist", #67 "insufficient resources for specific slice and DNN", #68 "not supported SSC mode", or #69 "insufficient resources for specific slice".
5GSM congestion re-attempt indicator The network may include this IE only if it includes the Back-off timer value IE and the 5GSM cause value is either #67 "insufficient resources for specific slice and DNN" or #69 "insufficient resources for specific slice".
PDU session authentication command The PDU SESSION AUTHENTICATION COMMAND message is sent by the SMF to the UE for authentication of the UE establishing the PDU session or of the UE participating in the PDU session.
See table Message type: PDU SESSION AUTHENTICATION COMMAND Direction: network to UE PDU session ID PDU session identity.
PTI Procedure transaction identity 
message identity Message type 
EAP message EAP message 7B Extended protocol configuration Extended protocol configuration options This IE is included in the message when the network needs to transmit (protocol) data (e.
configuration parameters, error codes or messages/events) to the UE.
NOTE: How the Extended protocol configuration options IE is used by the network and the UE during the PDU session authentication and authorization procedure is not specified in this release of the specification.
PDU session authentication complete The PDU SESSION AUTHENTICATION COMPLETE message is sent by the UE to the SMF in response to the PDU SESSION AUTHENTICATION COMMAND message and indicates acceptance of the PDU SESSION AUTHENTICATION COMMAND message.
See table Message type: PDU SESSION AUTHENTICATION COMPLETE Direction: UE to network Table : PDU SESSION AUTHENTICATION COMPLETE message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
PDU session ID PDU session identity.
PTI Procedure transaction identity 
EAP message EAP message 7B Extended protocol configuration codes or messages/events) to the network.
NOTE: How the Extended protocol configuration options IE is used by the network and the UE during the PDU session authentication and authorization procedure is not specified in this release of the specification.
PDU session authentication result The PDU SESSION AUTHENTICATION RESULT message is sent by the SMF to the UE for indication of successful result of authentication of the UE participating in the PDU session.
See table Message type: PDU SESSION AUTHENTICATION RESULT Direction: network to UE Table : PDU SESSION AUTHENTICATION RESULT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
PDU session ID PDU session identity.
PTI Procedure transaction identity 
78 EAP message EAP message 7B Extended protocol configuration options Extended protocol configuration This IE shall be included when the external DN performs authentication and authorization of the UE using EAP and it Extended protocol configuration options This IE is included in the message when the network needs to transmit (protocol) data (e.
configuration parameters, error codes or messages/events) to the UE.
NOTE: How the Extended protocol configuration options IE is used by the network and the UE during the PDU session authentication and authorization procedure is not specified in this release of the specification.
PDU session modification request PDU session.
See table Message type: PDU SESSI ON MODIFICATION REQUEST Table : PDU SESSION MODIFICATION REQUEST message content IEI Information Element Type/Ref erence Presence Format Length Extended protocol discriminator Extended protocol discriminator.
PDU session ID PDU session identity.
PTI Procedure transaction identity 
28 5GSM capability 5GSM capability 59 5GSM cause 5GSM cause 55 Maximum number of supported packet filters Maximum number of supported packet filters B- Always-on PDU session requested Always-on PDU session requested 13 Integrity protection maximum data 7A Requested QoS rules QoS rules 79 Requested QoS flow descriptions QoS flow descriptions 75 Mapped EPS bearer contexts Mapped EPS bearer contexts 7B Extended protocol configuration 7C Port management information container Port management information container 7 O TLV-E 5538 66 IP header compression configuration Header compression configuration 4 O TLV 57 1F Ethernet header compression configuration Ethernet header compression configuration 8 O TLV 3 NOTE: It is possible for UEs compliant with earlier versions of this specification to send the Mapped EPS bearer contexts IE with IEI of value "7F" for this message.
This IE is included in the message: a) if the PDU session is of "IPv4", "IPv6", "IPv4v6" or "Ethernet" PDU session type, and the UE supports b) if the PDU session is of "IPv6" or "IPv4v6" PDU session type, and the UE supports multi-homed IPv6 PDU 2) if the UE needs to revoke the previously indicated support of reflective QoS.
Maximum number of supported packet filters interface, the PDU session type is "IPv4", "IPv6", "IPv4v6" or "Ethernet", and the UE can support more than 16 packet filters for this PDU session.
Always-on PDU session requested Integrity protection maximum data rate Requested QoS flow descriptions Extended protocol configuration options This IE is included in the message when the UE needs to transmit (protocol) data (e.
configuration parameters, error codes or messages/events) to the network.
0 Mapped EPS bearer contexts This IE is included when the UE requests to delete one or more mapped EPS bearer contexts.
1 Port management information container 2 IP header compression configuration This IE is included in the message: UE and the network supports Control plane CIoT 5GS optimization and IP header compression; or S1 mode to N1 mode when both the UE and the network support control plane CIoT 5GS optimization and IP header compression, and the UE is operating in single-registration mode in the network supporting N26 interface.
This IE is included in the message: both the UE and the network support Control plane CIoT 5GS optimization and Ethernet header compression; or from S1 mode to N1 mode.
PDU session modification reject The PDU SESSION MODIFICATION REJECT message is sent by the SMF to the UE to indicate rejection of the PDU SESSION MODIFICATION REQUEST.
See table Message type: PDU SESSION MODIFICATION REJECT Significance: dual Direction: network to UE Table : PDU SESSION MODIFICATION REJECT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
PDU session ID PDU session identity.
PTI Procedure transaction identity 
REJECT message identity Message type.
5GSM cause 5GSM cause 
37 Back-off timer value GPRS timer 3 7B Extended protocol configuration 1D Re-attempt indicator Re-attempt indicator 61 5GSM congestion re-attempt indicator 5GSM congestion re-attempt indicator interval before procedure retry is allowed.
Extended protocol configuration options This IE is included in the message when the network needs to transmit (protocol) data (e.
configuration parameters, error codes or messages/events) to the UE.
The network may include this IE only if it includes the Back-off timer value IE and the 5GSM cause value is not #26 "insufficient resources", #46 "out of LADN service area", # 67 "insufficient resources for specific slice and DNN", or #69 "insufficient resources for specific slice".
PDU session modification command Message type: PDU SESSION MODIFICATION COMMAND Significance: dual Direction: network to UE Table : PDU SESSION MODIFICATION COMMAND message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
PDU session ID PDU session identity.
PTI Procedure transaction identity 
59 5GSM cause 5GSM cause 2A Session AMBR Session-AMBR 56 RQ timer value GPRS timer 7A Authorized QoS rules QoS rules 75 Mapped EPS bearer contexts Mapped EPS bearer contexts 79 Authorized QoS flow descriptions QoS flow descriptions 7B Extended protocol configuration 77 ATSSS container ATSSS container 66 IP header compression configuration IP header compression configuration 4 O TLV 57 7C Port management information container Port management information 1E Serving PLMN rate control Serving PLMN rate control 1F Ethernet header compression configuration Ethernet heaer compression configuration NOTE: It is possible for networks compliant with earlier versions of this specification to send the Mapped EPS bearer contexts IE with IEI of value "7F" for this message.
This IE is included when the session-AMBR of the PDU session is modified.
This IE is included when the network needs to provide the RQ timer value.
Always-on PDU session indication The network shall include this IE if the network decides to inform the UE whether the PDU session is an always-on This IE is included when the authorized QoS rules of the PDU session are modified.
Mapped EPS bearer contexts This IE is included when interworking with EPS is suppor ted for the PDU session and the mapped EPS bearer contexts Authorized QoS flow descriptions This IE is included when the authorized QoS fl ow descriptions of the PDU session are modified.
Extended protocol configuration options This IE is included in the message when the network needs to transmit (protocol) data (e.
configuration parameters, error codes or messages/events) to the UE.
2 IP header compression configuration This IE is included in the message if the network wishes to re-negotiate IP header compression configuration associated 3 Port management information container 4 Serving PLMN rate control This IE shall be included when the network needs to indi cate the maximum uplink control plane user data the UE is 0 PDU session modification complete The PDU SESSION MODIFICATION COMPLETE message is sent by the UE to the SMF in response to the PDU SESSION MODIFICATION COMMAND message and indicates an acceptance of the PDU SESSION MODIFICATION COMMAND message.
See table Message type: PDU SESSION MODIFICATION COMPLETE Direction: UE to network Table : PDU SESSION MODIFICATION COMPLETE message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
PDU session ID PDU session identity.
PTI Procedure transaction identity 
7B Extended protocol configuration options Extended protocol configuration 7C Port management information container Port management information NOTE: It is possible for UEs compliant with earlier versions of this specification to include the 5GSM cause IE with IEI 59 in the PDU SESSION MODIFICATION COMPLETE message, and therefore the IEI 59 cannot be used for other optional IEs other than the 5GSM cause IE for future extensions of the PDU SESSION MODIFICATION COMPLETE message.
Extended protocol configuration options This IE is included in the message when the UE needs to transmit (protocol) data (e.
configuration parameters, error codes or messages/events) to the network.
Port management information container 1 PDU session modification command reject The PDU SESSION MODIFICATION COMMAND REJECT message is sent by the UE to the SMF to indicate rejection of the PDU SESSION MODIFICATION COMMAND message.
See table Message type: PDU SESSION MODIFICATION COMMAND REJECT IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
PDU session ID PDU session identity.
PTI Procedure transaction identity 
5GSM cause 5GSM cause 
7B Extended protocol configuration Extended protocol configuration options This IE is included in the message when the UE needs to transmit (protocol) data (e.
configuration parameters, error codes or messages/events) to the network.
2 PDU session release request Message type: PDU SESSION RELEASE REQUEST Significance: dual Direction: UE to network Table : PDU SESSION RELEASE REQUEST message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
PDU session ID PDU session identity.
PTI Procedure transaction identity 
59 5GSM cause 5GSM cause 7B Extended protocol configuration This IE is included in the message to indicate the reason for releasing the PDU session.
3 PDU session release reject Message type: PDU SESSION RELEASE REJECT Significance: dual Direction: network to UE Table : PDU SESSION RELEASE REJECT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
PDU session ID PDU session identity.
PTI Procedure transaction identity 
5GSM cause 5GSM cause 
7B Extended protocol configuration Extended protocol configuration options This IE is included in the message when the network needs to transmit (protocol) data (e.
configuration parameters, error codes or messages/events) to the UE.
4 PDU session release command Message type: PDU SESSION RELEASE COMMAND Direction: network to UE PDU session ID PDU session identity.
PTI Procedure transaction identity 
5GSM cause 5GSM cause 
37 Back-off timer value GPRS timer 3 78 EAP message EAP message 61 5GSM congestion re-attempt indicator 5GSM congestion re-attempt indicator 7B Extended protocol configuration D- Access type Access type This IE is included when the external DN performs re-authentication and re-authorization of the UE using EAP and it Extended protocol configuration options This IE is included in the message when the network wants to transmit (protocol) data (e.
configuration parameters, error codes or messages/events) to the UE.
5GSM congestion re-attempt indicator The network may include this IE only if it includes the Back-off timer value IE and the 5GSM cause value is either #67 "insufficient resources for specific slice and DNN" or #69 "insufficient resources for specific slice".
This IE is included in the message when the network releases user-plane reources of an MA PDU session specifically over either 3GPP access or non-3GPP access.
5 PDU session release complete Message type: PDU SESSION RELEASE COMPLETE IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
PDU session ID PDU session identity.
PTI Procedure transaction identity 
59 5GSM cause 5GSM cause 7B Extended protocol configuration options Extended protocol configuration This IE is included in the message when the UE needs to indicate to the network that an error encountered with a mandatory information element in the PDU SESSION RELEASE COMMAND message.
Extended protocol configuration options This IE is included in the message when the UE needs to transmit (protocol) data (e.
configuration parameters, error codes or messages/events) to the network.
The 5GSM STATUS message is sent by the SMF or the UE to pass information on the status of the indicated PDU session and report certain error conditions.
See table Message type: 5GSM STATUS Significance: dual Direction: both Table : 5GSM STATUS message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator.
PDU session ID PDU session identity.
PTI Procedure transaction identity 
5GSM STATUS message identity Message type.
5GSM cause 5GSM cause 
3GPP specification document .
This means that the message consists of the following parts: a) extended protocol discriminator; c) procedure tran saction identity; e) other information elements, as required.
c) message authentication code; d) sequence number; e) plain 5GS NAS message, as defined in item 1 Extended protocol discriminator octet 1 PDU session identity octet 2 Procedure transaction identity octet 2a* Message type octet 3 Other information elements as required The PDU session identity and the proced ure transaction identity are only used in messages with extended protocol discriminator 5GS session management.
Octet 2a with the procedure transaction identity shall only be included in these Sequence number octet 7 Plain 5GS NAS message Field format and mapping The most significant bit of the field is represented by the highest numbered bit of the lowest numbered octet of the field.
The least significant bit of the field is represented by the lowest numbered bit of the highest numbered octet of the field.
of the field is mapped on bit (1, 3) and the least significant bit is mapped on bit (2, 7).
information related to the security protection of a 5GMM message.
The total size of the Security header type IE is 4 bits.
The Security header type IE can take the values shown in table Security protected 5GS NAS message: All other values are reserved.
A 5GMM message received with the security header type enc oded as 0000 shall be treated as not security protected, plain 5GS NAS message and encode the security header type as 000 This element is used in the description of 5GMM and 5GSM messages when an odd number of half octet type 1 information elements are used.
This element is filled with spare bits set to zero and is placed in bits 5 to 8 of the octet unless otherwise specified.
Bits 1 to 8 of the third octet of every 5GSM message contain the procedure transaction identity.
Bits 1 to 8 of the first octet of every UE policy delivery message contain the proced ure transaction identity.
The procedure transaction identity and its use are defined in 3GPP specification document .
The Message type IE and its use are defined in 3GPP specification document .
Tables and define the value part of the message type IE used in the 5GS mobility management protocol and 5GS session management protocol.
0 1 - - - - - - 5GS mobility management messages.
1 1 - - - - - - 5GS session management messages NAS security context exists and security functions are started.
The message authentication code (MAC) is also included in the Intra N1 mode NAS transparent container IE and in the S1 mode to N1 mode NAS transparent container IE.
The usage of MAC is specified in subclause Plain 5GS NAS message PROTECTED 5GS NAS MESSAGE message (see subclause 8) is not plain 5GS NAS messages and shall not be included in this IE.
The NAS message sequence number (SN) with the eight least significant bits of the NAS COUNT is also included in the Intra N1 mode NAS transparent container IE and in the N1 mode to S1 mode NAS transparent container IE.
The usage of SN is specified in subclause 4 and 6) are defined in 3GPP specification document .
The first octet of an information element in the non-imperative part contains the IEI of the information element.
If this octet does not correspond to an IEI known in the message, the receiver shall determine whether this IE is of type 1 or 2 (i.
it is an information element of one octet length) or an IE of type 4 (i.
that the next octet is the length indicator indicating the length of the remaining of the information element) (see 3GPP specification document\).
This allows the receiver to jump over unknown inform ation elements and to analyse any following information The definitions of information elements which are: a) common for the 5GMM and 5GSM protocols; b) used by access stratum protocols; or c) sent to upper layers are described in subclause The information elements of the 5GMM or 5GSM protocols can be defined by reference to an appropriate specification which provides the definition of the information element, e.
, "see subclause 1A in 3GPP specification document ".
The purpose of the Additional information information element is to provide additional information to upper layers in relation to the NAS transport mechanism.
Additional information IEI octet 1 Additional information length octet 2 Additional information value octets n Additional information information element Table : Additional information information element Additional information value (octet 3 to octet n) The coding of the additional information value is dependent on the LCS application.
The purpose of the access type information element is to indicate the access ty pe over which the signalling or user data is pending to be sent to the UE.
The access type information element is coded as shown in figure A.
1 and table Access type information element Table A.
1: Access type information element Access type value (octet 1, bit 1 to bit 2).
0 1 3GPP access 1 0 Non-3GPP access All other values are reserved.
The purpose of the DNN information element is to identify the data network.
DNN IEI octet 1 Length of DNN contents octet 2 DNN value octet 3 A DNN value field contains an APN as defined in 3GPP specification document .
The purpose of the EAP message information element is to transport an EAP message as specified in EAP message IEI octet 1 Length of EAP message contents octet 2 EAP message octet 4 octet n EAP message information element Table : EAP message information element EAP message (octet 4 to n) An EAP message as specified in IETF RFC 3748 .
See subclause 1 in 3GPP specification document .
See subclause 1a in 3GPP specification document .
Intra N1 mode NAS transparent container The purpose of the Intra N1 mode NAS transparent container information element is to provide the UE with parameters that enable the UE to handle the 5G NAS security context after N1 mode to N1 mode handover.
The Intra N1 mode NAS transparent container information element is coded as shown in figure and elements within some RRC messages sent to the UE.
in 3GPP specification document .
Intra N1 mode NAS transparent container IEI octet 1 Length of Intra N1 mode NAS transparent container contents octet 2 Message authentication code octet 3 Type of ciphering algorithm Type of integrity protection Spare 0 KACF TSC Key set identifier in 5G Sequence number octet 9 Intra N1 mode NAS transparent container information element Type of integrity protection algorithm (octet 7, bit 1 to 4) and type of ciphering algorithm (octet 7, bit 5 to 8) These fields are coded as the type of integrity protection algorithm and type of ciphering algorithm in the NAS security algorithms information element (see K_AMF_change_flag (KACF) (octet 8, bit 5).
Key set identifier in 5G (octet 8, bit 1 to 3) and Type of security context flag (TSC) (octet 8, bit 4) These fields are coded as the NAS key set identifier and type of security context flag in the NAS key set identifier information element (see subclause 2).
Sequence number (octet 9) This field is coded as the Sequence number information element (see subclause 0) N1 mode to S1 mode NAS transparent container The purpose of the N1 mode to S1 mode NAS transparent container information element is to provide the UE with The N1 mode to S1 mode NAS transparent container information element is coded as shown in figure and The value part of the N1 mode to S1 mode NAS transpar ent container information element is included in specific information elements within some RRC messages sent to the UE; see 3GPP specification document .
For these cases the coding of the information element identifier and length information is defined in 3GPP specification document .
N1 mode to S1 mode NAS transparent container IEI octet 1 Sequence number octet 2 N1 mode to S1 mode NAS transparent container information element Table : N1 mode to S1 mode NAS transparent container information element Sequence number (octet 2) This field is coded as the Sequence number information element (see subclause 0).
The S-NSSAI information element is coded as shown in figure and table Mapped HPLMN SST octet 7* Mapped HPLMN SD octet 8* S-NSSAI information element This field indicates the length of the included S-NSSAI contents, and it can have the following values.
Depending on the value of the length field the following S-NSSAI contents are included:.
All other values are reserved.
Slice/service type (SST) (octet 3) This field contains the 8 bit SST value.
The coding of the SST value part is defined in 3GPP specification document .
If this IE is included during the network slice-specific authentication and authorization procedure, this field contains the 8 bit SST value of an S-NSSAI in the S-NSSAI(s) of the HPLMN or the RSNPN.
Slice differentiator (SD) (octet 4 to octet 6) This field contains the 24 bit SD value.
The coding of the SD value part is defined in 3GPP specification document .
If this IE is included during the network slice-specific authentication and authorization procedure, this field contains the 24 bit SD value of an S-NSSAI in the S-NSSAI(s) of the HPLMN or the RSNPN.
to 10), then the sender shall set the SD value (octets 4 to 6) to "no SD value associated with the SST".
mapped HPLMN Slice/service type (SST) (octet 7) This field contains the 8 bit SST value of an S-NSSAI in the S-NSSAI(s) of the HPLMN to which the SST value is mapped.
The coding of the SST value part is defined in 3GPP specification document .
mapped HPLMN Slice differentiator (SD) (octet 8 to octet 10) This field contains the 24 bit SD value of an S-NSSAI in the S-NSSAI(s) of the HPLMN to which the SD value is mapped.
The coding of the SD value part is defined in 3GPP specification document .
NOTE 1: Octet 3 shall always be included.
NOTE 2: If the octet 4 is included, then octet 5 and octet 6 shall be included.
NOTE 3: If the octet 7 is included, then octets 8, 9, and 10 may be included.
NOTE 4: If the octet 8 is included, then octet 9 and octet 10 shall be included.
NOTE 5: If only HPLMN S-NSSAI or RSNPN S-NSSAI is included, then octets 7 to 10 shall not be included.
S1 mode to N1 mode NAS transparent container The purpose of the S1 mode to N1 mode NAS transparent container information element is to provide the UE with system change to N1 mode in 5GMM-CONNECTED mode.
The S1 mode to N1 mode NAS transparent container information element is coded as shown in figure and in 3GPP specification document .
S1 mode to N1 mode NAS transparent container IEI octet 1 Length of S1 mode to N1 mode NAS transparent container contents octet 2 Message authentication code octet 3 Type of ciphering algorithm Type of integrity protection Spare NCC TSC Key set identifier in 5G.
Spare octet 9 octet 10.
S1 mode to N1 mode NAS transparent container information element Table : S1 mode to N1 mode NAS transparent container information element Message authentication code (octet 3 to 6) This field is coded as the Message authentication code information element (see Type of integrity protection algorithm (octet 7, bit 1 to 4) and type of ciphering algorithm (octet 7, bit 5 to 8) These fields are coded as the type of integrity protection algorithm and type of ciphering algorithm in the NAS security algorithms information element (see NCC (octet 8, bits 5 to 7) This field contains the 3 bit Next hop chaining counter (see 3GPP specification document\) Key set identifier in 5G (octet 8, bit 1 to 3) and type of security context flag (TSC) (octet 8, bit 4) These fields are coded as the NAS key set identifier and type of security context flag in the NAS key set identifier information element (see subclause 2).
Octets 9 and 10 are spare and shall be coded as zero.
NOTE: In earlier versions of this protocol, octets 9 and 10 can have any value.
In this version of the protocol, octets 9 and 10 can always be ignored by the UE.
5GS mobility management (5 GMM) information elements The purpose of the 5GMM capability information element is to provide the network with information concerning aspects of the UE related to the 5GCN or interworking with the EPS.
The contents might affect the manner in which the network handles the operation of the UE.
5GMM capability IEI octet 1 Length of 5GMM capability contents octet 2.
eUP WUSA CAG Octet 5* 5GMM capability information element ATTACH REQUEST message containing PDN CONNECTIVITY REQUEST message for handover support (HO attach) (octet 3, bit 2) 0 ATTACH REQUEST message containing PDN CONNECTIVITY REQUEST message with request type set to "handover" or "handover of emergency bearer services" to transfer PDU session from N1 mode to S1 1 ATTACH REQUEST message containing PDN CONNECTIVITY REQUEST message with request type set to "handover" or "handover of emergency bearer services" to transfer PDU session from N1 mode to S1 LTE Positioning Protocol (LPP) capability (octet 3, bit 3) 0 LPP in N1 mode not supported 1 LPP in N1 mode supported (see 3GPP specification document\) Restriction on use of enhanced coverage support (RestrictEC) (octet 3, bit 4) This bit indicates the capability to support restriction on use of enhanced coverage.
0 Restriction on use of enhanced coverage not supported 1 Restriction on use of enhanced coverage supported Control plane CIoT 5GS optimization (5G-CP CIoT) (octet 3, bit 5) This bit indicates the capability for control plane CIoT 5GS optimization.
0 Control plane CIoT 5GS optimization not supported 1 Control plane CIoT 5GS optimization supported N3 data transfer (N3 data) (octet 3, bit 6) This bit indicates the capability for N3 data transfer.
0 N3 data transfer supported 1 N3 data transfer not supported IP header compression for control plane CIoT 5GS optimization (5G-IPHC-CP CIoT) (octet 3, bit 7) This bit indicates the capability for IP header compression for control plane CIoT 5GS 0 IP header compression for control plane CIoT 5GS optimization not 1 IP header compression for control plane CIoT 5GS optimization supported Service gap control (SGC) (octet 3, bit 8) 0 service gap control not supported 1 service gap control supported 5G-SRVCC from NG-RAN to UTRAN (5GSRVCC) capability (octet 4, bit 1) 0 5G-SRVCC from NG-RAN to UTRAN not supported 1 5G-SRVCC from NG-RAN to UTRAN supported (see 3GPP specification document [6A]) User plane CIoT 5GS optimization (5G-UP CIoT) (octet 4, bit 2) This bit indicates the capability for user plane CIoT 5GS optimization.
0 User plane CIoT 5GS optimization not supported 1 User plane CIoT 5GS optimization supported V2X capability (V2X) (octet 4, bit 3) This bit indicates the capability for V2X, as specified in 3GPP specification document [19B].
0 V2X not supported V2X communication over E-UTRA-PC5 capability (V2XCEPC5) (octet 4, bit 4) This bit indicates the capability for V2X communication over E-UTRA-PC5, as specified in 3GPP specification document [19B].
4 This bit indicates the capability for V2X communication over NR-PC5, as specified in 3GPP specification document [19B].
Bit 5 0 V2X communication over NR-PC5 not supported 1 V2X communication over NR-PC5 supported Location Services (5G-LCS) notification mechanisms capability (octet 4, bit 6) 0 LCS notification mechanisms not supported 1 LCS notification mechanisms supported (see 3GPP specification document [6B]) Network slice-specific authentication and authorization (NSSAA) (octet 4, bit 7) This bit indicates the capability to support network slice-specific authentication and 0 Network slice-specific authentication and authorization not supported 1 Network slice-specific authentication and authorization supported Radio capability signalling optimisation (RACS) capability (octet 4, bit 8) 0 RACS not supported Closed Access Group (CAG) capability (octet 5, bit 1) 0 CAG not supported WUS assistance (WUSA) information reception capability (octet 5, bit 2) 0 WUS assistance information reception not supported 1 WUS assistance information reception supported Multiple user-plane resources support (multipleUP) (octet 5, bit 3) This bit indicates the capability to support multiple user-plane resources in NB-N1 mode.
0 Multiple user-plane resources not supported 1 Multiple user-plane resources supported Ethernet header compression for control plane CIoT 5GS optimization (5G-EHC-CP CIoT) (octet 5, bit 4) 0 Ethernet header compression for control plane CIoT 5GS optimization 1 Ethernet header compression for control plane CIoT 5GS optimization bits in octet 5 and bits in octets 6 to 15 are spare and shall be coded as zero, if the respective octet is included in the information element.
The purpose of the 5GMM cause information element is to indicate the reason why a 5GMM request from the UE is rejected by the network.
The 5GMM cause information element is coded as shown in figure and table 5GMM cause IEI octet 1 Cause value octet 2 5GMM cause information element.
Any other value received by the mobile station shall be treated as 0110 1111, "protocol error, unspecified".
Any other value received by the network shall be treated as 0110 1111, "protocol error, unspecified".
A 5GS DRX parameters The purpose of the 5GS DRX parameters information element is to indicate that the UE wants to use DRX and for the network to indicate the DRX cycle value to be used at paging.
5GS DRX parameters information element Table A.
1: 5GS DRX parameters information element DRX value (bits 4 to 1 of octet 3) This field represents the DRX cycle parameter 'T' as defined in 3GPP specification document .
All other values shall be interpreted as "DRX value not specified" by this version of the Bits 5 to 8 of octet 3 are spare and shall be coded as zero.
The purpose of the 5GS identity type information element is to specify which identity is requested.
The 5GS identity type information element is coded as shown in figure and table 5GS identity type information element Table : 5GS identity type information element Type of identity (octet 1).
1 1 0 MAC address All other values are unused and shall be interpreted as "SUCI", if received by the UE.
The purpose of the 5GS mobile identity information element is to provide either the SUCI, the 5G-GUTI, the IMEI, the IMEISV, the 5G-S-TMSI, the MAC address or the EUI-6 5GS mobile identity IEI octet 1 Length of 5GS mobile identity contents octet2 spare Type of identity MCC digit 1 octet 5 MCC digit 3 octet 6 AMF Set ID octet 9 5G-TMSI (continued) octet 12 5GS mobile identity information element for type of identity "5G-GUTI" 5GS mobile identity IEI octet 1 Length of 5GS mobile identity contents octet 2 5GS mobile identity information element for type of identity or "IMEI" or "IMEISV" spare Type of identity Routing indicator digit 2 Routing indicator digit 1 octet 8 Routing indicator digit 4 Routing indicator digit 3.
Home network public key identifier octet 11 octet 12 - x 5GS mobile identity information element for type of identity "SUCI" and SUPI Scheme output for type of identity "SUCI", SUPI format "IMSI" and Protection scheme Id "Null scheme" 5GS mobile identity IEI octet 1 Length of 5GS mobile identity contents octet 2 octet 3.
Spare Type of identity octet 5 - y 5GS mobile identity information element for type of identity "SUCI" and SUPI format "Network specific identifier", "GCI" or "GLI" spare Type of identity 5G-TMSI (continued) octet 8 5GS mobile identity information element for type of identity "5G-S-TMSI" 5GS mobile identity IEI octet 1 Length of 5GS mobile identity contents octet 2 5GS mobile identity information element for type of identity "No identity" 5GS mobile identity IEI octet 1 Length of 5GS mobile identity contents octet 2 octet 3 I Type of identity MAC address octet 5 5GS mobile identity information element for type of identity "MAC address" 5GS mobile identity IEI octet 1 Length of 5GS mobile identity contents octet 2 octet 3 spare Type of identity 5GS mobile identity information element for type of identity "EUI-64" 1 1 0 MAC address All other values are reserved.
Odd/even indication (octet 4) Bit 0 even number of identity digits 1 odd number of identity digits For the 5G-GUTI, then bits 5 to 8 of octet 4 are coded as "1111", octet 5 through 7 contain the MCC and MNC values as specified below, octet 8 through 10 contain the AMF Region ID, the AMF Set ID and the AMF Pointer values and octet 11 through 14 contain the 5G-TMSI as defined in 3GPP specification document .
MCC, Mobile country code (octet 5, octet 6 bits 1 to 4) The MCC field is coded as in ITU-T Recommendation E.
212 , annex A.
MNC, Mobile network code (octet 6 bits 5 to 8, octet 7) The contents of the MCC and MNC digits are coded as octets 6 to 8 of the Temporary mobile group identity IE in figure 154 of 3GPP specification document .
AMF Region ID (octet 8) This field contains the binary encoding of the AMF Region ID.
Bit 8 of octet 7 is the most significant bit and bit 1 of octet 7 is the least significant bit.
AMF Set ID (octet 9, octet 10 bits 7 to 8) This field contains the binary encoding of the AMF Set ID.
Bit 8 of octet 9 is the most significant bit and bit 7 of octet 10 is the least significant bit.
AMF Pointer (octet 10 bits 1 to 6) This field contains the binary encoding of the AMF Pointer.
Bit 6 of octet 9 is the most significant bit and bit 1 of octet 9 is the least significant bit.
5G-TMSI (octet 11 to 14) Bit 8 of octet 11 is the most significant bit and bit 1 of octet 14 is the least significant Identity digit (octet 4 bits 5 to 8, octet 5 etc.
) For the IMEI, Identity digit field is coded using BCD coding.
If the number of identity digits is even then bits 5 to 8 of the last octet shall be filled with an end mark coded as "1111".
The format of the IMEI is described in 3GPP specification document .
For the IMEISV, Identity digit field is coded using BCD coding.
Bits 5 to 8 of the last octet shall be filled with an end mark coded as "1111".
The format of the IMEISV is described in 3GPP specification document .
For the SUCI, bit 8 of octet 4 is spare and shall be coded as zero.
Bits of octet 4 contain the SUPI format and are coded .
SUPI format (octet 4, bits\) Bits All other values are interpreted as IMSI by this version of the protocol.
For the SUCI with SUPI format "IMSI", octets 5 through 7 contain the MCC and MNC values as specified below.
For subsequent fields, bit 8 of octet 8 is the most significant bit and bit 1 of the last octet the least significant bit.
The required fields for the SUCI are as defined in 3GPP specification document .
MCC, Mobile country code (octet 5, octet 6 bits 1 to 4) The MCC field is coded as in ITU-T Recommendation E.
212 , annex A.
use only two digits in the MNC, bits 5 to 8 of octet 6 shall be coded as "1111".
The contents of the MCC and MNC digits are coded as octets 6 to 8 of the Temporary mobile group identity IE in figure 154 of 3GPP specification document .
operator decides to assign less than 4 digits to Routing Indicator, the remaining digits shall be coded as "1111" to fill the 4 digits coding of Routing Indicator (see NOTE 2).
If no Routing Indicator is configured in the USIM, the UE shall code bits 1 to 4 of octet 8 of the Routing Indicator as "0000" and the remaining digits as “1111".
Protection scheme identifier (octet 10 bits 1 to 4).
to Operator-specific protection scheme Bits of octet 10 are spare and shall be coded as zero.
Home network public key identifier (octet 10) The Home network public key identifier (PKI) field is coded as defined in 3GPP specification document .
Home network public key identifier shall be coded as "00000000" when Protection scheme identifier is set to "0000" (i.
to Home network PKI value (54).
coded as hexadecimal digits.
For the SUCI with SUPI format set to "Netwo rk specific identifier", the SUCI NAI field contains an NAI constructed as specified in subclause 2 of 3GPP specification document and encoded as UTF-8 string.
For the SUCI with SUPI format set to "GCI", the SUCI NAI field contains an NAI constructed as specified in subclause 2 of 3GPP specification document and encoded as For the SUCI with SUPI format set to "GLI", the SUCI NAI field contains an NAI constructed as specified in subclause 2 of 3GPP specification document and encoded as For the 5G-S-TMSI, bits 5 to 8 of octet 4 are coded as "1111".
The coding of the 5G-S- TMSI is left open for each administration.
AMF Set ID (octet 5, octet 6 bits 7 to 8) This field contains the binary encoding of the AMF Set ID.
Bit 8 of octet 5 is the most significant bit and bit 7 of octet 6 is the least significant bit.
AMF Pointer (octet 6 bits 1 to 6) This field contains the binary encoding of the AMF Pointer.
Bit 6 of octet 6 is the most significant bit and bit 1 of octet 6 is the least significant bit.
5G-TMSI (octet 7 to 10) Bit 8 of octet 7 is the most significant bit and bit 1 of octet 10 is the least significant bit.
MAC address (octets 5 to 10) This field contains the MAC address as defined in subclause 8 of IEEE Std 802 .
Bit 8 of octet 5 is the most significant bit and bit 1 of octet 10 is the least significant bit.
This field contains an EUI-64 as defined in .
Bit 8 of octet 5 is the most significant bit and bit 1 of octet 10 is the least significant bit.
MAC address usage restriction indication (MAURI) (octet 4 bit 4).
1 MAC address is not usable as an equipment identifier For Type of identity "No identity", the length of mobile identity contents parameter shall be set to 1 and the bits of octet 4 are spare and shall be coded as zero.
NOTE 1: This can be used when the requested identity is not available at the UE during the identification procedure.
"0101", bits 5 to 8 of octet 8 are coded as "0110", bits 1 to 4 of octet 9 are coded as "0111", bits 5 to 8 of octet 9 are coded as "1111".
5GS network feature support The purpose of the 5GS network feature support information element is to indicate whether certain features are supported by the network.
The 5GS network feature support information element is coded as shown in figure and table If the network does not include octet 4 as defined in figure in the present version of the protocol, then the UE 5GS network feature support IEI octet 1 Length of 5GS network feature support contents octet 2 N26 EMF EMC IMS-.
5GS network feature support information element 0 IMS voice over PS session not supported over 3GPP access 1 IMS voice over PS session supported over 3GPP access IMS voice over PS session over non-3GPP access indicator (IMS-VoPS-N3GPP) (octet 3, bit 2) This bit indicates the support of IMS voice over PS session over non-3GPP access.
0 IMS voice over PS session not supported over non-3GPP access 1 IMS voice over PS session supported over non-3GPP access Emergency service support indicator for 3GPP access (EMC) (octet 3, bit 3 and bit 4) These bits indicate the support of emergency services in 5GS for 3GPP access (see NOTE 1).
0 0 Emergency services not supported 0 1 Emergency services supported in NR connected to 5GCN only 1 0 Emergency services supported in E-UTRA connected to 5GCN only 1 1 Emergency services supported in NR connected to 5GCN and E-UTRA Emergency services fallback indicator for 3GPP access (EMF) (octet 3, bit 5 and bit 6) These bits indicate the support of emergency services fallback for 3GPP access (see NOTE 1).
0 0 Emergency services fallback not supported 0 1 Emergency services fallback supported in NR connected to 5GCN only 1 0 Emergency services fallback supported in E-UTRA connected to 5GCN 1 1 Emergency services fallback supported in NR connected to 5GCN and E-UTRA connected to 5GCN Interworking without N26 interface indicator (IWK N26) (octet 3, bit 7) This bit indicates whether interworking without N26 interface is supported.
0 Interworking without N26 interface not supported 1 Interworking without N26 interface supported MPS indicator (MPSI) (octet 3, bit 8) This bit indicates the validity of MPS.
0 Access identity 1 not valid 1 Access identity 1 valid Emergency service support for non-3GPP access indicator (EMCN3) (octet 4, bit 1) This bit indicates the support of emergency services in 5GS for non-3GPP access.
Bit (see NOTE 2) 0 Emergency services not supported over non-3GPP access 1 Emergency services supported over non-3GPP access MCS indicator (MCSI) (octet 4, bit 2) This bit indicates the validity of MCS.
0 Access identity 2 not valid 1 Access identity 2 valid.
In NB-N1 mode these bits are set as follows.
0 0 Use of enhanced coverage is not restricted 0 1 Use of enhanced coverage is restricted.
Control plane CIoT 5GS optimization (5G-CP CIoT) (octet 4, bit 5) This bit indicates the capability for control plane CIoT 5GS optimization.
0 Control plane CIoT 5GS optimization not supported 1 Control plane CIoT 5GS optimization supported N3 data transfer (N3 data) (octet 4, bit 6) This bit indicates the capability for N3 data transfer.
0 N3 data transfer supported 1 N3 data transfer not supported IP header compression for control plane CIoT 5GS optimization (5G-HC-CP CIoT) (octet 4, bit 7) This bit indicates the capability for IP header compression for control plane CIoT 5GS.
0 IP header compression for control plane CIoT 5GS optimization not 1 IP header compression for control plane CIoT 5GS optimization User plane CIoT 5GS optimization (5G-UP CIoT) (octet 4, bit 8) This bit indicates the capability for user plane CIoT 5GS optimization.
0 User plane CIoT 5GS optimization not supported 1 User plane CIoT 5GS optimization supported Location Services indicator in 5GC (5G-LCS) (octet 6, bit 1).
0 Location services via 5GC not supported 1 Location services via 5GC supported ATSSS support indicator (ATS-IND) (octet 5, bit 2) This bit indicates the network support for ATSSS.
0 ATSSS not supported Ethernet header compression for control plane CIoT 5GS optimization (5G-EHC-CP CIoT) (octet 5, bit 3) This bit indicates the capability for Ethernet header compression for control plane CIoT 5GS optimization 1 Ethernet header compression for control plane CIoT 5GS optimization Bits 4 to 8 in octet 5 are spare and shall be coded as zero.
3 to 6 of octet 3 are ignored.
5GS registration result IEI octet 1 Length of 5GS registration result contents octet 2.
d 5GS registration result 5GS registration result information element 0 1 0 Non-3GPP access All other values are unused and shall be treated as "3GPP access", if received by the SMS over NAS transport allowed (SMS allowed) (octet 3, bit 4) (NOTE).
0 SMS over NAS not allowed 1 SMS over NAS allowed Network slice-specific authentication and authorization is to be performed (NSSAA to be performed) (octet 3, bit 5) (NOTE).
0 Network slice-specific authentication and authorization is not to be 1 Network slice-specific authentication and authorization is to be Emergency registered (octet 3, bit 6).
0 Not registered for emergency services 1 Registered for emergency services Bits 7 to 8 of octet 3 are spare and shall be coded as zero.
NOTE: All bits other than bit 6 in octet 3 shall be ignored by the UE when the 5GS registration result IE is received in the CONFIGURATION UPDATE COMMAND message The purpose of the 5GS registration type information element is to indicate the type of the requested registration.
The 5GS registration type information element is coded as shown in figure and table 5GS registration type IEI FOR 5GS registration type 5GS registration type information element 0 0 1 initial registration 0 1 0 mobility registration updating 0 1 1 periodic registration updating 1 0 0 emergency registration All other values are unused and shall be interpreted as "initial registration", if received Follow-on request bit (FOR) (octet 1, bit 4).
0 No follow-on request pending 1 Follow-on request pending 5GS tracking area identity The purpose of the 5GS tracking area identity information element is to provide an unambiguous identification of tracking areas within the area covered by the 5GS.
5GS tracking area identity IEI octet 1 MNC digit 1 octet 4 TAC (continued) octet 7 5GS tracking area identity information element The MCC field is coded as in ITU-T Rec.
E212 , annex A.
If the TAI is deleted the MCC and MNC shall take the value from the deleted TAI.
In abnormal cases, the MCC stored in the UE can contain elements not in the set {0, 1 .
In such cases the UE should transmit the stored values using full hexadecimal encoding.
When receiving such an MCC, the network shall treat the MNC, Mobile network code (octet 3 bits 5 to 8, octet 4) The coding of this field is the responsibility of each administration, but BCD coding shall be used.
The MNC shall consist of 2 or 3 digits.
For PCS 1900 for NA, Federal In abnormal cases, the MNC stored in the UE can have: - digit 1 or 2 not in the set {0, 1 .
9}, or digit 3 not in the set {0, 1 .
TAC, Tracking area code (octets 5 to 7) In the TAC field bit 8 of octet 5 is the most significant bit and bit 1 of octet 7 the The coding of the tracking area code is the responsibility of each administration except that two values are used to mark the TAC, and hence the TAI, as deleted.
Coding using full hexadecimal representation may be used.
The tracking area code consists of 3 octets.
5GS tracking area identity list network to the UE.
The coding of the information element allows combining different types of lists.
The lists of type "00" and "01" allow a more compact encoding, when the different TAIs are sharing the PLMN identity.
The 5GS tracking area identity list information element is coded as shown in figure , figure , figure , figure and table Partial tracking area identity list 1 octet 3 Partial tracking area identity list 2 octet i+1* octet l* … octet l+1* octet m* 5GS tracking area identity list information element Spare Type of list Number of elements octet 1 TAC 1 octet 5 TAC 1 (continued) octet 6 TAC k (continued) octet 3k+3* TAC k (continued) octet 3k+4* Partial tracking area identity list – type of list = "00" MNC digit 1 octet 4 TAC 1 octet 5 Partial tracking area identity list – type of list = "01" Spare Type of list Number of elements octet 1 MCC digit 3 octet 3 TAC 1 (continued) octet 6 TAC 1 (continued) octet 7 MNC digit 1 octet 10* TAC 2 octet 11* MCC digit 1 octet 6k-4* MCC digit 3 octet 6k-3* TAC k (continued) octet 6k* Partial tracking area identity list – type of list = "10" identity list can be determined from the 'type of list' field and the 'number of elements' field in the first octet of the partial tracking area identity list.
The UE shall store the complete list received.
If more than 16 TAIs are included in this information element, the UE shall store the first 16 TAIs and ignore the remaining octets of the information element.
Partial tracking area identity list: Type of list (octet 1).
0 0 list of TACs belonging to one PLMN or SNPN, with non-consecutive TAC values 0 1 list of TACs belonging to one PLMN or SNPN, with consecutive TAC values 1 0 list of TAIs belonging to different PLMNs (see NOTE) All other values are reserved.
Number of elements (octet 1).
All other values are unused and shall be interpreted as 16, if received by the UE.
Bit 8 of octet 1 is spare and shall be coded as zero.
For type of list = "00" and number of elements = k: octet 2 to 4 contain the MCC+MNC, and for j = 1, …, k: octets 3j+2 to 3j+4 contain the TAC of the j-th TAI belonging to the partial list, For type of list = "01" and number of elements = k: octet 2 to 4 contain the MCC+MNC, and octets 5 to 7 contain the TAC of the first TAI belonging to the partial list.
The TAC values of the other k-1 TAIs are TAC+1, TAC+2, …, TAC+k- For type of list = "10" and number of elements = k: for j = 1, …, k.
octets 6j-4 to 6j-2 contain the MCC+MNC, and octets 6j-1 to 6j+1 contain the TAC of the j-th TAI belonging to the partial list.
MCC, Mobile country code The MCC field is coded as in ITU-T Recommendation E.
212 , annex A.
MNC, Mobile network code The coding of this field is the responsibility of each administration but BCD coding shall TAC, Tracking area code Coding using full hexadecimal representation may be used.
The tracking area code consists of 3 octets.
NOTE: If the "list of TAIs belonging to different PLMNs" is used, the PLMNs included in the list need to be present in the list of "equivalent PLMNs".
This type of list is not applicable in an SNPN.
A 5GS update type The purpose of the 5GS update type IE is to allow the UE to provide additional information to the network when 5GS update type IEI octet 1 Length of 5GS update type octet 2.
Spare EPS- PNB-CIoT 5GS-PNB-CIoT NG- 5GS update type information element Table A.
1: 5GS update type information element SMS over NAS transport requested (SMS requested) (octet 3, bit 1).
0 SMS over NAS not supported 1 SMS over NAS supported NG-RAN Radio Capability Update (NG-RAN-RCU) (octet 3, bit 2).
0 UE radio capability update not needed 1 UE radio capability update needed indication see subclause , case n).
5GS Preferred CIoT network behaviour (5GS PNB-CIoT) (octet 3, bits 3 and 4).
0 0 no additional information 0 1 control plane CIoT 5GS optimization 1 0 user plane CIoT 5GS optimization EPS Preferred CIoT network behaviour (EPS-PNB-CIoT) (octet 3, bits 5 and 6).
0 0 no additional information 0 1 control plane CIoT EPS optimization 1 0 user plane CIoT EPS optimization Bits 7 to 8 of octet 3 are spare and shall be coded as zero.
The purpose of the ABBA information element is to en able the bidding down protection of security features.
The ABBA information element is coded as shown in figure and table ABBA IEI octet 1 Length of ABBA contents octet 2 ABBA contents octet 3 Table : ABBA information element ABBA contents (octet n): indicate set of security features defined for 5GS as described in 3GPP specification document .
2 Additional 5G security information The purpose of the Additional 5G security information information element is to provide the UE with additional The Additional 5G security information information element is coded as shown in figure and Additional 5G security information IEI octet 1 Length of Additional 5G security information contents octet 2.
Additional 5G security information information element Table : Additional 5G security information information element Horizontal derivation parameter (HDP) (octet 3, bit 1) 0 K AMF derivation is not required 1 K AMF derivation is required Retransmission of initial NAS message request (octet 3, bit 2) 0 Retransmission of the initial NAS message not requested 1 Retransmission of the initial NAS message requested Bits 3 to 8 of octet 3 are spare and shall be coded as zero.
for deciphering of ciphered broadcast assistance data.
The Additional information requested information element is coded as shown in figure 2A.
1 and Additional information requested IEI octet 1 Length of additional information requested contents octet 2.
Additional information requested information element Table 2A.
1: Additional information requested information element Ciphering keys for ciphered broadcast assistance data (CipherKey) (octet 3, bit 1).
0 ciphering keys for ciphered broadcast assistance data not requested 1 ciphering keys for ciphered broadcast assistance data requested Bits 8 to 2 of octet 3 are spare and shall be coded as zero.
3 Allowed PDU session status The purpose of the Allowed PDU session status information element is to indicate to the network user-plane resources of PDU sessions associated with non-3GPP access that are allowed to be re-established over 3GPP access or if there is no PDU session(s) for which the UE allows the user-plane resources to be re-established over 3GPP access.
Allowed PDU session status IEI octet 1 Length of Allowed PDU session status contents octet 2 Spare octet 5* -34* Allowed PDU session status information element PSI(0): Bit 1octet 3 is spare and shall be coded as zero.
0 indicates that the user-plane resources of corresponding PDU session is not allowed to be re-established over 3GPP access.
1 indicates that the user-plane resources of corresponding PDU session can be re-established over 3GPP If there is no PDU session for which the user-plane resources can be re-established over 3GPP access, all bits in PSI(1) – PSI(15) shall be coded as zero.
All bits in octet 5 to 34 are spare and shall be coded as zero, if the respective octet is included in the information element.
4 Authentication failure parameter See subclause 1 in 3GPP specification document .
5 Authentication parameter AUTN See subclause 1 in 3GPP specification document .
6 Authentication parameter RAND See subclause 1 in 3GPP specification document .
7 Authentication response parameter See subclause in 3GPP specification document .
8 Configuration update indication The purpose of the Configuration update indication information element is to indicate the additional information associated with the generic UE configuration update procedure.
The Configuration update indication information element is coded as shown in figure and table.
Spare RED ACK octet 1 Table : Configuration update indication Acknowledgement (ACK) (octet 1, bit 1).
0 acknowledgement not requested Bits 3 and 4 are spare and shall be coded as zero, 8A CAG information list The purpose of the CAG information list information element is to provide "CAG information list" or to delete the "CAG information list" at the UE.
The CAG information list information element is coded as shown in figures 8A.
2 and CAG information list IEI octet 1 Length of CAG information list contents Entry 1 octet 4* octet a* Entry 2 octet a+1* octet b* … octet b+1* octet g* CAG information list information element Length of entry contents octet q MNC digit 1 octet q+3.
CAG-ID 1 octet q+5* CAG-ID 2 octet q+9* MNC, Mobile network code (bits 5 to 8 of octet q+2 and octet q+3) The coding of this field is the responsibility of each administration but BCD coding shall only two digits in the MNC, bits 5 to 8 of octet 6 shall be coded as "1111".
The contents of the MCC and MNC digits are coded as octets 6 to 8 of the Temporary mobile group identity IE in figure 154 of 3GPP specification document .
Indication that the UE is only allowed to access 5GS via CAG cells (CAGonly) (bit 1 of.
0 "Indication that the UE is only allowed to access 5GS via CAG cells" is not set (i.
the UE is allowed to access 5GS via non-CAG cells) 1 "Indication that the UE is only allowed to access 5GS via CAG cells" is set (i.
the UE is not allowed to access 5GS via non-CAG cells) CAG-ID m (octet q+4m+1 to octet q+4m+4) This field contains the 32 bit CAG-ID.
The coding of the CAG-ID is defined as the CAG- Identifier in 3GPP specification document .
8B CIoT small data container is not more than 254 octets between the UE and the AMF when the UE is using control plane CIoT 5GS optimization.
4 and table length of 257 octets.
CIoT small data container IEI octet 1 Length of CIoT small data container contents octet 2 CIoT small data container contents CIoT small data container information element Data type DDX PDU session identity octet 3 CIoT small data container contents for Data type "Control plane user data" Additional information octet 5* CIoT small data container contents for Data type "Location services message Data type Spare octet 3 CIoT small data container contents for Data type "SMS" Data type (octet 3, bits 6 to 8).
0 0 0 Control plane user data 0 1 0 Location services message container All other values are spare.
When the Data type is "Control plane user data ", the PDU session identity and Downlink data expected (DDX) fields are encoded as follows: PDU session identity (octet 3, bits 1 to 4).
0 0 0 No PDU session identity assigned 0 0 1 PDU session identity value 1 0 1 0 PDU session identity value 2 0 1 1 PDU session identity value 3 1 0 0 PDU session identity value 4 1 0 1 PDU session identity value 5 1 1 0 PDU session identity value 6 1 1 1 PDU session identity value 7 Downlink data expected (DDX) (octet 3, bits 5 to 6).
0 0 No information available 0 1 No further uplink and no further downlink data transmission subsequent to the uplink data transmission is expected transmission subsequent to the uplink data transmission is expected NOTE: The DDX field is only used in the UE to network direction.
Data contents (octet 4 to octet 257) This field contains the control plane user data.
When the Data type is "SMS", Bits 1 to 5 of octet 3 are spare and shall be coded as Data contents (octet 4 to octet 257) This field contains an SMS message.
When the Data type is "Location services message container": Downlink data expected (DDX) (octet 3, bits 5 to 4) This field is encoded as described above for the case when the Data type is "Control plane user data".
Bits 3 to 1 of octet 3 are spare and shall be encoded as zero.
Length of Additional information (octet 4) (see NOTE) Indicates the length, in octets, of the Additional information field.
Additional information (octets 5 to m) Contains additional information if provided by the upper layer location services Data contents (octets m+1 to n) Contains the location services message payload.
8C Ciphering key data the UE for deciphering of ciphered assistance data.
The Ciphering key data information element is coded as shown in figure 8C.
2 and Ciphering key data IEI octet 1 Length of ciphering key data contents Ciphering data set 1 octet 4 octet i Ciphering data set 2 octet i+1* octet l* … octet l+1* octet m* Ciphering key data information element Ciphering key octet 3.
Validity start time octet q+1 Validity duration octet q+6 TAIs list octet q+8 Ciphering data set The UE shall store the complete list received.
If more than 16 ciphering data sets are included in this information element, the UE shall store the first 16 ciphering data sets and ignore the remaining octets of the information element.
Ciphering set ID (octets 1 to 2) This field contains the binary encoding of the ID identifying the ciphering set.
Ciphering key (octets 3 to octet 18) This field contains the 128 bit ciphering key.
c0 length (octet 19, bits 5 to 1) This field contains the binary encoding of the length, in octets, of the c0 counter.
The maximum value for the length of the c0 counter is 16 octets.
Bits 8 to 6 of octect 19 are spare and shall be coded as zero.
c0 (octets 20 to k) This field contains the binary encoding of the c0 counter.
E-UTRA posSIB length (octet k+1, bits 4 to 1) Ciphering data set applicable for positioning SIB type (octet k+2, bit 8) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet k+2, bit 7) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet k+2, bit 6) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet k+2, bit 5) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet k+2, bit 4) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet k+2, bit 3) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet k+2, bit 2) 0 Ciphering data set not applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet k+3, bit 8) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet k+3, bit 7) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet k+3, bit 6) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet k+3, bit 5) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet k+3, bit 4) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet k+3, bit 3) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet k+3, bit 2) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet k+3, bit 1) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet k+4, bit 8) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type 0 (octet k+4, bit 7) 0 Ciphering data set not applicable to positioning SIB type 0 1 Ciphering data set applicable to positioning SIB type 0 Ciphering data set applicable for positioning SIB type 1 (octet k+4, bit 6) 0 Ciphering data set not applicable to positioning SIB type 1 1 Ciphering data set applicable to positioning SIB type 1 Ciphering data set applicable for positioning SIB type 2 (octet k+4, bit 5) 0 Ciphering data set not applicable to positioning SIB type 2 1 Ciphering data set applicable to positioning SIB type 2 Ciphering data set applicable for positioning SIB type 3 (octet k+4, bit 4) 0 Ciphering data set not applicable to positioning SIB type 3 1 Ciphering data set applicable to positioning SIB type 3 Ciphering data set applicable for positioning SIB type 4 (octet k+4, bit 3) 0 Ciphering data set not applicable to positioning SIB type 4 1 Ciphering data set applicable to positioning SIB type 4 Ciphering data set applicable for positioning SIB type 5 (octet k+4, bit 2) 0 Ciphering data set not applicable to positioning SIB type 5 1 Ciphering data set applicable to positioning SIB type 5 Ciphering data set applicable for positioning SIB type 6 (octet k+4, bit 1) 1 Ciphering data set applicable to positioning SIB type 7 Ciphering data set applicable for positioning SIB type 8 (octet k+5, bit 7) 0 Ciphering data set not applicable to positioning SIB type 8 1 Ciphering data set applicable to positioning SIB type 8 Ciphering data set applicable for positioning SIB type 9 (octet k+5, bit 6) 0 Ciphering data set not applicable to positioning SIB type 9 1 Ciphering data set applicable to positioning SIB type 9 Ciphering data set applicable for positioning SIB type 0 (octet k+5, bit 5) 0 Ciphering data set not applicable to positioning SIB type 0 1 Ciphering data set applicable to positioning SIB type 0 Ciphering data set applicable for positioning SIB type 1 (octet k+5, bit 4) 0 Ciphering data set not applicable to positioning SIB type 1 1 Ciphering data set applicable to positioning SIB type 1 Ciphering data set applicable for positioning SIB type 2 (octet k+5, bit 3) 0 Ciphering data set not applicable to positioning SIB type 2 1 Ciphering data set applicable to positioning SIB type 2 Ciphering data set applicable for positioning SIB type 3 (octet k+5, bit 2) 0 Ciphering data set not applicable to positioning SIB type 3 1 Ciphering data set applicable to positioning SIB type 3 Ciphering data set applicable for positioning SIB type 4 (octet k+5, bit 1) 0 Ciphering data set not applicable to positioning SIB type 4 1 Ciphering data set applicable to positioning SIB type 4 Ciphering data set applicable for positioning SIB type 5 (octet k+6, bit 8) 0 Ciphering data set not applicable to positioning SIB type 5 1 Ciphering data set applicable to positioning SIB type 5 Ciphering data set applicable for positioning SIB type (octet k+6, bit 7) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet k+6, bit 6) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet k+6, bit 5) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Any unassigned bits shall be coded as zero.
NR posSIB length (octet p+1, bits 4 to 1) This field contains the length in octets of the NR Positioning SIB types.
A length of zero means NR Positioning SIB types are not included.
NR Positioning SIB types for which the ciphering data set is applicable (octets p+2 to q).
Unassigned bits shall be ignored.
Non-included bits shall be assumed to be zero.
Ciphering data set applicable for positioning SIB type (octet p+2, bit 8) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet p+2, bit 7) 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet p+2, bit 5) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet p+2, bit 4) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet p+2, bit 3) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet p+2, bit 2) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet p+2, bit 1) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet p+3, bit 8) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet p+3, bit 7) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet p+3, bit 6) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet p+3, bit 5) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet p+3, bit 4) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet p+3, bit 3) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet p+3, bit 2) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet p+3, bit 1) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet p+4, bit 8) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type 0 (octet p+4, bit 7) 0 Ciphering data set not applicable to positioning SIB type 0 1 Ciphering data set applicable to positioning SIB type 0 0 Ciphering data set not applicable to positioning SIB type 2 1 Ciphering data set applicable to positioning SIB type 2 Ciphering data set applicable for positioning SIB type 3 (octet p+4, bit 4) 0 Ciphering data set not applicable to positioning SIB type 3 1 Ciphering data set applicable to positioning SIB type 3 Ciphering data set applicable for positioning SIB type 4 (octet p+4, bit 3) 0 Ciphering data set not applicable to positioning SIB type 4 1 Ciphering data set applicable to positioning SIB type 4 Ciphering data set applicable for positioning SIB type 5 (octet p+4, bit 2) 0 Ciphering data set not applicable to positioning SIB type 5 1 Ciphering data set applicable to positioning SIB type 5 Ciphering data set applicable for positioning SIB type 6 (octet p+4, bit 1) 0 Ciphering data set not applicable to positioning SIB type 6 1 Ciphering data set applicable to positioning SIB type 6 Ciphering data set applicable for positioning SIB type 7 (octet p+5, bit 8) 0 Ciphering data set not applicable to positioning SIB type 7 1 Ciphering data set applicable to positioning SIB type 7 Ciphering data set applicable for positioning SIB type 8 (octet p+5, bit 7) 0 Ciphering data set not applicable to positioning SIB type 8 1 Ciphering data set applicable to positioning SIB type 8 Ciphering data set applicable for positioning SIB type 9 (octet p+5, bit 6) 0 Ciphering data set not applicable to positioning SIB type 9 1 Ciphering data set applicable to positioning SIB type 9 Ciphering data set applicable for positioning SIB type 0 (octet p+5, bit 5) 0 Ciphering data set not applicable to positioning SIB type 0 1 Ciphering data set applicable to positioning SIB type 0 Ciphering data set applicable for positioning SIB type 1 (octet p+5, bit 4) 0 Ciphering data set not applicable to positioning SIB type 1 1 Ciphering data set applicable to positioning SIB type 1 Ciphering data set applicable for positioning SIB type 2 (octet p+5, bit 3) 0 Ciphering data set not applicable to positioning SIB type 2 1 Ciphering data set applicable to positioning SIB type 2 Ciphering data set applicable for positioning SIB type 3 (octet p+5, bit 2) 0 Ciphering data set not applicable to positioning SIB type 3 1 Ciphering data set applicable to positioning SIB type 3 Ciphering data set applicable for positioning SIB type (octet p+5, bit 1) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet p+6, bit 8) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet p+6, bit 7) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet p+6, bit 6) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Ciphering data set applicable for positioning SIB type (octet p+6, bit 4) 0 Ciphering data set not applicable to positioning SIB type 1 Ciphering data set applicable to positioning SIB type Any unassigned bits shall be coded as zero.
Validity start time (octets q+1 to q+5) This field contains the UTC time when the ciphering data set becomes valid, encoded as octets 2 to 6 of the Time zone and time IE specified in 3GPP specification document .
Validity duration (octets q+6 to q+7) This field contains the duration for which the ciphering data set is valid after the validity start time, in units of minutes.
TAIs list (octets q+8 to r) This field contains the list of tracking areas for which the ciphering data set is ciphering data set is applicable to the entire serving PLMN.
8D Control plane service type The purpose of the Control plane service type information element is to specify the purpose of the CONTROL PLANE Control plane service type Spare Control plane service Control plane service type information element Table 8D.
1: Control plane service type information element Control plane service type value (octet 1, bit 1 to 3).
0 0 0 mobile originating request 0 0 1 mobile terminating request to unused; shall be interpreted as " mobile originating request", if received 9 Daylight saving time See subclause 12 in 3GPP specification document .
The purpose of the De-registration type information element is to indicate the type of de-registration.
required Access type octet 1 Deregistration type information element Table : Deregistration type information element Switch off (octet 1, bit 4) In the UE to network direction:.
In the network to UE direction bit 4 is spare.
The network shall set this bit to zero.
Re-registration required (octet 1, bit 3) In the network to UE direction:.
0 re-registration not required In the UE to network direction bit 3 is spare.
The UE shall set this bit to zero.
Access type (octet 1, bit 2, bit 1).
0 1 3GPP access 1 0 Non-3GPP access 1 1 3GPP access and non-3GPP access All other values are reserved.
2 Void 3 Emergency number list See subclause 13 in 3GPP specification document .
4 EPS NAS message container The purpose of the EPS NAS message container information element is to transport an EPS NAS message as specified in 3GPP specification document .
EPS NAS message container IEI octet 1 Length of EPS NAS message container contents octet 2 EPS NAS message container octet 4 EPS NAS message container information element Table : EPS NAS message container information element EPS NAS message container (octet 4 to n) An EPS NAS message as specified in 3GPP specification document .
5 EPS NAS security algorithms See subclause 3 in 3GPP specification document .
6 Extended emergency number list See subclause 7A in 3GPP specification document .
6A Extended DRX parameters See subclause 12 in 3GPP specification document .
See subclause 10 in 3GPP specification document .
The purpose of the LADN indication information element is to request the network for LADN information for specific LADN DNN value 1 octet 4* LADN DNN value 2 octet a+1* LADN indication information element Table : LADN indication information element Value part of the LADN indication information element (octet 4 to h): The value part of the LADN indication information element consists of zero or more LADN DNN values.
If the LADN indication information element conveys more than 8 LADN DNN values in this information element, the network shall consider the first 8 LADN DNN values and ignore the remaining octets of the information element.
The purpose of the LADN information information element is to provide the UE with the LADN service area for each available LADN in the current registration area or to delete the LADN information at the UE.
The LADN information information element is coded as shown in figure , figure and LADN information IEI octet 1 Length of LADN information contents octet 2 LADN 1 octet 4 LADN 2 octet a+1* LADN information information element octet m 5GS tracking area identity list octet m+1 octet a Table : LADN information information element Value part of the LADN information information element (octet 4 to octet h) The value part of the LADN information information element consists of one or several LADNs.
octet 4 to octet a) consists one DNN value and one 5GS tracking area identity list.
The length of each LADN is determined by the length of DNN value field and the length of 5GS tracking area identity list field.
The UE shall store the complete list as received.
If more than 8 LADNs are included in this information element, the UE shall store the first 8 LADNs and ignore the remaining octets of the information element.
DNN value (octet 5 to octet m): 5GS tracking area identity list (octet m+1 to octet a): 5GS tracking area identity list field is coded as the length and the value part of the 5GS Tracking area identity list information element as specified in subclause starting with the second octet.
The purpose of the MICO indication information element is to indicate the use of MICO mode or the re-negotiation of The MICO indication information element is coded as shown in figure and table MICO indication IEI 0.
Spare SPRTI RAAI octet 1.
0 all PLMN registration area not allocated 1 all PLMN registration area allocated In the UE to network direction bit 1 is spare.
The UE shall set this bit to zero.
Strictly Periodic Registration Timer Indication (SPRTI) (octet 1, bit 2) In the network to UE and the UE to network direction:.
0 strictly periodic registration timer not supported 1 strictly periodic registration timer supported Bits 3 and 4 are spare and shall be coded as zero.
NOTE: In the network to UE direction in the CONFIGURATION UPDATE COMMAND message, bit 1 shall be coded as zero.
1A MA PDU session information The purpose of the MA PDU session information information element is to convey the MA-related information for the The MA PDU session information information element is coded as shown in figure 1A.
1 and MA PDU session information IEI MA PDU session information MA PDU session information information element Table 1A.
1: MA PDU session information information element MA PDU session information value (octet 1, bit 1 to bit 4).
All other values are spare.
The purpose of the Mapped NSSAI information element is to transfer S-NSSAI(s) applicable in the HPLMN to the The Mapped NSSAI information element is coded as shown in figure 1B.
2 and Mapped S-NSSAI content 1 octet 3 Mapped S-NSSAI content 2 octet m+1* octet n* Mapped NSSAI information element Length of Mapped S-NSSAI content octet 3 Mapped HPLMN SST octet 4 Mapped HPLMN SD octet 5* Table 1B.
1: Mapped NSSAI information element Value part of the Mapped NSSAI information element (octet 3 to v) The value part of the Mapped NSSAI information element consists of one or more mapped S-NSSAI contents.
Mapped S-NSSAI content: Length of S-NSSAI contents (octet 3) Mapped HPLMN Slice/service type (SST) (octet 4) This field contains the 8 bit SST value of an S-NSSAI in the S-NSSAI(s) of the HPLMN to which the SST value is mapped.
The coding of the SST value part is defined in 3GPP specification document .
NOTE 1: Octet 4 (i.
mapped HPLMN SST) shall always be included.
Mapped HPLMN Slice differentiator (SD) (octet 5 to octet 7) This field contains a 2bit SD value of an S-NSSAI in the S-NSSAI(s) of the HPLMN to which the SD value is mapped.
The coding of the SD value part is defined in 3GPP TS NOTE 2: If the octet 5 is included, then octet 6 and octet 7 shall be included.
1C Mobile station classmark 2 See subclause 1 in 3GPP specification document .
2 NAS key set identifier The NAS key set identifier is allocated by the network.
Table : NAS key set identifier information element Type of security context flag (TSC) (octet 1).
0 native security context (for KSI AMF) 1 mapped security context (for KSI ASME) TSC does not apply for NAS key set identifier value "111".
NAS key set identifier (octet 1).
through possible values for the NAS key set identifier 1 1 1 no key is available (UE to network); reserved (network to UE) 3 NAS message container The NAS message container information element is coded as shown in figure and table NAS message container IEI octet 1 Length of NAS message container contents octet 2 NAS message container contents NAS message container information element Table : NAS message container information element NAS message container contents (octet 4 to octet n); Max value of 65535 octets 4 NAS security algorithms The purpose of the NAS security algorithms information el ement is to indicate the 5G algorithms to be used for ciphering and integrity protection.
NAS security algorithms information element Table : NAS security algorithms information element Type of integrity protection algorithm (octet 2, bit 1 to 3).
All other values are reserved.
Type of ciphering algorithm (octet 2, bit 5 to 7).
All other values are reserved.
See subclause 1a in 3GPP specification document .
6 Network slicing indication The purpose of the Network slicing indication information element is to indicate additional information associated with network slicing in the generic UE configuration update procedure and the registration procedure, other than the user's configured NSSAI, allowed NSSAI, pending NSSAI and rejected NSSAI information.
The Network slicing indication information element is coded as shown in figure and table Network slicing indication IEI 0.
Spare DCNI NSSCI octet 1 0 Network slicing subscription not changed 1 Network slicing subscription changed Default configured NSSAI indication (DCNI) (octet 1, bit 2).
0 Requested NSSAI not created fr om default configured NSSAI 1 Requested NSSAI created from default configured NSSAI In the UE to network direction bit 1 is spare.
The UE shall set this bit to zero.
In the network to UE direction bit 2 is spare.
The network shall set this bit to zero.
Bits 3 and 4 are spare and shall be coded as zero.
6A Non-3GPP NW provided policies See subclause 17 in 3GPP specification document .
The NSSAI information element is coded as shown in figure and table which are associated with different mapped HPLMN SST values and optionally mapped HPLMN SD NSSAI IEI octet 1 Length of NSSAI contents octet 2 S-NSSAI value 1 octet 3 S-NSSAI value 2 octet m+1* NSSAI information element values.
Each S-NSSAI value consists of one S-NSSAI and optionally one mapped S-NSSAI.
If the recipient of this information element is the UE, the UE shall store the complete list received.
If the NSSAI information element conveys an allowed NSSAI and more than more than 16 S-NSSAI values are included in this information element, the UE shall store the first 16 S-NSSAI values and ignore the remaining octets of the information element.
S-NSSAI value is coded as the length and value part of S-NSSAI information element as specified in subclause starting with the second octet.
7A NSSAI inclusion mode The purpose of the NSSAI inclusion mode information element is to indicate the NSSAI inclusion mode in which the inclusion mode octet 1 NSSAI inclusion mode information element Table 7A.
1: NSSAI inclusion mode information element NSSAI inclusion mode (octet 1, bit 1 to bit 2).
0 0 NSSAI inclusion mode A 0 1 NSSAI inclusion mode B 1 0 NSSAI inclusion mode C 1 1 NSSAI inclusion mode D 8 Operator-defined access category definitions The purpose of the Operator-defined access category definiti ons information element is to provide the UE with the operator-defined access category definitions or to delete the operator-defined access category definitions at the UE.
The Operator-defined access category definitions information element is coded as shown in figure , Operator-defined access category definition 1 octet 4* Operator-defined access category definition 2 octet a+1* Operator-defined access category definitions information element Length of operator-defined access category definition contents octet 4 Precedence value octet 5.
Spare Operator-defined access category number octet 6 Length of criteria octet 7.
Spare Standardized access category octet a* Operator-defined access category definition in figure The length of each operator-defined access category definition field is determined by the length of operator-defined access category definition contents field.
Operator-defined access category definition (octet 4 to octet a): Length of operator-defined access category definition contents (octet 4) Length of operator-defined access category definition contents indicates binary coded length of the operator-defined access category definition value field (octet 5 to octet a).
Precedence value (octet 5) 
Operator-defined access category number (bits 5 to 1 of octet 6).
Presence of standardized access category (PSAC) (bit 8 of octet 6) PSAC field indicates whether the standardized access category field is present or absent.
0 Standardized access category field is not included 1 Standardized access category field is included Length of criteria (octet 7) Length of criteria field indicates binary coded length of the criteria field.
Criteria (octets 8 to octet a-1) The criteria field contains one or more cr iteria components fields.
All other values are reserved.
DNN length-value pair count field and one or more DNN length-value pair fields.
The DNN length-value pair count field indicates the number of included DNN indicates the length in octets of the DNN value field.
The DNN value field contains an APN as specified in 3GPP specification document .
Coding of the OS app id value field is outside the scope of the value fields.
The S-NSSAI length-value pair count field indicates the number of NSSAI value field.
The S-NSSAI value field contains one octet SST field optionally Standardized access category (bits 5 to 1 of octet a) Standardized access category field indicates the access category number of the standardized access category that is used in combination with the access identities to determine the establishment cause.
All other values are reserved.
The purpose of the Payload container information element is to transport one or multiple payloads.
If multiple payloads are transported, the associated information of each payl oad are also transported together with the payload.
The Payload container information element is coded as shown in figure , figure , figure , figure and table Payload container IEI octet 1 Length of payload container contents octet 2 Payload container information element octet x2 Payload container entry 2 octet x2+1 Payload container contents with Payload container type "Multiple payloads" Length of Payload container entry octet xi +1 Number of optional IEs Payload container type octet xi +3 Optional IE 1 octet xi +4 octet y2 Optional IE 2 octet y2+1 Payload container entry contents octet z+1 Type of optional IE octet xi +4 Length of optional IE octet xi +5 Value of optional IE octet xi +6 Optional IE same way as the contents of the SOR transparent container IE (see subclause 1) for SOR data type is set to value "0" except that the first three octets are not included.
If the payload container type is set to "SOR transparent container" and is included in the UL NAS TRANSPORT message, the payload container contents are coded the same way as the contents of the SOR transparent container IE (see subclause 1) for SOR data type is set to value "1" except that the first three octets are not included.
If the payload container type is set to "UE parameters update transparent container" and is included in the DL NAS TRANSPORT message, the payload container contents are coded the same way as the contents of the UE parameters update transparent container IE (see subclause 3A) for UE parameters update data type is set to value "0" except that the first three octets are not included.
If the payload container type is set to "UE parameters update transparent container" and is included in the UL NAS TRANSPORT message, the payload container contents are coded the same way as the contents of the UE parameters update transparent container IE (see subclause 3A) for UE parameters update data type is set to value "1" except that the first three octets are not included.
If the payload container type is set to "SMS", the payload container contents contain an SMS message (i.
CP-DATA, CP-ACK or CP-ERROR) as defined in subclause in 3GPP specification document .
If the payload container type is set to "CIoT user data container" and is included in the UL NAS TRANSPORT, DL NAS TRANSPORT or CONTROL PLANE SERVICE REQUEST message, the payload container contents are coded the same way as the contents of the user data container IE (see subclause 4 in 3GPP specification document\) except that the first three octets are not included.
If the payload container type is set to "SMS" and is included in the CONTROL PLANE SERVICE REQUEST message, the payload container contents are coded the same way as the contents of the NAS message container IE (see subclause 2 in 3GPP specification document\) except that the first two octets are not included.
If the payload container type is set to "Location services message container" and is included in the UL NAS TRANSPORT, DL NAS TRANSPORT or CONTROL PLANE SERVICE REQUEST message, the payload container contents include location services message payload.
If the payload container type is set to "LTE Positioning Protocol (LPP) message container" and is included in the UL NAS TRANSPORT or DL NAS TRANSPORT message, the payload container contents include LPP message payload.
The coding of Payload container contents is dependent on the particular application.
If the payload container type is set to "Multiple payloads", the number of entries field represents the total number of payload cont ainer entries, and the payload container Payload container entry For each payload container entry, the payload container type field represents the payload container type value as described in subclause 0, the coding of payload container contents field is dependent on the particular application, and the number of optional IEs field represents the total number of optional IEs associated with the payload container entry contents field in the payload container entry.
The error handlings for optional IEs specified in subclauses , and shall apply to the optional IEs included in the payload container entry.
Length of optional IE (octet xi+5) This field indicates binary coded length of the value of the optional IE entry.
Value of optional IE (octet xi+6 to octet y2) This field contains the value of the optional IE entry with the value part of the referred information element based on following optional IE reference.
If the Request type is included, the value part of the Request type shall be encoded in the bits 1 to 4 and bits 5 to 8 shall be coded as zero.
IEI Optional IE name Optional IE reference 12 PDU session ID PDU session identity 2 (see subclause 1) 24 Additional information Additional information (see subclause\) 58 5GMM cause 5GMM cause (see subclause\) 37 Back-off timer value GPRS timer 3 (see subclause\) 59 Old PDU session ID PDU session identity 2 (see subclause 1) 80 Request type Request type (see subclause 7) 22 S-NSSAI S-NSSAI (see subclause\) 25 DNN DNN (see subclause B) indication Release assistance indication (see A0 MA PDU session information MA PDU session information (see subclause 1A) 0 Payload container type The purpose of the Payload container type information element indicates type of payload included in the payload IEI Payload container type value octet 1 Payload container type information element Table : Payload container type information element Payload container type value (octet 1).
All other values are reserved.
NOTE: The value "Multiple payloads" is only used when the Payload container contents in figure contains multiple payloads as shown in PDU session identity 2 IEI octet 1 PDU session identity 2 value octet 2 PDU session identity 2 information element Table : PDU session identity 2 information element PDU session identity 2 value (octet 2) The coding of the DU session identity 2 value is identical to the coding of the PDU session identity value as defined in 3GPP specification document .
2 PDU session reactivation result user-plane resources of PDU sessions.
length of 34 octets.
PDU session reactivation result IEI octet 1 Length of PDU session reactivation result octet 2.
PDU session reactivation result information element Table : PDU session reactivation result information element PSI(x) shall be coded as follows: Bit 0 of octet 3 is spare and shall be coded as zero.
PSI(1) – PSI(15): 0 indicates establishment of user-plane resources of the PDU session was not requested in the Uplink data status IE or establishment of user-plane resources of the PDU session was not allowed in the Allowed PDU session status IE or establishment of user-plane resource of the PDU session is successful.
1 indicates either establishment of user-plane resources of the PDU session was requested in the Uplink data status IE but establishment of user-plane resource of the PDU session is not successful or indicates establishment of user-plane resources of the PDU session was allowed in the Allowed PDU session status IE but establishment of user-plane resource of the PDU session is either not performed or not successful.
All bits in octet 5 to 34 are spare and shall be coded as zero, if the respective octet is included in the information The PDU session reactivation result error cause information element is coded as shown in figure and maximum length of 515 octets.
PDU session reactivation result error cause IEI octet 1 Length of PDU session reactivation result error cause octet 2 PDU session ID octet 4 cause value octet 5 PDU session ID octet 514* cause value octet 515* PDU session reactivation result error cause information element Table : PDU session reactivation result error cause information element PDU session ID is coded same as PDU session ID IE (see subclause\).
The cause value is coded same as second octet of 5GMM cause information element (see subclause\).
4 PDU session status The purpose of the PDU session status information element is to indicate the state of each PDU session that can be The PDU session status information element is coded as shown in figure and table maximum length of 34 octets.
PDU session status IEI octet 1 Length of PDU session status contents octet 2 PDU session status information element PSI(0): Bit 1 of octet 3 is spare and shall be coded as zero.
0 indicates that the 5GSM state of the corr esponding PDU session is PDU SESSION INACTIVE.
1 indicates that the 5GSM state of the corresponding PDU session is not PDU SESSION INACTIVE All bits in octet 5 to 34 are spare and shall be coded as zero, if the respective octet is included in the information See subclause 13 in 3GPP specification document .
The Rejected NSSAI information element is coded as shown in figure , figure and NOTE: The number of rejected S-NSSAI(s) cannot exceed eight.
Rejected NSSAI IEI octet 1 Length of Rejected NSSAI contents octet 2 Rejected S-NSSAI 1 octet 3 Rejected S-NSSAI 2 octet m+1* Rejected NSSAI information element Length of rejected S-NSSAI Cause value octet 1 Rejected S-NSSAI The value part of the Rejected NSSAI information element consists of one or more rejected S-NSSAIs.
Each rejected S-NSSAI consists of one S-NSSAI and an associated cause value.
The length of each rejected S-NSSAI can be determined by the 'length of rejected S-NSSAI' field in the first octet of the rejected S-NSSAI.
The UE shall store the complete list received.
If more than 8 rejected S-NSSAIs are included in this information element, the UE shall store the first 8 rejected S-NSSAIs and ignore the remaining octets of the information element.
Cause value (octet 1) 
specific authentication and authorization.
All other values are reserved.
Slice/service type (SST) (octet 2) This field contains the 8 bit SST value.
The coding of the SST value part is defined in 3GPP specification document .
(NOTE 2) Slice differentiator (SD) (octet 3 to octet 5) This field contains the 24 bit SD value.
The coding of the SD value part is defined in 3GPP specification document .
(NOTE 3) NOTE 1: If octet 3 is included, then octet 4 and octet 5 shall be included.
NOTE 2: If the Cause value is “S-NSSAI not available due to the failed or revoked network slice-specific authentication and authorization”, this field shall contain the 8 bit SST value of an S-NSSAI in the S-NSSAI(s) of the HPLMN.
NOTE 3: If the Cause value is “S-NSSAI not available due to the failed or revoked network slice-specific authentication and authorization”, this field shall contain the 24 bit SD value of an S-NSSAI in the S-NSSAI(s) of the HPLMN.
6A Release assistance indication See subclause 5 in 3GPP specification document .
The purpose of the Request type information element is to indicate the type of the 5GSM message.
Request type IEI 0 spare Request type value octet 1 Request type information element 0 0 1 initial request 0 1 0 existing PDU session 0 1 1 initial emergency request 1 0 0 existing emergency PDU session 1 0 1 modification request 1 1 0 MA PDU request (NOTE) All other values are unused and shall be interpreted as "initial request", if received by the network.
not supporting MA PDU sessions.
8 S1 UE network capability See subclause 4 in 3GPP specification document .
8A S1 UE security capability See subclause 6 in 3GPP specification document .
9 Service area list The coding of the information element allows combining different types of lists.
The lists of type "00" and "01" allow a TAIs of the PLMNs in the registration area are allowed area.
The Service area list information element is coded as shown in figure , figure , figure , figure , figure and table Service area list IEI octet 1 Length of service area list contents octet 2 Partial service area list 1 octet 3 Partial service area list 2 octet i+1* octet l* … octet l+1* octet m* Service area list information element TAC 1 octet 5 TAC 1 (continued) octet 6 Partial service area list – type of list = "00".
type Type of list Number of elements octet 1 MCC digit 1 octet 2 TAC 1 octet 5 TAC 1 (continued) octet 6 Partial service area list – type of list = "01" MNC digit 1 octet 4 TAC 1 octet 5 MCC digit 1 octet 8* MCC digit 3 octet 9* TAC 2 (continued) octet 12* TAC 2 (continued) octet 13* MCC digit 1 octet 6k-4* MCC digit 3 octet 6k-3* TAC k (continued) octet 6k* Partial service area list – type of list = "10".
type Type of list Number of elements octet 1 MCC digit 3 octet 3 MNC digit 1 octet 4 Partial service area list – type of list = "11" from the 'type of list' field and the 'number of elements' field in the first octet of the partial service area list.
The "Allowed type" fields in all the partial service area lists shall have the same value.
For allowed type "0", TAIs contained in all partial service area lists are in the allowed area.
For allowed type "1", TAIs contained in all partial service area lists are in the non- allowed area.
The UE shall store the complete list received.
If more than 16 TAIs are included in this information element, the UE shall store the first 16 TAIs and ignore the remaining octets of the information element.
Partial service area list: Allowed type (octet 1).
0 TAIs in the list are in the allowed area 1 TAIs in the list are in the non-allowed area Type of list (octet 1).
0 0 list of TACs belonging to one PLMN, with non-consecutive TAC values 0 1 list of TACs belonging to one PLMN, with consecutive TAC values 1 0 list of TAIs belonging to different PLMNs (see NOTE) 1 1 All TAIs belonging to the PLMNs in the registration area are in the allowed area Number of elements (octet 1).
All other values are unused and shall be interpreted as 16, if received by the UE.
For type of list = "00" and number of elements = k: octets 2 to 4 contain the MCC+MNC, and for j = 1, …, k: octets 3j+2 to 3j+4 contain the TAC of the j-th TAI belonging to the partial list, For type of list = "01" and number of elements = k: octets 2 to 4 contain the MCC+MNC, and octets 5 to 7 contain the TAC of the first TAI belonging to the partial list.
The TAC values of the other k-1 TAIs are TAC+1, TAC+2, …, TAC+k- For type of list = "10" and number of elements = k: for j = 1, …, k.
octets 6j-4 to 6j-1 contain the MCC+MNC, and octets 6j-1 to 6j+1 contain the TAC of the j-th TAI belonging to the partial list.
For type of list = "11": Allowed type shall be coded as "0" and number of elements shall be ignored, and octets 2 to 4 containing the MCC+MNC can be ignored.
If allowed type is coded as "1", it shall be interpreted as "0".
The coding of this field is the responsibility of each administration but BCD coding shall TAC, Tracking area code In the TAC field bit 8 of the first octet is the most significant bit and bit 1 of the third octet the least significant bit.
The coding of the tracking area code is the responsibility of each administration.
Coding using full hexadecimal representation may be used.
The tracking area code consists of 3 octets.
NOTE: If the "list of TAIs belonging to different PLMNs" is used, the PLMNs included in the list need to be present in the list of equivalent PLMNs.
This type is not applicable in an SNPN.
The purpose of the service type information element is to specify the pu rpose of the service request procedure.
The service type information element is coded as shown in figure and table IEI Service type value octet 1 Service type information element Table : Service type information element Service type value (octet 1).
All other values are reserved.
The purpose of the SMS indication information element is to indicate that the ability for the UE to use SMS over NAS Table 0A.
1: SMS indication SMS availability indication (SAI) (octet 1).
0 SMS over NAS not available 1 SMS over NAS available Bits 2, 3 and 4 are spare and shall be coded as zero, 1 SOR transparent container The purpose of the SOR transparent container information element in the REGISTRATION ACCEPT message is to provide the list of preferred PLMN/access technology combinations (or HPLMN indication that 'no change of the "Operator Controlled PLMN Selector with Access Technology" list stored in the UE is needed and thus no list of preferred PLMN/access technology combin ations is provided') (see 3GPP specification document annex C) and optional acknowledgement request.
The purpose of the SOR transp arent container information element in the REGISTRATION COMPLETE message is to indicate the UE acknowledgement of successful reception of the SOR transparent container IE in the REGISTRATION ACCEPT message.
element in the Payload container IE of the DL NAS TRANSPORT message are used to provide the list of preferred PLMN/access technology combinations and optional acknowledgement request, and the NAS TRANSPORT message are used to indicate the UE acknowledgement of successful reception of the SOR transparent container IE in the DL NAS TRANSPORT message.
The SOR transparent container information element is coded as shown in figure , figure , figure , figure , figure , figure and table SOR transparent container IEI octet 1 Length of SOR transparent container contents octet 2 SOR header octet 4 SOR-MAC-I AUSF octet 0 Counter SOR octet 22 Secured packet octet 23* - SOR transparent container information element for list type with value "0" and SOR data type with value "0" SOR transparent container IEI octet 1 Length of SOR transparent container contents octet 2 SOR header octet 4 SOR-MAC-I AUSF octet 0 Counter SOR octet 22 PLMN ID and access technology list octet 23*- SOR transparent container information element for list type with value "1" and SOR data type with value "0" PLMN ID and access technology list SOR transparent container IEI octet 1 Length of SOR transparent container contents octet 2 SOR header octet 4 SOR-MAC-I UE octet 5 - 20 SOR transparent container information element for SOR data type with value "1".
SOR header for SOR data type with value "0".
SOR header for SOR data type with value "1" Table : SOR transparent container information element SOR-MAC-I AUSF, SOR-MAC-I UE and Counter SOR are coded as specified in SOR data type (octet 4, bit 1) 0 The SOR transparent container carries steering of roaming information.
1 The SOR transparent container carries acknowledgement of successful reception of the steering of roaming information.
List indication value (octet 4, bit 2) 0 HPLMN indication that 'no change of the "Operator Controlled PLMN Selector with Access Technology" list stored in the UE is needed and thus no list of preferred PLMN/access technology combinations is provided' 1 list of preferred PLMN/access technology combinations is provided List type (octet 4, bit 3) 1 The list type is a "PLMN ID and access technology list".
Acknowledgement (ACK) value (octet 4, bit 4) 0 acknowledgement not requested The secure packet is coded as specified in 3GPP specification document [22B].
See subclause 1 in 3GPP specification document .
3 Time zone and time See subclause 1 in 3GPP specification document .
3A UE parameters update transparent container The purpose of the UE parameters update transparent container when sent from the network to the UE is to provide UE parameters update data, optional acknowledgement request and optional re-registration request.
The purpose of the UE of successful reception of the UE parameters update transparent container.
The UE parameters update transparent container information element is coded as shown in figure 3A.
7 and table UE parameters update transparent container IEI octet 1 Length of UE parameters update tran sparent container contents octet 2 UE parameters update header octet 4 UPU-MAC-I AUSF octet 0 Counter UPU octet 22 UE parameters update list octet 23* - UE parameters update transparent container information element for UE parameters update data type with value "0".
Spare UE parameters update data set 1 Length of UE parameters update data set 1 octet 24*- UE parameters update data set 1 octet 26*-.
Spare UE parameters update data set n UE parameters update list Secured packet octet a* - UE parameters update data set for UE parameters update data set type with value "00000001" UE parameters update data set for UE parameters update data set type with UE parameters update transparent container IEI octet 1 Length of UE parameters update tran sparent container contents octet 2 UE parameters update header octet 4 UPU-MAC-I UE octet 5 - 20 UE parameters update transparent container information element for UE parameters update data type with value "1".
Spare REG ACK UPU UE parameters update header for UE parameters update data type with value "0".
UE parameters update header for UE parameters update data type with value "1" Table 3A.
1: UE parameters update transparent container information element UPU-MAC-I AUSF, UPU-MAC-I UE and Counter UPU are coded as specified in UPU data type (octet 4, bit 1) Acknowledgement (ACK) value (octet 4, bit 2) 0 acknowledgement not requested Re-registration (REG) value (octet 4, bit 3) 0 re-registrationt not requested UE parameters update data set type.
All other values are reserved The secured packet is coded as specified in 3GPP specification document [22B].
The default configured NSSAI is encoded as the value part of the NSSAI IE (see 4 UE security capability The UE security capability information element is used by the UE and by the network to indicate which security algorithms are supported by the UE in N1 mode for NAS security as well as which security algorithms are supported over NR and E-UTRA connected to 5GCN for AS security.
Octets 5 to 10 are optional.
If octet 5 is included, then also octet 6 shall be included.
If the UE does not support any security algorithm for AS security over E-UTRA connected to 5GCN, it shall not include octets 5 and The UE shall not include octets 7 to 1 If the UE does not support any security algorithm for AS security over E-UTRA connected to 5GCN, and if the network includes octets 7 to 10, then the network shall also include octets 5 to If the network includes octet 7, then it shall include also octet If the network includes octet 9, then it shall include UE security capability IEI octet 1 Length of UE security capability contents octet 2.
Spare octet 7* -10* UE security capability information element 5GS encryption algorithm 12G-EA1 supported (octet 3, bit 7) 0 5GS encryption algorithm 12G-EA1 not supported 1 5GS encryption algorithm 12G-EA1 supported 5GS encryption algorithm 12G-EA2 supported (octet 3, bit 6) 0 5GS encryption algorithm 12G-EA2 not supported 1 5GS encryption algorithm 12G-EA2 supported 5GS encryption algorithm 12G-EA3 supported (octet 3, bit 5) 0 5GS encryption algorithm 12G-EA3 not supported 1 5GS encryption algorithm 12G-EA3 supported 5GS encryption algorithm 5G-EA4 supported (octet 3, bit 4) 0 5GS encryption algorithm 5G-EA4 not supported 1 5GS encryption algorithm 5G-EA4 supported 5GS encryption algorithm 5G-EA5 supported (octet 3, bit 3) 0 5GS encryption algorithm 5G-EA5 not supported 1 5GS encryption algorithm 5G-EA5 supported 5GS encryption algorithm 5G-EA6 supported (octet 3, bit 2) 0 5GS encryption algorithm 5G-EA6 not supported 1 5GS encryption algorithm 5G-EA6 supported 5GS encryption algorithm 5G-EA7 supported (octet 3, bit 1) 0 5GS encryption algorithm 5G-EA7 not supported 1 5GS encryption algorithm 5G-EA7 supported 5GS integrity algorithms supported (see NOTE 2) (octet 4) 5GS integrity algorithm 5G-IA0 supported (octet 4, bit 8) 0 5GS integrity algorithm 5G-IA0 not supported 1 5GS integrity algorithm 5G-IA0 supported 5GS integrity algorithm 12G-IA1 supported (octet 4, bit 7) 0 5GS integrity algorithm 12G-IA1 not supported 1 5GS integrity algorithm 12G-IA1 supported 5GS integrity algorithm 12G-IA2 supported (octet 4, bit 6) 0 5GS integrity algorithm 12G-IA2 not supported 1 5GS integrity algorithm 12G-IA2 supported 5GS integrity algorithm 12G-IA3 supported (octet 4, bit 5) 0 5GS integrity algorithm 12G-IA3 not supported 1 5GS integrity algorithm 12G-IA3 supported 5GS integrity algorithm 5G-IA4 supported (octet 4, bit 4) 0 5GS integrity algorithm 5G-IA4 not supported 1 5GS integrity algorithm 5G-IA4 supported 5GS integrity algorithm 5G-IA5 supported (octet 4, bit 3) 0 5GS integrity algorithm 5G-IA5 not supported 1 5GS integrity algorithm 5G-IA5 supported 5GS integrity algorithm 5G-IA6supported (octet 4, bit 2) 0 5GS integrity algorithm 5G-IA6 not supported 1 5GS integrity algorithm 5G-IA6 supported 5GS integrity algorithm 5G-IA7 supported (octet 4, bit 1) 0 5GS integrity algorithm 5G-IA7 not supported 1 5GS integrity algorithm 5G-IA7 supported EPS encryption algorithm 12EEA1 supported (octet 5, bit 7) 0 EPS encryption algorithm 12EEA1 not supported 1 EPS encryption algorithm 12EEA1 supported EPS encryption algorithm 12EEA2 supported (octet 5, bit 6) 0 EPS encryption algorithm 12EEA2 not supported 1 EPS encryption algorithm 12EEA2 supported EPS encryption algorithm 12EEA3 supported (octet 5, bit 5) 0 EPS encryption algorithm 12EEA3 not supported 1 EPS encryption algorithm 12EEA3 supported EPS encryption algorithm EEA4 supported (octet 5, bit 4) 0 EPS encryption algorithm EEA4 not supported 1 EPS encryption algorithm EEA4 supported EPS encryption algorithm EEA5 supported (octet 5, bit 3) 0 EPS encryption algorithm EEA5 not supported 1 EPS encryption algorithm EEA5 supported EPS encryption algorithm EEA6 supported (octet 5, bit 2) 0 EPS encryption algorithm EEA6 not supported 1 EPS encryption algorithm EEA6 supported EPS encryption algorithm EEA7 supported (octet 5, bit 1) 0 EPS encryption algorithm EEA7 not supported 1 EPS encryption algorithm EEA7 supported EPS integrity algorithms supported (see NOTE 4) (octet 6) EPS integrity algorithm EIA0 supported (octet 6, bit 8) 0 EPS integrity algorithm EIA0 not supported 1 EPS integrity algorithm EIA0 supported EPS integrity algorithm 12EIA1 supported (octet 6, bit 7) 0 EPS integrity algorithm 12EIA1 not supported 1 EPS integrity algorithm 12EIA1 supported EPS integrity algorithm 12EIA2 supported (octet 6, bit 6) 0 EPS integrity algorithm 12EIA2 not supported 1 EPS integrity algorithm 12EIA2 supported EPS integrity algorithm 12EIA3 supported (octet 6, bit 5) 0 EPS integrity algorithm 12EIA3 not supported 1 EPS integrity algorithm 12EIA3 supported EPS integrity algorithm EIA4 supported (octet 6, bit 4) 0 EPS integrity algorithm EIA4 not supported 1 EPS integrity algorithm EIA4 supported EPS integrity algorithm EIA5 supported (octet 6, bit 3) 0 EPS integrity algorithm EIA5 not supported 1 EPS integrity algorithm EIA5 supported EPS integrity algorithm EIA6 supported (octet 6, bit 2) 0 EPS integrity algorithm EIA6 not supported 1 EPS integrity algorithm EIA6 supported EPS integrity algorithm EIA7 supported (octet 6, bit 1) 0 EPS integrity algorithm EIA7 not supported 1 EPS integrity algorithm EIA7 supported respective octet is received with the information element.
If the AMF receives any of the octets 7 to 10 (NOTE 5), it shall store the octets as received and include them when sending the UE security capability information element to the UE.
NOTE 1: The code points in octet 3 are used to indicate support for 5GS encryption algorithms for NAS security in N1 mode and support for 5GS encryption algorithms for AS security over NR.
NOTE 2: The code points in octet 4 are used to indicate support for 5GS integrity algorithms for NAS security in N1 mode and support for 5GS integrity algorithms for AS security over NR.
NOTE 3: The code points in octet 5 are used to indicate support for EPS encryption algorithms for AS security over E-UTRA connected to 5GCN.
NOTE 4: The code points in octet 6 are used to indicate support for EPS integrity algorithms for AS security over E-UTRA connected to 5GCN.
NOTE 5: The AMF can receive this information element also from another AMF or MME during N1 mode to N1 mode or S1 mode to N1 mode handover preparation.
5 UE's usage setting The purpose of the UE's usage setting information element is to provide the network with the UE's usage setting as defined in 3GPP specification document .
The network uses the UE's usage setting to select the RFSP index.
UE's usage setting IEI octet 1 Length of UE's usage setting contents octet 2.
UE's usage setting information element Table : UE's usage setting information element UE's usage setting (octet 3, bit 1) All other bits in the octet 3 are spare and shall be coded as zero, The purpose of the UE status information element is to pr ovide the network with information concerning aspects of the current UE registration status which is used for interworking with EPS.
The UE status information element is coded as shown in figure and table UE status IEI octet 1 Length of UE status contents octet 2.
UE status information element 5GMM registration status (N1 mode reg) (octet 3, bit 2) 0 UE is not in 5GMM-REGISTERED state 1 UE is in 5GMM-REGISTERED state All other bits in the octet 3 are spare and shall be coded as zero.
7 Uplink data status The purpose of the Uplink data status information element is to indicate to the network which preserved PDU sessions have uplink data pending.
maximum length of 34 octets.
Uplink data status IEI octet 1 Length of uplink data status contents octet 2 spare octet 5* -34* Uplink data status information element Table : Uplink data status information element PSI(x) shall be coded as follows: Bit 1 of octet 3 is spare and shall be coded as zero.
PSI(1) – PSI(15): 0 indicates that no uplink data are pending for the corresponding PDU session identity or the PDU session is in PDU SESSION INACTIVE state or is in PDU SESSION ACTIVE state with user-plane resources already established.
1 indicates that uplink data are pending for the corresponding PDU session identity and the user-plane resources for the corresponding PDU session are not established.
All bits in octet 5 to 34 are spare and shall be coded as zero, if the respective octet is included in the information element.
9 Void 0 Void 1 Void 2 Void 3 Void 4 Void 5 Void 6 Void 7 Void 8 UE radio capability ID UE radio capability ID IEI octet 1 Length of UE radio capability ID contents octet 2 UE radio capability ID octet 3 UE radio capability ID information element Table : UE radio capability ID information element UE radio capability ID (octets 3 to n) The UE radio capability ID contents contain the UE radio capability ID as specified in 3GPP specification document , with each hexadecimal digit coded over 4 bits, starting with the first hexadecimal digit coded in bits 4 to 1 of octet 3, the second hexadecimal digit coded in bits 8 to 5 of octet 3, and so on.
If the UE radio capability ID contains an odd number of hexadecimal digits, bits 8 to 5 of the last octet (octet n) shall be coded as "1111".
9 UE radio capability ID deletion indication The purpose of the UE radio capability ID deletion indication information element is to indicate to the UE that deletion of UE radio capability IDs is requested.
UE radio capability ID deletion spare Deletion request octet 1 UE radio capability ID deletion indication information element Table : UE radio capability ID deletion indication information element Deletion requested (octet 1).
0 0 0 UE radio capability ID deletion not requested 0 0 1 Network-assigned UE radio capability IDs deletion requested All other values are unused and shall be interpreted as "UE radio capability ID deletion not requested", if received by the UE.
0 Truncated 5G-S-TMSI configuration The purpose of the Truncated 5G-S-TMSI configuration information element is to provide the size of the components of the truncated 5G-S-TMSI to the UE in NB-N 1 mode to create the truncated 5G-S-TMSI.
The Truncated 5G-S-TMSI configuration information element is coded as shown in figure and table Truncated 5G-S-TMSI configuration IEI octet 1 Length of Truncated 5G-S-TMSI configuration contents octet 2 Truncated AMF Set ID value Truncated AMF Pointer value octet 3 Truncated 5G-S-TMSI configuration information element This field represents the size of the least significant bits of the AMF Pointer.
All other values shall be interpreted as "6 least significant bits of the AMF Pointer" by this version of the protocol.
Truncated AMF Set ID value (bits 8 to 5 of octet 3) This field represents the size of the least significant bits of the AMF Set ID.
All other values shall be interpreted as "10 least significant bits of the AMF Set ID" by this version of the protocol.
NOTE: Total sum of the "Truncated AMF Set ID value" and the "Truncated AMF Pointer value" in the Truncated 5G-S-TMSI configuration IE is specified in 3GPP specification document and 3GPP specification document [25B].
1 WUS assistance information See subclause 2 in 3GPP specification document .
The purpose of the N5GC indication information element is to indicate to the network that the registration request by the W-AGF is on behalf of an N5GC device.
N5GC indication IEI octet 1 N5GC indication NB-N1 mode and for the network to indicate the DRX cycle value to be used at paging in NB-N1 mode.
NB-N1 mode DRX parameters IEI octet 1 Length of NB-N1 mode DRX parameters contents octet 2 NB-N1 mode DRX parameters information element Table : NB-N1 mode DRX parameters information element NB-N1 mode DRX value (octet 3, bits 1 to 4) This field represents the DRX cycle parameter 'T', for NB-N1 mode, as defined in 3GPP specification document .
All other values shall be interpreted as "DRX value not specified" by this version of the Bits 5 to 8 of octet 3 are spare and shall be coded as zero.
4 Additional configuration indication The purpose of the Additional configuration indication information element is to indicate additional information associated with the generic UE configuration update procedure.
The Additional configuration indication information element is coded as shown in figure and.
Spare SCMR octet 1 0 no additional information 1 release of N1 NAS signalling connection not required Bits 2 to 4 are spare and shall be coded as zero, 5GS session management (5GSM) information elements The purpose of the 5GSM capability information element is to indicate UE capability related to the PDU session 5GSM capability IEI octet 1 Length of 5GSM capability contents octet 2 octet 4* -15* Spare 5GSM capability information element 0 Reflective QoS not supported 1 Reflective QoS supported Multi-homed IPv6 PDU session (MHPDU) (octet 3, bit 2) This bit indicates the 5GSM capability for Multi-homed IPv6 PDU session.
0 Multi-homed IPv6 PDU session not supported 1 Multi-homed IPv6 PDU session supported Ethernet PDN type in S1 mode (EPT-S1) (octet 3, bit 3) This bit indicates UE's 5GSM capability for Ethernet PDN type in S1 mode.
0 Ethernet PDN type in S1 mode not supported 1 Ethernet PDN type in S1 mode supported Supported ATSSS steering functionalities and steering modes (ATSSS-ST) (octet 3, bits 4 to 7) These bits indicate the 5GSM capability of ATSSS steering functionalities and steering with only active-standby steering mode supported with any steering mode supported All other values are reserved.
Transfer of port management information containers (TPMIC) (octet 3, bit 8) This bit indicates the 5GSM capability to support transfer of port management information containers 0 Transfer of port management information containers not supported 1 Transfer of port management information containers supported All other bits in octet 4 to 15 are spare and shall be coded as zero, if the respective octet is included in the information element.
The purpose of the 5GSM cause information element is to indicate the reason why a 5GSM request is rejected.
The 5GSM cause information element is coded as shown in figure and table 5GSM cause IEI octet 1 Cause value octet 2 5GSM cause information element integrity protection is too low Any other value received by the UE shall be treated as 0001 1111, " Request rejected, unspecified ".
Any other value received by the network shall be treated as 0110 1111, "protocol error, unspecified".
Always-on PDU session indication established as an always-on PDU session.
Table : Always-on PDU session indication Always-on PDU session indication (APSI) (octet 1).
0 Always-on PDU session not allowed 1 Always-on PDU session required Bits 2, 3 and 4 are spare and shall be coded as zero, Always-on PDU session requested requested to be established as an always-on PDU session.
Spare APSR octet 1 Always-on PDU session requested Table : Always-on PDU session requested Always-on PDU session requested (APSR) (octet 1).
0 Always-on PDU session not requested 1 Always-on PDU session requested Bits 2, 3 and 4 are spare and shall be coded as zero, The purpose of the Allowed SSC mode information element is to indicate the SSC modes allowed to be used by the UE for the PDU session.
Allowed SSC mode IEI 0 Spare SSC3 SSC2 SSC1 octet 1 Allowed SSC mode information element 0 SSC mode 1 not allowed 1 SSC mode 1 allowed SSC2 (octet 1, bit 2).
0 SSC mode 2 not allowed 1 SSC mode 2 allowed SSC3 (octet 1, bit 3).
0 SSC mode 3 not allowed 1 SSC mode 3 allowed Bit 4 is spare and shall be encoded as zero.
Extended protocol configuration options See subclause 1A in 3GPP specification document .
Integrity protection maximum data rate The purpose of the integrity protection maximum data rate information element is for the UE to indicate to the network the maximum data rate per UE for user-plane integrity protection for uplink and the maximum data rate per UE for user-plane integrity protection for downlink that are supported by the UE.
The integrity protection maximum data rate is coded as shown in figure and table Integrity protection maximum data rate IEI octet 1 Maximum data rate per UE for user-plane integrity protection for Maximum data rate per UE for user-plane integrity protection for Integrity protection maximum data rate information element Table : Integrity protection maximum data rate information element Maximum data rate per UE for user-plane integrity protection for uplink (octet 2).
All other values are spare.
If received they shall be interpreted as "64 kbps".
Maximum data rate per UE for user-plane integrity protection for downlink (octet 3).
All other values are spare.
If received they shall be interpreted as "64 kbps".
NOTE: This value shall be used when N3 data transfer is not supported by the UE.
PDU session, as described in subclause The mapped EPS bearer contexts information element is coded as shown in figure , figure , Mapped EPS bearer contexts IEI octet 1 Length of Mapped EPS bearer contexts contents octet 2 Mapped EPS bearer context 1 Mapped EPS bearer context 2 Mapped EPS bearer context n Mapped EPS bearer contexts EPS bearer identity octet 4 Length of Mapped EPS bearer context octet 5.
EPS parameters list octet 8* Mapped EPS bearer context EPS parameter identifier 1 octet 8 Length of EPS parameter contents 1 octet 9 EPS parameter contents 1 octet 10 EPS parameter identifier 2 octet h+1 Length of EPS parameter contents 2 octet h+2 EPS parameter contents 2 octet h+3 EPS parameters list Operation code (bits 8 to 7 of octet 7) Bits 0 0 Reserved 0 1 Create new EPS bearer 1 0 Delete existing EPS bearer 1 1 Modify existing EPS bearer Bit 6 of octet 7 is spare and shall be coded as zero.
E bit (bit 5 of octet 7) 0 parameters list is not included (NOTE) 0 extension of previously provided parameters list 1 replacement of all previously provided parameters list of parameters field has non-zero value.
For the "create new EPS bearer" operation and "delete existing EPS bearer" operation, bit 5 of octet 7 is ignored.
Number of EPS parameters (bits 4 to 1 of octet 7) The number of EPS parameters contains the binary coding for the number of EPS parameters in the EPS parameters list field.
The number of EPS parameters field is encoded in bits 4 through 1 of octet 7 where bit 4 is the most significant and bit 1 is the least significant bit.
Each EPS parameter included in the EPS parameters list is of variable length and consists of: - an EPS parameter identifier (1 octet); the length of the EPS parameter contents (1 octet); and the EPS parameter contents itself (variable amount of octets).
The EPS parameter identifier field is used to identify each EPS parameter included in the EPS parameters list and it contains the hexadecimal coding of the EPS parameter identifier.
Bit 8 of the EPS parameter identifier field contains the most significant bit and bit 1 contains the least significant bit.
In this version of the protocol, the following EPS parameter identifiers are specified: 01H (Mapped EPS QoS parameters); 02H (Mapped extended EPS QoS parameters); and - 03H (Traffic flow template).
- 05H (extended APN-AMBR).
If the EPS parameters list contains an EPS parameter identifier that is not supported by the receiving entity the corresponding EPS parameter shall be discarded.
and parameter contents field are coded as specified in subclause of 3GPP specification document .
When the parameter identifier indicates mapped extended EPS QoS parameters, the length and parameter contents field are coded as specified in subclause 0 of 3GPP specification document .
When the parameter identifier indicates traffic flow template, the length and parameter contents field are coded from octet 2 as shown figure 144 and table 162 of 3GPP specification document .
When the parameter identifier indicates APN-AMBR, the length and parameter contents field are coded as specified in subclause of 3GPP specification document .
When the parameter identifier indicates Extended APN-AMBR, the length and parameter contents field are coded as specified in subclause 9 of 3GPP specification document .
NOTE: This value shall not be used In this version of the specification.
Maximum number of supported packet filters The purpose of the Maximum number of supported packet filters information element is for the UE to indicate to the The Maximum number of supported packet filters is coded as shown in figure and table Maximum number of supported packet filters IEI octet 1 Maximum number of supported packet filters octet 2.
Maximum number of supported packet filters in formation element Table : Maximum number of suppor ted packet filters information element Maximum number of supported packet filters (octet 2 to 3) In the Maximum number of supported packet filters field bit 8 of the first octet is the most significant bit and bit 6 of second octet is the least significant bit.
Bit 5 to bit 1 of the second octet are spare bits and shall be coded as zero.
The number of supported packet filters shall be in the range of 17 to 102 The purpose of the PDU address information element is to assign to the UE: an interface identifier for the IPv6 link local address associated with the PDU session; or - an IPv4 address and an interface identifier for the IPv6 link local address, associated with the PDU session.
The PDU address information element is coded as shown in figure and table PDU address information element Table : PDU address information element PDU session type value (octet 3).
All other values are reserved.
Bit 4 to 8 of octet 3 are spare and shall be coded as zero.
PDU address information (octet 4 to 15) If the PDU session type value indicates IPv4, the PDU address information in octet 4 to octet 7 contains an IPv4 address.
If the PDU session type value indicates IPv6, the PDU address information in octet 4 to octet 11 contains an interface identifier for the IPv6 link local address.
If the PDU session type value indicates IPv4v6, the PDU address information in octet 4 to octet 11 contains an interface identifier for the IPv6 link local address and in octet 12 to octet 15 contains an IPv4 address.
1 PDU session type The purpose of the PDU session type information element is to indicate type of the PDU session.
PDU session type IEI 0 Spare PDU session type value octet 1 PDU session type information element Table : PDU session type information element PDU session type value (octet 1, bit 1 to bit 3).
1 0 0 Unstructured 
All other values are unused and shall be interpreted as "IPv4v6", if received by the UE maximum length for the information element is 65538 octets.
The QoS flow descriptions information element is coded as shown in figure , figure , figure , figure , and table QoS flow descriptions IEI octet 1 Length of QoS flow descriptions contents octet 2 QoS flow description 1 octet 4 QoS flow description 2 octet u+1 QoS flow descriptions information element.
Spare QFI octet 4 
Parameters list octet 7* octet u* Parameter 1 octet 7 octet m Parameter 2 octet m+1 octet n Parameter identifier octet 7 Length of parameter contents octet 8 Parameter contents octet 9 The network shall not set the QFI value to Operation code (bits 8 to 6 of octet 5) Bits 8 7 6 0 0 1 Create new QoS flow description 0 1 0 Delete existing QoS flow description 0 1 1 Modify existing QoS flow description All other values are reserved.
7 0 parameters list is not included 1 reserved Bit 7 0 extension of previously provided parameters 1 replacement of all previously provided parameters parameters" or "replacement of all previo usly provided parameters", the number of exists in the previously provided parameters, the parameter shall be set to the new value.
Number of parameters (bits 6 to 1 of octet 6) The number of parameters field contains the binary coding for the number of parameters in the parameters list field.
T he number of parameters field is encoded in bits 6 through 1 of octet 6 where bit 6 is the most significant and bit 1 is the least significant bit.
Each parameter included in the parameters list is of variable length and consists of: a parameter identifier (1 octet); - the length of the parameter contents (1 octet); and - the parameter contents itself (variable amount of octets).
The parameter identifier field is used to identify each parameter included in the parameters list and it contains the hexadecimal coding of the parameter identifier.
Bit 8 of the parameter identifier field contains the most significant bit and bit 1 contains the least significant bit.
In this version of the protocol, the following parameter identifiers are specified: - 01H (5QI); - 02H (GFBR uplink); - 03H (GFBR downlink); 05H (MFBR downlink); - 06H (Averaging window); and - 07H (EPS bearer identity).
receiving entity the corresponding parameter shall be discarded.
The length of parameter contents field contains the binary coded representation of the length of the parameter contents field.
The first bit in transmission order is the most significant bit.
When the parameter identifier indicates 5QI, the parameter contents field contains the binary representation of 5G QoS identifier (5QI) that is one octet in length.
The network shall consider all other values not explicitly defined in this version of the protocol as unsupported.
The UE shall use this chosen 5QI value for internal operations only.
The UE shall use the received 5QI value in subsequent NAS signalling procedures.
When the parameter identifier indicates "GFBR uplink", the parameter contents field contains one octet indicating the unit of the guaranteed flow bit rate for uplink followed by two octets containing the value of the guaranteed flow bit rate for uplink.
Unit of the guaranteed flow bit rate for uplink (octet 1).
Other values shall be interpreted as multiples of 256 Pbps in this version of the protocol.
Value of the guaranteed flow bit rate for uplink (octets 2 and 3) Octets 2 and 3 represent the binary coded value of the guaranteed flow bit rate for uplink in units defined by the unit of the guaranteed flow bit rate for uplink.
When the parameter identifier indicates "GFBR downlink", the parameter contents field contains one octet indicating the unit of the guaranteed flow bit rate for downlink followed by two octets containing the value of the guaranteed flow bit rate for downlink.
Unit of the guaranteed flow bit rate for downlink (octet 1) The coding is identical to that of the unit of the guaranteed flow bit rate for uplink.
Value of the guaranteed flow bit rate for downlink (octets 2 and 3) Octets 2 and 3 represent the binary coded value of the guaranteed flow bit rate for downlink in units defined by the unit of the guaranteed flow bit rate for downlink.
When the parameter identifier indicates "MFBR uplink", the parameter contents field contains the one octet indicating the unit of the maximum flow bit rate for uplink followed by two octets containing the value of maximum flow bit rate for uplink.
Unit of the maximum flow bit rate for uplink (octet 1) The coding is identical to that of the unit of the guaranteed flow bit rate for uplink.
Value of the maximum flow bit rate for uplink (octets 2 and 3) Octets 2 and 3 represent the binary coded value of the maximum flow bit rate for uplink in units defined by the unit of the maximum flow bit rate for uplink.
When the parameter identifier indicates "MFBR downlink", the parameter contents field contains one octet indicating the unit of the maximum flow bit rate for downlink followed by two octets containing the value of the maximum flow bit rate for downlink.
Unit of the maximum flow bit rate for downlink (octet 1) The coding is identical to that of the unit of the guaranteed flow bit rate for uplink.
Value of the maximum flow bit rate for downlink (octets 2 and 3) Octets 2 and 3 represent the binary coded value of the maximum flow bit rate for downlink in units defined by the unit of the maximum flow bit rate for downlink.
In this version of the protocol, for messages specified in the present document, the sending entity shall not request 0 kbps for both the maximum flow bit rate for downlink identity is one octet, bits 5 to 8 of the parameter contents contain the EPS bearer identity as specified in subclause of 3GPP specification document (see NOTE) and bits 1 to 4 of the parameter contents are spare and shall be coded as zero.
The UE shall not include the EPS bearer identity parameter in any mobile originated 5GSM messages.
NOTE 1: The total number of EPS bearer identities included in all QoS flow NOTE 2: In this release of the specifications if received it shall be interpreted as value is incremented in multiples of 1 Kbps.
a) for classification and marking of uplink user traffic; and description provided by the UE in an IMS session.
packet filters for DL direction, zero or more packet filters for both UL and DL directions or any combinations of these.
The set of packet filters determine the traffic mapping to QoS flows.
length for the information element is 65538 octets.
The QoS rules information element is coded as shown in figure , figure , figure , QoS rules IEI octet 1 Length of QoS rules IE octet 2 octet u+1 octet v octet v+1 octet w octet w+1 octet x QoS rules information element Rule operation code DQR bit Number of packet filters octet 7 Packet filter list octet 8* QoS rule precedence octet m+1*.
gation QoS flow identifier (QFI) octet m+2*.
Packet filter list when the rule operation is "modify existing QoS rule and delete 0 0 Packet filter direction 1 Packet filter identifier 1 octet 8.
Length of packet filter contents 1 octet 9 Packet filter contents 1 octet 10 0 0 Packet filter direction 2 Packet filter identifier 2 octet m+1.
Length of packet filter contents 2 octet m+2 Packet filter contents 2 octet m+3 0 0 Packet filter.
Packet filter list when the rule operation is "create new QoS rule", or "modify The network shall not set the QRI value to QoS rule precedence (octet m+1) The QoS rule precedence field is used to specify the precedence of the QoS rule among all QoS rules (both the signalled QoS rules as described in subclause and the derived QoS rules as described in subclause\) associated with the PDU session of the QoS flow.
This field includes the binary coded value of the QoS rule precedence in the range from 0 to 255 (decimal).
The higher the value of the QoS rule precedence field, the lower the precedence of that QoS rule is.
For the "delete existing QoS rule" operation, the QoS rule precedence value field shall not be included.
For the "create new QoS rule" operation, the QoS rule precedence value field shall be included.
The value 80 (decimal) is reserved.
Segregation bit (bit 7 of octet m+2) (see NOTE 1) In the UE to network direction the segregation bit indicates whether the UE is requesting the network to bind service data flows described by the QoS rule to a dedicated QoS Flow and it is encoded as follows.
In the network to UE direction this bit is spare.
Bit 0 Segregation not requested 1 Segregation requested QoS flow identifier (QFI) (bits 6 to 1 of octet m+2) (see NOTE 1) The network shall not set the QFI value to For the "delete existing QoS rule" operation, the QoS flow identifier value field shall not be included.
For the "create new QoS rule" operation, the QoS flow identifier value field shall be included.
DQR bit (bit 5 of octet 7) The DQR bit indicates whether the QoS rule is the default QoS rule and it is encoded as follows:.
5 0 the QoS rule is not the default QoS rule.
1 the QoS rule is the default QoS rule.
Rule operation code (bits 8 to 6 of octet 7) Bits 8 7 6.
0 0 1 Create new QoS rule 0 1 0 Delete existing QoS rule 0 1 1 Modify existing QoS rule and add packet filters 1 0 0 Modify existing QoS rule and replace all packet filters 1 0 1 Modify existing QoS rule and delete packet filters 1 1 0 Modify existing QoS rule without modifying packet filters 1 1 1 Reserved Number of packet filters (bits 4 to 1 of octet 7) filters shall be coded as For the "create new QoS rule" operation and the "modify existing QoS rule and replace all packet filters" operation, the number of packet filters shall be greater than or equal to 0 and less than or equal to 1 For all other operations, the number of packet filters shall be greater than 0 and less than or equal to 1 Packet filter list (octets 8 to m) For the "delete existing QoS rule" operation, the length of QoS rule field is set to one.
For the "delete existing QoS rule" operation and the "modify existing QoS rule without modifying packet filters" operation, the packet filter list shall be empty.
For the "modify existing QoS rule and delete packet filters" operation, the packet number of packet filters.
This number shall be derived from the coding of the number of packet filters field in octet For the "modify existing QoS rule and add packet filters" operation, the packet filter Each packet filter is of variable length and consists of a packet filter direction (2 bits); - a packet filter identifier (4 bits); - the length of the packet filter contents (1 octet); and the packet filter contents itself (variable amount of octets).
The packet filter direction field is used to indicate for what traffic direction the filter applies.
1 0 uplink only The least significant 4 bits are used.
fixed length packet filter component value field.
The packet filter component type identifier shall be transmitted first.
In each packet filter, there shall not be more than one occurrence of each packet filter component type.
Among the "IPv4 remote address type" and "IPv6 remote address/prefix length type" packet filter components, only one shall be present in one packet filter.
Among the "IPv4 local address type" and "IPv6 local address/prefix length type" packet filter components, only one shall be present in one packet filter.
Among the "single local port type" and "local port range type" packet filter components, only one shall be present in one packet filter.
Among the "single The term local refers to the UE and the term remote refers to an external network entity.
Packet filter component type identifier The description and valid combinations of packet filter component type identifiers in a packet filter are defined in 3GPP specification document .
For "match-all type", the packet filter component shall not include the packet filter address mask field.
The IPv4 address field shall be transmitted first.
For "IPv4 local address type", the packet filter component value field shall be encoded as defined for "IPv4 remote address type".
For "IPv6 local address/prefix length type", the packet filter component value field shall be encoded as defined for "IPv6 remote address /prefix length".
For "protocol identifier/Next header type", the packet filter component value field shall be encoded as one octet which specifies the IPv4 protocol identifier or Ipv6 next header.
For "security parameter index", the packet filter component value field shall be encoded as four octets which specify the IPSec security parameter index.
For "flow label type", the packet filter component value field shall be encoded as three octets which specify the IPv6 flow label.
The bits 8 through 5 of the first octet shall be spare whereas the remaining 20 bits shall contain the IPv6 flow label.
For "80Q C-TAG VID type", the packet filter component value field shall be encoded as two octets which specify the VID of the customer-VLAN tag (C-TAG).
The bits 8 through 5 of the first octet shall be spare whereas the remaining 12 bits shall contain the VID.
For "80Q S-TAG VID type", the packet filter component value field shall be encoded as two octets which specify the VID of the service-VLAN tag (S-TAG).
The bits 8 through 5 of the first octet shall be spare whereas the remaining 12 bits shall contain the VID.
For "80Q C-TAG PCP/DEI type", the packet filter component value field shall be encoded as one octet which specifies the 80Q C-TAG PCP and DEI.
The bits 8 through 5 of the octet shall be spare, the bits 4 through 2 contain the PCP and bit 1 contains the DEI.
For "80Q S-TAG PCP/DEI type", the packet filter component value field shall be encoded as one octet which specifies the 80Q S-TAG PCP.
The bits 8 through 5 of the octet shall be spare, the bits 4 through 2 contain the PCP and bit 1 contains the DEI.
For "ethertype type", the packet filter component value field shall be encoded as two octets which specify an ethertype.
NOTE 1: Octet m+2 shall not be included without octet m+ NOTE 2: The "Match-all type" packet filter component type identifier shall not be used with packet filter direction "downlink only".
The purpose of the Session-AMBR information element is to indicate the initial subscribed PDU session aggregate maximum bit rate if it is changed by the network.
The Session-AMBR information element is coded as shown in figure and table Session-AMBR IEI octet 1 Length of Session-AMBR contents octet 2 Unit for Session-AMBR for downlink octet 3 Session-AMBR for downlink octet Unit for Session-AMBR for uplink octet 6 Session-AMBR for uplink octet Other values shall be interpreted as multiples of 256 Pbps in this version of the protocol.
Session-AMBR for downlink (octets 4 and 5) Octets 4 and 5 represent the binary coded value of PDU session aggregated maximum bit rate for downlink in units defined by octet Unit for Session-AMBR for uplink (octet 6) The coding is identical to the unit coding defined for Session-AMBR for downlink (octet 3) Session-AMBR for uplink (octets 7 and 8) Octets 7 and 8 represent the binary coded value of PDU session aggregated maximum bit rate for uplink in units defined by octet NOTE: In this release of the specifications if received it shall be interpreted as value is incremented in multiples of 1 Kbps.
5 SM PDU DN request container the network access identifier (NAI) format.
length of 255 octets.
DN-specific identity octets 3*-n* SM PDU DN request container information element Table : SM PDU DN request container information element DN-specific identity (octet 3 to octet n) A DN-specific identity of the UE in the network access identifier (NAI) format according to IETF RFC 7542 , encoded as UTF-8 string.
The purpose of the SSC mode information element is to indicate SSC mode.
SSC mode IEI 0 Spare SSC mode value octet 1 SSC mode information element Table : SSC mode information element SSC mode value (octet 1, bit 1 to bit 4).
1 0 0 unused; shall be interpreted as "SSC mode 1", if received by the network 1 0 1 unused; shall be interpreted as "SSC mode 2", if received by the network 1 1 0 unused; shall be interpreted as "SSC mode 3", if received by the network All other values are reserved.
3GPP specification document\) corresponding to the 5GS session management procedure which was rejected by the network.
The Re-attempt indicator information element is coded as shown in figure and table Re-attempt indicator IEI octet 1 Length of Re-attempt indicator contents octet 2.
NC RATC octet 3 0 UE is allowed to re-attempt the procedure in S1 mode 1 UE is not allowed to re-attempt the procedure in S1 mode EPLMNC (octet 3, bit 2).
0 UE is allowed to re-attempt the procedure in an equivalent PLMN 1 UE is not allowed to re-attempt the procedure in an equivalent PLMN Bits 3 to 8 of octet 3 are spare and shall be encoded as zero.
8 5GSM network feature support The purpose of the 5GSM network feature support information element is to indicate whether certain session management related features are supported by the network.
length of 15 octets.
5GSM network feature support IEI octet 1 Length of 5GSM network feature support contents octet 2.
octet 4* -15* Spare 5GSM network feature support information element Table : 5GSM network feature support information element 5GSM network feature support contents Ethernet PDN type in S1 mode (IEPT-S1) (octet 3, bit 1) This bit indicates network's capability for Ethernet PDN type in S1 mode.
0 Ethernet PDN type in S1 mode not supported 1 Ethernet PDN type in S1 mode supported All other bits in octet 3 to 15 are spare and shall be coded as zero, if the respective octet is included in the information element.
0 Serving PLMN rate control See subclause 8 in 3GPP specification document .
1 5GSM congestion re-attempt indicator The purpose of the 5GSM congestion re-attempt indicator info rmation element is to indicate whether the back-off timer is applied in the registered PLMN or all PLMNs.
The 5GSM congestion re-attempt indicator information element is coded as shown in figure and.
Spare ABO octet 3 5GSM congestion re-attempt indicator Table : 5GSM congestion re-attempt indicator ABO (All PLMNs Back-off timer) (octet 3, bit 3).
0 The back-off timer is applied in the registered PLMN.
1 The back-off timer is applied in all PLMNs.
Bits 2 to 8 of octet 3 are spare and shall be encoded as zero.
The purpose of the ATSSS container information element is to transfer parameters associated with ATSSS.
The ATSSS container information element is coded as shown in figure and table ATSSS container IEI octet 1 Length of ATSSS container contents octet 2 ATSSS container contents octet 4 ATSSS container information element Table : ATSSS container information element ATSSS container contents are defined in 3GPP specification document [13B].
3 Control plane only indication control plane CIoT 5GS optimization.
The control plane only indication information element is coded as shown in figure Control plane only indication IEI 0.
Control plane only indication information element 1 PDU session can be used for control plane CIoT 5GS optimization only The value 0 is reserved.
If received, it shall be interpreted as if the control plane only indication IE was not included in the message.
Bits 4 to 2 of octet 1 are spare and shall be all encoded as zero.
4 IP header compression configuration The purpose of the IP header compression configuration information element is to negotiate ROHC channel setup The IP header compression configuration information element is coded as shown in figure and maximum length of 257 octets.
The optional Additional IP header compression parameters container field conveys the additional header compression IP header compression configuration IEI octet 1 Length of IP header compression configuration contents octet 2 Additional IP header compression context setup parameters type octet 6* Additional IP header compression context setup parameters container octet 7* IP header compression configuration information element shall always be supported.
When all the bits are set to 0, this indicates that only the No Compression profile 0x0000 is supported.
Profile 0x0002 support indicator (see IETF RFC 3095 [ 33A] and IETF RFC 4815 [38A]) (octet 3 bit 1) 0 RoHC profile 0x0002 (UDP/IP) is not supported 1 RoHC profile 0x0002 (UDP/IP) is supported Profile 0x0003 support indicator (see IETF RFC 3095 [33A] and IETF RFC 4815 [38A]) (octet 3 bit 2) 0 RoHC profile 0x0003 (ESP/IP) is not supported 1 RoHC profile 0x0003 (ESP/IP) is supported Profile 0x0004 support indicator (see IETF RFC 3843 [34A] and IETF RFC 4815 [38A]) (octet 3 bit 3) 0 RoHC profile 0x0004 (IP) is not supported 1 RoHC profile 0x0004 (IP) is supported Profile 0x0006 support indicator (see IETF RFC 6846 [40B]) (octet 3 bit 4) 0 RoHC profile 0x0006 (TCP/IP) is not supported 1 RoHC profile 0x0006 (TCP/IP) is supported Profile 0x0102 support indicator (see IETF RFC 5225 [39A]) (octet 3 bit 5) 0 RoHC profile 0x0102 (UDP/IP) is not supported 1 RoHC profile 0x0102 (UDP/IP) is supported Profile 0x0103 support indicator (see IETF RFC 5225 [39A]) (octet 3 bit 6) 0 RoHC profile 0x0103 (ESP/IP) is not supported 1 RoHC profile 0x0103 (ESP/IP) is supported Profile 0x0104 support indicator (see IETF RFC 5225 [39A]) (octet 3 bit 7) 0 RoHC profile 0x0104 (IP) is not supported 1 RoHC profile 0x0104 (IP) is supported Bits 8 is spare and shall be set to MAX_CID (octet 4 and octet 5) Additional IP header compression context parameters type (octet 6).
The Additional IP header compression context parameters type octet indicates the profile associated with the profile- specific information in the Additional IP header compression context parameters container.
IETF RFC 5795 [39B]).
The maximum size is 251 octets.
NOTE: If the Additional IP header compression context setup parameters container is included, then the Additional IP header compression context parameters type shall be included in the octet 5 DS-TT Ethernet port MAC address The purpose of the DS-TT Ethernet port MAC address information element is to signal the MAC address of the DS-TT The DS-TT Ethernet port MAC address information element is coded as shown in figure and DS-TT Ethernet port MAC address IEI octet 1 Length of DS-TT Ethernet port MAC address contents octet 2 DS-TT Ethernet port MAC address contents DS-TT Ethernet port MAC address information element Table : DS-TT Ethernet port MAC address information element DS-TT Ethernet port MAC address contents (octets 3 to 7) The DS-TT Ethernet port MAC address contents co nsist of the binary representation of the MAC address of the DS-TT Ethernet port used for the PDU session, starting with the LSB bit of the first octet of the MAC address included in bit 1 of octet 6 UE-DS-TT residence time The purpose of the UE-DS-TT residence time information element is to signal the time taken within the UE and DS-TT The UE- DS-TT residence time information element is coded as shown in figure and table UE-DS-TT residence time IEI octet 1 Length of UE-DS-TT residence time contents octet 2 UE-DS-TT residence time contents UE-DS-TT residence time information element The UE-DS-TT residence time contents contain the UE-DS-TT residence time encoded as specified for the correctionField in IEEE 158008 [43B], with the LSB bit of the first octet of the UE-DS-TT residence time included in bit 1 of octet If the UE-DS-TT residence time.
is too big to be represented, all bits of octets 3 to 10 shall be coded as "1" except the MSB bit of octet 1 7 Port management information container The purpose of the Port management information container information element is to transport an Ethernet port management service message as specified in clause 8 of 3GPP specification document [19D].
The Port management information container information element is coded as shown in figure and maximum length of 65538 octets.
Port management information container IEI octet 1 Length of Port management information container contents octet 2 Port management information container octet 4 Port management information container information element Table : Port management information container information element Port management information container (octet 4 to n) An Ethernet port management service message as specified in clause 8 of 3GPP specification document [19D].
8 Ethernet header compression configuration the length of the CID field in the EHC packet (see 3GPP specification document\).
The Ethernet header compression configuration information element is coded as shown in figure and Ethernet header compression configuration IEI octet 1 Length of Ethernet header compression configuration contents octet 2.
Spare CID Length octet 3 Ethernet header compression configuration information element 0 0 Ethernet header compression not used All other values shall be interpreted as "7 bits".
Bits 3 to 8 of octet 3 are spare and shall be coded as zero.
2 3GPP specific coding info rmation defined within present Serving network name (SNN) The serving network name (SNN) is used: in the Network name field of the AT_KDF_INPUT attribute defined in IETF RFC 5448 ; in RES* and XRES* derivation function as specified in 3GPP specification document annex A.
MCC and MNC in the SNN-PLMN-ID are MCC and MNC of the serving PLMN.
If the MNC of the serving PLMN has MCC and MNC in the SNN-SNPN-ID are MCC and MNC of the serving SNPN.
If the MNC of the serving SNPN has SNN-NID contains an NID in hexadecimal digits.
ABNF syntax of SNN is specified in table Table : ABNF syntax of SNN SNN = SNN-service-code ":" SNN-network-identifier SNN-service-code = %x37 ; "5G" SNN-network-identifier = SNN-PLMN-ID / SNN-SNPN-ID SNN-PLMN-ID = SNN-mnc-string SNN-mnc-digits ".
" SNN-mcc-string SNN-mcc-digits ".
" SNN-3gppnetwork- string ".
" SNN-org-string ; applicable when not operating in SNPN access mode.
SNN-SNPN-ID = SNN-mnc-string SNN-mnc-digits ".
" SNN-mcc-string SNN-mcc-digits ".
" SNN-3gppnetwork- string ".
" SNN-org-string ":" SNN-NID ; applicable when operating in SNPN access mode.
SNN-mnc-digits = DIGIT DIGIT DIGIT ; MNC of the PLMN ID SNN-mcc-digits = DIGIT DIGIT DIGIT ; MCC of the PLMN ID SNN-mnc-string = %x6d.
63 ; "mnc" in lower case SNN-mcc-string = %x6d.
63 ; "mcc" in lower case SNN-3gppnetwork-string = %x3e.
7b ; "3gppnetwork" in lower case SNN-hexadecimal-digit = DIGIT / %x41 / %x42 / %x43 / %x44 / %x45 / %x46 NOTE: SNN-service-code allows for distinguishing of ANID specified in 3GPP specification document and SNN as either of SNN or ANID can be carri ed in the AT_KDF_INPUT attribute.
10 List of system parameters.
clauses 4 to 6, which should be considered the definitive descriptions.
1 Timers of 5GS mobility management Timers of 5GS mobility management are shown in table 1 and table 1 are defined in 3GPP specification document .
NOTE 7 NOTE 8 In WB- if T3510 expired during the registration RMAL-SERVICE At registration failure due to lower layer failure, T3510 timeout or registration rejected with other 5GMM cause values than those treated in registration or subclause for mobility and periodic registration Transmission of entered (NOTE 5) Retransmission of the REGISTRATION REQUEST, if still required.
REGISTERED In 5GMM-REGISTERED, when 5GMM-CONNECTED mode is left and if the NW does not indicate support for strictly periodic registration timer as specified in subclause If the network indicates support for strictly periodic registration timer, T3512 is started after the registration update procedure.
T3512 is restarted if it expires in 5GMM-CONNECTED mode as specified in subclause When entering state if the NW does not indicate support for strictly periodic specified in subclause In 5GMM-IDLE mode, Initiation of registration procedure if the UE is not registered for mode, restart the timer T351 the UE is registered for emergency services NOTE 7 NOTE 8 In WB-N1/CE ACCEPT received AUTHENTICATION REJECT received NOTE 8 In WB- INITIATED Transmission of SERVICE REQUEST message, or CONTROL PLANE SERVICE REQUEST message (a) Indication from the lower layers that the UE has changed to S1 mode or E- 5GCN for case h) in subclause ; or (b) SERVICE received, or SERVICE REJECT message received for cases other than h) in subclause see subclause Abort the procedure NOTE 7 NOTE 8 In WB-N1/CE mode, 90s (NOTE 6) Transmission of IDENTITY message, or DEREGISTRATION REQUEST message with freshly generated message with new 5G-GUTI received DEREGISTRATION ACCEPT message Delete stored SUCI NOTE 7 NOTE 8 In WB-N1/CE message with an EAP-response message after detection of an error as described in message received or AUTHENTICATION received or SECURITY MODE message received when entering indication of transmission failure authentication and key agreement procedure, the UE will follow services.
On first expiry based primary authentication and key agreement 5, if the UE is not registered for emergency On first expiry during an EAP authentication and key agreement procedure, the UE subclause under "For item e:", if the UE is NOTE 7 NOTE 8 In WB-N1/CE INITIATED Transmission of DEREGISTRATION REQUEST message when de-registration procedure is not due to a "switch off" DEREGISTRATION REQUEST message NOTE 3 NOTE 7 NOTE 8 In WB- request attempt counter is UE camped on a than the PLMN on which timer started, or User-plane REGISTERED REGISTRATION REJECT message or DEREGISTRATION REQUEST message received with any of the 5GMM cause #3, received with any of the 5GMM message received as described in subclause case b) SERVICE ACCEPT message received as described in subclause case f) AUTHENTICATION REJECT message received N1 NAS signalling connection released PDU sessions have been set up Release the NAS signalling connection for the cases a), b), f) and g) as described in REGISTERED CONFIGURATION UPDATE COMMAND message received as described in subclause case e) N1 NAS signalling connection released Release the NAS signalling connection for the case e) and perform procedure as described in subclause SERVICE REGISTRATION REJECT message received with the 5GMM cause #9 or #10 received with the 5GMM cause #9, #10 or #28 Release the NAS signalling connection for the cases c) and d) as described in subclause and initiation of the procedure as specified in subclause NOTE 2 NOTE 4 All 5GMM state non-3GPP access N1 NAS signalling connection over established or when entering state 5GMM- over non-3GPP access Implicitly de-register the UE for non- 3GPP access on 1st mode and if not in WB-N1/CE mode.
NOTE 4: If the T3346 value received in the mobility management messages is greater than the value of the non-3GPP de-registration timer, the UE sets the non-3GPP de-registration timer value to be 4 minutes greater than the value of timer T334 NOTE 5: The conditions for which this applies are described in subclause NOTE 6: The conditions for which this applies to the 5GMM-SERVICE-REQUEST-INITIATED state are described in subclause case c) and case d).
NOTE 7: In NB-N1 mode, the timer value shall be calculated as described in subclause timer value is as described in this table for the case of WB-N1/CE mode (see subclause 9).
Table 1: Timers of 5GS mobility management – AMF side NOTE 7.
NOTE 6 NOTE 8 6s In WB-N1/CE REGISTRATION ACCEPT message as specified in REGISTRATION COMPLETE message received Retransmission of REGISTRATION ACCEPT message.
NOTE 6 NOTE 8 6s N1/CE mode, 24s 5GMM- COMMAND message with "acknowledgement requested" set in the Acknowldgement bit of COMPLETE message received Retransmission of.
INITIATED Transmission of AUTHENTICATION REQUEST Transmission of SECURITY MODE COMMAND message AUTHENTICATION RESPONSE AUTHENTICATION FAILURE message received COMPLETE message received SECURITY MODE received Retransmission of AUTHENTICATION message or SECURITY MODE COMMAND.
N1/CE mode, 24s 5GMM- REGISTERED Transmission of NOTIFICATION message received NOTIFICATION RESPONSE REGISTRATION REQUEST Message received REQUEST message received NGAP UE context message as specified in 3GPP specification document [3 1] received Retransmission of NOTIFICATION.
INITIATED Transmission of IDENTITY REQUEST message IDENTITY RESPONSE message received Retransmission of REGISTERED Transmission of NETWORK AUTHENTICATION COMMAND message NETWORK SLICE- AUTHENTICATION COMPLETE message received Retransmission of SPECIFIC AUTHENTICATION COMMAND message.
timer TBD All except 5GMM- DEREGISTERED Entering 5GMM- IDLE mode after indicating MICO mode activation to the UE with an active timer value.
N1 NAS signalling connection established Activate MICO mode for the UE.
expires while the network is in 5GMM-IDLE mode Entering 5GMM-IDLE 3GPP access if the MICO mode is activated and strictly periodic monitoring timer is not running The strictly periodic monitoring.
timer NOTE 1 All except 5GMM- DEREGISTERED Entering 5GMM-IDLE mode N1 NAS signalling established Network dependent, but typically paging is halted on 1 registration timer, if the UE is not registered for services.
Implicitly de-register the UE which is timer NOTE 3 All except 5GMM- DEREGISTERED Entering 5GMM- IDLE mode over non-3GPP access N1 NAS signalling non-3GPP access established Implicitly de-register the UE for non- 3GPP access on 1.
timer NOTE 5 All except 5GMM- DEREGISTERED At the successful completion of registration update procedure if strictly periodic registration timer indication is supported as specified in subclause Entering 5GMM- DEREGISTERED.
In 5GMM-IDLE mode, start implicit de-registration timer as specified in periodic monitoring timer is started again as specified in NOTE 1: The default value of this timer is 4 minutes greater than the value of timer T351 If the UE is registered for emergency services, the value of this timer is set equal to the value of timer T351 If the T3346 value provided in the mobility management messages is greater than the value of the timer T3512, the AMF sets the mobile reachable timer and the implicit de-registration timer such that the sum of the timer values is greater than the value of timer T334 NOTE 2: The value of this timer is network dependent.
If MICO is activated, the default value of this timer is 4 minutes greater than the value of timer T351 NOTE 3: The value of this timer is network dependent.
The default value of this timer is 4 minutes greater than the non-3GPP de-registration timer.
If the T3346 value provided in the mobility management messages is greater than the value of the non-3GPP de-registration timer, the AMF sets the non-3GPP implicit de-registration timer value to be 8 minutes greater than the value of timer T334 NOTE 4: The value of this timer is network dependent.
NOTE 5: The value of this timer is the same as the value of timer T351 NOTE 6: In NB-N1 mode, the timer value shall be calculated as described in subclause NOTE 7: In NB-N1 mode, the timer value shall be calculated by using an NAS timer value which is network dependent. timer value is as described in this table for the case of WB-N1/CE mode (see subclause 9).
timer value which value is network dependent.
Timers of 5GS session management are shown in table 1 and table 1 NOTE: Timer T3396 is defined in 3GPP specification document .
NOTE 5 16s In WB-N1/CE PDU SESSION ESTABLISHMENT REJECT message PDU SESSION ESTABLISHMENT REQUEST received TRANSPORT message with 5GMM cause #22,.
N1/CE mode, 24s PDU SESSION PENDING Transmission of PDU SESSION COMMAND message with the same PTI is received or PDU MODIFICATION REJECT message received or message with 5GMM cause #22, #2 #67, #69, or #90 Retransmission of PDU SESSION.
mode, 24s PDU SESSION PENDING Transmission of PDU SESSION RELEASE REQUEST message PDU SESSION RELEASE message with the same PTI is received or PDU RELEASE REJECT message received Retransmission of PDU SESSION.
NOTE 2 PDU SESSION 
ESTABLISHMENT REJECT, PDU SESSION MODIFICATION REJECT, or PDU SESSION with 5GSM cause #67 and with a timer value for T3584 PDU SESSION ESTABLISHMENT REQUEST, or PDU SESSION timer value for T3584 (see PDU SESSION MODIFICATION REJECT, or PDU SESSION RELEASE COMMAND received with 5GSM cause #69 and with a timer value for T3585 PDU SESSION ESTABLISHMENT REQUEST, 5GMM cause #69 and with a timer value for T3585(see subclause\) PDU SESSION COMMAND or PDU SESSION MODIFICATION COMMAND or REQUEST with the re-registration type "re-registration timer defined in 3GPP specification document NOTE 1: Typically, the procedures are aborted on the fifth expiry of the relevant timer.
Exceptions are described in the as RQ timer value in the PDU SESSION ESTABLISHMENT ACCEPT message and PDU SESSION MODIFICATION COMMAND message.
The maximum value of the timer is 30 min.
If the network indicates a value greater than the maximum value, then the UE shall use the maximum value.
NOTE 3: The value of this timer is provided by the network.
timer value is as described in this table for the case of WB-N1/CE mode (see subclause 0).
different packet system specific timers as back-off timers is left up to UE implementation.
1st, 2nd, 3rd, 4th 
NOTE 4 15s In WB-N1/CE mode, 23s PROCEDURE.
mode, 24s PDU SESSION PENDING Transmission of PDU SESSION MODIFICATION COMMAND message received or PDU SESSION MODIFICATION REJECT message received Retransmission of PDU SESSION.
NOTE 3 NOTE 4 16s In WB-N1/CE mode, 24s PDU SESSION PENDING Transmission of PDU SESSION RELEASE COMMAND message PDU SESSION RELEASE COMPLETE message received N1 SM delivery skipped indication received Retransmission of PDU SESSION RELEASE COMMAND.
NOTE 4 Default 60s (NOTE 2) PDU SESSION PENDING Reception of PDU SESSION MODIFICATION COMPLETE message for transmitted PDU COMMAND message where the PDU SESSION MODIFICATION COMMAND message included 5GSM cause #39 PDU SESSION PDU session release procedure NOTE 1: Typically, the procedures are aborted on the fifth expiry of the relevant timer.
Exceptions are described in the NOTE 2: If the PDU Session Address Lifetime value is sent to the UE in the PDU SESSION MODIFICATION timer value is as described in this table for the case of WB-N1/CE mode (see subclause 0).
Cause values for 5GS mobility management A.
1 Causes related to UE identification Cause #3 – Illegal UE This 5GMM cause is sent to the UE when the network refuses service to the UE either because an identity of the UE is not acceptable to the network or because the UE does not pass the authentication check.
Cause #6 – Illegal ME This 5GMM cause is sent to the UE if the ME used is not acceptable to the network, e.
Cause #9 – UE identity cannot be derived by the network.
This 5GMM cause is sent to the UE when the network cannot derive the UE's identity from the 5G-GUTI or 5G- integrity check failure of the received message.
Cause #10 – Implicitly de-registered This 5GMM cause is sent to the UE either if the network has implicitly de-registered the UE, e.
after the implicit de-registration timer has expired, or if the 5GMM context data related to the subscription does not exist A.
2 Cause related to subscription options Cause #5 – PEI not accepted This cause is sent to the UE if the network does not accept an initial registra tion procedure for emergency Cause #7 – 5GS services not allowed This 5GMM cause is sent to the UE when it is not allowed to operate 5GS services.
Cause #11 – PLMN not allowed PLMN where the UE, by subscription or due to operat or determined barring, is not allowed to operate.
Cause #12 – Tracking area not allowed tracking area where the HPLMN or SNPN determines that the UE, by subscription, is not allowed to operate.
are available on which registration was possible.
Cause #13 – Roaming not allowed in this tracking area NOTE 2: The network does not send 5GMM cause value #13 to the UE operating in SNPN access mode in this Cause #15 – No suitable cells in tracking area tracking area in the same PLMN or an equivalent PLMN or the same SNPN.
NOTE 3: Cause #15 and cause #12 differ in the fact that cause #12 does not trigger the UE to search for another allowed tracking area on the same PLMN or SNPN.
Cause #27 – N1 mode not allowed PLMN or SNPN where the UE by subscription or operator policy, is not allowed to operate in N1 mode.
Cause #31 – Redirection to EPC required allowed in 5GCN and redirection to EPC is required.
Cause #72 – Non-3GPP access to 5GCN not allowed UE by subscription, is not allowed to access 5GCN over non-3GPP access.
Cause #74 – Temporarily not authorized for this SNPN a cell belonging to an SNPN for which the UE has no subscription to operate.
Cause #75 – Permanently not authorized for this SNPN Cause #76 – Not authorized for this CAG or authorized for CAG cells only This 5GMM cause is sent to the UE if the UE requests access or de-registration: Cause #77 – Wireline access area not allowed This 5GMM cause is sent to the 5G-RG or the W-AGF acting on behalf of the FN-CRG (or on behalf of the N5GC device) if the 5G-RG or the W-AGF acting on behalf of the FN-CRG (or on behalf of the N5GC device) the W-AGF acting on behalf of the FN-CRG (or on behalf of the N5GC device) are not allowed by subscription to access the 5GCN over the wireline access.
3 Causes related to PLMN or SNPN specific network failures Cause #20 – MAC failure This 5GMM cause is sent to the network if the USIM detects that the MAC in the AUTHENTICATION REQUEST message is not fresh.
Cause #21 – Synch failure This 5GMM cause is sent to the network if the USIM detects that the SQN in the AUTHENTICATION REQUEST message is out of range.
Cause #22 – Congestion Cause #23 – UE security capabilities mismatch This 5GMM cause is sent to the network if the UE detects that the UE security capability does not match the one sent back by the network.
Cause #24 – Security mode rejected, unspecified This 5GMM cause is sent to the network if the security mode command is rejected by the UE for unspecified Cause #26 – Non-5G authentication unacceptable This 5GMM cause is sent to the network in N1 mode if the "separation bit" in the AMF field of AUTN is set to 0 in the AUTHENTICATION REQUEST message (see 3GPP specification document\).
Cause #28 – Restricted service area Cause #43 – LADN not available This 5GMM cause is sent to the UE if the user-plane resources of the PDU session are not established when the UE is located outside the LADN service area.
Cause #62 – No network slices available This 5GMM cause is sent by the network if none of the requested network slice(s) in the registration request are allowed and there are no default network slice(s) configured in the network.
NOTE: Network does not send this cause in REGISTRATION REJECT message if the UE does not include a requested NSSAI in the REGISTRATION REQUEST message.
In that case, the Network uses other causes (e.
#11, #13, #15) etc based on the subscription.
Cause #65 – Maximum number of PDU sessions reached This 5GMM cause is used by the network to indicate that the procedure requested by the UE was rejected as the network has reached the maximum number of simultaneously active PDU sessions for the UE.
Cause #67 – Insufficient resources for specific slice and DNN This 5GMM cause is sent by the network to indicate that the requested service cannot be provided due to insufficient resources for specific slice and DNN.
Cause #69 – Insufficient resources for specific slice This 5GMM cause is sent by the network to indicate that the requested service cannot be provided due to insufficient resources for specific slice.
Cause #71 – ngKSI already in use This 5GMM cause is sent to the network in N1 mode if the ngKSI value received in the AUTHENTICATION REQUEST message is already associated with one of the 5G security contexts stored in the UE.
Cause #73 – Serving network not authorized network fails to be authorized by the UE's home network.
Cause #90 – Payload was not forwarded This 5GMM cause is sent by the network to indicate that the requested service cannot be provided because payload could not be forwarded by AMF.
payload could not be forwarded by AMF because the DNN is not supported or not subscribed in the slice slice indicated by the UE.
Cause #92 – Insufficient user-plane resources for the PDU session This 5GMM cause is sent by the network to indicate that the requested service cannot be provided due to insufficient user-plane resources for the PDU session.
4 Causes related to invalid messages Cause #95 – Semantically incorrect message Cause #96 – Invalid mandatory information semantical mandatory IE error.
Cause #97 – Message type non-existent or not implemented Cause #98 – Message type not compatible with protocol state compatible with the protocol state.
Cause #99 – Information element non-existent or not implemented includes information elements not reco gnized because the information element identifier is not defined or it is defined but not implemented by the equipment sending the 5GMM cause.
However, the information element is not required to be present in the message in order for the equipment sending the 5GMM cause to process the Cause #100 – Conditional IE error Cause #101 – Message not compatible with protocol state Cause #111 – Protocol error, unspecified class applies.
Cause values for 5GS session management B.
1 Causes related to nature of request.
Cause #8 – Operator Determined Barring This 5GSM cause is used by the network to indicate th at the requested service was rejected by the SMF due to.
Cause #26 – Insufficient resources This 5GSM cause is used by the UE or by the network to indicate that the requested service cannot be provided due to insufficient resources.
Cause #27 – Missing or unknown DNN This 5GSM cause is used by the network to indicate th at the requested service was rejected by the external DN because the DNN was not included although re quired or if the DNN could not be resolved.
Cause #28 – U nknown PDU session type This 5GSM cause is used by the network to indicate th at the requested service was rejected by the external DN because the requested PDU session type could not be recognised or is not allowed.
Cause #29 – User authentication or authorization failed This 5GSM cause is used by the network to indicate th at the requested service was rejected by the external DN Cause #31 – Request rejected, unspecified This 5GSM cause is used by the network or by the UE to indicate that the requested service or operation or the Cause #32 – Service option not supported Cause #33 – Requested service option not subscribed Cause #35 – PTI already in use This 5GSM cause is used by the network to indicate that the PTI included by the UE is already in use by another active UE requested procedure for this UE.
Cause #36 – Regular deactivation Cause #38 – Network failure This 5GSM cause is used by the network to indicate th at the requested service was rejected due to an error situation in the network.
Cause #39 – Reactivation requested Cause #43 –Invalid PDU session identity This 5GSM cause is used by the network or the UE to in dicate that the PDU session identity value provided to it Cause #44 – Semantic errors in packet filter(s) This 5GSM cause is used by the network or the UE to indicate that the requested service was rejected due to one or more semantic errors in packet filter(s) of the QoS rule included in the request.
Cause #45 – Syntactical error in packet filter(s) This 5GSM cause is used by the network or the UE to indicate that the requested service was rejected due to one or more syntactical errors in packet filter(s) of the QoS rule included in the request.
Cause #46 –Out of LADN service area This 5GSM cause is used by the network to indicate the UE is out of the LADN service area.
Cause #47 –PTI mismatch This 5GSM cause is used by the network or UE to indicate that the PTI provided to it does not match any PTI in Cause #50 – PDU session type IPv4 only allowed This 5GSM cause is used by the network to indicate that only PDU session type IPv4 is allowed for the Cause #51 – PDU session type IPv6 only allowed This 5GSM cause is used by the network to indicate that only PDU session type IPv6 is allowed for the Cause #54 –PDU session does not exist This 5GSM cause is used by the network to indicate that the network does not have any information about the PDU session which is requested by the UE to transfer between 3GPP access and non-3GPP access or from the EPS to the 5GS.
Cause #57 – PDU session type IPv4v6 only allowed This 5GSM cause is used by the network to indicate that only PDU session types IPv4, IPv6 or IPv4v6 are allowed for the requested IP connectivity.
Cause #58 – PDU session type Unstructured only allowed This 5GSM cause is used by the network to indicate that only PDU session type Unstructured is allowed for the Cause #59 – Unsupported 5QI value This 5GSM cause is used by the network if the 5QI indicated in the UE request cannot be supported.
Cause #61 – PDU session type Ethernet only allowed This 5GSM cause is used by the network to indicate that only PDU session type Ethernet is allowed for the Cause #67 – Insufficient resources for specific slice and DNN Cause #68 – Not supported SSC mode This 5GSM cause is used by the network to indicate that the requested SSC mode is not supported.
Cause #69 –Insufficient resources for specific slice This 5GSM cause is used by the network to indicate that the requested service cannot be provided due to insufficient resources for specific slice.
This 5GSM cause is used by the network to indicate th at the requested service was rejected by the external DN because the DNN was not included although required or if the DNN could not be resolved, in the slice.
Cause #81 – Invalid PTI value Cause #82 – Maximum data rate per UE for user-plane integrity protection is too low This 5GSM cause is used by the network to indicate th at the requested service cannot be provided because the maximum data rate per UE for user-plane integrity protection is too low.
Cause #83 – Semantic error in the QoS operation This 5GSM cause is used by the network or the UE to indicate that the requested service was rejected due to a semantic error in the QoS operation included in the request.
Cause #84 – Syntactical error in the QoS operation This 5GSM cause is used by the network or the UE to indicate that the requested service was rejected due to a syntactical error in the QoS operation included in the request.
Cause #85 – Invalid mapped EPS bearer identity This 5GSM cause is used by the network or the UE to indicate that the mapped EPS bearer identity value B.
2 Protocol errors (e.
, unknown message) Cause #95 – Semantically incorrect message Cause #96 – Invalid mandatory information semantical mandatory IE error.
Cause #97 – Message type non-existent or not implemented equipment sending this 5GSM cause.
Cause #98 – Message type not compatible with protocol state with the protocol state.
Cause #99 – Information element non-existent or not implemented to be present in the message in order for the equi pment sending the 5GSM cause to process the message.
Cause #100 – Conditional IE error Cause #101 – Message not compatible with protocol state Cause #111 – Protocol error, unspecified class applies.
Storage of 5GMM information C.
1 Storage of 5GMM information for UEs not operating in The following 5GMM parameters shall be stored on the USIM if the corresponding file is present: f) UE parameter update counter (see subclause 3A).
The presence and format of corresponding files on the USIM is specified in 3GPP specification document .
the ME together with the SUPI from the USIM.
These 5GMM parameters can only be used if the SUPI from the USIM matches the SUPI stored in the non-volatile memory; else the UE shall delete the 5GMM parameters.
NSSAI inclusion mode(s); - MPS indicator; - MCS indicator; - operator-defined access category definitions; network-assigned UE radio capability IDs; and "CAG information list", if the UE supports CAG.
The UE shall store the S-NSSAI(s) of the HPLMN.
If the UE is in the VPLMN, the UE shall also store the configured NSSAI for the current PLMN and any necessary mapped S-NSSAI(s).
The configured NSSAI(s) can only be used if the SUPI from the USIM matches the SUPI stored in the non-volatile memory of the ME; else the UE shall delete the only be used if the SUPI from the USIM matches the SUPI stored in the non-volatile memory of the ME; else the UE shall delete the NSSAI inclusion mode(s).
The MPS indicator can only be used if the SUPI from the USIM matches the SUPI stored in the non-volatile memory of the ME, else the UE shall delete the MPS indicator.
The MCS indicator can only be used if the SUPI from the USIM matches the SUPI stored in the non-volatile memory of the ME, else the UE shall delete the MCS indicator.
them, and is valid in that PLMN or equivalent PLMN.
The operator-defined access category definitions can only be category definitions is UE implementation dependent.
radio capability ID can only be used if the SUPI from the USIM matches the SUPI stored in the non-volatile memory of different from the value included in the network-assigned UE radio capability ID(s) stored at the UE for the serving PLMN, the UE may delete these stored network-assigned UE radio capability ID(s).
allowed NSSAI is stored, then the UE shall store the S-NSSAI(s) of the HPLMN.
If the UE is in the VPLMN, the UE shall also store the allowed NSSAI for the serving PLMN and any necessary mapping of the allowed NSSAI for the serving PLMN to the S-NSSAI(s) of the HPLMN.
The allowed NSSAI(s) can only be used if the SUPI from the USIM matches the SUPI stored in the non-volatile memory of the ME; else the UE shall delete the allowed NSSAI(s).
If the UE is registered for emergency services, the UE shall not store the 5GMM parameters described in this annex on the USIM or in non-volatile memory.
Instead the UE shall temporarily store these parameters locally in the ME and the UE shall delete these parameters when the UE is deregistered.
If the UE is configured for eCall only mode as specifi ed in 3GPP specification document , the UE shall not store the 5GMM parameters described in this annex on the USIM or in non-volatile memory.
Instead the UE shall temporarily store these parameters locally in the ME and the UE shall delete these parameters when the UE enters 5GMM-DEREGISTERED.
eCALL-INACTIVE state, the UE is switched-off or the USIM is removed.
The "CAG information list" can only be used if the SUPI from the USIM matches the SUPI stored in the non-volatile memory of the ME; else the UE shall delete the "CAG information list".
2 Storage of 5GMM information for UEs operating in SNPN b) last visited registered TAI; i) operator-defined access category definitions; and j) network-assigned UE radio capability IDs.
Each configured NSSAI consists of S-NSSAI(s) stored together with an SNPN identity, if it is associated with an SNPN.
The MCS indicator is stored together with an SNPN identity of the SNPN that provided it, and is valid in that registered Operator-defined access category definitions are stored togeth er with an SNPN identity of the SNPN that provided them, and are valid in that SNPN.
The maximum number of stored operator-defined access category definitions is UE Each network-assigned UE radio capability ID is stored together with an SNPN identity of the SNPN that provided it as at least the last 16 received network-assigned UE radio capability IDs.
There shall be only one network-assigned UE value different from the value included in the network-assigned UE radio capability ID(s) stored at the UE for the serving SNPN, the UE may delete these stored network-assigned UE radio capability ID(s).
stored together with an SNPN identity, if it is associated with an SNPN.
UE policy delivery service 
The PCF may provide the UE with one or more UE policies using the network-requested UE policy management a) a PLMN ID part containing: 1) the PLMN ID for the PLMN; or 2) the PLMN ID part of the SNPN identity for the SNPN; The UE processes the UE policy sections, each identified by the UPSI, received from the PCF and informs the PCF of The UE provides the PCF with the UE policy related capabilities such as the UE's support for ANDSP and the UE's The UE can also request the PCF to provide V2XP as specified in 3GPP specification document [19B].
Principles of PTI handling for UE policy delivery service procedures the response message the PTI value received within the received command or request message (see examples in figure D.
the PTI value received with the request message (see examples in figure D.
Network-requested transaction related procedure transaction related request (PTI = a) transaction related reject (PTI = a) UE-requested transaction related procedure rejected by the network transaction related request (PTI = a) transaction related command (PTI = a) transaction related response (PTI = a) the same as the one received within the command message, and therefore the PCF could not associate the response message from the UE to the command message sent.
Network-requested UE policy management procedure.
The purpose of the network-requested UE policy management procedure is to enable the network to: a) add one or more new UE policy sections to the UE; b) modify one or more UE policy sections stored at the UE; or c) delete one or more UE policy sections stored at the UE.
Network-requested UE policy management procedure initiation In order to initiate the network-requested UE policy management procedure, the PCF shall: c) send the MANAGE UE POLICY COMMAND message to the UE via the AMF as specified in 3GPP specification document ; and d) start timer T3501 (see example in figure D.
MANAGE UE POLICY COMPLETEMANAGE UE POLICY COMMAN.
MANAGE UE POLICY COMMAND REJECTStop T3501OR Network-requested UE policy management procedure instruction included in the UE policy section management list IE, the UE shall: a) store the received UE policy section of the instruction, if the UE has no st ored UE policy section associated with the same UPSI as the UPSI associated with the instruction; RPLMN and the HPLMN or the registered SNPN, before storing the new received UE policy sections.
of the stored UE policy section.
NOTE: The maximum number of UE policy sections for PLMNs or SNPNs other than the HPLMN and the RPLMN or the registered SNPN that the UE can store and how the UE selects the UE policy sections to be deleted are up to the UE implementation.
Network-requested UE policy management procedure accepted by the UE If all instructions included in the UE policy section manage ment list IE were executed successfully by the UE, the UE UE POLICY COMMAND message; and Upon receipt of the MANAGE UE POLICY COMPLETE message, the PCF shall stop timer T350 The PCF should ensure that the PTI value assigned to this procedure is not released immediately.
NOTE: The way to achieve this is implementation dependen t.
For example, the PCF can ensure that the PTI value assigned to this procedure is not released during the time equal to or greater than the default value of D.
Network-requested UE policy management procedure not accepted by the If the UE could not execute all instructions included in the UE policy section management list IE successfully, the UE shall: a) set the PTI IE to the PTI value received within the MANAGE UE POLICY COMMAND message and encode b) transport the MANAGE UE POLICY COMMAND REJECT message using the NAS transport procedure as The PCF should ensure that the PTI value assigned to this procedure is not released immediately.
NOTE: The way to achieve this is implementation dependen t.
For example, the PCF can ensure that the PTI value assigned to this procedure is not released during the time equal to or greater than the default value of Upon receipt of the notification from the AMF that the UE is not reachable, the PCF shall stop the T350 D.
Abnormal cases on the network side The following abnormal cases can be identified: D.
Abnormal cases in the UE The following abnormal cases can be identified: The UE shall set the UE policy delivery service cause to #111 (Protocol error, unspecified) for the instruction in the UE policy section management result IE of the MANAGE UE POLICY COMMAND REJECT message.
The UE shall set the UE policy delivery service cause to #111 (Protocol error, unspecified) for the instruction in the UE policy section management result IE of the MANAGE UE POLICY COMMAND REJECT message.
c) Transmission failure of the MANAGE UE POLICY COMPLETE message indication from lower layers.
case does not cause the UE to revert the execution of the instructions included in the MANAGE UE d) Transmission failure of the MANAGE UE POLICY COMMAND REJECT message indication from lower The UE shall not diagnose an error and consider the network-initiated UE policy delivery procedure complete.
case does not cause the UE to revert the execution of the instructions included in the MANAGE UE POLICY COMMAND message and successfully processed by the UE.
previously received MANAGE UE POLICY COMMAND message.
The UE shall discard the message and retransmit the MANAGE UE POLICY COMMAND COMPLETE or MANAGE UE POLICY COMMAND REJECT message transmitted in response to the previously received MANAGE UE POLICY COMMAND message.
NOTE 3: The way to achieve this is UE implementation dependent.
For example, the UE can assume that on the fifth expiry of timer T3501, the PCF will abort the procedure and that the PTI value assigned to the procedure will be released.
UE-initiated UE st ate indication procedure.
The purpose of the UE-initiated UE state indication procedure is: a) to deliver the UPSI(s) of the UE policy section(s) which are: stored in the UE; indicating the HPLMN or the selected PLMN; and D.
UE-initiated UE state indication procedure initiation b) if not operating in SNPN access mode, shall include the UP SI(s) of the UE policy section(s) which are identified c) if operating in SNPN access mode, shall include UPSI(s) of the UE policy section(s) which are identified by a with the PLMN ID part indicating the MCC and MNC of the selected SNPN; and associated with the NID of the selected SNPN; available in the UE in the UPSI list IE; d) shall specify whether the UE supports ANDSP in the UE policy classmark IE; and e) may include the UE's one or more OS Ids in the UE OS Id IE.
The UE shall send the UE STATE INDICATION message (see example in figure D.
The UE shall transport the created UE STATE INDICATION message using the registration procedure (see subclause\).
UE-initiated UE state indication procedure D.
UE-initiated UE state indication procedure accepted by the network 3GPP specification document .
Abnormal cases on the network side Apart from the case described in subclause D.
, no abnormal cases have been identified.
3 UE policy re-assembly at the UE When the UE needs to apply ANDSP as specified in 3GPP specification document , the UE shall consider all UE policy parts with ANDSP contents currently stored at the UE.
When the UE needs to apply URSP as specified in 3GPP specification document , the UE shall consider all UE policy parts with URSP contents currently stored at the UE.
When the UE needs to apply V2XP as specified in 3GPP specification document [19C], the UE shall consider all UE policy parts with V2XP contents currently stored at the UE.
5 Message functional definition and contents D.
Manage UE policy command The MANAGE UE POLICY COMMAND message is sent by the PCF to the UE to request the UE to manage UE policy sections, see table D.
Message type: MANAGE UE POLICY COMMAND Significance: dual Direction: network to UE Table D.
: MANAGE UE POLICY COMMAND message content IEI Information Element Type/Reference Presence Format Length PTI Procedure transaction identity.
COMMAND message identity UE policy delivery service message type D.
M V 1 UE policy section management list UE policy section management list D.
M LV-E 15533 NOTE: The total length of the MANAGE UE POLICY COMMAND message content cannot exceed 65535 octets (see Payload container contents maximum length as specified in subclause\).
Manage UE policy complete The MANAGE UE POLICY COMPLETE message is sent by the UE to the PCF to report that all received instructions have been successfully executed at the UE, see table D.
Message type: MANAGE UE POLICY COMPLETE Direction: UE to network Table D.
: MANAGE UE POLICY COMPLETE message content IEI Information Element Type/Reference Presence Format Length PTI Procedure transaction identity.
COMPLETE message identity UE policy delivery service message.
M V 1 The MANAGE UE POLICY COMMAND REJECT message is sent by the UE to the PCF to report that one or more instructions could not be successfully executed at the UE, see table D.
Message type: MANAGE UE POLICY COMMAND REJECT Significance: dual Direction: UE to network Table D.
: MANAGE UE POLICY COMMAND REJECT message content IEI Information Element Type/Reference Presence Format Length PTI Procedure transaction identity.
identity UE policy delivery service message type D.
M V 1 UE policy section management result UE policy section management result D.
M LV-E 15533 NOTE: The total length of the MANAGE UE POLICY COMMAND REJECT message content cannot exceed 65535 octets (see Payload container contents maximum length as specified in subclause\).
UE state indication The UE STATE INDICATION message is sent by the UE to the PCF: a) to deliver the UPSI(s) of the UE policy section(s) stored in the UE; b) to indicate whether the UE supports ANDSP; and c) to deliver the the UE's one or more OS Ids; Message type: UE STATE INDICATION Direction: UE to network Table D.
: UE STATE INDICATION message content IEI Information Element Type/Reference Presence Format Length PTI Procedure transaction identity.
UE STATE INDICATION message identity UE policy delivery service message.
M V 1 UPSI list UPSI list UE policy classmark UE policy classmark 41 UE OS Id OS Id NOTE: The total length of the UE STATE INDICATION message content cannot exceed 65535 octets (see Payload container contents maximum length as specified in subclause\).
: UE policy delivery service message type.
All other values are reserved NOTE: Coding and usage of UE POLICY PROVISIONING REQUEST message and UE POLICY PROVISIONING REJECT message are specified in 3GPP specification document [19B].
UE policy section management list of instructions to be performed at the UE for management of UE policy section stored at the UE.
The UE policy section management list information element is coded as shown in figure D.
UE policy section management list IEI octet 1 Length of UE policy section management list contents UE policy section management list contents UE policy section management list information element UE policy section management sublist (PLMN 2) octet a+1 octet b octet b+1 … octet c UE policy section management sublist (PLMN N) octet c+1 octet z UE policy section management list contents Length of UE policy section management sublist MCC digit 1 octet d+2 MCC digit 3 octet d+3 MNC digit 1 octet d+4 UE policy section management sublist contents UE policy section management sublist Instruction 1 octet d+5 Instruction 2 octet e+1 UE policy section management sublist contents UPSC octet d+7 octet d+8 UE policy section contents.
UE policy part 2 octet m+1 octet n UE policy section contents UE policy part contents length UE policy part type octet q+2.
UE policy part contents UE policy section management sublist: This field contains the binary encoding of the length of the UE policy section management sublist in units of octets.
MCC, Mobile country code (octet d+2, and bits 4 to 1 of octet d+3) The MCC field is coded as in ITU-T Recommendation E.
212 , annex A.
MNC, Mobile network code (bits 8 to 5 of octet d+3, and octet d+4) UE policy section management sublist contents (octets d+5 to y) The UE policy section management sublist contents consist of one or several.
Instruction contents length (octets d+5 to d+6) This field contains the binary encoding of the instruction contents length in units of UPSC (octets d+7 to d+8) This field contains the binary encoding of the UPSC.
The value of the UPSC is set by UE policy section contents (octets d+9 to k) The UE policy section contents consist of one or several UE policy parts.
This field contains the binary encoding of the UE policy part contents length in units of UE policy part type (bits 4 to 1 of octet q+2).
All other values are reserved.
Bits 8 to 5 of octet q+2 are spare and shall be coded as zero.
UE policy part contents information about instructions for UE policy section management which the UE could not execute successfully.
The UE policy section management result information element is coded as shown in figure D.
UE policy section management result IEI octet 1 Length of UE policy section management result contents UE policy section management result contents UE policy section management result information element UE policy section management subresult (PLMN 1) octet 4 octet a UE policy section management subresult (PLMN 2) octet a+1 octet b octet b+1 … octet c UE policy section management subresult (PLMN N) octet c+1 octet z UE policy section management result contents Number of results octet d MCC digit 1 octet d+1 MCC digit 3 octet d+2 MNC digit 1 octet d+3 UE policy section management subresult contents UE policy section management subresult Result 2 octet d+9 octet d+13 UE policy section management subresult contents octet f+2 octet f+3.
The value part of the UE policy section management result information element consists of one or several UE policy section management subresults.
UE policy section management subresult: Number of results (octet d) This field contains the binary encoding of number of results included in the UE policy section management subresult.
MCC, Mobile country code (octet d+1, and bits 4 to 1 of octet d+2) The MCC field is coded as in ITU-T Recommendation E.
212 , annex A.
MNC, Mobile network code (bits 8 to 5 of octet d+2, and octet d+3) The coding of this field is the responsibility of each administration but BCD coding shall only two digits in the MNC, MNC digit 3 shall be coded as "1111".
UE policy section management subresult contents (octets d+4 to y) The UE policy section management subresult contents consist of one or several This field contains the binary encoding of the UPSC.
The value of the UPSC is set by the PCF Failed instruction order (octets f+2 to f+3) This field contains the binary encoding of the order of the failed instruction in the UE policy section management sublist.
The receiving entity shall treat any other value as 0110 1111, "protocol error, unspecified".
UPSI sublist (PLMN 1) UPSI sublist (PLMN 2) UPSI sublist (PLMN N) UPSI list information element Length of UPSI sublist MCC digit 2 MCC digit 1 octet d+2 MNC digit 3 MCC digit 3 octet d+3 MNC digit 2 MNC digit 1 octet d+4 Table D.
: UPSI list information element MCC, Mobile country code (octet d+2, and bits 4 to 1 of octet d+3) The MCC field is coded as in ITU-T Recommendation E.
212 , annex A.
MNC, Mobile network code (bits 8 to 5 of octet d+3, and octet d+4) only two digits in the MNC, MNC digit 3 shall be coded as "1111".
UPSC (octets d+5 to d+6) This field contains the binary encoding of the UPSC.
The value of the UPSC is set by D.
UE policy classmark policy aspects of the UE.
Policy information IEI octet 1 Length of Policy information contents octet 2.
octet 4* -5* Spare UE policy classmark information element Table D.
: UE policy classmark information element Support of ANDSP by the UE (SupportANDSP) (octet 3, bit 1).
0 ANDSP not supported by the UE 1 ANDSP supported by the UE All other bits in octet 3 to 5 are spare and shall be coded as zero, if the respective octet is included in the information element.
UE OS Id The purpose of the UE OS Id information element is to prov ide the network with information about the OS of the UE.
The UE OS Id information element is coded as shown in figure D.
OS Id IEI octet 1 Length of OS Id information contents octet 2 OS Id_1 octets 3 - 18 UE OS Id information element Table D.
: UE OS Id information element defined as Universally Unique IDentifier (UUID) as specified in IETF RFC 4122 [35A].
7 Timers of UE policy delivery service Timers of UE policy delivery service are shown in table D.
1st, 2nd, 3rd, 4th T3501 NOTE 1 Transmission of MANAGE UE POLICY COMMAND MANAGE UE POLICY COMMAND COMPLETE or POLICY COMMAND REJECT message MANAGE UE POLICY COMMAND NOTE 1: The value of this timer is network dependent.
8 Handling of unknown, unforeseen, and erroneous UPDS.
The procedures specified in the subclause apply to those messages which pass the checks described in this subclause.
This subclause also specifies procedures for the handling of unknown, unforeseen, and erroneous UPDS data by the Subclauses D.
shall be applied in order of precedence.
Detailed error handling procedures in the network are implementation dependent and may vary from PLMN to PLMN.
However, when extensions of UPDS are developed, networks are assumed to have the error handling which is indicated in this subclause as mandatory ("shall") and that is indicated as strongly recommended ("should").
Also, the error handling of the network is only considered as mandatory or strongly recommended when certain For definition of semantical and syntactical errors see 3GPP specification document , subclause 1 D.
Message too short or too long D.
Message too short D.
Message too long D.
Unknown or unforeseen procedure transaction identity D.
Procedure transaction identity The following network procedures shall apply for handling an unknown, erroneous, or unforeseen PTI received in a UPDS message: any PTI in use, the network shall ignore the UPDS message.
ignore the UPDS message.
Unknown or unforeseen message type type not defined for the UPDS, see 3GPP specification document .
Non-semantical mandatory information element errors a) an "imperative message part" error; or b) a "missing mandatory IE" error a) a syntactically incorrect mandatory IE; b) an IE unknown in the message, but encoded as "comprehension required" (see 3GPP specification document\); or c) an out of sequence IE encoded as "comprehension required" (see 3GPP specification document\) is received, the UE shall ignore the UPDS message; the network shall proceed as follows: 1) try to treat the message (the exact further actions are implementation dependent); or 2) ignore the message.
Unknown and unforeseen IEs in the non-imperative message part D.
IEIs unknown in the message The network shall take the same approach.
The network should take the same approach.
information element is not specified in subclause D.
5, the UE shall handle only the contents of the information element appearing first and shall ignore all subsequent repetitions of the information element.
When repetition of information elements is specified, the UE shall handle only the contents of specified repeated information elements.
If the limit on repetition of information elements is exceeded, the UE shall handle the contents of information elements appearing first up to the limit of repetitions and shall ignore all subsequent repetitions of the information element.
The network should follow the same procedures.
Non-imperative message part errors a) syntactically incorrect optional IEs; and b) conditional IE errors.
Syntactically incorrect optional IEs The network shall take the same approach.
Conditional IE errors a) try to treat the message (the exact further actions are implementation dependent); or b) ignore the message.
Messages with semantically incorrect contents procedural part of subclauses D.
If, however no such reactions are specified, the UE shall ignore the message.
The network should follow the same procedure.
2012 CT1#107 Implementing the following p-CRs agreed by CT1:.
Corrections done by the rapporteur.
review Re-introduction of table in subclause 2012 CT1#108 Implementing the following p-CRs agreed by CT1:.
Corrections done by the rapporteur.
were not implemented correctly in the previous version.
Implementation of C80646 which was missed.
Corrections done by the rapporteur.
2013 CT1#109 Implementing the following p-CRs agreed by CT1:.
Corrections done by the rapporteur.
Reverting to the old title.
Editorial corrections of some of the implemented p-CRs as well as adding Corrections done by the rapporteur.
2013 CT#79 CP-180101 Version created for presentation to TSG CT#79 for information.
Corrections done by the rapporteur.
as well as adding some missing parts.
Corrections done by the rapporteur.
2016 CT1#111 Implementing the following p-CRs agreed by CT1:.
Corrections done by the rapporteur.
Implementation of C83816 which was missed.
Editorial corrections of some of the implemented p-CRs.
Corrections done by the rapporteur.
2016 CT#80 CP-181094 Version created for presentation to TSG CT#80 for approval.
2016 CT#80 Version 1 created after approval 1 2019 CT#81 CP-182138 0006 1 F Referring to the correct bits for SMS over NAS during the registration 2019 CT#81 CP-182133 0016 4 F Correction for maximum data rate per UE for integrity protection for DRBs 1 2019 CT#81 CP-182141 0027 2 F UAC information and establishment cause when uplink user data packet is 2019 CT#81 CP-182131 0035 2 F Authentication for normal services not accepted by network 1 2019 CT#81 CP-182131 0037 2 C Alignment and correction of mapped security context creation at S1 to N1 2019 CT#81 CP-182132 0039 1 F Correction and update of S1 mode to N1 mode NAS transparent container 1 2019 CT#81 CP-182138 0049 2 F Parameters for PDU session establishment due to change of SSC mode 3 or 2 PSA 1 2019 CT#81 CP-182137 0066 F Mapping to configured NSSAI for HPLM shall be included if available 1 2019 CT#81 CP-182130 0069 2 F Abnormal Cases in the UE for mobilty and periodic Registration Update.
2019 CT#81 CP-182136 0076 2 F Handling of Transmission failure for Service request message.
1 2019 CT#81 CP-182136 0077 4 B How to determine the maximum number of established PDU sessions 1 2019 CT#81 CP-182136 0082 2 B Including S-NSSAI received in EPS in Requested NSSAI and in PDU session establishment request upon inter-system change from S1 mode to 2019 CT#81 CP-182142 0084 B UE configuration for NAS signalling low priority via OMA-DM or USIM not applicable in 5GS 1 2019 CT#81 CP-182130 0095 F Abnormal cases in the UE for network-initiated de-registration procedure 1 2019 CT#81 CP-182131 0097 1 F Authentication procedure during registration procedure for mobility and periodic registration update 1 2019 CT#81 CP-182138 0098 4 F Registration procedure for mobility and periodic registration update 1 2019 CT#81 CP-182136 0115 5 F Including SD when Mapped configured SD is included in S-NSSAI 1 2019 CT#81 CP-182138 0124 4 C NW slicing and delayed re-registration due to emergency services 1 2019 CT#81 CP-182140 0138 F Security procedures and handling after inter-system change 1 2019 CT#81 CP-182139 0143 F Resolution of editor's note on UE behaviour in substate 5GMM- 2019 CT#81 CP-182139 0144 F Resolution of editor's note on other sub-states of state 5GMM- 2019 CT#81 CP-182139 0145 3 F Resolution of editor's note on sub-states of state 5GMM-REGISTERED 1 2019 CT#81 CP-182139 0146 1 F Resolution of editor's note on the key derivation function field 1 2019 CT#81 CP-182139 0147 F Resolution of editor's note on security context coordination 1 2019 CT#81 CP-182139 0151 F Resolution of editor's note on handling of unknown, unforeseen, and erroneous protocol data 1 2019 CT#81 CP-182131 0153 2 C AMF taking both EMC and EMC BS availability into account in setting EMF 1 2019 CT#81 CP-182132 0156 2 F Clarification on stopping back-off timers upon reception of NW initiated SM 2019 CT#81 CP-182131 0157 1 F Clarification for registration attempt counter handling and introduction of lower layer failure 1 2019 CT#81 CP-182134 0163 1 F Correction on retry of PDU session establishment procedure 1 2019 CT#81 CP-182130 0166 1 F 5GSM congestion control over AMF on PDU session modification 2019 CT#81 CP-182136 0169 1 B Establishment of N1 NAS signalling connection due to change in the network slicing information 1 2019 CT#81 CP-182138 0170 2 F Release of N1 NAS signalling connection due to change in the network 2019 CT#81 CP-182132 0173 3 F Clarifications on UE 5GSM capabilities and procedures during inter- working 2019 CT#81 CP-182142 0178 2 F UE re-registration when the AMF cannot determine an Allowed NSSAI 1 2019 CT#81 CP-182132 0182 2 C Common NAS security transparent container IE for intra-5G HO and S1 to N1 inter-system HO 1 2019 CT#81 CP-182136 0184 1 F Handling of PDU session type after intersystem change from N1 mode to 2019 CT#81 CP-182137 0190 1 F No EMM parameters handling for DR mode UEs due to rejected service 2019 CT#81 CP-182131 0192 3 F Clarification on activation of UP resources of PDU session 1 2019 CT#81 CP-182130 0194 1 B Access attempt barred for the UE-initiated NAS transport procedure 1 2019 CT#81 CP-182132 0200 4 F Clarify abnormal cases in the UE for independency of 5GMM procedures 2019 CT#81 CP-182136 0206 F Incorrect statement for handling of security context at IWK 1 2019 CT#81 CP-182131 0213 4 F Clarification on network-initiated de-registration procedure 1 2019 CT#81 CP-182132 0215 F Clarification on S-NSSAI based congestion control for PDU session 2019 CT#81 CP-182141 0232 1 F SMS over NAS re-transmission upon delivery failure on one Access Type 1 2019 CT#81 CP-182134 0233 2 F Corrections in EAP based primary authentication procedure (alternative 2) 1 access connected to EPC 1 2019 CT#81 CP-182131 0241 1 F Clarification of N1 NAS signalling connection release in AMF on generic UE configuration update completion 1 2019 CT#81 CP-182139 0242 1 F Requests for emergency services fallback from upper layers 1 2019 CT#81 CP-182135 0245 F Corrections to the Identification and Registration procedures 1.
2019 CT#81 CP-182132 0255 1 C Clarify the method of configuring the UE to use Access Identity 1 1 2019 CT#81 CP-182132 0258 2 F Correction for abnormal cases in the UE of service request procedure 1 2019 CT#81 CP-182140 0259 1 F Setting of RRC establishment cause for operator-defined access categories 1 2019 CT#81 CP-182131 0262 F Alignment with terminology "emergency PDU session" throughout TS 2019 CT#81 CP-182141 0263 1 F TAI removed from list of Servie area lists after reject from network 1 2019 CT#81 CP-182130 0272 2 F Adding procedures for updating local emergency numbers in other modes 1 2019 CT#81 CP-182134 0276 F Correction to the PDU Session ID value in Allowed PDU session status IE 1 2019 CT#81 CP-182138 0277 2 F Reactivation result indicating insufficient resources during service request 2019 CT#81 CP-182142 0280 2 F Updates to RRC fallback indication while in 5GMM-CONNECTED mode, or while in 5GMM-CONNECTED mode with RRC inactive indication 1 2019 CT#81 CP-182138 0282 3 F Removal of 5GSM cause from ePCO for PDU Session Release Complete 1 2019 CT#81 CP-182139 0293 2 F Removal of local PDU session relase statement in UCU procedure 1 2019 CT#81 CP-182140 0295 F Resolution of the editor's note on value of the non-3GPP de-registration 2019 CT#81 CP-182139 0296 F Resolution of editor's note on the format of the authentication parameters 1 2019 CT#81 CP-182140 0297 2 F Resolution of editor's note on unknown or unforeseen PDU session identity 1 2019 CT#81 CP-182139 0298 F Resolution of editor's note on other types of payload for the NAS transport 2019 CT#81 CP-182136 0301 1 B Initial registration not accepted due to serving network not authorized 1 2019 CT#81 CP-182130 0308 F 5GMM STATUS message sent by the AMF when certain error conditions are detected upon receipt of 5GMM protocol data in the AMF 1 via non-3GPP access 1 2019 CT#81 CP-182142 0313 2 F Use of S-NSSAI and session-AMBR provided during the EPS bearer context modification procedure 1 allowed for the target access 1 2019 CT#81 CP-182133 0322 F Correction on acknowledgement handling of UE configuration update 1 2019 CT#81 CP-182136 0346 1 F Handling of PDU session(s) not supporting interworking with EPS 1 2019 CT#81 CP-182131 0351 3 F Clarification on MICO indication and LADN information via generic UE configuration update procedure 1 2019 CT#81 CP-182132 0352 1 F Clarification on the temporary identity in the service request procedure 1 2019 CT#81 CP-182130 0367 1 F Access attempt due to delivery of LPP message/transparent container/UE 2012 CT#82 CP-183032 0274 4 F Correct Extended Local Emergency Numbers List deletion upon PLMN 2012 CT#82 CP-183032 0315 4 F Operator-controlled inclusion of NSSAI in access stratum connection 2012 CT#82 CP-183032 0371 2 F Correction for maximum data rate per UE for integrity protection for DRBs for PDU sessions in non-3GPP access which are transferable to 3GPP 2012 CT#82 CP-183032 0383 1 F Removal of UE security capability from Intra N1 mode NAS container 1 2012 CT#82 CP-183032 0393 1 F Correction for EAP based primary authentication and AUTHENTICATION 2012 CT#82 CP-183032 0403 1 F Signalling Default Configured NSSAI indication in the registration stage 2 terminology 1 2012 CT#82 CP-183032 0405 1 F "SMS subscribed indication" in CONFIGURATION UPDATE COMMAND 1 2012 CT#82 CP-183033 0407 F Continued need to align with terminology "emergency PDU session" throughout specification document 1 2012 CT#82 CP-183033 0408 1 F Ambiguity in the use of the terms "no other parameter" and "no parameters" 1 2012 CT#82 CP-183033 0410 2 F Miscellaneous wording, terminology and reference corrections 1 2012 CT#82 CP-183033 0416 2 F Clarification of "registration requested" in CONFIGURATION UPDATE 2012 CT#82 CP-183033 0417 5 F Updates on steering of roaming handling and information coding 1 2012 CT#82 CP-183033 0419 3 F Security context usage during NAS security mode control procedure 1 2012 CT#82 CP-183033 0421 1 F Correction to UE behavior when disabling N1 mode for non-3GPP access 1 2012 CT#82 CP-183033 0427 1 F S-NSSAI received in Notify payload during PDN connection establishment 2012 CT#82 CP-183033 0428 F No interworking to ePDG/EPC for Ethernet and unstructured PDU sessions 1 2012 CT#82 CP-183033 0434 1 F Applicability of UAC for other cases of NAS message transport 1 2012 CT#82 CP-183034 0438 F UL data status upon fallback indication from lower layers 1 2012 CT#82 CP-183034 0443 1 F Correction to trigger of the mobility and periodic registration update 2012 CT#82 CP-183034 0444 1 F Abnormal cases in the network side for Configuration update prcedure.
1 2012 CT#82 CP-183034 0448 3 F Resetting service request attempt counter upon receipt of the REGISTRATION ACCEPT message 1 2012 CT#82 CP-183034 0450 F Correction in determining sytactic errors for PDU session establishment 2012 CT#82 CP-183034 0461 1 F Applicability of the Service area list IE indicating all TAIs to equivalent 2012 CT#82 CP-183034 0464 1 F Clarification on PDU session transfer from non-3GPP to 3GPP access when 3GPP PS data off UE status is activated 1 2012 CT#82 CP-183034 0465 1 F EAP-Identification in EAP-AKA' primary authentication and key agreement 2012 CT#82 CP-183034 0467 1 F Excluding mobility procedures from ODAC access control checks 1 2012 CT#82 CP-183034 0471 1 F Network initiated de-registration in case of emergency PDU session 1 2012 CT#82 CP-183035 0474 F Resolution of editor's note on operator-defined access category 1 2012 CT#82 CP-183035 0480 F Aborted UE-initiated NAS transport procedure for delivery of SMS/LPP message/UE policy container 1 2012 CT#82 CP-183035 0502 1 F Resolution of editor's notes on abnormal case handling when rejection with "Extended wait time" received from lower layers 1 2012 CT#82 CP-183035 0503 1 F Resolution of editor's note on maximum length of the 5GS mobile identity 2012 CT#82 CP-183035 0507 3 F Correct non-3GPP registration accept procedure when local emergency 2012 CT#82 CP-183035 0511 2 F Abnormal cases for Registration procedure for mobility and periodic 2012 CT#82 CP-183036 0519 1 F Handling on collision of PDU session establishment and release 2012 CT#82 CP-183036 0523 1 F Correction of storage of operator-defined access categories 1 2012 CT#82 CP-183036 0526 F The UE behavior in non-3GPP access and in state ATTEMPTING- 2012 CT#82 CP-183036 0532 F Clarifications on UE behaviour upon receiving RRC fallback indication 1 2012 CT#82 CP-183036 0534 1 F Release of the N1 NAS signalling connection upon Service Accept 2012 CT#82 CP-183036 0535 1 F QoS rules verification during PDU session establishment procedure 1 2012 CT#82 CP-183036 0540 2 F Revisions on N1 NAS signaling connection establishment and release 1 2012 CT#82 CP-183036 0543 1 F UE's homogeneous support of emergency services fallback per RAT 1 2012 CT#82 CP-183036 0544 F Context management for 3GPP access and non-3GPP access due to SR 2012 CT#82 CP-183036 0549 2 F Establishment of secure exchange of NAS messages during inter-system change between N1 mode and S1 mode 1 2012 CT#82 CP-183037 0550 2 D Terminology alignment regarding support for interworking without N26 1 2012 CT#82 CP-183037 0557 2 F Correction of LADN information for generic UE configuration update 2012 CT#82 CP-183037 0559 F Management of the registration attempt counter and the attach attempt counter during inter-system change 1 2012 CT#82 CP-183037 0572 2 F Service area restrictions applicable for PLMNs in registration area 1 2012 CT#82 CP-183037 0577 3 F UAC - providing access identities for barring checks of AS triggered access 2012 CT#82 CP-183037 0584 F Correction on Maximum number of supported packet filters 1 2012 CT#82 CP-183038 0591 2 F Clarifications on NAS level mobility management congestion control 1 2012 CT#82 CP-183038 0593 1 F Handling of target CN type by NAS upon redirection to E-UTRA cell 1 2012 CT#82 CP-183038 0595 1 F Sending of 5GSM capability IE and Maximum number of supported packet filters IE in in PDU SESSION ESTABLISHMENT REQUEST with request type "existing PDU session" 1 2012 CT#82 CP-183038 0604 2 C Clarification on congestion control upon intersystem change 1 2012 CT#82 CP-183038 0608 1 F Abnormal cases in the network side for Configuration update prcedure.
1 2012 CT#82 CP-183038 0609 1 F Abnormal cases in the UE side for Configuration update prcedure.
1 2012 CT#82 CP-183038 0611 1 F Correction to QoS rules verification during PDU session establishment.
1 2012 CT#82 CP-183038 0613 1 F QoS flow descriptions IE to be set by SMF mandatory in PDU establishment accept for initial request.
1 2012 CT#82 CP-183038 0623 2 F Procedure collision handling in paging and notification procedure 1 2012 CT#82 CP-183039 0625 F Correction on 'E' bit for deleting QoS flow description 1 2012 CT#82 CP-183039 0627 1 F Registration rejected because of non-3GPP access to 5GCN is not allowed 1 2012 CT#82 CP-183039 0631 1 F CONFIGURATION UPDATE COMMAND with no parameters other than 2012 CT#82 CP-183039 0641 3 F Handling errors due to missing QoS flow descriptions parameters for GBR 2012 CT#82 CP-183039 0642 2 F Clarification on inclusion of Requested NSSAI during periodic registration 2012 CT#82 CP-183039 0643 1 F The release of the existing N1 NAS signalling connection after UCU 1 2012 CT#82 CP-183039 0648 1 F Clarification on the applicability of service area restrictions to the EPLMNs 1 2012 CT#82 CP-183039 0651 1 F Clarification on handling of PDU sessions associated with 3GPP access and non-3GPP access for interworking 1 2012 CT#82 CP-183040 0655 1 F Clarification on handling of invalid LADN DNN in registration procedure –.
2012 CT#82 CP-183040 0659 F Editorial correction for the generic UE configuration update procedure 1 2012 CT#82 CP-183029 0663 1 F UAC: Correction for operator-defined access categories of 2012 CT#82 CP-183040 0664 2 F Lower layer indication on the establishment/release of user plane 2012 CT#82 CP-183040 0665 3 F Setting the Uplink data status and Service type IEs after receiving a fallback indication from the lower layers 1 2012 CT#82 CP-183040 0667 1 F Adding the case that UE initiates the registration procedure for mobility and 2012 CT#82 CP-183040 0669 2 F Mobility and periodic registration update triggered by indications from lower 2012 CT#82 CP-183040 0674 1 F Correction to operator-defined access category criteria type values 1 2012 CT#82 CP-183040 0679 4 F UE identifier provided during an initial registration procedure 1 2012 CT#82 CP-183040 0682 1 F UE registered for emergency services upon authentication failure 1 2012 CT#82 CP-183040 0683 F Update the trigger of mobility registration update initiation 1 2012 CT#82 CP-183041 0701 F Resolution of editor's note on abnormal case handling for the UE-initiated UE state indication procedure 1 2012 CT#82 CP-183041 0702 1 F Resolution of editor's note on abnormal case handling for the network- requested UE policy management procedure 1 2012 CT#82 CP-183041 0703 F Resolution of editor's note on the information the N3IWF maintains for a 2013 CT#83 CP-190084 0382 9 F Correct Extended Local Emergency Numbers List use involving WLAN 1 2013 CT#83 CP-190084 0638 3 F Clarification for abnormal case handling of registration procedure after inter-system change from S1 mode to N1 mode 1 2013 CT#83 CP-190084 0706 6 F Resolution on the editor's note on abnormal cases in the UE for the PDU EAP message reliable transport procedure 1 2013 CT#83 CP-190084 0721 2 F Clarification on inclusion of the Uplink data status IE in the SERVICE REQUEST message after an RRC fallback indication 1 2013 CT#83 CP-190084 0729 2 F UAC - access attempt matching criteria of operator-defined access 2013 CT#83 CP-190084 0732 2 F 5GSM - request type not included in PDU SESSION ESTABLISHMENT 2013 CT#83 CP-190084 0734 2 F AMF rejecting PDU session establishment when the DNN is not subscribed 1 2013 CT#83 CP-190084 0735 1 F Correction for acknowledgement of extended emergency number list 1 2013 CT#83 CP-190085 0754 1 F QoS flow description to be added in PDU session modification command 1 2013 CT#83 CP-190085 0767 1 F Addition of the 5GSM cause IE in the PDU SESSION MODIFICATION 2013 CT#83 CP-190085 0771 2 F Adding missing abnormal cases for initial registration (UE side) 1 2013 CT#83 CP-190085 0773 3 F Removal of UE security capabilities from the S1 mode to N1 mode NAS 2013 CT#83 CP-190085 0774 2 F Clarification on NSSAI inclusion mode after an inter-system change from S1 mode to N1 mode 1 2013 CT#83 CP-190085 0785 1 F Removal of abnormal case handling for collision between initial registration and paging or notification 1 2013 CT#83 CP-190085 0791 2 F Generic UE configuration update procedure during registration procedure 1 indication from the lower layers 1 2013 CT#83 CP-190086 0802 3 F Handling of QoS flow description without valid EPS bearer contextt 1 2013 CT#83 CP-190086 0810 1 F Clarification on the behaviors of UE and SMF during the inter-system 2013 CT#83 CP-190086 0821 1 F Informing the UE about the integrity protection failure at S1 to N1 mode 2013 CT#83 CP-190086 0823 1 F Handling of abnormal case when UE gets UE policies with incorrect PLMN 2013 CT#83 CP-190174 0833 4 F Possible criterion for the selection of the requested NSSAI 1 2013 CT#83 CP-190087 0839 1 F Update the conditions on the AMF to provide the configured NSSAI to the 2013 CT#83 CP-190087 0845 1 F Removal of Editor’s note on home network public key and home network public key identifier update and removal of protection scheme identifier 1 2013 CT#83 CP-190087 0846 1 F Update of PDU session authentication and authorization messages 1 2013 CT#83 CP-190087 0847 2 F Update of error handling for Mapped EPS bearer contexts IE 1 2013 CT#83 CP-190087 0854 1 F 3GPP PS Data Off UE status change and congestion control in AMF - 2013 CT#83 CP-190088 0863 F Initial maximum number of packet filters for associated PDU session 1 2013 CT#83 CP-190088 0864 1 F SUCI to be used for the registration for emergency services 1 2013 CT#83 CP-190088 0867 F Correction to the inclusion of requested QoS rule and requested QoS flow descripstion in PDU session modification request.
1 2013 CT#83 CP-190088 0873 1 F Transmission failure at UE side for UE policy delivery procedure 1 2013 CT#83 CP-190088 0885 1 F Addressing missing scenarios and providing other clarifications related to 2013 CT#83 CP-190088 0888 2 F Handling when the UE indicated security capabilities are invalid or 2013 CT#83 CP-190088 0889 1 F Correction in UE-initiated de-registration procedure initiation 1 non-existent QoS rule 1 2013 CT#83 CP-190088 0895 1 F Improvement on 5G-GUTI allocation after network triggered service request 1 2013 CT#83 CP-190089 0901 1 F Clarification on congestion control upon intersystem change 1 exchanged via 3GPP access 1 reselecting an EPLMN cell 1 2013 CT#83 CP-190089 0912 1 F Change of N1 mode capability on UE mode change or on IMS availability REGISTRATION REQUEST message during an initial registration is not available in Rel-15 1 2013 CT#83 CP-190209 0915 3 F Correction to the REGISTRATION REQUEST msg when the Payload container IE is included 1 2013 CT#83 CP-190089 0922 F Use of stored NSSAI inclusion mode during initial registrationt 1 2013 CT#83 CP-190089 0923 F Correction to the Operator-defined access category definitions IE t 1 2013 CT#83 CP-190089 0933 F Handling of Replayed S1 UE security capabilities IE in Security Mode 2013 CT#83 CP-190089 0934 2 F Clarifications on use of PCF-provided PTI for UE policies delivery 1 2013 CT#83 CP-190101 0720 1 F Initiation of Service Request after reception of Notification over non-3GPP while the UE is in 5GMM-CONNECTED mode with RRC inactive indication in the 3GPP access 1 2013 CT#83 CP-190101 0782 1 F 5G-GUTI as additional guti in initial registration and UE holds 4G-GUTI 1 2013 CT#83 CP-190101 0786 1 D Consistent description on release of N1 NAS signalling connection 1 2013 CT#83 CP-190101 0789 4 F Handling of indication to the 5GSM sublayer in case of 5GSM message not forwarded to SMF due to service area restrictions 1 2013 CT#83 CP-190101 0840 F Update the conditions on the AMF to provide an allowed NSSAI based upon the default S-NSSAI(s) 1 2013 CT#83 CP-190101 0865 2 F Clarfication on allowed NSSAI storage in Non Volatile Memory 1 2013 CT#83 CP-190101 0866 1 F UE state at lower layer failure on the NW side at initial registration 1 2013 CT#83 CP-190101 0896 F Correction on deriving mapped EPS security context for EPC interworking in connected mode 1 2013 CT#83 CP-190101 0897 1 F Correction on abnormal case handlng at AMF for registration 1 2013 CT#83 Completion of de-implementation of CR468 1 2016 CT#84 CP-191147 0936 B Interworking of Ethernet PDU session to Ethernet PDN connection 1 2016 CT#84 CP-191124 0948 2 A Precedence between access identities for derivation of RRC establishment cause and for derivation of establishment cause for non-3GPP access 1 2016 CT#84 CP-191132 0950 F Corrections to the length of the SOR transparent container and UE parameters update transparent container 1 2016 CT#84 CP-191132 0955 1 F Correction on the descriptions of 5GSM parameters and capabilities 1 2016 CT#84 CP-191148 0963 3 B Adding support for SNPNs (Stand-alone Non-Public Networks) 1 2016 CT#84 CP-191132 0964 F Clarification on LADN information for the registered and equivalent PLMNs 1 2016 CT#84 CP-191129 0975 3 B Service Gap control in 5GS, activation with IE and indication flag 1 2016 CT#84 CP-191129 0980 1 B General Description for Restriction on use of enhanced coverage 1 2016 CT#84 CP-191129 0981 1 B Updates to Registration procedure for Restriction on use of enhanced 2016 CT#84 CP-191132 0998 5 B UE behaviour upon receiving non-integrity protected NAS reject messages 2016 CT#84 CP-191217 1000 5 A Multiple NAS connections and 5G NAS security context change handling 1 2016 CT#84 CP-191132 1018 6 F UE-requested PDU session modification procedure and exemption 2016 CT#84 CP-191138 1021 4 B Update PDU session establishment procedure to support MA PDU session 1 2016 CT#84 CP-191132 1029 2 F Correction of requirements for the handling of access barring 1 2016 CT#84 CP-191129 1030 2 B Strictly periodic registration timer indication for MICO mode 1 2016 CT#84 CP-191133 1047 F Exception in suspension of 5GSM procedures in case of ongoing 5GMM procedures: Service request procedure initiated during connected mode 1 2016 CT#84 CP-191124 1050 1 A PDU SESSION ESTABLISHMENT message sent via target access in case of handover of an existing PDU session between 3GPP access and non- 2016 CT#84 CP-191133 1060 2 F Correction on UE handling for network initiated de-registration with #22 1 2016 CT#84 CP-191133 1070 F Including the other cases in [S-NSSAI, DNN] combination back-off timer 1 2016 CT#84 CP-191124 1075 2 A Resolution of editor's notes on handling at emergency registration and emergency PDU sessions 1 2016 CT#84 CP-191133 1096 2 F Correction on associating default EPS bearer with the default QoS rule 1 2016 CT#84 CP-191133 1107 1 F Correction of term “user preference” to “UE local configuration” for inter- system change without N26 1 2016 CT#84 CP-191133 1114 2 F Modification of the maximum number of supported packet filters 1 2016 CT#84 CP-191133 1115 1 F 5GS-EPS interworking for Multi-homed IPv6 PDU Session not supported 2016 CT#84 CP-191133 1118 3 F UE-requested PDU session modification for emergency PDU session 1 2016 CT#84 CP-191122 1121 3 A Access control and indication that access barring is applicable for all access categories except categories '0' and '2' 1 2016 CT#84 CP-191148 1134 1 B Adding support for unified access control in SNPNs (Stand-alone Non.
2016 CT#84 CP-191134 1135 1 D The phrase “outside the scope of the present document” is not used 2016 CT#84 CP-191134 1146 3 F Correction of inconsistent requirements for the use of SUCI 1 2016 CT#84 CP-191134 1147 1 F Disabling of N1 mode capability after emergency services fallback 1 2016 CT#84 CP-191134 1149 1 F Clarification on disabling N1 mode capability when there is persistent PDU 2016 CT#84 CP-191123 1151 1 A Indicating PS data off status report for the UE in the Non-allowed Area 1 2016 CT#84 CP-191134 1156 1 F Clarification of "registration requested" with no other parameters 1 2016 CT#84 CP-191134 1160 F Clarification on the length of the key stream for initial NAS message 2016 CT#84 CP-191207 1162 4 F Applicability of the allowed NSSAI in an equivalent PLMN outside the UE’s more than 2 octets 1 2016 CT#84 CP-191134 1176 1 F Correction to PDU session authentication result transport procedure.
1 2016 CT#84 CP-191134 1177 1 F Clarification for transfter of PDU session for LADN to EPS.
1 2016 CT#84 CP-191134 1178 1 F Correction to De-registration and registration procedure collision 1 2016 CT#84 CP-191134 1180 2 F Added detailed description for substates INITIAL-REGISTRATION- NEEDED and UPDATE-NEEDED 1 2016 CT#84 CP-191123 1206 1 A Deletion of the 5GSM cause IE in the PDU SESSION MODIFICATION 2016 CT#84 CP-191135 1207 1 F Correction on the abnormal cases for registration procedure 1 2016 CT#84 CP-191129 1210 F Alignment of the Abnormal cases for eDRX between 5GS and EPS 1 2016 CT#84 CP-191122 1219 2 A Alignment of the 5G ciphering and integrity algorithm identifiers 1 2016 CT#84 CP-191135 1220 2 F Conditions to apply the "null-scheme" to generate the SUCI 1 2016 CT#84 CP-191135 1227 2 F Transmission failure of Registration Request during Initial Reg proc 1 2016 CT#84 CP-191135 1239 1 F Handling of multiple QoS rule/flow parameters included in one PCO/ePCO 1 2016 CT#84 CP-191124 1245 1 A Indication of syntactical or semantic errors related to SM policy association 2016 CT#84 CP-191135 1246 3 F Clean-up of general section for 5GMM aspects of network slicing 1 2016 CT#84 CP-191135 1247 F Request from the upper layers to perform emergency service fallback 1 2019 CT#85 CP-192056 1270 1 F Handling the non-current 5G NAS security context after inter-system change from N1 mode to S1 mode 1 2019 CT#85 CP-192073 1273 F Updates to new stage-2 requirements of CAG information structure 1 2019 CT#85 CP-192059 1276 2 F Management of service area restrictions in wireline access 1 2019 CT#85 CP-192056 1288 1 F Core network type restriction determined by operator policy 1 2019 CT#85 CP-192060 1297 1 B MA PDU session establishment reject due to unstructured PDU Session 2019 CT#85 CP-192056 1302 3 F Staying in inactive upon resume failure with RRC staying in 2019 CT#85 CP-192056 1326 F Correction wrt EPS attempt counter to be used for Single Registration Failure use cases 1 2019 CT#85 CP-192056 1328 F Correction on terminology regarding EPS bearer contextst 1 2019 CT#85 CP-192056 1330 1 F Correction to SM procedures for back off timer not forwarded from 5GMM 2019 CT#85 CP-192056 1332 F Deletion of RAND and RES on receiving Service Accept message 1 2019 CT#85 CP-192083 1336 1 B Addition of location service message condition to Additional informaton IE 1 2019 CT#85 CP-192071 1341 F Keep equivalent PLMNs list for Deregistration Request message with 5GMM cause #7 1 2019 CT#85 CP-192056 1344 F Correction to handling of operator-defined access category missing a standardized access category 1 2019 CT#85 CP-192057 1353 1 F Re-ordering of text on the applicability of access identities 1 2019 CT#85 CP-192057 1354 1 F Trigger for NAS procedure retry in case NAS is put back in RRC inactivet 1 2019 CT#85 CP-192069 1356 1 B Signalling of UE support for RACS and of UE radio capability ID 1 2019 CT#85 CP-192073 1358 1 B Signalling of UE support for transfer of port management information containers, MAC address and DS-TT residence time 1 2019 CT#85 CP-192073 1359 2 B Adding support for transfer of Ethernet port management information 2019 CT#85 CP-192073 1360 1 F Removal of Editor’s note on adding unified access control configuration to "list of subscriber data" for access to SNPNs 1 2019 CT#85 CP-192073 1361 2 F Resolution of Editor’s notes on abnormal case handling for UE-initiated de- registration procedure in an SNPN 1 2019 CT#85 CP-192073 1363 1 F Resolution of Editor’s notes on the applicability of MPS, MCS and delay tolerant in SNPNs 1 2019 CT#85 CP-192073 1364 1 F Update of requirements on UE to construct packet filters based on the N3IWF destination IP address and the SPI for the IPsec SA 1 2019 CT#85 CP-192052 1366 F Resolve Editor’s note on support indication for Small Data Rate Control 1 2019 CT#85 CP-192052 1370 1 F General description on redirection of the UE by the core network 1 2019 CT#85 CP-192052 1385 2 F Service gap control, stop of timer via configuration update command 1 2019 CT#85 CP-192052 1386 F Service gap control, MO service request when connected and timer running 1 2019 CT#85 CP-192052 1387 2 C Service gap control, follow-on request indicator at mobility update 2019 CT#85 CP-192052 1388 2 2 Service gap control, follow-on request indicator at initial registration 1 2019 CT#85 CP-192052 1391 F MICO mode and stop of active timer in AMF when UE enters 5GMM- 2019 CT#85 CP-192062 1395 3 C Registration reject due to no available allowed S-NSSAI(s) 1 2019 CT#85 CP-192052 1396 1 F Service gap control, MO SMS or LPP payload not allowed when connected 1 2019 CT#85 CP-192060 1425 1 F Updates to UE-requested PDU session procedures for converting to MA 2019 CT#85 CP-192059 1427 2 F Applicability of unified access control for wireline 5G access network 1 2019 CT#85 CP-192073 1460 2 C Shared network broadcasting PLMN identity(ies) or SNPN identity(ies) 1 2019 CT#85 CP-192057 1461 2 F Alignment on the implication description of type of list = “11” in service area 2019 CT#85 CP-192073 1470 2 B Port management information container: Delivery via the NAS protocol and 2019 CT#85 CP-192054 1474 2 F Update the UE-requested PDU session establishment procedure regarding always-on PDU session for URLLC service 1 2019 CT#85 CP-192054 1476 2 F Update the network-requested PDU session modification procedure regarding always-on PDU session for URLLC service 1 2012 CT#86 CP-193094 1284 2 F Handling of unknown, unforeseen, and erroneous UPDS data in UE policy 2012 CT#86 CP-193094 1327 4 F Handing of 5GMM parameters during certain mobility registration failurest 1 2012 CT#86 CP-193094 1342 2 F Local release when receiving REFRESH command for routing indicator in 2012 CT#86 CP-193094 1349 3 F UAC check for services started in WLAN and being transferred to 3GPP 2012 CT#86 CP-193094 1373 4 F Maintenance of forbidden TA lists for non-integrity protected NAS reject 1 2012 CT#86 CP-193094 1400 3 F Correction on handling and coding of Mapped EPS bearer contexts 1 2012 CT#86 CP-193115 1403 1 F Correction on the condition for handling reattempt for PDU session type parameter update counter 1 2012 CT#86 CP-193095 1433 3 F Correction and clarification of interworking with ePDG connected to EPC 1 2012 CT#86 CP-193118 1469 3 C PDU session used for TSC established as an always-on PDU session 1 2012 CT#86 CP-193095 1489 F Correction of statement related to K'AMF derivation during S1 to N1 and Non-3GPP accesst 1 2012 CT#86 CP-193101 1504 2 F MA PDU session rejection due to operator policy and subscription policy 1 2012 CT#86 CP-193104 1505 6 C Introduction of pending NSSAI for network slice-specific authentication and 2012 CT#86 CP-193089 1506 1 F Resolving Editor’s Note for need of new EPD in CPSR message 1 2012 CT#86 CP-193089 1507 1 F Resolving Editor’s Note on whether CIoT small data container IE can be TV format in CPSR message 1 2012 CT#86 CP-193118 1510 3 B Primary authentication using EAP methods other than EAP-AKA' and EAP- 2012 CT#86 CP-193088 1519 4 F Abnormal case handling for uplink NAS transport for non-supporting UEs 1 2012 CT#86 CP-193088 1520 2 F Applicability of existing emergency PDU session request type 1 2012 CT#86 CP-193118 1523 F Corrections on the Port management information container IE 1 2012 CT#86 CP-193104 1526 6 F Deregistration due to the failed network Slice-Specific Authentication and.
2012 CT#86 CP-193088 1532 1 C Control plane service request message and abnornal cases on the network 2012 CT#86 CP-193104 1542 F Reset of registration attempt counter at registration reject with cause #62 1 2012 CT#86 CP-193095 1546 1 F Corrrection to the notification procedure and collision with UE initiated de- 2012 CT#86 CP-193089 1548 1 F Service gap control, simultaneous registration over N3GPP access in same 2012 CT#86 CP-193104 1549 3 F Registration reject due to no allowed slices and NW slice specific authentication and authorization 1 2012 CT#86 CP-193118 1555 2 F 5GMM cause value #74 and requirements for non-integrity protected reject received without integrity protection 1 2012 CT#86 CP-193118 1559 F Reset of the registration attempt counter upon receipt of NPN-based cause 2012 CT#86 CP-193118 1565 F Correction to name of IE carrying residence time for TSN 1 2012 CT#86 CP-193101 1580 1 F Provision of MA PDU session information during the UE-initiated NAS transport procedure initiation 1 2012 CT#86 CP-193089 1585 1 C Resolving Editor’s notes on the Data Type field for the Control Plane Service Request message 1 2012 CT#86 CP-193104 1598 4 B "S-NSSAI not available in the current PLMN" when non NSSAA supported UE requesting the S-NSSAI subjects to NSSAA 1 2012 CT#86 CP-193106 1619 1 B Release of NAS signalling connecti on for the UE authorized for V2X communication over PC5 1 2012 CT#86 CP-193088 1623 2 F Control plane service request, correction regarding service accept 2012 CT#86 CP-193096 1628 4 F Unified Access Control for IMS registration related signalling 1 2012 CT#86 CP-193096 1633 1 B Handling of non-integrity protected rejects when registered 1 2012 CT#86 CP-193101 1636 D Editorial on PDU session establisment request upgraded to MA PDU 2012 CT#86 CP-193096 1650 D Editorial corrections to text related to the status of PDU sessions during SR 2012 CT#86 CP-193089 1651 1 F Short MAC and ngKSI in Control plane service request NAS message 1 2012 CT#86 CP-193089 1657 2 B Introduction of NSSAI efficient signalling for IoT devices 1 2012 CT#86 CP-193104 1658 1 C Removal of Editor’s note on conditions of accepting registration 1 2012 CT#86 CP-193088 1661 F AMF behaviour for mobility registration when SGC timer running 1 2012 CT#86 CP-193096 1665 1 F Correction of handling of de-registration procedure in ATTEMPTING-.
– Option 1 1 2012 CT#86 CP-193169 1676 2 F Equivalent SNPNs not supported for stand-alone non-public networks 1 2012 CT#86 CP-193096 1680 F 5GMM state in non-3GPP access not impacting EMM state of single- 2012 CT#86 CP-193096 1681 1 F Registration attempt counter reset by single-registered UE 1 2012 CT#86 CP-193100 1685 C Access stratum connection and user-plane resources for trusted non-3GPP access and wireline access 1 2012 CT#86 CP-193100 1686 1 B Usage of PDU session identity for the PDU sessions requested by the 2012 CT#86 CP-193106 1692 1 B UPDS updates enabling UE-requested V2X policy provisioning procedure 1 2012 CT#86 CP-193090 1705 1 B Transfer of Ciphering Key Information for Broadcast Location Assistance.
2012 CT#86 CP-193090 1710 1 F Sending location services data from 5GMM-IDLE mode using the Control Plane Service Request message 1 2012 CT#86 CP-193119 1717 3 F Removal of CAG suscription while emergency PDU session is established.
1 2012 CT#86 CP-193097 1731 F Inclusion of PDU session reactivation result error cause IE 1 2012 CT#86 CP-193088 1742 1 C CIoT user data container in UL NAS transport message not routable 1 2012 CT#86 CP-193089 1744 1 C Service gap control, supporting UE sends MO user data when connected when timer running 1 2012 CT#86 CP-193088 1749 2 F Correction on the condition for including CP only indication 1 2012 CT#86 CP-193106 1753 1 C Access control for UE triggered V2X policy provisioning procedure 1 2012 CT#86 CP-193119 1756 2 C Introduction of SNPN-specific attempt counter for non-3GPP access and counter for "the entry for the current SNPN considered invalid for non- 3GPP access" events 1 2012 CT#86 CP-193119 1758 1 F Maintenance of forbidden TA lists for non-integrity protected NAS reject in 2012 CT#86 CP-193097 1759 1 F Handling of UAC for an MO IMS registration related signalling 1 2012 CT#86 CP-193097 1760 D Correction of the definition of Network slicing information 1 2012 CT#86 CP-193101 1778 1 D Editorial on PDU session establisment request upgraded to MA PDU 2023 CT#87e CP-200117 1533 6 C NW slice specific authentication and authorization failure and revocation 1 2023 CT#87e CP-200107 1672 4 C Handling of user-plane resources for NB-IoT UEs having at least two PDU 2023 CT#87e CP-200113 1689 2 C Secondary authentication and W-AGF acting on behalf of FN-RG 1 2023 CT#87e CP-200111 1781 3 F Correcting unimplementable condition regarding N26 interworking support 2023 CT#87e CP-200111 1784 2 F Maintain Selected EPS NAS security algorithms during N1 mode to N1 2023 CT#87e CP-200111 1786 1 D Editorial correction of an input parameter for 5G NAS message integrity 2023 CT#87e CP-200111 1789 1 F Correction to sending of EPS NAS message container in Registration 2023 CT#87e CP-200111 1810 1 F Inclusion of PDU session reactivation result error cause IE 1 2023 CT#87e CP-200111 1812 2 F Deletion of the rejected NSSAI for the current registration area 1 2023 CT#87e CP-200112 1829 2 F Corrections on UE-initiated NAS transport procedure initiation 1 2023 CT#87e CP-200112 1837 1 F Optional IE description for release assistance indication IE 1 2023 CT#87e CP-200112 1839 1 F S-NSSAI value associated with the BO timer applied for all PLMNs 1 SESSION MODIFICATION REQUEST message 1 2023 CT#87e CP-200112 1842 F Correction in handling of persistent PDU session during the mobility 2023 CT#87e CP-200112 1845 2 F Reject non-emergency PDU session request attempt while UE registered for emergency services in the network 1 2023 CT#87e CP-200112 1853 3 F Service area restrictions, case missing for when UE is out of allowed tracking area list and RA 1 2023 CT#87e CP-200113 1871 F Resolving editor's note on W-AGF acting on behalf of FN-RG not using the "null integrity protection algorithm" 5G-IA0 1 2023 CT#87e CP-200113 1872 F Resolving editor's note on service area restrictions in case of FN-BRG 1 2023 CT#87e CP-200113 1873 F Resolving editor's note in forbidden wireline access area 1 2023 CT#87e CP-200113 1876 F Alignment for stop of enforcement of mobility restrictions in 5G-RG and W- AGF acting on behalf of FN-CRG 1 2023 CT#87e CP-200130 1882 F Removal of Editor’s note on the use of the NOTIFICATION message in 2023 CT#87e CP-200135 1884 3 B Including CAG information list in REGISTRATION ACCEPT message 1 2023 CT#87e CP-200125 1886 F Removal of Editor’s note on applicability of RACS to SNPNs 1 2023 CT#87e CP-200107 1907 3 B Support for the signalling of the capability for receiving WUS assistance 2023 CT#87e CP-200113 1910 3 F Enabling mobility with (emergency) sessions/connections between the (trusted) non-3GPP access network connected to the 5GCN and the E- 2023 CT#87e CP-200117 1913 1 F UE behaviour for other causes in the rejected NSSAI during deregistration 2023 CT#87e CP-200117 1914 1 F Pending NSSAI update for the configured NSSAI in the CUC message 1 2023 CT#87e CP-200107 1934 1 F Correction on SMS in payload container IE in CPSR message 1 2023 CT#87e CP-200130 1938 F Reset the registration attempt counter for #76 in service reject 1 2023 CT#87e CP-200130 1945 1 F Clarification on Public Network Integrated NPN in specification document 1 2023 CT#87e CP-200130 1947 2 F Establish PDU session to transfer port management information containers 1 2023 CT#87e CP-200117 1958 F Correction UE behaviour when the UE recives the pending NSSAI 1 2023 CT#87e CP-200107 1961 1 F Adding an editor’s note for suspend indication due to user plane CIoT 5GS 2023 CT#87e CP-200107 1966 1 C Recovery from fallback for UEs using CP CIoT optimization 1 2023 CT#87e CP-200119 1968 B Triggering service request procedure for V2X communication over PC5 2023 CT#87e CP-200114 1976 1 B Considering allowed NSSAI when establishing MA PDU session 1 2023 CT#87e CP-200107 1978 1 F Correction to UL CIoT user data container not routable or not allowed to be 2023 CT#87e CP-200107 1979 1 F Single downlink data only indication and release of N1 NAS signalling 2023 CT#87e CP-200107 1980 2 F PDU session status with control plane service request message 1 2023 CT#87e CP-200107 1981 1 F Service gap control, correction when to start service gap control timer in UE 2023 CT#87e CP-200107 1982 1 F Clarification of control plane service request message options 1 2023 CT#87e CP-200109 1987 1 F Setting the Always-on PDU session indication IE in the PDU SESSION ESTABLISHMENT ACCEPT message 1 2023 CT#87e CP-200117 1997 F Additional conditions to the presence in the subscribed S-NSSAIs 1 2023 CT#87e CP-200130 1998 1 F Triggering mobility registration update due to manual CAG selection 1 2023 CT#87e CP-200125 2005 1 F Additional condition to change UE radio capability ID during mobility 2023 CT#87e CP-200125 2006 1 F UE radio capability information storage not needed for RACS 1 2023 CT#87e CP-200130 2017 1 F No mandate to support default configured NSSAI or network slicing 2023 CT#87e Addition of IEI values, editorial corrections, implementation of missing 2026 CT#88e CP-201102 0793 9 F Inclusion of ATTACH REQUEST message in REGISTRATION REQUEST message during initial registration when 5G-GUTI mapped from 4G- GUTI is 2026 CT#88e CP-201102 1379 6 F Corrections on the abnormal cases of registration procedure for initial 2026 CT#88e CP-201113 1734 2 F S-NSSAI in rejected NSSAI for the failed or revoked NSSAA not to be 2026 CT#88e CP-201102 1782 5 F Correcting transfer of connections/sessions if there is an emergency call 1 2026 CT#88e CP-201102 1792 2 F Restricting handling of cause #9 to the access on which it was received 1 2026 CT#88e CP-201102 1795 3 F Clarification on use of operator-defined access categories 1 2026 CT#88e CP-201136 1880 2 C CAG-ID not provided to lower layers during NAS signalling connection 2026 CT#88e CP-201113 1912 5 C Deleting Editors note regarding indefinite wait at the UE for NSSAA 2026 CT#88e CP-201109 2027 B EPS interworking of MA PDU session of 5G-RG when N26 is not supported 1 2026 CT#88e CP-201108 2028 1 F Secondary authentication and W-AGF acting on behalf of N5GC device 1 2026 CT#88e CP-201096 2031 F Integrity protection data rate for UEs that don’t support N3 data transfer 1 2026 CT#88e CP-201096 2032 F Addition of Control Plane Service Request in the abnormal cases for service request procedure 1 2026 CT#88e CP-201132 2033 F Correction of certain erroneous Information Element Identifiers 1 2026 CT#88e CP-201113 2040 1 F Pending NSSAI update for the configured NSSAI in the UCU message 1 2026 CT#88e CP-201113 2043 1 F Missing condition for inclusion of “NSSAA to be performed” indicator 1 2026 CT#88e CP-201113 2058 3 F Clarifying the description for Network Slice-Specific Authorization.
2026 CT#88e CP-201136 2065 F temporarily and permanently forbidden SNPNs lists per access type 1 2026 CT#88e CP-201096 2077 1 C Generic UE configuration update trigger for registration and EC Restriction 2026 CT#88e CP-201113 2079 1 F Clarify that NSSAA can occur during periodic registration or mobility updating for NB-N1 mode UEs 1 2026 CT#88e CP-201113 2084 1 F Alignment of UE actions of rejected NSSAI for the failed or revoked NSSAA 1 2026 CT#88e CP-201136 2087 1 C Addition of CAG information list in registration reject message.
1 2026 CT#88e CP-201113 2089 1 F Exception to initiate the service request procedure during NSSAA when there is no allowed NSSAI 1 2026 CT#88e CP-201113 2091 1 F Missing condition at registration reject due to no available slices 1 2026 CT#88e CP-201102 2095 F Correct parameters included by AMF during inter-system change from S1 mode to N1 mode in 5GMM-CONNECTED mode 1 2026 CT#88e CP-201102 2096 F Remove invalid cases in error handling for QoS rule operation and TFT 2026 CT#88e CP-201102 2104 1 F Network triggered service request procedure over non-3GPP access 1 2026 CT#88e CP-201113 2108 3 C Updating Rejected NSSAI IE for failed NSSAA case in roaming scenerios 1 2026 CT#88e CP-201102 2110 F Consider PDU session type IE set by UE in IP address allocation 1 2026 CT#88e CP-201096 2114 1 F CIoT user or small data container in CPSR message not forwarded 1 2026 CT#88e CP-201103 2121 2 F Initial registration for initiating emergency PDU session 1 2026 CT#88e CP-201103 2122 3 F Missing QoS flow description parameters for GBR QoS flows in 5GSM and 2026 CT#88e CP-201096 2130 1 F Correction on terminology for the Control plane CIoT 5GS optimization 1 2026 CT#88e CP-201096 2132 1 F Handling of PDU session and PDN connection associated with Control plane only indication in case of N26 based interworking procedures 1 2026 CT#88e CP-201136 2134 1 F Non-integrity protected REGISTRATION REJECT message including substate operating in SNPN access mode 1 2026 CT#88e CP-201103 2161 1 F Correction to conditions for including the S-NSSAI(s) from default NSSAI in the requested NSSAI 1 2026 CT#88e CP-201096 2164 1 B Signalling of EPS APN rate control parameters during PDU session 2026 CT#88e CP-201096 2174 F NAS-MAC calculation for RRC connection reestablishment for NB-IoT CP 2026 CT#88e CP-201114 2181 F Term on rejected NSSAI for the failed or revoked NSSAA 1 2026 CT#88e CP-201103 2187 1 F Correction to criteria to enter 5GMM-REGISTERED.
UPDATE-NEEDED substate after resumption failure 1 2026 CT#88e CP-201103 2192 F Correcting that 5G NAS integrity key is one of the input parameters for integrity protection algorithm 1 2026 CT#88e CP-201103 2197 F De-registration before initial registration for Emergency Services 1 2026 CT#88e CP-201103 2198 2 F Handling of allowed NSSAI when the RA includes the TAI belonging to 2026 CT#88e CP-201103 2202 1 F UE behaviour when the UE receives the rejected NSSAI for the current RA 2026 CT#88e CP-201109 2203 1 B Handlings of MA PDU session when deregistration from an access 1 2026 CT#88e CP-201103 2204 F Indicate support of ePCO length of two octets parameter when establishing the PDU session – Alt#2 1 2026 CT#88e CP-201108 2219 F Stop of enforcement of wireline access service area restrictions and forbidden wireline access area 1 2026 CT#88e CP-201104 2221 F Incorrect set up of PDN type in inter-system change from S1 mode to N1 2026 CT#88e CP-201311 2229 2 F Resolve EN for Ciphering Key data IE regarding positioning SIBs 1 2026 CT#88e CP-201104 2230 1 F MICO indication needs to be included without Network Slicing Subscription Change Indication in UCU.
1 2026 CT#88e CP-201104 2231 2 F Conditions for use of S-NSSAIs after receiving Rejected NSSAI Conditions for use of S-NSSAIs after receiving Rejected NSSAI 1 2026 CT#88e CP-201114 2232 2 F Default S-NSSAI not subject to network slice-specific authentication and 2026 CT#88e CP-201114 2233 3 F Performing network slice-specific re-authentication and re-authorisation 1 2026 CT#88e CP-201127 2241 1 F Avoiding too frequent registration procedures due to signalling of UE radio 2026 CT#88e CP-201106 2250 F Store the received S-NSSAI via ePDG in the configured NSSAI 1 2026 CT#88e CP-201104 2255 1 F Clarification of the forbidden PLMN list used for non-3GPP access 1 2026 CT#88e CP-201104 2256 F Re-enabling the N1 mode capability upon request from the upper layers 1 2026 CT#88e CP-201097 2265 1 F Condition under which the UE shall enter 5GMM-IDLE mode when user plane CIoT 5GS optimization is used 1 2026 CT#88e CP-201104 2270 F Clarification in state transition of 5GMM-DEREGISTERED from another 2026 CT#88e CP-201104 2271 F Clarification of SMS over NAS supported bit in initial registration 1 2026 CT#88e CP-201104 2273 F Clarification on missing subclause in 5GMM-REGISTERED.
ATTEMPTING- 2026 CT#88e CP-201104 2275 1 F Correction to paging timer stop in case of integrity check failure 1 2026 CT#88e CP-201137 2278 2 F UE shall use the GUTI assigned by the same SNPN during registration 1 2026 CT#88e CP-201114 2281 1 F Clarification on S-NSSAI deletion based on the rejected NSSAI due to NSSAA in the roaming case 1 2026 CT#88e CP-201104 2283 B Indicate 5GSM cause when initiating 5GSM procedure for error handling 1.
